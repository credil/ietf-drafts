<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced. 
     An alternate method (rfc include) is described in the references. -->

<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!--
<!ENTITY RFC2629 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2629.xml">
-->
<!--
<!ENTITY RFC3552 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3552.xml">
<!ENTITY RFC5226 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5226.xml">
-->
<!-- NAT -->
<!ENTITY RFC2663 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2663.xml">
<!-- source address selection -->
<!--
<!ENTITY RFC3484 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3484.xml">
-->
<!-- DHCP4 -->
<!ENTITY RFC2131 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2131.xml">
<!-- DHCP6 -->
<!--- Stateful --->
<!ENTITY RFC3315 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3315.xml">
<!--- Stateless --->
<!ENTITY RFC3736 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3736.xml">
<!--- IPv6 prefix option --->
<!ENTITY RFC3633 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3633.xml">
<!ENTITY RFC6603 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6603.xml">
<!-- ND -->
<!ENTITY RFC4861 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4861.xml">
<!ENTITY RFC5942 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5942.xml">
<!-- Basic transition mechanism / dual stack -->
<!ENTITY RFC4213 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4213.xml">
<!-- IPv6 Router Advertisement Options for DNS configurations -->
<!ENTITY RFC6106 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6106.xml">
<!-- DNS64 -->
<!ENTITY RFC6147 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6147.xml">
<!-- ipv6 addressing for translator -->
<!ENTITY RFC6052 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6052.xml">
<!-- NAT64 for XLAT -->
<!-- framework for nat64 -->
<!ENTITY RFC6144 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6144.xml">
<!-- IP/ICMP Translation algorithm -->
<!ENTITY RFC6145 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6145.xml">
<!-- stateful NAT64 -->
<!ENTITY RFC6146 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6146.xml">
<!ENTITY RFC6384 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6384.xml">
<!-- wrong DNS -->
<!ENTITY RFC4074 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4074.xml">
<!---   NAT Behavioral Requirements for Unicast UDP --->
<!ENTITY RFC4787 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4787.xml">
<!--- STUN --->
<!ENTITY RFC5389 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5389.xml">
<!--- STUN --->
<!ENTITY RFC5780 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5780.xml">
<!--- TURN --->
<!ENTITY RFC5766 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5766.xml">
<!--- IPoE --->
<!ENTITY RFC0894 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.0894.xml">
<!--- PPPoE --->
<!ENTITY RFC2516 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2516.xml">
<!--- v4 linklocal --->
<!ENTITY RFC3927 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3927.xml">
<!--- v4 linklocal assumption --->
<!ENTITY RFC4943 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4943.xml">
<!--- v4 linklocal assumption --->
<!ENTITY RFC4193 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4193.xml">
<!--- experiences from IPv6 only network, draft-arkko --->
<!ENTITY RFC6586 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6586.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs), 
     please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space 
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<!--
<rfc category="info" docName="draft-hazeyama-widecamp-ipv6-only-experience-02" ipr="trust200902">
-->
<rfc category="info" docName="draft-hazeyama-widecamp-ipv6-only-experience-02" ipr="trust200902">
  <!-- category values: std, bcp, info, exp, and historic
     ipr values: trust200902, noModificationTrust200902, noDerivativesTrust200902,
        or pre5378Trust200902
     you can add the attributes updates="NNNN" and obsoletes="NNNN" 
     they will automatically be output with "(if approved)" -->

  <!-- ***** FRONT MATTER ***** -->

  <front>
    <!-- The abbreviated title is used in the page header - it is only necessary if the 
         full title is longer than 39 characters -->

    <title abbrev="IPv6 Experiments in the WIDE Camp">
	Experiences from IPv6-Only Networks with Transition Technologies
        in the WIDE Camp Autumn 2012
    </title>

    <!-- add 'role="editor"' below for the editors if appropriate -->

    <!-- Another author who claims to be an editor -->

    <author fullname="Hiroaki Hazeyama" initials="H." 
            surname="Hazeyama">
      <organization>NAIST</organization>

      <address>
        <postal>
          <street>Takayama 8916-5</street>

          <!-- Reorder these if your country does things differently -->

          <city>Nara</city>

          <region></region>

          <code></code>

          <country>Japan</country>
        </postal>

        <phone>+81 743 72 5216</phone>

        <email>hiroa-ha@is.naist.jp</email>

        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>

    <author fullname="Ruri Hiromi" initials="R." 
            surname="Hiromi">
      <organization>Intec Inc.</organization>

      <address>
        <postal>
          <street>1-3-3 Shin-Suna, Koutou</street>

          <!-- Reorder these if your country does things differently -->

          <city>Tokyo</city>

          <region></region>

          <code></code>

          <country>Japan</country>
        </postal>
        <email>hiromi@inetcore.com</email>
        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>

    <author fullname="Tomohiro Ishihara" initials="T." 
            surname="Ishihara">
      <organization>Univ. of Tokyo</organization>

      <address>
        <postal>
          <street>3-8-1 Komaba, Meguro</street>

          <!-- Reorder these if your country does things differently -->

          <city>Tokyo</city>

          <region></region>

          <code></code>

          <country>Japan</country>
        </postal>
        <email>sho@c.u-tokyo.ac.jp</email>
        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>

    <author fullname="Osamu Nakamura" initials="O." 
            surname="Nakamura">
      <organization>WIDE Project</organization>

      <address>
        <postal>
          <street>5322 Endo</street>

          <!-- Reorder these if your country does things differently -->

          <city>Kanagawa</city>

          <region></region>

          <code></code>

          <country>Japan</country>
        </postal>
        <email>osamu@wide.ad.jp</email>
        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>


    <date year="2012" />

    <!-- If the month and year are both specified and are the current ones, xml2rfc will fill 
         in the current day for you. If only the current year is specified, xml2rfc will fill 
	 in the current day and month for you. If the year is not the current one, it is 
	 necessary to specify at least a month (xml2rfc assumes day="1" if not specified for the 
	 purpose of calculating the expiry date).  With drafts it is normally sufficient to 
	 specify just the year. -->

    <!-- Meta-data Declarations -->

    <area>Operation and Management</area>

    <workgroup>Network Working Group</workgroup>

    <!-- WG name at the upperleft corner of the doc,
         IETF is fine for individual submissions.  
	 If this element is not present, the default is "Network Working Group",
         which is used by the RFC Editor as a nod to the history of the IETF. -->

    <keyword>IPv6 Only network, NAT64, DNS64, DHCP6 </keyword>

    <!-- Keywords will be incorporated into HTML output
         files in a meta tag but they have no effect on text or nroff
         output. If you submit your draft to the RFC Editor, the
         keywords will be used for the search engine. -->

    <abstract>
      <t>
This document reports and discusses issues on IPv6 only networks and IPv4/IPv6 transition technologies through our experiences on the 3rd experiment on the WIDE camp. The 3rd experiment was held from September 3rd to September 6th, 2012. As well as past two experiments, we conducted face to face interview to participants for grasping IPv6 capability on users' devices, OSes, and applications. In addition to this, we explored solutions to mitigate timeout / fallback problems of IPv4/IPv6 dual stack clients on an IPv6 only network that is composed of DHCP6 and DNS64/NAT64. 

      </t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>
<!--The original specification of xml2rfc format is in <xref
      target="RFC2629">RFC&nbsp;2629</xref>.
-->

This document reports and discusses issues on IPv6 only networks and IPv4/IPv6 transition technologies through our experiences on the 3rd experiment on the WIDE camp. The 3rd experiment was held from September 3rd to September 6th in Matsushiro Royal Hotel, Nagano, Japan, where is the same hotel of the 1st and 2nd experiments. 
</t>

     <section title="History of ``Live with IPv6 experiments'' on the WIDE camp">
<t> "Live with IPv6 experiment" aims to evaluate commercial IPv6 network services, the availability of IPv6 networks with several IPv4 / IPv6 translation / encapsulation technologies by actual users' experiences, and to grasp issues on IPv4 exhaustion situation or IPv4 / IPv6 transition. These experiments are based on an assumption that ISP backbone networks will be constructed on IPv6 only and end customer will have to use an IPv6 network with 64 translators or an IPv4 network with 464 translators to keep current usage of the Internet services. 
</t>
        <section title="Summary of the 1st experiment">

<t>
The 1st experiment was held in Matsushiro Royal Hotel from September 6th to September 9th, 2011 with 153 participants, and the experiment result was reported in the v6ops BoF on IETF 82 Taipei. 
In the 1st experiment, we constructed an IPv6 only network with stateless NAT64 and DNS64 as a part of the WIDE backbone through IPv6 L2TP over a commercial IPv6 network service. 
The commercial IPv6 network service was provided by NTT-East as an Access Carrier, Internet MultiFeed (MFeed) as a Virtual Network Enabler (VNE) and IIJ as an IPv6 Internet Service Provider (IPv6 ISP). In addition to an IPv6 connectivity with NAT64/DNS64, we also tested a <xref target="I-D.draft-matsuhira-sa46t-spec">SA46T</xref> based IPv4 global network service and a <xref target="I-D.draft-murakami-softwire-4rd">murakami-4RD</xref> based IPv4 private network service (murakami-4RD is now merged into <xref target="I-D.draft-ietf-softwire-map-02">MAP</xref>). 
With referring IETF's IPv6 only network experiences <xref target="RFC6586"></xref>, we reported several new issues on an IPv6 only network with IPv4 / IPv6 transition technologies, especially on inappropriate DNS replies mentioned in  <xref target="RFC4074"></xref>, on MTU mismatch, on VPN protocols and applications through IPv4 / IPv6 translators. 
</t>
        </section><!--- 1st --->
        <section title="Summary of the 2nd experiment">

<t>
According to the experiences on the 1st experiment, the 2nd experiment was conducted from March 5th to March 8th, 2012 in Matsushiro Royal Hotel, the same hotel of the 1st experiment. 
171 participants joined this 2nd experiment, most of them were engineers or academic people. 
The 2nd experiment result was reported in the v6ops BoF on IETF 83 Paris.</t>

<t>
The settings of the core network in the 2nd experiment was same as the 1st experiment. 
In the 1st experiment, a commercial IPv6 network service was employed as a backbone network, in other word, we did evaluate the availability of commercial IPv6 network services from the view of home users. 
Therefore, the evaluation target of the 2nd experiment was planned as living in commercial IPv6 networks with IPv4 / IPv6 translation technologies or IPv4 / IPv6 translation services.
</t>
<t>
The user access networks of the 2nd experiment were achieved by two types of commercial IPv6 network services through the NTT NGNv6 access network, with four kinds of IPv4 / IPv6 translation technologies. 
One of the two commercial IPv6 network services was /48 prefix IPv6 network service through IPoE<xref target="RFC0894"></xref> on NTT NGNv6 (we name it "native IPoE" in this draft), the other was /56 prefix IPv6 network service through PPPoE<xref target="RFC2516"></xref> on NTT NGNv6 (we label it "native PPPoE" in this draft) <xref target="YasudaAPRICOT2011"></xref>. Both IPv6 networks were served from NTT-East, MFeed and IIJ as same as the 1st experiment. 
</t>
<t>
Usually, IPv6 networks on both native IPoE and native PPPoE were provided with only DNS v6 proxy. We constructed DNS64/NAT64 service on the WIDE backbone and on the camp core network, and served it through <xref target="RFC3736">stateless DHCP6</xref> both on native IPoE and on native PPPoE. 
</t>
<t>
Along with the DNS64/NAT64 translation service, for aiming to evaluate more practical approaches on the current commercial environments, we tested three IPv4 services over IPv6 networks, <xref target="I-D.draft-murakami-softwire-4rd">murakami-4RD </xref>, <xref target="I-D.draft-matsuhira-sa46t-spec">SA46T</xref> and <xref target="I-D.draft-ietf-v6ops-464xlat"> 464XLAT</xref>. We mainly served seven IP networks to participants by combination of those networks and translation services, that is, native IPoE with DNS64/NAT64, native PPPoE with DNS64/NAT64, murakami-4RD on both IPoE and PPPoE, 464XLAT on both IPoE and PPPoE, SA46T on PPPoE. 
</t>
<t>
Three evaluations were mainly conducted by the evaluation team, i) user survey about the availability of each network through face to face interview, ii) analysis of DNS behaviors to grasp inappropriate behaviors mentioned in  <xref target="RFC4074"></xref>, iii) availability test of VPN applications to analyze MTU problems For to grasp whether an unavailability of VPN applications was intentional one due to the specification of  a translation technology or not. 
Also, Konami Digital Entertainment (KDE) joined in this experiment, and evaluated NAT/Firewall traversal testing on each IPv6 network or each translator service from the view of commercial (P2P) Network Game services. KDE gave us the importance / requirements of hair-pinning functions and of MTU / packet fragmentation handling on NAT/NAPT for P2P based Multiplayer Online Games. 
</t>
         </section><!--- 2nd --->


      </section> <!--- history --->

        <section title="Abstract of the 3rd experiment">
<t>
The 3rd experiment was conducted from September 3rd to September 6th, 2012 in Matsushiro Royal Hotel, the same hotel of the past two experiments. 
136 participants joined this 3rd experiment, most of them were engineers or academic people. 
</t>

<t>
The aims of 3rd experiments were 1) continuous user survey on IPv6 capability of devices, OSes and applications, 2) exploration of a practical solution to mitigate timeout / fallback problems of IPv4/IPv6 dual stack clients on an IPv6 only network. 
</t>
<t>
The first aim was conducted to grasp the IPv6 capability of users' devices, OSes, and applications and to collect users' experiences through face to face interview. From the 2nd experiments, several new OSes or new devices have been released. Through this continuous survey, we saw the current development / deployment strategy of IPv6 on commercial vendors or Telecom / Internet Service providers. This user survey was mainly carried on September 3rd and September 4th. 
</t>
<t>
The second aim was derived from our experiences of an IPv6 only network with DHCP6/DNS64/NAT64 on past two experiments. In past two experiments, various OSes met several timeout / fallback problems, in the initial connection setting through Wi-Fi settings, in the name server selection, in the establishment of a TCP connection. Most OSes and applications, that met tedious timeout / fallback problems, preferred IPv4 to IPv6, or required IPv4 settings to enable IPv6 settings. These timeout / fallback problems were seemed to be derived from an assumption that there are no IPv6 only network on the current situation. 
</t>

<t>
Toward the sunset of IPv4, we have to explore and achieve a practical solution to move from IPv4/IPv6 dual stack networks to IPv6 only networks without giving stress or difficulties to end users. In IPv4/IPv6 transition situation, end users will usually use IPv4/IPv6 dual stack mode, and they will leave all IPv4 / IPv6 network settings by OSes' auto configuration behaviors on their devices except for selecting Wi-Fi connections. 
</t>
<t>
We focused on testing an IPv6 only network that was basically composed of DHCP6, DNS64 and NAT64. In this IPv6 only network, we sought a current practice of timeout / fallback mitigation among IPv4/IPv6 dual stack networks and IPv6 only networks. 
According to results of the user survey, we added several functions to a basic DHCP6/DNS64/NAT64 network in step by step fashion, and we analyzed or revised mitigation methods for timeout / fallback problems. 
</t>
<t>
This draft is composed of following sections. We explain the overview of the network settings in the 3rd experiment at first. Next, we report the result of the user survey. Then, we describe the experiment on timeout / fallback mitigation methods. Finally, we summarize our practical timeout / fallback mitigation method. We also mention about limitations our mitigation method and our recommendations on development / deployment of IPv6 capability on end clients. 
</t>

         </section><!--- 3rd --->

      <section title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <xref
        target="RFC2119">RFC 2119</xref>.</t>
      </section><!--- requirement language --->

    </section>

    <section title="Technology and Terminology">
<t>In this document, the following terms are used.  "NAT44" refers to any IPv4-to-IPv4 network address translation algorithm, both "Basic NAT" and "Network Address/Port Translator (NAPT)", as defined by <xref target="RFC2663"></xref>.
</t>

<t>"Dual Stack" refers to a technique for providing complete support for both Internet protocols -- IPv4 and IPv6 -- in hosts and routers <xref target="RFC4213"></xref>.</t>

<t> "NAT64" refers to a Network Address Translator - Protocol Translator defined in <xref target="RFC6052"></xref>, 
<xref target="RFC6144"></xref>,
<xref target="RFC6145"></xref>,
<xref target="RFC6146"></xref>,
<xref target="RFC6384"></xref>.
</t>

<t> "DNS64" refers DNS extensions to use NAT64 translation from IPv6 clients to IPv4 servers with name resolution mechanisms that is defined in <xref target="RFC6147"></xref>. 
</t>


<t> "DHCP4" refers Dynamic Host Configuration Protocol for IPv4 that is defined in <xref target="RFC2131"></xref>.
</t>

<t> "DHCP6" refers Dynamic Host Configuration Protocol for IPv6. So called "Stateful DHCP6" is defined in <xref target="RFC3315"></xref> and "Stateless DHCP6" is defined in <xref target="RFC3736"></xref>. "DHCP-PD" or "DHCPv6 Prefix Delegation" refers IPv6 Prefix Options for DHCP6 that is initially defined in <xref target="RFC3633"></xref> and updated in <xref target="RFC6603"></xref>. 
</t>

<t> "ND" refers Neighbor Discovery for IP version 6 (IPv6) that is defined in <xref target="RFC4861"></xref> and updated in <xref target="RFC5942"></xref>. 
</t>

    </section>

    <section title="Basic configuration of Network and Experiments">
<t>
The WIDE Camp Autumn 2012 was held at Matsushiro Royal Hotel in Nagano Prefecture of Japan, the same place of the 1st and 2nd experiment, from September 3rd to September 6th, 2012. <xref target="topology_overview"></xref> shows the overview of the whole network topology on the WIDE Camp Autumn 2012.
</t>

<t>
Besides our IPv6 only experiments, the camp NOC team set up a core network (camp-net-core) for preparing a backup plan of our IPv6 only network experiments and for conducting other experiments such as OLSR emulation,  <xref target="I-D.draft-matsuhira-sa46t-at-00">SA46T-AT</xref> and NAT44 double translation, and measurement of a satellite link. All server instances and routing instances of the core network were built on StarBED that is a cloud / network emulation testbed in Japan. We constructed two layer 2 tunnels  between StarBED and Matsushiro Royal hotel through IPv4 PPPoE. The layer 2 tunnels over IPv4 PPPoE were constructed by NEC IX2015. The OLSR network and the satellite link were served as IPv4 / IPv6 dual stack networks. The wireless Accesses to these networks were provided by CISCO Systems Mesh Wi-Fi Access Point and WLC (Wireless LAN Controller). 
</t>

<t>
As well as our 2nd experiment, a commercial IPv6 service was employed to achieve our IPv6 only network experiments. 
The Access Carrier (AC), the Virtual Network Enabler (VNE) and the IPv6 Internet Service Provider (v6ISP) of this 3rd experiment were same combination of past experiments, that is, NTT-East as AC, MFeed as the VNE and IIJ Mio as v6ISP. 
We contracted two external FTTH lines by NTT NGNv6 IPoE method. 
We changed the IPv6 address allocation method on NTT NGNv6 IPoE during this camp. 
</t>

<t>
From September 2th (the preparation day) to September 4th, we used the RA method for the external connectivity. <xref target="topology_ra"></xref> represents details of the IPv6 only network by RA method. From September 5th to September 6th, we changed the external connectivity to the DHCP-PD method. 
</t>
<t>
In the RA method, we tested the DHCP6 client behaviors when two stateless DHCP6 servers exist, one is placed by the VNE or ISP to indicate AAAA name servers, the other is located in the local subnet to lead clients to a DNS64 name server.
On the other hand, we explored mitigation methods for timeout / fallback problems after we changed the external connectivity to the DHCP-PD method. 
We explain the experiment on the RA method in <xref target="RA"></xref> and the experiments on the DHCP-PD method in <xref target="DHCP PD"></xref>, respectively. 
</t>
<t>
We employed following implementations for key components;
  <list style="symbols">
    <t>DNS64 and recursive cache server: NLNet Labs Unbound 1.4.7 with DNS64 patch</t>
    <t>NAT64 : OpenBSD 5.1 PF (Packet Filter)</t>
    <t>DHCP-PD client : WIDE DHCP client (dhcp6c)</t>
    <t>Stateless DHCP6 server : Alaxala 3630 </t>
   </list>
</t>

      <figure align="center" anchor="topology_overview">
        <artwork align="left"><![CDATA[

    +----------------------------------------------------+
    |               The Internet  (IPv4 / IPv6)          |
    +----------------------------------------------------+
           |     |                      |
           |     |                      |
  +-----------+  |               +--------------+
  | IIJ (ISP) |  |               |  WIDE (ISP)  |---------+
  +-----------+  |               +--------------+         |
           |     |                  |         |           |
           |     |                  |      (L2 Tunnel)    |
           |     |             (IPv4/IPv6)    |           |
           |     |                  |     +---------+     |
           |     |                  |     | IX 2015 |     |
        +-----------+               |     +---------+     |
        |MFeed (VNE)|               |         |           |
        +-----------+          +---------------+  +-------------+
               |               | camp-net-core |  | SAT station |
               |               +---------------+  +-------------+
               |                                          |
   +--------------------------+                           |
   |  NTT NGNv6 (Access Line) |                  (satellite link)
   +--------------------------+                           |
        |      |                                  +-------------+
      (IPoE method)                               | SAT station |
        |      |                                  +-------------+
        |      +--------------+                           |
        |      |              |                           |
     (native IPv6)  (L2 tunnel over IPv4 PPPoE)       (L2 Tunnel)
        |      |              |                           |
        |      |        +---------+                  +---------+
        |      |        | IX 2015 |                  | IX 2015 |
        |      |        +---------+                  +---------+
        |      |              |                           |
        |      |           (vlan)                      (vlan)
        |      |              |                           |
 +------------------------------------------------------------+
 |      Wi-fi Access (CISCO  Layer 2 mesh, 11b/g/n Wi-fi)     |
 +------------------------------------------------------------+


            ]]></artwork>

       <postamble> Over view of the 2nd experiment topology </postamble>
      </figure>


    </section> <!-- network -->

    <section anchor="Experiments" title="Experiments">

       <section anchor="RA" title="An Experiment in RA method">
          <section anchor="Detail of RA" title="Details of Network Configuration">

<t>
The experiment conducted in RA method was overwriting client DNS information by a local stateless DHCP6 server. <xref target="topology_ra"></xref> shows the test network topology. 
The RA method provided /64 prefix addresses and routing information through RA. The RA was set managed flag as zero (M flag == 0) and the other flag to one (O flag == 1) to let clients query to stateless DHCP6 servers. In this case, a stateless DHCP6 server was placed on the VNE network of MFeed and IIJ that advertised two AAAA name servers. Those two AAAA name servers returned only AAAA records to any queries. 
</t>
<t>
We wanted to inform only the DNS64 IPv6 address to clients on this RA method while using address assignment and default route settings by the RA method. Of course, we could not control the DHCP6 server on the VNE network. Therefore, we tried to use the preference option of DHCP6. 
</t>
<t>
The preference option of DHCP6 (section 22.8 of <xref target="RFC3315"></xref>) defines that "the Preference option is sent by a server to a client to affect the selection of a server by the client". 

Section 17.1.3 of <xref target="RFC3315"></xref> defines the criteria on the behavior of DHCP6 server selection by a client when the client has received two or more valid advertise messages;  

    <list style="symbols">
      <t> Those Advertise messages with the highest server preference 
        value are preferred over all other Advertise messages.
      </t>
      <t> Within a group of Advertise messages with the same server
      preference value, a client MAY select those servers whose
      Advertise messages advertise information of interest to the
      client.  For example, the client may choose a server that returned
      an advertisement with configuration options of interest to the
      client.</t>
      <t> The client MAY choose a less-preferred server if that server 
          has a better set of advertised parameters, such as 
          the available addresses advertised in IAs. </t>
  </list>
</t>
<t>
We assumed we could overwrite the name server information by sending advertise messages with highest preference value from a local stateless DHCP6 server. 
Thus, we placed a local stateless DHCP6 server shown in <xref target="topology_ra"></xref>.
</t>
<t>
This overwriting was partially succeeded as well as we assumed, however, several inconveniences were reported through face to face interview and inspection by the special observation team. 
</t>

      <figure align="center" anchor="topology_ra">
        <artwork align="left"><![CDATA[

                                           +-------+ +------+
                                           | DNS64 | | NAT64|
                                           +-------+ +------+
                                               |        |
                                             (-- StarBED --)
                                               |        |
    +--------------- IPv6 Internet ----------------------+
          |
    +-------------+
    | IPv6 router |
    |   on ISP    |
    +-------------+
          |
    +---------+  +---------+  +----------+             +---------+
    | IPv6 GW |  | DHCP6   |  |AAAA name |             | DHCP6   |
    |         |  | to AAAA |  | servers  |             | to DNS64|
    +---------+  +---------+  +----------+             +---------+
          |         |               |                     |
        (----------  VNE  --------------)             (-- Hotel --)
          |         |               |                     |
    +----------------  /64 prefix segment -----------------------+
                                                      |
                                                  +---------------+
                                                  | users devices |
                                                  +---------------+
                                                      
            ]]></artwork>

       <postamble> The Test Topology on RA method </postamble>
      </figure>


          </section> <!-- Details of Network Configuration -->

          <section anchor="Survey" title="User Survey">

<t>
59 participants (42.8 %) replied our face to face interview. 
We show the client profile in <xref target="Client Profile"></xref> and reported troubles in <xref target="Behaviors of DHCP6 Clients"></xref> and <xref target="Fallback Problems"></xref>. 
</t>
            <section anchor="Client Profile" title="Client Profile">
<t>
94 unique devices were profiled. The distribution of the pair of device and OS were shown in <xref target="table_devices"></xref>. 
</t>

        <texttable anchor="table_devices" title="The distributions of devices of participants">

<!--          <preamble>Tables use ttcol to define column headers and widths.
          Every cell then has a "c" element for its content.</preamble>
-->
          <ttcol align="center">Device Type</ttcol>
          <ttcol align="center">OS Type</ttcol>
          <ttcol align="center"># of devices (%) </ttcol>

          <c>PC/AT Note PC</c>
          <c> Windows 7  </c>
          <c> 16 (17.0 %)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>PC/AT Note PC</c>
          <c> NetBSD </c>
          <c> 2 (2.1 %)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>PC/AT Note PC</c>
          <c> Linux </c>
          <c> 4 (4.3 %)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>Apple Note PC </c>
          <c> Mountain Lion </c>
          <c> 15 (16.0 %)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>Apple Note PC </c>
          <c> Lion </c>
          <c> 18 (19.1%)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>Apple Note PC </c>
          <c> Snow Leopard </c>
          <c> 9 (9.6 %)</c>


          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>Apple Note PC </c>
          <c> Windows 7 (Bootcamp) </c>
          <c> 3 (3.2 %)</c>


          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>iPhone / iPod </c>
          <c> iOS 5 </c>
          <c> 9 (9.6 %)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>Android Phone </c>
          <c>Android OS 4 </c>
          <c>3 (3.2 %)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>Android Phone </c>
          <c>Android OS 2 </c>
          <c>4 (4.3 %)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c>Android Phone </c>
          <c>Android OS 1 </c>
          <c>1 (1.0 %)</c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c> iPad  </c>
          <c> iOS 6  </c>
          <c> 1 (1.0 %)  </c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c> iPad  </c>
          <c> iOS 5  </c>
          <c> 6 (6.4 %)  </c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c> Android Tablet  </c>
          <c> Android OS 4  </c>
          <c> 2 (2.1 %)  </c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c> Kindle  </c>
          <c> Kindle 3.3 </c>
          <c> 1 (1.0 %)  </c>

          <c> ----------------- </c>
          <c> ----------------- </c>
          <c> ----------------- </c>

          <c> Total  </c>
          <c>    </c>
          <c> 94   </c>

<!--
          <postamble>which is a very simple example.</postamble>
-->
        </texttable>

            </section> <!-- Client Profile -->

            <section anchor="Behaviors of DHCP6 Clients" title="Behaviors of DHCP6 Clients">
<t>
Many users reported inconveniences of DHCP6 client behaviors in the RA method. We focused on the analysis of DHCP6 client behavior of Windows 7 and of Mac OS X Lion / Mountain Lion. Both Windows 7 and Mac OS X usually stored DNS64 IPv6 address to their name server information, however, both of them sometime stored two AAAA name servers on the VNE network. Differences of their DHCP6 client behaviors were as follows;
    <list style="symbols">
      <t> In most cases, Windows 7 preferred to the advertise message from the local DHCP6 server that indicated the DNS64 server, however, it often preferred the advertise message from the DHCP6 server on the VNE network at the RA refresh timing. 
         <list style="symbols">
           <t> When the DHCP6 client preferred to the DHCP6 server on the VNE network, an user had to reset the Wi-Fi device of his/her PC and to reconnect to the Wi-Fi network. "ipconfig /renew" or simply reconnecting by Wi-Fi selection icon often failed to prefer the advertise message from the local DHCP6 server. 
           </t>
         </list>
      </t>
      <t> On the other hand, Mac OS X Lion and Mountain Lion often failed to prefer the advertise message from the local DHCP6 server at the initial set up on Wi-Fi setting, however, "Renew DHCP lease" on the detail of network settings always preferred to the advertise message from the local DHCP6 server, that is, Mac OS X always changed the name server setting to only DNS64 IPv6 address by "Renew DHCP lease". At RA refresh timing, Mac OS X sometime preferred to the DHCP6 server on the VNE network, then, the user had to refresh DHCP configurations again. 
      </t>
  </list>

</t>
            </section> <!-- Behaviors of DHCP6 Clients -->

            <section anchor="Fallback Problems" title="Timeout / Fallback Problems">

<t>
Many users reported inconveniences due to timeout / fallback problems. Root causes were roughly categorized into 1) troubles of DNS64, 2) incapability of IPv6 and of DNS64 on various servers and applications mentioned in <xref target="RFC4074"></xref> and <xref target="RFC6586"></xref>, 3) incapability of DHCP6 client and / or IPv4 dependency on OSes. In <xref target="DHCP PD"></xref>, we explain the detail of timeout / fallback problems without effects by the selection of stateless DHCP6 servers. 
</t>

            </section> <!-- Fallback Problems -->

          </section> <!-- User Survey -->

       </section> <!-- RA method -->

       <section anchor="DHCP PD" title="Experiments in DHCP-PD method">
<t>
On the contrary of the RA method mentioned in <xref target="RA"></xref>, the DHCP-PD method provided /56 prefix delegation by DHCP6 prefix delegation mechanism. We settled a DHCP-PD client PC router and set up static routes to two delegated /64 networks, one was labeled as "v6only-basic", the other was named as "v6only-fallback". The v6only-basic network was a basic IPv6 only network that was composed of stateless DHCP6, DNS64 and NAT64. On the other hand, we tested several timeout / fallback mitigation methods in "v6only-fallback". 
<xref target="topology_experiment0"></xref> shows the basic network topology of experiments on DHCP-PD method.
</t>

          <section anchor="Detail of DHCP PD" title="Basic Network Configuration">
<t>
<xref target="topology_experiment0"></xref> shows the basic network topology of experiments on DHCP-PD method.
</t>
      <figure align="center" anchor="topology_experiment0">
        <artwork align="left"><![CDATA[

                                           +-------+ +------+
                                           | DNS64 | | NAT64|
                                           +-------+ +------+
                                               |        |
                                             (-- StarBED --)
                                               |        |
    +--------------- IPv6 Internet ----------------------+
                           |
                   +-------------+      +----------------+
                   | IPv6 router |      | DHCP PD server |
                   |   on ISP    |      |    on VNE      |
                   +-------------+      +----------------+
                           |                    |
 +-- (VNE network) ----------------+----------------------+
                                   |      
                                   |(v6)
                                   |
                            (---- Hotel ----)
                                   |
                             +---------------+
                             | DHCP-PD Client|
                             |  PC router    |
                             +---------------+
                                   |
   +-----------------+             |
   | Stateless DHCP6 |             |
   +-----------------+             |
              |                    |
              |                    |
    +------------- each /64 prefix segment ---------------+
                                           |
                                   +---------------+
                                   | users devices |
                                   +---------------+

            ]]></artwork>

       <postamble> Basic Network Topology on DHCP-PD method (v6only-basic)</postamble>
      </figure>

          </section> <!-- Details of Network Configuration -->

        <section anchor="Experiment0" title="Experiment 0">
<t>
In the experiment 0, we observed OSes behaviors again. Actually, the inconvenience on the selection of two stateless DHCP6 servers were resolved by DHCP-PD and placing one stateless DHCP6 server onto each /64 prefix subnet. However, we clearly recognized several timeout / fallback problems. In following sections, we explain timeout / fallback problems due to DHCP6 client incapability and IPv4 dependency of OSes. 
</t>
          <section anchor="Waiting timeout of DHCP4 in Windows 7" title="Waiting timeout of DHCP4 in Windows 7">

<t>
In Windows 7, timeout of DHCP4 queries spent a few minutes in the initial Wi-Fi connection setup. After fallback on the initial Wi-Fi connection, there were no problem on using IPv6 capable applications. DNS64 fallback failures due to the inappropriate authoritative servers still occurred, however, several authoritative servers, that returned inappropriate AAAA reply in past experiments, had been fixed to have appropriate fallback. 
</t>
         </section><!---- Windows 7 ---->

          <section anchor="Waiting timeout of IPv4 TCP in Mac OS X" title="Long TCP fallback in Mac OS X Lion and Mountain Lion">

<t>
Mac OS X implementations, such as Lion and Mountain Lion, had more serious timeout / fallback problems than Windows 7.
After the timeout of DHCP4 queries with a few minutes as well as Windows 7, the interface that is allocated IPv4 link local address was inserted as IPv4 default route. 
This Mac OS X behavior may be along with IPv4 on-link assumption in Section 3.3 of <xref target="RFC3927"></xref>. Section 3.3 of RFC3927 mentions "Interaction with Hosts with Routable Addresses", which assumes all IPv4 address are on-link at Link-Local configuration. 
</t>
<t>
Also, getaddrinfo implementation on Mac OS X did HappyEyeball like behavior. The getaddrinfo of Mac OS X returned an IP address list where IPv4 addresses were inserted the top of the list initially. Combining the on-link-assumption and the HappyEyeball like getaddrinfo caused long long TCP fallback from IPv4 to IPv6 in the initial TCP connection setup. Once the long long TCP fallback occurred, getaddrinfo of Mac OS X marked some flag that IPv4 is not available at the moment, then the getaddrinfo gave higher priority to IPv6 addresses than IPv4 addresses until ARP and / or ND tables were refreshed. When ARP and / or ND tables were refreshed, Mac OS X users face long long TCP fallback from IPv4 to IPv6 again. 
 
</t>
         </section><!---- Mac OS X ---->

          <section anchor="Incompletion of network settings in iOS 5" title="Incompletion of network settings in iOS 5">

<t>
In iOS 5, "Network Setting" were not completed, "Network Settings" will be completed only if IPv4 address, IPv4 router, and IPv4 DNS can be retrieved via DHCPv4 or manually configured all of these 3. 
</t>
         </section><!---- iOS 5 ---->

          <section anchor="Incapability of IPv6 DNS settings by DHCP6" title="Incapability of IPv6 DNS settings by DHCP6">

<t>
Windows XP, older Mac OS X (Snow Leopard and older) and Android OS required an IPv4 address for an DNS server even when they can use IPv6. In an IPv6 only network, DNS information should be gotten via DHCP6, these OSes did not support DHCP6 client. Also, Android cannot be configured to use DNS over IPv6 even in manual configuration. 
</t>
         </section><!---- incapability of DHCP6 ---->

       </section> <!-- Experiment 0 -->


       <section anchor="Experiment1" title="Experiment 1">

          <section anchor="Diff of network settings 0 and 1" title="Diff of network settings">

<t>
In the Experiment 1, we added a DHCP4 server that provided only IPv4 private address to DHCP4 client without the default gateway IPv4 address nor IPv4 address of DNS. We employed ISC-DHCP for this DHCP4 server.
</t>


      <figure align="center" anchor="topology_experiment1">
        <artwork align="left"><![CDATA[

                                           +-------+ +------+
                                           | DNS64 | | NAT64|
                                           +-------+ +------+
                                               |        |
                                             (-- StarBED --)
                                               |        |
    +--------------- IPv6 Internet ----------------------+
                           |
                   +-------------+      +----------------+
                   | IPv6 router |      | DHCP PD server |
                   |   on ISP    |      |    on VNE      |
                   +-------------+      +----------------+
                           |                    |
 +-- (VNE network) ----------------+----------------------+
                                   |      
                                   |(v6)
                                   |
                            (---- Hotel ----)
                                   |
                             +---------------+
                             | DHCP-PD Client|
                             |  PC router /  |
                             |    DHCP4      |
                             +---------------+
                                   |
   +-----------------+             |
   | Stateless DHCP6 |             |
   +-----------------+             |
              |                    |
              |                    |
    +------------- /64 prefix segment ---------------+
                                           |
                                   +---------------+
                                   | users devices |
                                   +---------------+

            ]]></artwork>

       <postamble> Test Topology on Experiment 1 (v6only-fallback) </postamble>
      </figure>


         </section><!---- incapability of DHCP6 ---->
          <section anchor="Result1" title="Result">
<t>
As the result of Experiment 1, only timeout of DHCP4 was solved, that is,  only Windows 7 was working well without any fallback problems except for DNS64 name resolving. 
TCP fallback problem on MacOS X still occurred.

iOS applications were sometimes working, but periodically failed due to retrying Wi-Fi connection setup. 
</t>
         </section><!---- Result ---->
       </section> <!-- Experiment 1 -->


       <section anchor="Experiment2" title="Experiment 2">

          <section anchor="Diff of network settings 1 and 2" title="Diff of network settings">

<t>
In the Experiment 2, we put BIND9 forwarder on-link and configured DHCP4/6 to use this DNS. We configured BIND9 forwarder with: * deny-answer-addresses { 0.0.0.0/0; }; * which directed that no IPv4 address answer should be trusted. It returned SERVFAIL to resolvers. 

</t>

      <figure align="center" anchor="topology_experiment2">
        <artwork align="left"><![CDATA[

                                           +-------+ +------+
                                           | DNS64 | | NAT64|
                                           +-------+ +------+
                                               |        |
                                             (-- StarBED --)
                                               |        |
    +--------------- IPv6 Internet ----------------------+
                           |
                   +-------------+      +----------------+
                   | IPv6 router |      | DHCP PD server |
                   |   on ISP    |      |    on VNE      |
                   +-------------+      +----------------+
                           |                    |
 +-- (VNE network) ----------------+----------------------+
                                   |      
                                   |(v6)
                                   |
                            (---- Hotel ----)
                                   |
                             +------------------+
                             | DHCP-PD Client   |
                             |  PC router /     |
                             |    DHCP4 /       |
                             | Bind 9 forwarder |
                             | which treats "A" |
                             | as SERVAFAIL     |
                             +------------------+
                                   |
   +-----------------+             |
   | Stateless DHCP6 |             |
   +-----------------+             |
              |                    |
              |                    |
    +------------- /64 prefix segment ---------------+
                                           |
                                   +---------------+
                                   | users devices |
                                   +---------------+

            ]]></artwork>

       <postamble> Test Topology on Experiment 2 (v6only-fallback) </postamble>
      </figure>

         </section><!---- incapability of DHCP6 ---->
          <section anchor="Result2" title="Result">
<t>
As result of Experiment 2, Android was working well. 
iOS was working, but periodically failed due to retrying to Wi-Fi connection setup.
MacOS X variants were working, but timeout by TCP fallback still occurred.
Windows XP was not working because all DNS queries failed due to SERVFAIL.


</t>
         </section><!---- Result ---->
       </section> <!-- Experiment 2 -->

       <section anchor="Experiment3" title="Experiment 3">

          <section anchor="Diff of network settings 2 and 3" title="Diff of network settings">

<t>
In the Experiment 3, we hacked AAAA filtering code on BIND9 to filter "A records" instead of "AAAA records" both on IPv4/IPv6 transport. We put BIND9 above to the local link, which was configured to forward all queries to DNS64. 
We also configured DHCP4/DHCP6 to use the DNS proxy. 
</t>

      <figure align="center" anchor="topology_experiment3">
        <artwork align="left"><![CDATA[

                                           +-------+ +------+
                                           | DNS64 | | NAT64|
                                           +-------+ +------+
                                               |        |
                                             (-- StarBED --)
                                               |        |
    +--------------- IPv6 Internet ----------------------+
                           |
                   +-------------+      +----------------+
                   | IPv6 router |      | DHCP PD server |
                   |   on ISP    |      |    on VNE      |
                   +-------------+      +----------------+
                           |                    |
 +-- (VNE network) ----------------+----------------------+
                                   |      
                                   |(v6)
                                   |
                            (---- Hotel ----)
                                   |
                             +-------------------+
                             | DHCP-PD Client    |
                             |  PC router /      |
                             |    DHCP4 /        |
                             | Bind 9 DNS Proxy  |
                             |  with "A" filter  |
                             +-------------------+
                                   |
   +-----------------+             |
   | Stateless DHCP6 |             |
   +-----------------+             |
              |                    |
              |                    |
    +------------- /64 prefix segment ---------------+
                                           |
                                   +---------------+
                                   | users devices |
                                   +---------------+

            ]]></artwork>

       <postamble> Test Topology on Experiment 3 (v6only-fallback)</postamble>
      </figure>

         </section><!---- incapability of DHCP6 ---->
          <section anchor="Result3" title="Result">
<t>
As the result of Experiment 3, Windows XP, MacOS X variants, iOS, Android were working well. Some of applications still failed on IPv6 only due to the IPv6 incapability or DNS64 fallback problem, but many cases were fine: IE/Safari/Chrome/Firefox, Twitter, Facebook, Instagram, and so on.
</t>
<t>
Remaining issues were connection failures during a few minutes after Wi-Fi was connected. We guess the possible reason of this failures as follows: RS (Router Solicitation) was sent from kernel before Wi-Fi link was established.  No IPv6 address was obtained until periodical RA (Router Advertisement) was received.

The possible workaround to this connection failure is shortening RA interval to 5-10 seconds (though it disturb Wi-Fi ...) or detecting association through AP log and kicking RS or RA. 

</t>

         </section><!---- Result ---->

      </section> <!-- Experiment 3 -->

       </section> <!-- DHCP-PD method -->

      </section> <!-- experiments -->

    <section title="Conclusion">
<t>Timeout / fallback problems on IPv4/IPv6 dual stack clients in an IPv6 only network are caused by 
    <list style="numbers">
      <t> timeout and fallback sequence on DHCP4 queries,</t>
      <t> timeout and fallback sequence on 
          the connectivity check to the IPv4 internet 
          after the DHCP4 auto configuration, </t>
      <t> connection retry sequence when the connectivity to the IPv4 
          internet was not given. </t>
      <t> timeout and fallback sequence of a TCP connection on Mac OS X 
          variants due to their HappyEyeball like behavior of 
          getaddrinfo,</t>
      <t> preference / dependency of IPv4 on name resolution,</t>
      <t> connection failures during 1-2 minutes after Wi-Fi was connected.</t>
  </list>
</t>
<t>To mitigate these timeout / fallback problems, our current practice is composed of following components;

 <list style="symbols">
  <t> Configure a DNS64 and a NAT64 in somewhere. </t>
  <t> Configure a Dual-stack DNS proxy as follows 
    <list style="symbols">
      <t> The DNS proxy forwards all queries to the DNS64 except 
          "A" query type (IPv4 address). 
          Since there is no IPv4 connectivity 
          on the client, all queries to "A" should be filtered and 
          the DNS proxy returns NO DATA, just like "AAAA" filtering. 
      </t>
      <t> This "A" filter should be enabled both on IPv4 and IPv6 
         transport.</t>
      <t> This Dual-stack "A" filter DNS proxy should be "on-link" 
         and reachable from IPv4/IPv6 dual stack mode clients.</t>
  </list>
  </t>
  <t> Configure a DHCP4 server to reply a private IPv4 address,
     an IPv4 gateway router, and IPv4 address of an "A" filter DNS 
     proxy to DHCP4 client.</t>
  <t> Configure a DHCP6 server to indicate the IPv6 address of 
     "A" filter DNS Proxy to DHCP6 client.
  <list style="symbols">
    <t> The IPv6 address of "A" filter DNS Proxy may be provided 
        to IPv4/IPv6 dual stack mode clients by 
        <xref target="RFC6106">RDNSS</xref>.
        However, from our experience on hot stage of Camp 1209 Autumn, 
        Mac OS X Lion and Mountain Lion could handle RDNSS, 
        but Windows 7 did not handle RDNSS. </t>
    <t> Only one DHCP6 server should be placed in each /64 prefix segment or indicated by DHCP6 relay. According to our experience, we do not recommend overwriting DNS information by a local stateless DHCP6 server with highest preference value due to the differences of handling multiple DHCP6 replies among DHCP6 client implementations. </t>
  </list>
  </t>
  <t>Configure the IPv4 gateway router not to forward any IPv4 packets. </t>
</list>
</t>
    </section>


    <section anchor="Security" title="Security Considerations">
<t>
As well as Arkko mentioned in <xref target="RFC6586"></xref>,
the use of IPv6 instead of IPv4 by itself does not make a big
security difference. 
In our experience, we only set up following security functions; 
the access control list on routers / servers, 
accounting on the wireless network access. 
</t>
    </section>

    <section anchor="IANA" title="IANA Considerations">
<t>
This document has no IANA implications.
</t>
    </section>




<!--
    <section anchor="Acknowledgments" title="Acknowledgments">
      <t>Here, we thank to 153 participants on this experiments.</t>

    </section>
-->
  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <!-- References split into informative and normative -->

    <!-- There are 2 ways to insert reference entries from the citation libraries:
     1. define an ENTITY at the top, and use "ampersand character"RFC2629; here (as shown)
     2. simply use a PI "less than character"?rfc include="reference.RFC.2119.xml"?> here
        (for I-Ds: include="reference.I-D.narten-iana-considerations-rfc2434bis.xml")

     Both are cited textually in the same manner: by using xref elements.
     If you use the PI option, xml2rfc will, by default, try to find included files in the same
     directory as the including file. You can also define the XML_LIBRARY environment variable
     with a value containing a set of directories to search.  These can be either in the local
     filing system or remote ones accessed by http (http://domain/dir/... ).-->

    <references title="Normative References">
      <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?-->
      &RFC2119;

      &RFC2663; <!-- NAT -->
      &RFC3736; <!-- DHCP6 --> <!-- no ref in middle -->
      &RFC4213; <!-- ??? -->
    </references>

    <references title="Informative References">
      <!-- Here we use entities that we defined at the beginning. -->
<!--
      &RFC2629;
      &RFC3552;
      &RFC5226;
-->

      &RFC4074; <!-- inappropriate AAAA replies -->
      &RFC6052;
      &RFC6106; <!-- RDNSS -->
      &RFC6144;
      &RFC6145;
      &RFC6146;
      &RFC6147;
      &RFC6384;

<!---
      &RFC4787;
      &RFC5389;
      &RFC5766;
      &RFC5780;
--->
      
      &RFC0894;
      &RFC2516;
      &RFC3927;
<!---
      &RFC4943;
      &RFC4193;
--->
      &RFC2131;
      &RFC3315;
      &RFC3633;
      &RFC6603;
      &RFC4861;
      &RFC5942;
      &RFC6586;

      <!-- A reference written by by an organization not a person. -->


      <reference anchor="YasudaAPRICOT2011"
                 target="http://meetings.apnic.net/__data/assets/pdf_file/0003/30981/Ayumu-Yasuda-apricot.pdf">
        <front>
          <title>Building for IPv6 by IPv6 Promotion Council Japan.</title>

          <author fullname="Ayumu Yasuda" initials="A."  surname="Yasuda">
            <organization>NTT East</organization>
          </author>

          <date year="February, 2011" />
          <keyword>http://meetings.apnic.net/__data/assets/pdf_file/0003/30981/Ayumu-Yasuda-apricot.pdf</keyword>
        </front>
      </reference>

<!---
      <reference anchor="I-D.draft-arkko-ipv6-only-experience"
                 target="draft-arkko-ipv6-only-experience-05 (work in progress)">
        <front>
          <title> Experiences from an IPv6-Only Network</title>

          <author initials="J."  surname="Arkko"></author>
          <author initials="A."  surname="Keranen"></author>

          <date year="Febrary 2012" />
          <keyword>draft-arkko-ipv6-only-experience-05 (work in progress)</keyword>
        </front>
      </reference>
--->


<!-- references for SA46T -->

<!---
      <reference anchor="I-D.draft-matsuhira-sa46t-as"
                 target="draft-matsuhira-sa46t-as-01 (work in progress)">
        <front>
          <title>Stateless Automatic IPv4 over IPv6 Tunneling with IPv4 Address Sharing</title>

          <author initials="N."  surname="Matsuhira"></author>

          <date year="April 2011" />
          <keyword> draft-matsuhira-sa46t-as-01 (work in progress)</keyword>
        </front>
      </reference>
--->

<!---
      <reference anchor="I-D.draft-matsuhira-sa46t-gaddr"
                 target="draft-matsuhira-sa46t-gaddr-03 (work in progress)">
        <front>
          <title> Stateless Automatic IPv4 over IPv6 Tunneling: Global SA46T Address Format</title>

          <author initials="N."  surname="Matsuhira"></author>

          <date year="July 2011" />
          <keyword> draft-matsuhira-sa46t-gaddr-03 (work in progress)</keyword>
        </front>
      </reference>
--->
<!---
      <reference anchor="I-D.draft-matsuhira-sa46t-mcast"
          target="draft-matsuhira-sa46t-mcast-00 (work in progress)">
        <front>
          <title> SA46T Multicast Support</title>

          <author initials="N."  surname="Matsuhira"></author>

          <date year="September 2011" />
          <keyword> draft-matsuhira-sa46t-mcast-00 (work in progress)</keyword>
        </front>
      </reference>
--->
<!---
      <reference anchor="I-D.draft-matsuhira-sa46t-motivation"
        target="draft-matsuhira-sa46t-motivation-00 (work in progress)">
        <front>
          <title> Motivation for developing Stateless Automatic IPv4 over IPv6 Tunneling (SA46T)</title>

          <author initials="N."  surname="Matsuhira"></author>

          <date year="July 2011" />
          <keyword> draft-matsuhira-sa46t-motivation-00 (work in progress)</keyword>
        </front>
      </reference>
--->

      <reference anchor="I-D.draft-ietf-v6ops-464xlat"
             target="draft-ietf-v6ops-464xlat-08 (work in progress)">
        <front>
          <title> 464XLAT: Combination of Stateful and Stateless Translation</title>

          <author initials="M."  surname="Mawatari"></author>
          <author initials="M."  surname="Kawashima"></author>
          <author initials="C."  surname="Byrne"></author>

          <date year="September 2012" />
          <keyword> draft-ietf-v6ops-464xlat-08 (work in progress)</keyword>
        </front>
      </reference>

<!---
      <reference anchor="I-D.draft-matsuhira-sa46t-applicability"
                 target="draft-matsuhira-sa46t-applicability-02 (work in progress)">
        <front>
          <title> Applicability of Stateless automatic IPv4 over IPv6 Tunneling (SA46T)</title>

          <author initials="N."  surname="Matsuhira"></author>

          <date year="July 2011" />
          <keyword> draft-matsuhira-sa46t-applicability-02 (work in progress)</keyword>
        </front>
      </reference>
--->

      <reference anchor="I-D.draft-matsuhira-sa46t-at-00"
                 target="draft-matsuhira-sa46t-at-00 (work in progress)">
        <front>
          <title> SA46T Address Translator </title>

          <author initials="N."  surname="Matsuhira"></author>
          <author initials="K."  surname="Horiba"></author>
          <author initials="Y."  surname="Ueno"></author>
          <author initials="O."  surname="Nakamura"></author>

          <date year="July 2011" />
          <keyword> draft-matsuhira-sa46t-at-00 (work in progress)</keyword>
        </front>
      </reference>

      <reference anchor="I-D.draft-matsuhira-sa46t-spec"
                 target="draft-matsuhira-sa46t-spec-05 (work in progress)">
        <front>
          <title>Stateless Automatic IPv4 over IPv6 Tunneling: Specification</title>

          <author initials="N."  surname="Matsuhira"></author>

          <date year="July 2012" />
          <keyword> draft-matsuhira-sa46t-spec-05 (work in progress)</keyword>
        </front>
      </reference>

<!-- reference to murakami-4RD and MAP -->
      <reference anchor="I-D.draft-murakami-softwire-4rd"
                 target="draft-murakami-softwire-4rd-01 (work in progress)">
        <front>
          <title>Stateless Automatic IPv4 over IPv6 Tunneling: Specification</title>

          <author initials="T."  surname="Murakami"></author>
          <author initials="O."  surname="Troan"></author>
          <author initials="S."  surname="Matsushima"></author>

          <date year="September 2011" />
          <keyword>draft-murakami-softwire-4rd-01 (work in progress)</keyword>
        </front>
      </reference>


      <reference anchor="I-D.draft-ietf-softwire-map-02"
                 target="draft-ietf-softwire-map-02 (work in progress)">
        <front>
          <title> Mapping of Address and Port with Encapsulation (MAP)</title>

          <author initials="O."  surname="Troan"></author>
          <author initials="C."  surname="Bao"></author>
          <author initials="S."  surname="Matsushima"></author>
          <author initials="T."  surname="Murakami"></author>

          <date year="September 5, 2012" />
          <keyword>draft-ietf-softwire-map-02 (work in progress)</keyword>
        </front>
      </reference>


<!-- references to software -->
<!---
      <reference anchor="SEIL"
                 target="http://www.seil.jp/">
        <front>
          <title>SEIL</title>
          <author>
            <organization> Internet Initiative Japan </organization>
          </author>
            <date year="September 2011" /> 
        </front>
      </reference>
--->
<!--
      <reference anchor="bind"
                 target="http://www.isc.org/software/bind">
        <front>
          <title>BIND</title>
          <author>
            <organization> Internet Systems Consortium. </organization>
          </author>
        </front>
      </reference>
-->

<!--
      <reference anchor="ISC-DHCP"
                 target="http://www.isc.org/software/dhcp">
        <front>
          <title>DHCP</title>
          <author>
            <organization> Internet Systems Consortium. </organization>
          </author>
        </front>
      </reference>
-->

<!--
      <reference anchor="linuxnat64"
                 target="http://linuxnat64.sourceforge.net/">
        <front>
          <title>Linux NAT64 implementation</title>
          <author>
            <organization>Geeknet, Inc.</organization>
          </author>
        </front>
      </reference>
-->

    </references>

    <section anchor="app-additional" title="Acknowledgments">
<!--
      <t>Here, we thank to 153 participants of WIDE camp 2011 autumn on this experiments. We also say thank you to N. Matsuhira of Fujitsu for the SA46T implementation, H. Suenaga and K. Ooyatsu of IIJ for SEIL 4RD implementation, NTT EAST, MFeed, and IIJ for serving the commercial IPv6 Internet service for this experiment on the Matsushiro Royal Hotel.</t>
-->
<t>
Here, we thank to all the participants of WIDE camp on the experiments. We also say thank you to whom serving implementations and services in the Matsushiro Royal Hotel.
</t>
<t> 
R. Nakamura of Univ. of Tokyo, Y. Ueno of Keio Univ. and R. Shouhara of Univ. of Tokyo for helping us on the base settings of the IPv6 only experiments and merging into the camp-net.
</t>
<t>
O. Onoe of Sony Corporation for his deep inspection and testing of end node devices.
</t>
<t>
T. Jimei of Internet Systems Consortium for his quick hack on A filter of Bind 9.
</t>
<t>
Y. Atarashi of Alaxala Networks and R. Atarashi of IIJ Innovation Institute for designing the items of face to face interview and analyzing user survey data.
</t>
    </section>

  </back>
</rfc>
