<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<rfc category="info" docName="draft-johansson-fticks-00"
     ipr="pre5378Trust200902">
  <front>
    <title abbrev="fticks">F-Ticks - A Federation Log Format</title>

    <author fullname="Leif Johansson" initials="L." role="editor"
            surname="Johansson">
      <organization>SUNET</organization>

      <address>
        <email>leifj@sunet.se</email>
      </address>
    </author>

    <author fullname="Stefan Winter" initials="S." surname="Winter">
      <organization>Restrena</organization>

      <address>
        <email>stefan.winter@restrena.lu</email>
      </address>
    </author>

    <date day="03" month="October" year="2013" />

    <area>General</area>

    <workgroup>Internet Engineering Task Force</workgroup>

    <abstract>
      <t>This document describes a log format for distributed identity
      federations that can be used as a tool for meetering and statistics
      gathering.</t>
    </abstract>

    <note title="Requirements Language">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <xref
      target="RFC2119">RFC 2119</xref>.</t>
    </note>
  </front>

  <middle>
    <section title="Introduction and Motivation">
      <t>Identity federations are often built as loosly coupled systems of
      identity providers and relying parties. In such a system it is often
      important to collect statistics and meetering in a consistent way.</t>

      <t>This document describes a simple (yet extensible) tex logformat which
      can be to communicate the essential aspects of authentication events to
      log reception software (eg <xref target="RFC5424">syslog</xref>).</t>
    </section>

    <section title="F-ticks Semantics">
      <t>An F-ticks log stream consists of a series of F-ticks log messages,
      each one represents a single authentication event. Each log message is
      generated at a federation entity (eg an identity provider or a relying
      party).</t>
    </section>

    <section title="F-ticks Format">
      <t>An F-ticks log message is a text string that fulfills the following
      <xref target="RFC5234">ABNF</xref>:</t>

      <figure>
        <artwork><![CDATA[fticks = "F-TICKS/" federation-identifier "/" version attribute-list
label = ( ALPHA / DIGIT / '_' / '-' / ':' / '.' / ',' / ';')
federation-identifier = label
version = label
attribute-list = 1*("#" attribute "=" value ) "#"
value = label
attribute = ( ALPHA / DIGIT )]]></artwork>
      </figure>

      <t>The federation-identifier and version can be used by federations and
      other communities to indicate the type of attributes used. This document
      does not describe any mandatory attributes but instead provides a list
      of attributes in use in various communities today.</t>

      <t>Future versions of this document may want to define an IANA registry
      for f-tick attribute definitions.</t>

      <t>Because of size constraints common to several log systems it is
      expected that f-ticks attributes are kept short.</t>
    </section>

    <section title="Common F-ticks Attributes">
      <t>In general a log consumer should not assume that any one attribute is
      present. Depending on the situation any one of these (or any other
      defined attributes) may be missing from an F-ticks message.</t>

      <section title="REALM">
        <t>The REALM attribute is used to convey the AAA-realm (eg RADIUS) of
        the authentication event. The presence of the REALM attribute implies
        that the message was generated by a AAA-based identity provider.</t>
      </section>

      <section title="VISCOUNTRY">
        <t>The ISO country code of the entity that generated the log
        messages.</t>
      </section>

      <section title="VISINST">
        <t>TODO</t>
      </section>

      <section title="CSI">
        <t>The Calling Station ID of the subject associated with the
        authentication event. The presence of this attribute implies that the
        message was generated by an AAA-based identity provider.</t>
      </section>

      <section title="RESULT">
        <t>The result of the authentication event - either 'OK' or 'FAIL'.</t>
      </section>

      <section title="RP">
        <t>Relying Party identifier. A string uniquely identifying the relying
        party invoved in the authentication event.</t>
      </section>

      <section title="AP">
        <t>Asserting party identifier. A string uniquely identifying the party
        making the claim towards the relying party. For an authentication
        event this is the identity provider. For an attribute authority lookup
        event this is the AA identifier.</t>
      </section>

      <section title="TS">
        <t>A timestamp (seconds since the epoch) associated with the
        authentication event. If this attribute is absent the consumer MAY
        choose to use a timestamp provided by the log message system (eg
        syslog) instead.</t>
      </section>

      <section title="AM">
        <t>Authentication Method identifier.</t>
      </section>

      <section title="PN">
        <t>A unique identifier for the subject involved in the event.</t>
      </section>
    </section>

    <section title="Examples">
      <t>TBD</t>
    </section>

    <section anchor="Acknowledgements" title="Acknowledgements">
      <t>The f-ticks log format has been in use in the eduroam community since
      TTT and was originally conceived as a usage-tracking mechanism by Stefan
      Winter.</t>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>Improperly configured logging may leak sensitive user information. In
      particular the PN attribute value (subject identitier) should be masked
      with a cryptographically keyed hash function before transmission.</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc include="reference.RFC.2119"?>

      <?rfc include="reference.RFC.5424"?>

      <?rfc include="reference.RFC.5234"?>
    </references>
  </back>
</rfc>
