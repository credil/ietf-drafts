<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced. 
     An alternate method (rfc include) is described in the references. -->

<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC3315 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3315.xml">
<!ENTITY RFC3633 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3633.xml">
<!ENTITY RFC4861 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4861.xml">
<!ENTITY I-D.ietf-dhc-option-guidelines SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-dhc-option-guidelines.xml">

<!ENTITY I-D.lear-abfab-arch SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.lear-abfab-arch.xml">


]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs), 
     please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="2"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space 
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="std" docName="draft-ietf-dhc-dhcpv6-solmaxrt-update-05" ipr='trust200902' updates="3315">
  <!-- category values: std, bcp, info, exp, and historic
     ipr values: full3667, noModification3667, noDerivatives3667
     you can add the attributes updates="NNNN" and obsoletes="NNNN" 
     they will automatically be output with "(if approved)" -->

  <!-- ***** FRONT MATTER ***** -->

  <front>
    <!-- The abbreviated title is used in the page header - it is only necessary if the 
         full title is longer than 39 characters -->

    <title abbrev="DHCPv6 SOL_MAX_RT Option">Modification to Default Values of
    SOL_MAX_RT and INF_MAX_RT</title> 

    <!-- add 'role="editor"' below for the editors if appropriate -->

    <!-- Another author who claims to be an editor -->

    <author fullname="Ralph Droms" initials="R." surname="Droms">
      <organization>Cisco Systems</organization>

      <address>
        <postal>
          <street>1414 Massachusetts Avenue</street>

          <!-- Reorder these if your country does things differently -->

          <city>Boxborough</city>

          <region>MA</region>

          <code>01719</code>

          <country>USA</country>
        </postal>

        <phone>+1 978 936 1674</phone>

        <email>rdroms@cisco.com</email>

        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>

    <date year="2013" />

    <!-- If the month and year are both specified and are the current ones, xml2rfc will fill 
         in the current day for you. If only the current year is specified, xml2rfc will fill 
	 in the current day and month for you. If the year is not the current one, it is 
	 necessary to specify at least a month (xml2rfc assumes day="1" if not specified for the 
	 purpose of calculating the expiry date).  With drafts it is normally sufficient to 
	 specify just the year. -->

    <!-- Meta-data Declarations -->

    <area>Internet</area>

    <workgroup>dhc</workgroup>

    <!-- WG name at the upperleft corner of the doc,
         IETF is fine for individual submissions.  
	 If this element is not present, the default is "Network Working Group",
         which is used by the RFC Editor as a nod to the history of the IETF. -->


    <keyword>SOL_MAX_RT, INF_MAX_RT</keyword>

    <!-- Keywords will be incorporated into HTML output
         files in a meta tag but they have no effect on text or nroff
         output. If you submit your draft to the RFC Editor, the
         keywords will be used for the search engine. -->

    <abstract>
      <t>This document updates RFC 3315 by redefining the default
      values for SOL_MAX_RT and INF_MAX_RT, and defining options
      through which a DHCPv6 server can override the client's default
      value for SOL_MAX_RT and INF_MAX_RT with new values.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">

      <t>Section 5.5 of the <xref target="RFC3315">DHCPv6
      specification</xref> defines the default values of SOL_MAX_RT
      and INF_MAX_RT to be 120 seconds.  In some circumstances, these
      defaults will lead to an unacceptably high volume of aggregated
      traffic at a DHCPv6 server.</t>

      <t>The change to SOL_MAX_RT is in response to DHCPv6 message
      rates observed at a DHCPv6 server in a deployment in which many
      DHCPv6 clients are sending Solicit messages but the DHCPv6
      server has been configured not to respond to those Solicit
      messages.  While no explicit observations of traffic due to
      INF_MAX_RT have been conducted, this document updates INF_MAX_RT
      for consistency with SOL_MAX_RT.</t>
    </section>

    <section title="Requirements Language">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <xref
      target="RFC2119">RFC 2119</xref>.</t>
    </section>

    <section title="Updates to SOL_MAX_RT and INF_MAX_RT in RFC 3315"
	     anchor="rfc3315_update">
      <t>This document changes section 5.5 of RFC 3315 as follows:

      <figure>
        <artwork><![CDATA[
OLD:
   SOL_MAX_RT      120 secs  Max Solicit timeout value

NEW:
   SOL_MAX_RT     3600 secs  Max Solicit timeout value

OLD:
   INF_MAX_RT      120 secs  Max Information-request timeout value

NEW:
   SOL_MAX_RT     3600 secs  Max Information-request timeout value
         ]]></artwork>
        </figure>
      </t>

      <t>With this change, a DHCPv6 client that does not receive a
      satisfactory response will send Solicit or Information-request
      messages with the same initial frequency and exponential backoff
      as specified in sections 17.1.2 and 18.1.5 of RFC 3315.
      However, the long term behavior of these DHCPv6 clients will be
      to send a Solicit or Information-request message every 3600
      seconds rather than every 120 seconds, significantly reducing
      the aggregated traffic at the DHCPv6 server.</t>

    </section>

    <section title="SOL_MAX_RT option">
      <t>A DHCPv6 server sends the SOL_MAX_RT option to a client to
      override the default value of SOL_MAX_RT.  The value of
      SOL_MAX_RT in the option replaces the default value defined in
      <xref target='rfc3315_update' />.  One use for the
      SOL_MAX_RT option is to set a longer value for SOL_MAX_RT, which
      reduces the Solicit traffic from a client that has not received
      a response to its Solicit messages.</t>

      <?rfc needLines="25" ?>
      <t>The format of the SOL_MAX_RT option is:

      <figure anchor="solmaxrt_option_format"
	      title="SOL_MAX_RT option format">
	<artwork>
<![CDATA[
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          option-code          |         option-len            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       SOL_MAX_RT value                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_SOL_MAX_RT (TBD).

      option-len           4.

      SOL_MAX_RT value     Overriding value for SOL_MAX_RT
                           in seconds; MUST be in range:
                             60 <= "value" <= 86400 (1 day)

]]>
	</artwork>
      </figure>
      </t>

    </section>
  
    <section title="INF_MAX_RT option">
      <t>A DHCPv6 server sends the INF_MAX_RT option to a client to
      override the default value of INF_MAX_RT.  The value of
      INF_MAX_RT in the option replaces the default value defined in
      <xref target='rfc3315_update' />.  One use for the INF_MAX_RT
      option is to set a longer value for INF_MAX_RT, which reduces
      the Information-Request traffic from a client that has not received a
      response to its Information-Request messages.</t>

      <?rfc needLines="25" ?>
      <t>The format of the INF_MAX_RT option is:

      <figure anchor="infmaxrt_option_format"
	      title="INF_MAX_RT option format">
	<artwork>
<![CDATA[
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          option-code          |         option-len            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       INF_MAX_RT value                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      option-code          OPTION_INF_MAX_RT (TBD).

      option-len           4.

      INF_MAX_RT value     Overriding value for INF_MAX_RT
                           in seconds; MUST be in range:
                             60 <= "value" <= 86400 (1 day)

]]>
	</artwork>
      </figure>
      </t>

    </section>

    <section title="Updates for SOL_MAX_RT and INF_MAX_RT options to RFC 3315">
      <t>Update to RFC 3315, section 17.1.3:

      <figure>
	<artwork>
	
<![CDATA[

OLD:

The client MUST ignore any Advertise message that includes a Status
Code option containing the value NoAddrsAvail, with the exception
that the client MAY display the associated status message to the
user.

NEW:

The client MUST ignore any Advertise message that includes a Status
Code option containing the value NoAddrsAvail, with the exception
that the client MUST process an included SOL_MAX_RT option and MUST
process an included INF_MAX_RT option and MAY display the associated
status message to the user.

]]>
	</artwork>
      </figure>
      </t>
      
      <t>Update to RFC 3315, section 17.2.2:

      <figure>
	<artwork>
<![CDATA[

OLD:

If the server will not assign any addresses to any IAs in a
subsequent Request from the client, the server MUST send an
Advertise message to the client that includes only a Status Code
option with code NoAddrsAvail and a status message for the user, a
Server Identifier option with the server's DUID, and a Client
Identifier option with the client's DUID.

NEW:

If the server will not assign any addresses to any IAs in a
subsequent Request from the client, the server MUST send an
Advertise message to the client that includes only a Status Code
option with code NoAddrsAvail and a status message for the user, a
Server Identifier option with the server's DUID, a Client
Identifier option with the client's DUID and (optionally)
SOL_MAX_RT and/or INF_MAX_RT options.

]]>
	</artwork>
      </figure>
      </t>

      <t>Add text to the end of section 14, clarifying client behavior
      while waiting for a response from a server:

      <figure>
	<artwork>
<![CDATA[

NEW:

A client is not expected to listen for a response during the entire
period between transmission of Solicit or Information-Request
messages. 

]]>
	</artwork>
      </figure>
      </t>

    </section>


    <section anchor="template-client" title="DHCPv6 Client Behavior">

      <t>A DHCPv6 client MUST include the SOL_MAX_RT option code in
      any <xref target='RFC3315'>Option Request option</xref> it sends
      as required by RFC 3315.</t>

      <t>A DHCPv6 client MUST include the INF_MAX_RT option code in
      any Option Request option it sends
      as required by RFC 3315.</t>

      <t>A DHCPv6 client MUST silently ignore any SOL_MAX_RT or
      INF_MAX_RT option values that are less than 60 or more than
      86400.</t>

      <t>If a DHCPv6 client receives a message containing a SOL_MAX_RT
      option containing a valid value for SOL_MAX_RT, the client MUST
      set its internal SOL_MAX_RT parameter to the value contained in
      the SOL_MAX_RT option.  This value of SOL_MAX_RT is then used by
      the retransmission mechanism defined in sections 17.1.2 and 14
      of RFC 3315.</t>

<!--     

      <t>Client also MAY include option SOL_MAX_RT in its SOLICIT,
      REQUEST, RENEW, REBIND and INFORMATION-REQUEST messages as a
      hint for the server regarding preferred option values.</t>
-->
      <t>If a DHCPv6 client receives a message containing a INF_MAX_RT
      option containing a valid value for INF_MAX_RT, the client MUST
      set its internal INF_MAX_RT parameter to the value contained in
      the INF_MAX_RT option.  This value of INF_MAX_RT is then used by
      the retransmission mechanism defined in sections 18.1.5 and 14
      of RFC 3315.</t>
    </section>

    <section anchor="template-server" title="DHCPv6 Server Behavior">
      <t>Sections 17.2.2 and 18.2 of RFC 3315 govern server operation
      in regards to option assignment. As a convenience to the reader,
      we mention here that the server will send option SOL_MAX_RT and
      INF_MAX_RT only if configured with specific values for them and
      the client requested those options using Option Request
      Option.</t>

      <t>The DHCPv6 server MAY include the SOL_MAX_RT option in any
      response it sends to a client that has included the SOL_MAX_RT
      option code in an Option Request option.  The SOL_MAX_RT option
      is sent in the main body of the message to client, not as a
      encapsulated option in, e.g., an <xref target="RFC3315">IA_NA,
      IA_TA</xref> or <xref target="RFC3633">IA_PD</xref> option.</t>

      <t>The DHCPv6 server MAY include the INF_MAX_RT option in any
      response it sends to a client that has included the INF_MAX_RT
      option code in an Option Request option.  The INF_MAX_RT option
      is sent in the main body of the message to client, not as a
      encapsulated option in, e.g., an IA_NA, IA_TA or IA_PD
      option.</t>

      </section>

      <section anchor="template-relay"
               title="DHCPv6 Relay Agent Behavior Text">
        <t>There are no additional requirements for relays.</t>
      </section>

    <section title="Security Considerations">
      <t>This document introduces one security consideration beyond
      those described in RFC 3315.  A malicious DHCPv6 server might
      cause a client to set its SOL_MAX_RT and INF_MAX_RT parameters
      to an arbitrarily high value with the SOL_MAX_RT and INF_MAX_RT
      options, which may cause an undue delay in a client completing
      its DHCPv6 protocol transaction in the case no other valid
      response is received.  Assuming the client also receives a
      response from a valid DHCPv6 server, large values for SOL_MAX_RT
      and INF_MAX_RT will not have any effect.</t>
    </section>

    <section title="Acknowledgments">
      <t>Tomek Mrugalski edited the text for compliance with <xref
      target="I-D.ietf-dhc-option-guidelines">draft-ietf-dhc-option-guidelines</xref>
      and added important details to the Security Considerations
      section.</t>
    </section>

    <section title="IANA Considerations">
      <t>IANA is requested to assign one option code each for
      OPTION_SOL_MAX_RT and OPTION_INF_MAX_RT from the "DHCP Option
      Codes" table of the Dynamic Host Configuration Protocol for IPv6
      (DHCPv6) Registry.</t>
    </section>


  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <!-- References split into informative and normative -->

    <!-- There are 2 ways to insert reference entries from the citation libraries:
     1. define an ENTITY at the top, and use "ampersand character"RFC2629; here (as shown)
     2. simply use a PI "less than character"?rfc include="reference.RFC.2119.xml"?> here
        (for I-Ds: include="reference.I-D.narten-iana-considerations-rfc2434bis.xml")

     Both are cited textually in the same manner: by using xref elements.
     If you use the PI option, xml2rfc will, by default, try to find included files in the same
     directory as the including file. You can also define the XML_LIBRARY environment variable
     with a value containing a set of directories to search.  These can be either in the local
     filing system or remote ones accessed by http (http://domain/dir/... ).-->

    <references title="Normative References">
      <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?-->

      &RFC2119;
      &RFC3315;
    </references>
    <references title="Informative References">
      &RFC3633;
      &I-D.ietf-dhc-option-guidelines;
    </references>

  </back>
</rfc>
