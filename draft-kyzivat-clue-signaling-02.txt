


Network Working Group                                         P. Kyzivat
Internet-Draft                                                   L. Xiao
Updates: 5234 (if approved)                                    C. Groves
Intended status: Standards Track                                  Huawei
Expires: August 22, 2013                               February 18, 2013


                             CLUE Signaling
                    draft-kyzivat-clue-signaling-02

Abstract

   This document specifies how signaling is conducted in the course of
   CLUE sessions.  This includes how SIP/SDP signaling is applied to
   CLUE sessions as well as defining a CLUE-specific signaling protocol
   that complements SIP/SDP and supports negotiation of CLUE application
   level data.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 22, 2013.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as



Kyzivat, et al.          Expires August 22, 2013                [Page 1]

Internet-Draft               CLUE Signaling                February 2013


   described in the Simplified BSD License.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  CLUE-Specific Signaling Protocol . . . . . . . . . . . . . . .  4
     3.1.  Protocol Versioning, Options & Extensions  . . . . . . . .  4
       3.1.1.  Versioning . . . . . . . . . . . . . . . . . . . . . .  4
       3.1.2.  Options and/or Extensions  . . . . . . . . . . . . . .  5
       3.1.3.  Negotiation  . . . . . . . . . . . . . . . . . . . . .  5
       3.1.4.  Principles . . . . . . . . . . . . . . . . . . . . . .  5
     3.2.  CLUE Messages  . . . . . . . . . . . . . . . . . . . . . .  6
       3.2.1.  ADVERTISEMENT Message  . . . . . . . . . . . . . . . .  6
       3.2.2.  CONFIGURE Message  . . . . . . . . . . . . . . . . . .  6
       3.2.3.  NAK/ERROR Message  . . . . . . . . . . . . . . . . . .  7
       3.2.4.  Stand-alone messages or deltas?  . . . . . . . . . . .  8
       3.2.5.  other  . . . . . . . . . . . . . . . . . . . . . . . .  8
     3.3.  Message Acknowledgement  . . . . . . . . . . . . . . . . .  8
       3.3.1.  Explicit Acknowledgment of Each Message  . . . . . . .  8
       3.3.2.  Piggybacking ACK on Requests . . . . . . . . . . . . .  9
     3.4.  Message Sequencing . . . . . . . . . . . . . . . . . . . . 10
       3.4.1.  Signaling Changes in Provider State  . . . . . . . . . 10
       3.4.2.  Signaling Changes in Consumer State  . . . . . . . . . 11
     3.5.  Message Transport  . . . . . . . . . . . . . . . . . . . . 11
       3.5.1.  CLUE Channel Lifetime  . . . . . . . . . . . . . . . . 12
       3.5.2.  Message Error Handling . . . . . . . . . . . . . . . . 12
     3.6.  Message Framing  . . . . . . . . . . . . . . . . . . . . . 13
     3.7.  other  . . . . . . . . . . . . . . . . . . . . . . . . . . 13
   4.  CLUE use of SDP O/A  . . . . . . . . . . . . . . . . . . . . . 13
   5.  Coordination of CLUE protocol and SDP O/A  . . . . . . . . . . 13
     5.1.  Combined Protocol Use Cases  . . . . . . . . . . . . . . . 13
       5.1.1.  Two CLUE-capable endpoints . . . . . . . . . . . . . . 13
       5.1.2.  A case with a non-CLUE-capable endpoint  . . . . . . . 16
   6.  CLUE requirements on SDP O/A . . . . . . . . . . . . . . . . . 18
   7.  SIP Signaling  . . . . . . . . . . . . . . . . . . . . . . . . 18
   8.  Interoperation with Legacy SIP Devices . . . . . . . . . . . . 18
   9.  CLUE over RTCWEB . . . . . . . . . . . . . . . . . . . . . . . 18
   10. Open Issues  . . . . . . . . . . . . . . . . . . . . . . . . . 19
   11. What else? . . . . . . . . . . . . . . . . . . . . . . . . . . 19
   12. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 19
   13. IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 19
   14. Security Considerations  . . . . . . . . . . . . . . . . . . . 19
   15. Change History . . . . . . . . . . . . . . . . . . . . . . . . 19
   16. References . . . . . . . . . . . . . . . . . . . . . . . . . . 20
     16.1. Normative References . . . . . . . . . . . . . . . . . . . 20
     16.2. Informative References . . . . . . . . . . . . . . . . . . 21



Kyzivat, et al.          Expires August 22, 2013                [Page 2]

Internet-Draft               CLUE Signaling                February 2013


   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 21


















































Kyzivat, et al.          Expires August 22, 2013                [Page 3]

Internet-Draft               CLUE Signaling                February 2013


1.  Introduction

   This document specifies how signaling is conducted in the course of
   CLUE sessions.  This includes how SIP/SDP signaling is applied to
   CLUE sessions as well as defining a CLUE-specific signaling protocol
   that complements SIP/SDP and supports negotiation of CLUE application
   level data.

   [Yes, this is a dup of the abstract for now.  Eventually it should
   say more.]


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   This document draws liberally from the terminology defined in the
   CLUE Framework [I-D.ietf-clue-framework].

   Other terms introduced here:

   CLUE Channel:  A reliable, bidirectional, transport mechanism used to
      convey CLUE messages.  A CLUE channel consists of one SCTP stream
      in each direction over a DTLS/SCTP session.



3.  CLUE-Specific Signaling Protocol

   The CLUE Framework [I-D.ietf-clue-framework] mentions a CLUE-specific
   protocol for the exchange of ADVERTISEMENT and CONFIGURE messages,
   but gives little detail.  The Data Model
   [I-D.presta-clue-data-model-schema] specifies a model and XML
   representation for CLUE-related data, but doesn't currently specify
   exactly what data belongs in each message, or how messages are
   sequenced.  This document provides the detail missing from those
   documents.

3.1.  Protocol Versioning, Options & Extensions

3.1.1.  Versioning

   There must be some provision for identifying incompatible protocol
   versions.

   NOTE: We probably don't want to have incompatible versions.



Kyzivat, et al.          Expires August 22, 2013                [Page 4]

Internet-Draft               CLUE Signaling                February 2013


   Typically changes will be introduced in a backward compatible way.
   But a time may come when this isn't possible, and we should be
   prepared for that.  This is more likely to occur before an RFC is
   published.  While it is probably unwise to deploy a product based on
   a draft, there will certainly be prototypes developed for testing,
   and those tests may lead to a need for incompatible change.  So
   whatever the mechanism is, it should be applicable to changes that
   occur from draft to draft, as well as after an RFC has been
   published.

3.1.2.  Options and/or Extensions

   There must be some provision for dealing with optional-to-implement
   features in the specification, and/or for backward compatible
   extensions to the protocol.  These are superficially different, but
   in practice they are more-or-less equivalent.  To an implementation
   of the base protocol and some extensions, those extensions must be
   viewed as optional-to-implement features in peers.

   One decision is whether extensions may be implemented mix-and-match,
   or whether there is a sequence of extensions, and one extension may
   only be supported if all the prior extensions have been supported.

3.1.3.  Negotiation

   Both version and options can be negotiated.  Some mechanisms may work
   for both, while others are only appropriate for one of the other.
   Some possibilities:
   o  No negotiation at all.  Instead, unrecognized syntax in certain
      "extension points" is to be ignored.  If it is recognized, then a
      corresponding extension specification defines what to do.
   o  Negotiate via the SIP signaling.
   o  Negotiate as part of the O/A exchange that establishes the
      channel.  (E.g. it is likely that individual channels of the SCTP
      association will be specified in SDP with a specific sub-protocol
      type.  There could be a separate sub-protocol for each new
      version.)
   o  Negotiate within the CLUE channel, via a special message exchange,
      before exchanging "normal" CLUE messages.
   o  Declare versioning in every CLUE message.  Define errors for
      unsupported versions and fallback to earlier versions.

3.1.4.  Principles
   o  CLUE SHOULD allow forwards and backwards compatibility through a
      version and extension mechanism.  Forward compatibility allows a
      version of a protocol to communicate effectively with and
      interwork with future versions of the protocol.  A version should
      not restrict the future protocol from providing extra



Kyzivat, et al.          Expires August 22, 2013                [Page 5]

Internet-Draft               CLUE Signaling                February 2013


      capabilities.
   o  Whenever possible backwards compatibility SHALL be maintained.
      Backward compatibility rules will be defined to ensure that
      endpoints implementing future versions of CLUE will be able to
      send protocol messages of the previous versions which will be
      understood and fully processed by the remote endpoint.
   o  Existing protocol elements should not be changed unless a protocol
      error needs to be corrected.
   o  The semantics of existing elements and values should not be
      changed.
   o  Established rules for formatting and encoding messages and
      elements should not be changed.
   o  When information elements are found to be obsolete they can be
      marked as not used.  However, the identifier for that information
      element will be marked as reserved.  In that way it cannot be used
      in future versions.

3.2.  CLUE Messages

   CLUE messages are encoded in XML.  The Data Model
   [I-D.presta-clue-data-model-schema] defines many/most of the elements
   from which CLUE messages are composed.  The content of each
   individual CLUE message could be defined by reference to an XML
   element type defined in the Data Model.  Or this document could
   itself define an XML element type for each message, with much of the
   content of those elements being drawn from the Data Model.  Which
   approach to follow is TBD.

3.2.1.  ADVERTISEMENT Message

   Most of the content needed for the ADVERTISEMENT message is already
   defined in the Data Model.  But the Data Model has't been constructed
   with that in mind.  So either the Data Model needs revision with a
   focus on the needs of signaling, or else additional schema is needed
   here.

3.2.2.  CONFIGURE Message

   The CONFIGURE message should probably also be based primarily on data
   elements defined in the Data Model.

   The CONFIGURE message must make reference (explicitly or implicitly)
   to the ADVERTISEMENT message on which it is based.  The mechanism for
   doing this must be specified.







Kyzivat, et al.          Expires August 22, 2013                [Page 6]

Internet-Draft               CLUE Signaling                February 2013


3.2.3.  NAK/ERROR Message

   There needs to be a message to report errors with other messages.
   The details of form, content, and usage still need to be specified,
   and need to be tuned to the details of the protocol.  Errors this
   message must be able to report include:

   Syntax error in message:  The message has been disregarded due to a
      syntax error detected at the message level.  The message does not
      conform to the productions of messages in [Protocol Document].
      Used when the message cannot be parsed.
   Sequencing Error:  Sequence number has already been used, or is
      greater than the expected number.  (Details of possible errors
      depend upon the specific sequence numbering mechanism.)
   Version not supported:  This indicates a lack of support for the
      protocol version indicated in the message header of the message.
      In the case of the version number being indicated in the message
      header, the message contents are disregarded.
   Option not supported:  This indicates a lack of support for the
      protocol option the used in the message.  The message contents are
      disregarded.
   Unknown capture identity:  The received Configure message contains an
      unknown capture identity not previously declared by an
      Advertisement.  The message contents are disregarded.
   Invalid identity:  The received message contains an invalid capture
      identity.  For example a duplicated Capture scene identity or some
      other semantically incorrect usage.  The message contents are
      disregarded.
   Invalid value:  The received message contains an invalid parameter
      value.  The value is not according to the protocol definition in
      [protocol document] or according the extension documentation.
   Missing element:  The received message is missing an element.
      Certain parameters require multiple values, e.g.  Point of capture
      requires X,Y,Z co-ordinates if one or more elements are missing
      this error code is used.
   Conflicting parameters or values:  The received message contains
      multiple values that may not be used together.
   Invalid capture area:  The received message defines a capture area
      that cannot be rendered in a sensible manner.  For example the
      capture area does not define a quadrilateral region.
   Invalid point of line of capture:  The indicated co-ordinate for the
      point on line of capture is invalid.  For example: does not lie
      between the point of capture and the area of capture or it is the
      same as the point of capture.







Kyzivat, et al.          Expires August 22, 2013                [Page 7]

Internet-Draft               CLUE Signaling                February 2013


   Invalid capture scene entry:  The message contains an invalid capture
      scene entry.  For example the capture scene entry contains more
      than one media type.
   Capture area out of scene area:  The received message includes a
      capture area whose region is outside the defined area of scene for
      the particular scene.  Note: this is not used if no area of scene
      is used.
   Invalid Simultaneous Set:  The simultaneous set contained in the
      message is invalid.  For example the simultaneous set refers to an
      undefined capture set or does not match the specified capture
      scene entries.
   Invalid Configuration:  The Configure message requests a
      configuration that the provider cannot support.
   Invalid Advertisement reference:  The Configure message refers to an
      invalid Advertisement.  The message refers-to/depends-upon out-of-
      date ADVERTISEMENT message or provides an invalid reference.

3.2.4.  Stand-alone messages or deltas?

   Each message exchanged within a CLUE session could contain a complete
   description of the state it wishes to achieve.  Or each message could
   describe just the changes that it wishes to make to the current
   state.  Or the protocol could support both message forms.  Which
   direction to pursue is TBD.

   [Paul: while this does need to be decided, it is fundamentally just
   an optimization.  IMO it does not have major impact on the other
   parts of this document, so I would prefer to continue deferring it
   until we are so far along with the remainder of the document that we
   can no longer defer it.]

3.2.5.  other

3.3.  Message Acknowledgement

   The CLUE channel is reliable, so there is no need for acknowledgement
   to guarantee delivery.  But there is still a need for application-to-
   application acknowledgement to report that the message has been
   received, parsed, and found to be of an acceptable format.  One
   possibility is to introduce separate ACK and/or NAK messages.
   Another possibility is to add a confirmation element to each CLUE
   message, so that confirmation can be piggybacked on the basic
   messages.  Some alternatives follow.  [OTHER PROPOSALS WELCOME.]

3.3.1.  Explicit Acknowledgment of Each Message

   The characteristics of this approach are:




Kyzivat, et al.          Expires August 22, 2013                [Page 8]

Internet-Draft               CLUE Signaling                February 2013


   o  There are separate request and response messages.  (This is
      similar to SIP.)
   o  Every request message expects exactly one response message.
   o  Every request message carries a sequence number that identifies
      it.
   o  Each end of the connection assigns sequential sequence numbers to
      the requests it sends.
   o  Every response message carries the sequence number of the message
      to which it responds.
   o  Responses are to be sent promptly upon the receipt of a request.
      (Needs more detail.)
   o  Responses are either ACK or NAK.  NAK responses also carry info
      describing the error.
   o  Each CONFIGURE message is to be understood in the context of the
      most recent ACKed ADVERTISEMENT message.  A CONFIGURE message may
      be rejected if there is an outstanding ADVERTISEMENT for which no
      response has been received.  (Or it may be accepted if the
      advertiser is able to do so meaningfully.)

3.3.2.  Piggybacking ACK on Requests

   The characteristics of this approach are:
   o  Every message carries a sequence number that identifies it.
   o  Each end of the connection assigns sequential sequence numbers to
      the messages it sends.
   o  Every message carries the sequence number of the last message
      received and found valid.
   o  If a message is received and found invalid, then a NAK message is
      sent that refers to it and indicates what is wrong with it.
   o  If a valid message is received and a new message needs to be sent
      in response, then the responding message implicitly acknowledges
      the prior message.
   o  If a valid message is received and there is no need to immediately
      send another message, then a NO-OP message is sent to acknowledge
      the received message.  But a NO-OP message is never sent in
      response to a NO-OP message.
   o  Each CONFIGURE message is to be understood in the context of the
      most recent *acknowledged* ADVERTISEMENT message.  A CONFIGURE
      message may be rejected if it doesn't acknowledge the most
      recently sent ADVERTISEMENT.  (Or it may be accepted if the
      advertiser is able to do so meaningfully.)

   The general format of every message is:
   o  sequence # of this message
   o  sequence # of most recently *received* and *valid* message
   o  message type (ADVERTISEMENT, CONFIG, NO-OP, NAK)





Kyzivat, et al.          Expires August 22, 2013                [Page 9]

Internet-Draft               CLUE Signaling                February 2013


   o  body of the message, according to type
   (The exact representation is TBD - by XML experts.)

   There are loose ends to resolve here.  In particular, how to
   acknowledge messages after NAKing one.

3.4.  Message Sequencing

   There is a very basic introduction to this topic in section 9.4
   (Message Flow) of the CLUE Framework [I-D.ietf-clue-framework].  That
   still mentions the Consumer Capability message, which we have decided
   to drop.  Without that it would look like:

            Media Consumer                         Media Provider
            --------------                         ------------
                  |                                     |
                  |<----- ADVERTISEMENT message --------|
                  |                                     |
                  |                                     |
                  |-------- CONFIGURE message --------->|
                  |                                     |

   But we need much more than this, to show multiple CONFIGUREs per
   ADVERTISEMENT, interleaving of ADVERTISEMENTs and CONFIGUREs in both
   directions, etc.

   Message sequencing needs to be described at two levels:
   o  Basic sequencing of the CLUE messages themselves, without regard
      for the SIP/SDP signaling that may be going on at the same time.
      This is useful to cover the basic concepts.  That should be
      covered in this section.  It provides context for understanding
      the more detailed treatment later.

      This could include some simple state machines.

   o  In reality there is a complex dependency between CLUE signaling
      and SDP Offer/Answer exchanges carried in SIP signaling.  So there
      is a need to describe the valid ways in which these two forms of
      signaling interact.  That is covered in Section 5.

3.4.1.  Signaling Changes in Provider State

   Once a CLUE session has been established, ADVERTISEMENTs and
   CONFIGUREs exchanged, and media is flowing, a provider may experience
   a change in state that has an effect on what it wishes or is able to
   provide.  In this case it may need to alter what it is sending and/or
   send a new ADVERTISEMENT.  In some cases it will be necessary to
   alter what is being sent without first sending a new ADVERTISEMENT



Kyzivat, et al.          Expires August 22, 2013               [Page 10]

Internet-Draft               CLUE Signaling                February 2013


   and waiting for a CONFIGURE conforming to it.

   The following is a non-exhaustive list of situations and recommended
   actions:
   o  An advertised capture, that is not currently configured, is no
      longer available.

      To recover from this: Send a new ADVERTISEMENT that omits this
      capture.
   o  An advertised capture, that has been configured, is no longer
      available.

      To recover from this: (1) stop transmitting the configured
      encoding of this capture. (2) Send a new ADVERTISEMENT that omits
      this capture.
   o  The provider loses some resource and must reduce the frame rate,
      frame size, or resolution of a capture encoding.

      If the reduced values still fall within the advertised values for
      the capture then the change may be made without any further
      signaling.

      If the change must be outside the range of what was advertised,
      then the provider must cease transmitting the capture encoding.
      It then must send a new ADVERTISEMENT reflecting what it is now
      capable of delivering.
   o  New or changed scenes or scene geometry.  For instance, the
      addition of a new scene containing presentation captures.  Also,
      an MCU may make significant changes in what it advertises as new
      endpoints join a conference.
   o  [Add more]

3.4.2.  Signaling Changes in Consumer State

   If the Consumer for some reason looses the CLUE state information how
   does it ask for an Advertisement from the provider?  There could be
   multiple possibilities.  A error code approach?  However error codes
   would typically be associated with a NACK so it may not be good for a
   Config message.  Maybe send a message which means "send me a complete
   update".  An alternative may be to release the connection or just do
   new signaling to establish a new CLUE session.

3.5.  Message Transport

   CLUE messages are transported over a bidirectional CLUE channel.  In
   a two-party CLUE session, a CLUE channel connects the two endpoints.
   In a CLUE conference, each endpoint has a CLUE channel connecting it
   to an MCU.  (In conferences with cascaded mixers [RFC4353], two MCUs



Kyzivat, et al.          Expires August 22, 2013               [Page 11]

Internet-Draft               CLUE Signaling                February 2013


   will be connected by a CLUE channel.)

3.5.1.  CLUE Channel Lifetime

   The transport mechanism used for CLUE messages is DTLS/SCTP as
   specified in [I-D.tuexen-tsvwg-sctp-dtls-encaps] and
   [I-D.ietf-mmusic-sctp-sdp].  A CLUE channel consists of one SCTP
   stream in each direction over a DTLS/SCTP session.  The mechanism for
   establishing the DTLS/SCTP session is described in Section 4.

   The CLUE channel will usually be offered during the initial SIP
   INVITE, and remain connected for the duration of the CLUE/SIP
   session.  However this need not be the case.  The CLUE channel may be
   established mid-session after desire and capability for CLUE have
   been determined, and the CLUE channel may be dropped mid-call if the
   desire and/or capability to support it is lost.

   There may be cases when it becomes necessary to "reset" the CLUE
   channel.  This by be as a result of an error on the underlying SCTP
   association, a need to change the endpoint address of the SCTP
   association, loss of CLUE protocol state, or something else TBD.

   The precise mechanisms used to determine when a reset is required,
   and how to accomplish it and return to a well defined state are TBS.

3.5.2.  Message Error Handling

   We will need to specify behavior in the face of transport errors that
   are so severe that they can't be managed via CLUE messaging within
   the CLUE channel.  Some errors of this sort are:
   o  Unable to establish the SCTP association after signaling it in
      SDP.
   o  CLUE channel setup rejected by peer.
   o  Error reported by transport while writing message to CLUE channel.
   o  Error reported by transport while reading message from CLUE
      channel.
   o  Timeout - overdue acknowledgement of a CLUE message.
      (Requirements for now soon a message must be responded to are
      TBD.)
   o  Application fault.  CLUE protocol state lost.
   The worst case is to drop the entire CLUE call.  Another possibility
   is to fall back to legacy compatibility mode.  Or perhaps a "reset"
   can be done on the protocol.  E.g. this might be accomplished by
   sending a new O/A and establishing a replacement SCTP association.
   Or a new CLUE channel might be established within the existing SCTP
   association.





Kyzivat, et al.          Expires August 22, 2013               [Page 12]

Internet-Draft               CLUE Signaling                February 2013


3.6.  Message Framing

   Message framing is provided by the SCTP transport protocol.  Each
   CLUE message is carried in one SCTP message.

3.7.  other


4.  CLUE use of SDP O/A

   The CLUE channel is usually offered in the first SIP O/A exchange
   between two parties in an intended CLUE session.  The offer of the
   CLUE channel is the indicator that this SIP session is proposing to
   establish a CLUE session.

   (However it is also acceptable to start with a non-CLUE SIP session
   and upgrade it to a CLUE session later.)

   The mechanism for negotiating a DTLS/SCTP connection is specified in
   [I-D.ietf-mmusic-sctp-sdp].  We need to specify how to select the
   specific pair of SCTP streams that comprise the CLUE channel.

   Any specific usage/conventions required for coordination of SDP
   offers and answers with the CLUE messages should also be described
   here.

   (We have a draft [I-D.even-clue-sdp-clue-relation] that can
   contribute to this.)


5.  Coordination of CLUE protocol and SDP O/A

   This should include state machines and/or call flows.  These will
   illustrate, and then provide normative rules for valid sequences of
   messages of both types.  For instance this needs to show when SDP
   offers and answers must occur relative to an ADVERTISEMENT or
   CONFIGURE message that requires SDP changes.

   [THIS IS A VERY IMPORTANT PART OF THIS DOCUMENT!]

5.1.  Combined Protocol Use Cases

5.1.1.  Two CLUE-capable endpoints

   This is the case where two CLUE-capable endpoints are willing to set
   up a CLUE telepresence session.  In the following, a possible
   approach addressing the problem is illustrated.




Kyzivat, et al.          Expires August 22, 2013               [Page 13]

Internet-Draft               CLUE Signaling                February 2013


         +----------+                      +-----------+
         |   EP1    |                      |    EP2    |
         |          |                      |           |
         +----+-----+                      +-----+-----+
              |                                  |
              |                                  |
              | INVITE (BASIC SDP+COMEDIA)       |
              |--------------------------------->|
              |                                  |
              |                                  |
              |        200 0K (BASIC SDP+COMEDIA)|
              |<---------------------------------|
              |                                  |
              |                                  |
              | ACK                              |
              |--------------------------------->|
              |                                  |
              |                                  |
              |                                  |
              |<################################>|
              |  ?? BASIC SDP MEDIA SESSION  ??  |
              |<################################>|
              |                                  |
              |                                  |
              |        CLUE CTRL CHANNEL SETUP   |
              |<================================>|
              |            ...                   |
              |<================================>|
              |   CLUE CTRL CHANNEL ESTABLISHED  |
              |<================================>|
              |                                  |
              |                                  |
              | ADVERTISEMENT 1                  |
              |*********************************>|
              |                                  |
              |                                  |
              |                  ADVERTISEMENT 2 |
              |<*********************************|
              |                                  |
              |                                  |
              |                                  |
              |                      CONFIGURE 1 |
              |<*********************************|
              |                                  |
              |                                  |
              | CONFIGURE 2                      |
              |*********************************>|
              |                                  |



Kyzivat, et al.          Expires August 22, 2013               [Page 14]

Internet-Draft               CLUE Signaling                February 2013


              |                                  |
              |                                  |
              | REINVITE (UPDATED SDP)           |
              |--------------------------------->|
              |                                  |
              |                                  |
              |              200 0K (UPDATED SDP)|
              |<---------------------------------|
              |                                  |
              |                                  |
              | ACK                              |
              |--------------------------------->|
              |                                  |
              |<################################>|
              |   UPDATED SDP MEDIA SESSION      |
              |<################################>|
              |                                  |
              |                                  |
              |                                  |
              |                                  |
              |                                  |
              v                                  v


   First, endpoint EP1 sends to endpoint EP2 a SIP INVITE including in
   the SDP body the basilar audio and video capabilities ("BASIC SDP")
   and the information needed for opening a control channel to be used
   for CLUE protocol messages exchange, according to what is envisioned
   in the COMEDIA approach ("COMEDIA") for DTLS/SCTP channel
   [I-D.ietf-mmusic-sctp-sdp].

   After the successful SIP O/A phase, EP1 and EP2 are able to exchange
   audio and video streams ("BASIC AUDIO AND VIDEO").  [RP: Is this
   channel needed at this point of the call flow?]  [RP: which streams
   are sent on this channel in this moment?]

   Moreover, another effect of the above successful SIP O/A phase, is
   the opening of the control channel.  After the setup phase, the
   channel is established and CLUE protocol messages can flow above it.

   CLUE protocol messages have not been formally defined yet.  However,
   up to now there is a common agreement on their names and their main
   purposes, that should be following.

   CLUE protocol ADVERTISEMENT messages are used to better describe the
   media provider's available streams in order to make the media
   consumer able to reproduce them in a more realistic fashion, as it is
   the main purpose of a telepresence session.  These messages are



Kyzivat, et al.          Expires August 22, 2013               [Page 15]

Internet-Draft               CLUE Signaling                February 2013


   needed since it is not possible in an agile fashion to describe
   spatial information and several further metadata about media captures
   via SDP.

   In this document it is assumed that ADVERTISEMENT messages contain
   the full description of the sender's telepresence room in terms of
   available media capture and encoding capabilities.  [RP: open issue -
   the mapping between what is described in the advertisement messages
   and media streams exchanged in the eventual basic SDP session already
   established]

   CLUE protocol CONFIGURE messages are used to let the media consumer
   indicate to the media provider which are the available streams it is
   interested in, so that the media provider can send to the media
   consumer what it desires.

   In the following, it is considered one of the possible call flow that
   can lead to the desired session configuration.

   EP1 sends the ADVERTISEMENT message to EP2 (ADVERTISEMENT 1), which
   replies with a CONFIGURE message (CONFIGURE 1).  After receiving the
   CONFIGURE message, EP1 assumes the CLUE offer/answer negotiation it
   started is completed.  EP1 then can issue a REINVITE to EP2 with an
   SDP body updated accordingly to the CLUE messages exchange.

   Similarly, EP2 sends its ADVERTISEMENT to EP1 (ADVERTISEMENT 2),
   which replies with a CONFIGURE (CONFIGURE 2).

   EP1 re-negotiates the media involved in the existent session via a
   SIP REINVITE message to EP2.  The SDP body within the REINVITE
   message reflects the negotiation carried on by the CLUE message
   exchange.  In the case represented in figure, EP2 builds the 200 OK
   response also according to the second CLUE O/A negotiation.

5.1.2.  A case with a non-CLUE-capable endpoint

   In this example, one of the two involved endpoint (EP2) is not CLUE-
   capable, i.e., it is not able to use the CLUE protocol.













Kyzivat, et al.          Expires August 22, 2013               [Page 16]

Internet-Draft               CLUE Signaling                February 2013


         +----------+                      +-----------+
         |   EP1    |                      |    EP2    |
         |          |                      |           |
         +----+-----+                      +-----+-----+
              |                                  |
              |                                  |
              | INVITE (BASIC SDP+COMEDIA)       |
              |--------------------------------->|
              |                                  |
              |                                  |
              | 200 0K (BASIC SDP + *NO* COMEDIA)|
              |<---------------------------------|
              |                                  |
              |                                  |
              | ACK                              |
              |--------------------------------->|
              |                                  |
              |                                  |
              |                                  |
              |<################################>|
              |  ?? BASIC SDP MEDIA SESSION  ??  |
              |<################################>|
              |                                  |
              |                                  |
              |                                  |
              | REINVITE (UPDATED SDP)           |
              |--------------------------------->|
              |                                  |
              |                                  |
              |              200 0K (UPDATED SDP)|
              |<---------------------------------|
              |                                  |
              |                                  |
              | ACK                              |
              |--------------------------------->|
              |                                  |
              |<################################>|
              |   UPDATED SDP MEDIA SESSION      |
              |<################################>|
              |                                  |
              |                                  |
              |                                  |
              |                                  |
              |                                  |
              v                                  v


   Endpoint EP1 sends to endpoint EP2 a SIP INVITE including in the SDP



Kyzivat, et al.          Expires August 22, 2013               [Page 17]

Internet-Draft               CLUE Signaling                February 2013


   body the basilar audio and video capabilities ("BASIC SDP") and the
   information needed for opening a control channel to be used for CLUE
   protocol messages exchange, as envisioned by the COMEDIA approach
   ("COMEDIA") for DTLS/SCTP channel [I-D.ietf-mmusic-sctp-sdp].

   Since EP2 is not CLUE-capable, it answers with a 200 OK in which
   basic audio and video capabilities are accepted while the opening of
   the CLUE channel is rejected.

   From such a response, EP1 understands the peer is not CLUE-capable.
   In this example, EP1 re-negotiates the session according to a pre-
   determined bulk of media streams to be sent to non-CLUE-capable
   endpoints.


6.  CLUE requirements on SDP O/A

   Any SDP extensions required to support CLUE signaling should be
   specified here.  Then we will need to take action within MMUSIC to
   make those happen.  This section should be empty and removed before
   this document becomes an RFC.

   NOTE: The RTP mapping document [I-D.even-clue-rtp-mapping] is also
   likely to call for SDP extensions.  We will have to reconcile how to
   coordinate these two documents.


7.  SIP Signaling

   (Placeholder) This may be unremarkable.  If so we can drop it.


8.  Interoperation with Legacy SIP Devices

   This may just describe how the degenerate form of the general
   mechanisms work for legacy devices.  Or it may describe special case
   handling that we mandate as part of CLUE.  Or it may just discuss
   non-normative things for implementors should consider.


9.  CLUE over RTCWEB

   We may want to rule this out of scope for now.  But we should be
   thinking about this.







Kyzivat, et al.          Expires August 22, 2013               [Page 18]

Internet-Draft               CLUE Signaling                February 2013


10.  Open Issues

   Here are issues pertinent to signaling that need resolution.
   Resolution will probably result in changes somewhere in this
   document, but may also impact other documents.

   o  While the preference is to multiplex multiple capture encodings
      over a single RTP session, this will not always be desirable or
      possible.  The factors that prevent multiplexing may come from
      either the provider or the consumer.  So the extent of
      multiplexing must be negotiated.  The decision about how to
      multiplex affects the number and grouping of m-lines in the SDP.
      The endpoint of a CLUE session that sends an offer needs to know
      the mapping of capture encodings to m-lines for both sides.

      AFAIK this issue hasn't yet been considered at all.


11.  What else?


12.  Acknowledgements

   The team focusing on this draft consists of: Roni Even, Rob Hansen,
   Christer Holmberg, Paul Kyzivat, Simon Pietro-Romano, Roberta Presta.

   The author list should be updated as people contribute substantial
   text to this document.

   (I added Lennard Xiao as an author because the material added in -02
   was codeveloped with him.)


13.  IANA Considerations

   TBD


14.  Security Considerations

   TBD


15.  Change History







Kyzivat, et al.          Expires August 22, 2013               [Page 19]

Internet-Draft               CLUE Signaling                February 2013


   -02:  A bunch of revisions by pkyzivat:
      *  Moved roberta's call flows to a more appropriate place in the
         document.
      *  New section on versioning.
      *  New section on NAK.
      *  A couple of possible alternatives for message acknowledgment.
      *  Some discussion of when/how to signal changes in provider
         state.
      *  Some discussion about the handling of transport errors.
      *  Added a change history section.
      These were developed by Lennard Xiao, Christian Groves and Paul,
      so added Lennard and Christian as authors.
   -01:  Updated by roberta to include some sample call flows.
   -00:  Initial version by pkyzivat.  Established general outline for
      the document, and specified a few things thought to represent wg
      consensus.


16.  References

16.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [I-D.ietf-clue-framework]
              Duckworth, M., Pepperell, A., and S. Wenger, "Framework
              for Telepresence Multi-Streams",
              draft-ietf-clue-framework-08 (work in progress),
              December 2012.

   [I-D.presta-clue-data-model-schema]
              Presta, R. and S. Romano, "An XML Schema for the CLUE data
              model", draft-presta-clue-data-model-schema-02 (work in
              progress), February 2013.

   [I-D.ietf-mmusic-sctp-sdp]
              Loreto, S. and G. Camarillo, "Stream Control Transmission
              Protocol (SCTP)-Based Media Transport in the Session
              Description Protocol (SDP)", draft-ietf-mmusic-sctp-sdp-03
              (work in progress), January 2013.

   [I-D.tuexen-tsvwg-sctp-dtls-encaps]
              Jesup, R., Loreto, S., Stewart, R., and M. Tuexen, "DTLS
              Encapsulation of SCTP Packets for RTCWEB",
              draft-tuexen-tsvwg-sctp-dtls-encaps-01 (work in progress),
              July 2012.




Kyzivat, et al.          Expires August 22, 2013               [Page 20]

Internet-Draft               CLUE Signaling                February 2013


16.2.  Informative References

   [RFC4353]  Rosenberg, J., "A Framework for Conferencing with the
              Session Initiation Protocol (SIP)", RFC 4353,
              February 2006.

   [I-D.even-clue-sdp-clue-relation]
              Even, R., "Signalling of CLUE and SDP offer/answer",
              draft-even-clue-sdp-clue-relation-01 (work in progress),
              October 2012.

   [I-D.even-clue-rtp-mapping]
              Even, R. and J. Lennox, "Mapping RTP streams to CLUE media
              captures", draft-even-clue-rtp-mapping-05 (work in
              progress), February 2013.


Authors' Addresses

   Paul Kyzivat
   Huawei

   Email: pkyzivat@alum.mit.edu


   Lennard Xiao
   Huawei

   Email: lennard.xiao@huawei.com


   Christian Groves
   Huawei

   Email: Christian.Groves@nteczone.com
















Kyzivat, et al.          Expires August 22, 2013               [Page 21]

