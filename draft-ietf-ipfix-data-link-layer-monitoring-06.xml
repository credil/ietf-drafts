<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
    <!ENTITY rfc0791 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.0791.xml'>
    <!ENTITY rfc2119 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>
    <!ENTITY rfc2460 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2460.xml'>
    <!ENTITY rfc2804 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2804.xml'>
    <!ENTITY rfc3031 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3031.xml'>
    <!ENTITY rfc3032 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3032.xml'>
    <!ENTITY rfc7011 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.7011.xml'>
    <!ENTITY rfc5477 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5477.xml'>
    <!ENTITY rfc6313 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.6313.xml'>
    <!ENTITY rfc6325 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.6325.xml'>
    <!ENTITY VXLAN PUBLIC 'VXLAN'
      'http://xml.resource.org/public/rfc/bibxml3/reference.I-D.mahalingam-dutt-dcops-vxlan.xml'>
]>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>

<?rfc autobreaks="yes" ?>
<?rfc toc="yes" ?>
<?rfc sortrefs="yes"?>
<?rfc iprnotified="no" ?>
<?rfc strict="no" ?>
<?rfc symrefs="yes" ?>
<?rfc compact="yes" ?>

<rfc category="std" ipr="trust200902" docName="draft-ietf-ipfix-data-link-layer-monitoring-06">
<front>
    <title abbrev='Data Link Information Elements'>Information Elements for Data Link Layer Traffic Measurement</title>
    <author initials='S.K.' surname="Kashima" fullname='Shingo Kashima'>
        <organization abbrev='NTT'>Nippon Telegraph and Telephone Corporation</organization>
        <address>
            <postal>
		            <street>Midori-Cho 3-9-11</street>
                <city>Musashino-shi</city>
                <region>Tokyo</region>
                <code>180-8585</code>
                <country>Japan</country>
            </postal>
            <phone>+81 422 59 3894</phone>
            <email>kashima@nttv6.net</email>
        </address>
    </author>
    <author initials='A.K.' surname="Kobayashi, Ed." fullname='Atsushi Kobayashi'>
        <organization abbrev='NTT East'>Nippon Telegraph and Telephone East Corporation</organization>
        <address>
            <postal>
		            <street>3-19-2 Nishi-shinjuku</street>
                <city>Shinjuku-ku</city>
                <region>Tokyo</region>
                <code>163-8019</code>
                <country>Japan</country>
            </postal>
            <phone>+81 3 5359 4351</phone>
            <email>akoba@nttv6.net</email>
        </address>
    </author>
    <author initials='P.A.' surname="Aitken" fullname='Paul Aitken'>
        <organization abbrev='Cisco Systems, Inc.'>Cisco Systems, Inc.</organization>
        <address>
            <postal>
            		<street>96 Commercial Quay</street>
                <city>Commercial Street</city>
                <region>Edinburgh</region>
                <code>EH6 6LX</code>
                <country>United Kingdom</country>
            </postal>
            <phone>+44 131 561 3616</phone>
            <email>paitken@cisco.com</email>
        </address>
    </author>

    <date month="October" year="2013"/>
    <area></area>
    <workgroup>IP Flow Information Export</workgroup>
    <keyword>Internet-Draft</keyword>

	<abstract>
		<t>This document describes Information Elements related to the data link layer. They are used by the IP Flow Information Export (IPFIX) protocol for encoding measured data link layer traffic information.</t>
	</abstract>
</front>

<middle>

<section title="Introduction"> <!-- 1 -->

<t>Ethernet <xref target="IEEE802.1D" /> and VLAN (Virtual LAN) technologies had been used only in Local Area Networks. Recently, they have been used in Wide Area Networks, e.g., L2-VPN services. Accordingly, carrier networks using VLAN technologies have been enhanced to <xref target="IEEE802.1Q">Provider Bridged Network and Provider Backbone Bridged Networks</xref>. And, Ethernet in data centers has also been enhanced for server virtualization and I/O consolidation.</t>

<t>While these innovations provide flexibility, scalability, and mobility to an existing network architecture, it increases the complexity of traffic measurement due to the existence of various Ethernet header formats. To cope with this, a more sophisticated method is required.</t>

<t>IPFIX and PSAMP helps to resolve these problems. However, the PSAMP Information Model <xref target="RFC5477" /> and the IPFIX Information Model <xref target="RFC7011" /> are not yet enough for Information Elements related to data link layer, e.g., Ethernet header forms. This document describes the Information Elements related to data link layers that enable a more sophisticated traffic measurement method.</t>

<section title="Conventions Used in This Document"> <!-- 1.1 -->

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <xref target="RFC2119">RFC 2119</xref>.</t>

</section> <!-- 1.1 -->
</section> <!-- 1 -->

<section title="Extended Ethernet Technology"> <!-- 2 -->

<section title="Wide-Area Ethernet Technology Summary"> <!-- 2.1 -->

<t><xref target="IEEE802.1Q"> Provider Bridge and Provider Backbone Bridge</xref>, which are standards for Wide-Area Ethernet, are described below.</t>

<t>
<list style="symbols">

<t>In <xref target="IEEE802.1Q">Provider Bridge</xref>, there are two VLAN IDs: Service VLAN Identifier (S-VID) and Customer VLAN Identifier (C-VID). S-VID is assigned to an Ethernet frame by a service provider, while C-VID is independently assigned to an Ethernet frame by a customer. Frame switching in a service provider network is based on only S-VID.</t>

<t>In <xref target="IEEE802.1Q">Provider Backbone Bridge</xref>, new Ethernet fields, such as Backbone VLAN Identifier (B-VID) and Backbone Service Instance Identifier (I-SID), are introduced to overcome the limitations on the VLAN identifier space and to isolate the service provider and customer identifier spaces. Frame switching is based on a 12-bit B-VID, and customer identification is based on a 24-bit I-SID. A flexible network design has become possible because network management is separated from customer management. Other Ethernet fields that indicate quality of service (QoS) class are Backbone VLAN priority code point (B-PCP), Backbone VLAN drop eligible indicator (B-DEI), Backbone Service Instance priority code point (I-PCP), and Backbone Service Instance Drop Eligibility Indicator (I-DEI).</t>
</list>
</t>

<t>The Provider Backbone Bridge technologies have enhanced a wide-area Ethernet service from a flat network to a hierarchical network consisting of Provider Bridge Network and Provider Backbone Bridge Network.</t>

<t>
Frame formats used in Wide-Area Ethernet are shown in Appendix A.
</t>

</section> <!-- 2.1 -->

<section title="Virtual Ethernet Technology Summary"> <!-- 2.2 -->

<t>
There have been several challenges in the existing virtual switches environment in a data center. One is the lack of network management visibility: limited features on virtual switches makes it difficult to monitor traffic among virtual machines (VMs). Also, the lack of management scalability and flexibility: increasing the number of VMs for multi-tenant causes an increase of the number of virtual switches and of the number of the traffic control policies, which reaches the limitations of network management scalability and flexibility.
</t>
<t>
In this situation, the IEEE 802.1 Working Group is standardizing virtual bridging technologies as Edge Virtual Bridge (EVB) including two kinds of Edge Relay (ER): Virtual Edge Bridge (VEB) and Virtual Edge Port Aggregator (VEPA) <xref target="IEEE802.1Qbg" />. The VEB is a bridge that provides a bridging among multiple VMs and the external bridging environment. The VEPA is a bridge-like device on a host that forwards all internal traffic to the adjacent EVB bridge and then distributes any traffic received from the adjacent EVB bridge to VMs. The VEPA makes all the VM-to-VM traffic visible to EVB bridge so that the traffic can be monitored and so the EVB bridge can apply filtering to the traffic.
</t>
<t>
To improve flexibility, a virtual link between a host system and EVB bridge is standardized as S-channel. S-channel allows a bridge to treat the traffic in the virtual link as if it comes in on a separate port. For example, in the host, an S-channel may be attached to a VEB or a VEPA or directly an internal port in order to apply each port-based filtering rules to the traffic. S-channel over the link between a host and its adjacent bridge uses S-TAG <xref target="IEEE802.1Q" />.
When S-channel is in use, frames on the link carry an S-TAG to identify the S-channel.
</t>
<t>
On the other hand, Bridge Port Extension emulates single Extended Bridge from multiple physical switches and virtual switches, and simplifies network management. Also, it solves the lack of network management visibility by forwarding all traffic into a central Controlling Bridge using E-channel. E-channel over the link between a Bridge Port extender and a Controlling Bridge uses E-TAG defined in <xref target="IEEE802.1BR" />.
</t>
<t>
Traffic monitoring over S-channel and E-channel is required in order to get visibility of VM-to-VM traffic, and visibility of each channel's traffic on a virtual link. 
</t>
<t>
Frame formats with E-TAG used in E-channel and S-TAG used in S-channel are shown in Appendix A. Though these frames carry special tags while on the link, those tags identify a virtual port (or for multicast in the downstream direction, a set of virtual ports) to which they are destined. These tag values only have local meaning and the flow would be reported as sent and arriving on the corresponding virtual ports. Therefore, IPFIX does not need to monitor data based on these tags.
</t>

</section> <!-- 2.2 -->

</section> <!-- 2 -->

<section title="Information Elements Related to Data Link Layer"> <!-- 3 -->

<t>The following Information Elements whose ElementId are from 312 to TBD03 are necessary for enabling the IPFIX and PSAMP traffic measurement for data link layer, which is not limited to Ethernet because the method can be applied to other data link protocols as well.</t>

<t>The following Information Elements whose ElementId are from TBD04 to TBD08 are necessary for enabling the IPFIX and PSAMP traffic measurement for <xref target="IEEE802.1Q" />.</t>

<t>The following Information Elements whose ElementId are from TBD09 to TBD22 are octet counter or packet length for layer 2, and are necessary for enabling the IPFIX and PSAMP traffic measurement for data link layer.</t>

<figure title="Table 1: Information Elements related to data link layer">
<artwork><![CDATA[
+-----+------------------------------------+
| ID  | Name                               |
+-----+------------------------------------+
| 312 | dataLinkFrameSize                  |
| 315 | dataLinkFrameSection               |
|TBD01| dataLinkFrameType                  |
|TBD02| sectionOffset                      |
|TBD03| sectionExportedOctets              |
|TBD04| dot1qServiceInstanceTag            |
|TBD05| dot1qServiceInstanceId             |
|TBD06| dot1qServiceInstancePriority       |
|TBD07| dot1qCustomerSourceMacAddress      |
|TBD08| dot1qCustomerDestinationMacAddress |
|TBD09| l2OctetDeltaCount                  |
|TBD10| postL2OctetDeltaCount              |
|TBD11| postMCastL2OctetDeltaCount         |
|TBD12| l2OctetTotalCount                  |
|TBD13| postL2OctetTotalCount              |
|TBD14| postMCastL2OctetTotalCount         |
|TBD15| minimumL2TotalLength               |
|TBD16| maximumL2TotalLength               |
|TBD17| droppedL2OctetDeltaCount           |
|TBD18| droppedL2OctetTotalCount           |
|TBD19| ignoredL2OctetTotalCount           |
|TBD20| notSentL2OctetTotalCount           |
|TBD21| l2OctetDeltaSumOfSquares           |
|TBD22| l2OctetTotalSumOfSquares           |
+-----+------------------------------------+
]]></artwork>
</figure>

<section title="Existing Information Elements"> <!-- 3.1 -->

<t>Some existing Information Elements are required for data link layer export.
Their details are reproduced here from IANA's IPFIX registry <xref target="IANA-IPFIX"/>,
except for additions as marked *.</t>

<section title="dataLinkFrameSize">
<t>Description:</t>
<t>
<list>
<t>This Information Element specifies the length of the selected data link frame.</t>
<t></t>
<t>The data link layer is defined in <xref target="ISO_IEC.7498-1_1994"/>.</t>
</list>
</t>
<t>Abstract Data Type: unsigned16</t>
<t>*Data Type Semantics: quantity*</t>
<t>ElementId: 312</t>
<t>Status: current</t>
</section>

<section title="dataLinkFrameSection">

<t>Description:</t>
<t>
<list>
<t>This Information Element carries n octets from the data link frame of a selected frame, starting sectionOffset octets into the frame.</t>
<t>*However, when the sectionOffset field corresponding to this Information Element does not exist, the octets MUST be from the start of the data link frame.*</t>
<t>The sectionExportedOctets expresses how much data was observed, while the remainder is padding.</t>
<t></t>
<t>When the sectionExportedOctets field corresponding to this Information Element exists, this Information Element MAY have a fixed length and MAY be padded, or MAY have a variable length.</t>
<t></t>
<t>When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.</t>
<t></t>
<t>Further Information Elements, i.e., dataLinkFrameType and dataLinkFrameSize are needed to specify the data link type and the size of the data link frame of this Information Element.  A set of these Information Elements MAY be contained in a structured data type, as expressed in 
<xref target="RFC6313"/>. Or a set of these Information Elements MAY be contained in one Flow Record as shown in Appendix B of [RFCEDITOR:thisRFC].</t>
<t></t>
<t>The data link layer is defined in <xref target="ISO_IEC.7498-1_1994"/>.</t>
</list>
</t>
<t>Abstract Data Type: octetArray</t>
<t>ElementId: 315</t>
<t>Status: current</t>
</section>

</section> <!-- 3.1 -->

<section title="New Information Elements"> <!-- 3.2 -->

<t>The following new Information Elements are added for data link layer monitoring.</t>

<section title="dataLinkFrameType">
<t>Description:</t>
<t>
<list>
<t>This Information Element specifies the type of the selected data link frame.</t>
<t></t>
<t>The following data link types are defined here.</t>
<t></t>
<t>- 0x01 IEEE802.3 ETHERNET <xref target="IEEE802.3"/></t>
<t>- 0x02 IEEE802.11 MAC Frame format <xref target="IEEE802.11"/></t>
<t></t>
<t>Further values may be assigned by IANA. Note that the assigned values are bits so that multiple observations can be OR'd together.</t>
<t></t>
<t>The data link layer is defined in <xref target="ISO_IEC.7498-1_1994"/>.</t>
</list>
</t>
<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: flags</t>
<t>ElementId: TBD01</t>
<t>Status: current</t>
</section>

<section title="sectionOffset">
<t>Description:</t>
<t>
<list>
<t>This Information Element specifies the offset of the packet section (e.g., dataLinkFrameSection, ipHeaderPacketSection, ipPayloadPacketSection, mplsLabelStackSection and mplsPayloadPacketSection). If this Information Element is omitted, it defaults to zero (ie, no offset).</t>
<t>If multiple sectionOffset IEs are specified within a single Template, then they apply to the packet section IEs in order. ie, the first sectionOffset applies to the first packet section, etc.  Note that the "closest" sectionOffset and packet section IEs within a given Template are not necessarily related. If there are less sectionOffset IEs than packet section IEs, then subsequent packet section IEs have no offset.  If there are more sectionOffset IEs than the number of packet section IEs, then the additional sectionOffset IEs are meaningless.</t>
</list>
</t>
<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: quantity</t>
<t>ElementId: TBD02</t>
<t>Status: current</t>
</section>

<section title="sectionExportedOctets">
<t>Description:</t>
<t>
<list>
<t>This Information Element specifies the observed length of the packet section (e.g., dataLinkFrameSection, ipHeaderPacketSection, ipPayloadPacketSection, mplsLabelStackSection and mplsPayloadPacketSection) when padding is used.</t>
<t></t>
<t>The packet section may be of a fixed size larger than the sectionExportedOctets. In this case, octets in the packet section beyond the sectionExportedOctets MUST follow the <xref target="RFC7011"/> rules for padding (ie, be composed of zero (0) valued octets).</t></list>
</t>
<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: quantity</t>
<t>ElementId: TBD03</t>
<t>Status: current</t>
</section>


<section title="dot1qServiceInstanceTag">
<t>Description:</t>
<t>
<list>
<t>This Information Element, which is 16 octets long, represents the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />. It encodes the Backbone Service Instance Priority Code Point (I-PCP), Drop Eligible Indicator (I-DEI), Use Customer Addresses (UCA), Backbone Service Instance Identifier (I-SID), Encapsulated Customer Destination Address (C-DA), Encapsulated Customer Source Address (C-SA) and reserved fields. The structure and semantics within the Tag Control Information field are defined in <xref target="IEEE802.1Q" />.</t>
</list>
</t>
<t>Abstract Data Type: octetArray</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: TBD04</t>
<t>Status: current</t>
</section>

<section title="dot1qServiceInstanceId">
<t>Description:</t>
<t>
<list>
<t>The value of the 24-bit Backbone Service Instance Identifier (I-SID) portion of the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />. </t>
</list>
</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: TBD05</t>
<t>Status: current</t>
</section>

<section title="dot1qServiceInstancePriority">
<t>Description:</t>
<t>
<list>
<t>The value of the 3-bit Backbone Service Instance Priority Code Point (I-PCP) portion of the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned8</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: TBD06</t>
<t>Status: current</t>
</section>

<section title="dot1qCustomerSourceMacAddress">
<t>Description:</t>
<t>
<list>
<t>The value of the Encapsulated Customer Source Address (C-SA) portion of the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>
<t>Abstract Data Type: macAddress</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: TBD07</t>
<t>Status: current</t>
</section>

<section title="dot1qCustomerDestinationMacAddress">
<t>Description:</t>
<t>
<list>
<t>The value of the Encapsulated Customer Destination Address (C-DA) portion of the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>
<t>Abstract Data Type: macAddress</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: TBD08</t>
<t>Status: current</t>
</section>

<section title="l2OctetDeltaCount">
<t>Description:</t>
<t>
<list>
<t>The number of layer 2 octets since the previous report (if any) in incoming packets for this Flow at the Observation Point. The number of octets includes layer 2 header(s) and layer 2 payload. </t>
<t>This Information Element is the layer 2 version of octetDeltaCount (ElementId #1) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: TBD09</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="postL2OctetDeltaCount">
<t>Description:</t>
<t>
<list>
<t>The definition of this Information Element is identical to the definition of Information Element 'l2OctetDeltaCount', except that it reports a potentially modified value caused by a middlebox function after the packet passed the Observation Point.</t>
<t>This Information Element is the layer 2 version of postOctetDeltaCount (ElementId #23) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: TBD10</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="postMCastL2OctetDeltaCount">
<t>Description:</t>
<t>
<list>
<t>The number of layer 2 octets since the previous report (if any) in outgoing multicast packets sent for packets of this Flow by a multicast daemon within the Observation Domain. This property cannot necessarily be observed at the Observation Point, but may be retrieved by other means. The number of octets includes layer 2 header(s) and layer 2 payload.
</t>
<t>This Information Element is the layer 2 version of postMCastOctetDeltaCount (ElementId #20) in <xref target="RFC5477" />. </t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: TBD11</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="l2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The total number of layer 2 octets in incoming packets for this Flow at the Observation Point since the Metering Process (re-)initialization for this Observation Point. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of octetTotalCount (ElementId #85) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: TBD12</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="postL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The definition of this Information Element is identical to the definition of Information Element 'l2OctetTotalCount', except that it reports a potentially modified value caused by a middlebox function after the packet passed the Observation Point.</t>
<t>This Information Element is the layer 2 version of postOctetTotalCount (ElementId #171) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: TBD13</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="postMCastL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The total number of layer 2 octets in outgoing multicast packets sent for packets of this Flow by a multicast daemon in the Observation Domain since the Metering Process (re-)initialization. This property cannot necessarily be observed at the Observation Point, but may be retrieved by other means. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of postMCastOctetTotalCount (ElementId #175) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: TBD14</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="minimumL2TotalLength">
<t>Description:</t>
<t>
<list>
<t>Layer 2 length of the smallest packet observed for this Flow. The packet length includes the layer 2 header(s) length and the layer 2 payload length.</t>
<t>This Information Element is the layer 2 version of minimumIpTotalLength (ElementId #25) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>ElementId: TBD15</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="maximumL2TotalLength">
<t>Description:</t>
<t>
<list>
<t>Layer 2 length of the largest packet observed for this Flow. The packet length includes the layer 2 header(s) length and the layer 2 payload length.</t>
<t>This Information Element is the layer 2 version of maximumIpTotalLength (ElementId #26) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>ElementId: TBD16</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="droppedL2OctetDeltaCount">
<t>Description:</t>
<t>
<list>
<t>The number of layer 2 octets since the previous report (if any) in packets of this Flow dropped by packet treatment. The number of octets includes layer 2 header(s) and layer 2payload.</t>
<t>This Information Element is the layer 2 version of droppedOctetDeltaCount (ElementId #132) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: TBD17</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="droppedL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The number of layer 2 octets since the previous report (if any) in packets of this Flow dropped by packet treatment. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of droppedOctetTotalCount (ElementId #134) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: TBD18</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="ignoredL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The total number of octets in observed layer 2 packets (including the layer 2 header) that the Metering Process did not process since the (re-)initialization of the Metering Process.</t>
<t>This Information Element is the layer 2 version of ignoredOctetTotalCount (ElementId #165) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: TBD19</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="notSentL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The total number of octets in observed layer 2 packets (including the layer 2 header) that the Metering Process did not process since the (re-)initialization of the Metering Process.</t>
<t>This Information Element is the layer 2 version of notSentOctetTotalCount (ElementId #168) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: TBD20</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="l2OctetDeltaSumOfSquares">
<t>Description:</t>
<t>
<list>
<t>The sum of the squared numbers of layer 2 octets per incoming packet since the previous report (if any) for this Flow at the Observation Point. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of octetDeltaSumOfSquares (ElementId #198) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: TBD21</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="l2OctetTotalSumOfSquares">
<t>Description:</t>
<t>
<list>
<t>The total sum of the squared numbers of layer 2 octets in incoming packets for this Flow at the Observation Point since the Metering Process (re-)initialization for this Observation Point. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of octetTotalSumOfSquares (ElementId #199) in <xref target="RFC5477" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: TBD22</t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

</section> <!-- 3.2 -->

</section> <!-- 3 -->


<section title="Modification of Existing Information Elements Related to Packet Section"> <!-- 4 -->

<t>The new Information Elements related to packet section (ie, sectionOffset and sectionExportedOctets) can be applied to not only dataLinkFrameSection but also all kinds of packet section (ie, ipHeaderPacketSection, ipPayloadPacketSection, mplsLabelStackSection, and mplsPayloadPacketSection defined in <xref target="RFC5477" />). Therefore existing Information Elements Descriptions should be modified as follows:</t>

<section title="ipHeaderPacketSection">

<t>
This Information Element is defined in <xref target="RFC5477" />. The description is updated from <xref target="RFC5477" />.
</t>

<t>Description:</t>
<t>
<list>
<t>
This Information Element carries a series of n octets from the IP header of a sampled packet, starting sectionOffset octets into the IP header.</t>
<t>However, when the sectionOffset field corresponding to this Information Element does not exist, the octets MUST be from the start of the IP header.</t>

<t>
With sufficient length, this element also reports octets from the IP payload, subject to <xref target="RFC2804" />. See the Security Considerations section in <xref target="RFC5477" />.
</t>

<t>
The sectionExportedOctets expresses how much data was exported, while the remainder is padding.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element exists, this Information Element MAY have a fixed length and MAY be padded, or MAY have a variable length.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.
</t>

</list>
</t>

<t>Abstract Data Type: octetArray</t>
<t>ElementId: 313</t>
<t>Status: current</t>

</section>

<section title="ipPayloadPacketSection">

<t>
This Information Element is defined in <xref target="RFC5477" />. The description is updated from <xref target="RFC5477" />.
</t>

<t>Description:</t>
<t>
<list>
<t>
This Information Element carries a series of n octets from the IP payload of a sampled packet, starting sectionOffset octets into the IP payload.</t>
<t>However, when the sectionOffset field corresponding to this Information Element does not exist, the octets MUST be from the start of the IP payload.</t>

<t>
The IPv4 payload is that part of the packet that follows the IPv4 header and any options, which <xref target="RFC0791" /> refers to as "data" or "data octets".  For example, see the examples in <xref target="RFC0791" />, Appendix A.
</t>
<t>
The IPv6 payload is the rest of the packet following the 40-octet IPv6 header. Note that any extension headers present are considered part of the payload.  See <xref target="RFC2460" /> for the IPv6 specification.
</t>

<t>
The sectionExportedOctets expresses how much data was observed, while the remainder is padding.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element exists, this Information Element MAY have a fixed length and MAY be padded, or MAY have a variable length.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.
</t>

</list>
</t>

<t>Abstract Data Type: octetArray</t>
<t>ElementId: 314</t>
<t>Status: current</t>

</section>

<section title="mplsLabelStackSection">

<t>
This Information Element is defined in <xref target="RFC5477" />. The description is updated from <xref target="RFC5477" />.
</t>

<t>Description:</t>
<t>
<list>
<t>
This Information Element carries a series of n octets from the MPLS label stack of a sampled packet, starting sectionOffset octets into the MPLS label stack.</t>
<t>However, when the sectionOffset field corresponding to this Information Element does not exist, the octets MUST be from the head of the MPLS label stack.</t>

<t>
With sufficient length, this element also reports octets from the MPLS payload, subject to <xref target="RFC2804" />. See the Security Considerations section in <xref target="RFC5477" />.
</t>
<t>
See <xref target="RFC3031" /> for the specification of MPLS packets.
</t>
<t>
See <xref target="RFC3032" /> for the specification of the MPLS label stack.
</t>

<t>
The sectionExportedOctets expresses how much data was observed, while the remainder is padding.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element exists, this Information Element MAY have a fixed length and MAY be padded, or MAY have a variable length.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.
</t>

</list>
</t>

<t>Abstract Data Type: octetArray</t>
<t>ElementId: 316</t>
<t>Status: current</t>

</section>

<section title="mplsPayloadPacketSection">

<t>
This Information Element is defined in <xref target="RFC5477" />. The description is updated from <xref target="RFC5477" />.
</t>

<t>Description:</t>
<t>
<list>
<t>
The mplsPayloadPacketSection carries a series of n octets from the MPLS payload of a sampled packet, starting sectionOffset octets into the MPLS payload, being data that follows immediately after the MPLS label stack.</t>
<t>However, when the sectionOffset field corresponding to this Information Element does not exist, the octets MUST be from the start of the MPLS payload.</t>

<t>
See <xref target="RFC3031" /> for the specification of MPLS packets.
</t>
<t>
See <xref target="RFC3032" /> for the specification of the MPLS label stack.
</t>

<t>
The sectionExportedOctets expresses how much data was observed, while the remainder is padding.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element exists, this Information Element MAY have a fixed length and MAY be padded, or MAY have a variable length.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.
</t>

</list>
</t>

<t>Abstract Data Type: octetArray</t>
<t>ElementId: 317</t>
<t>Status: current</t>

</section>

</section> <!-- 4 -->

<section title="Modification of Existing Information Elements Related to VLAN Tag"> <!-- 5 -->

<t>
The traffic measurement using IPFIX and PSAMP for a Provider Backbone Bridged Network requires the Information Elements related to Backbone Service Instance Tag (I-TAG) and Backbone VLAN Tag (B-TAG). The set of Information Elements related to I-TAG is added in section 3, because I-TAG structure and semantics are different from that of Service VLAN Tag (S-TAG) and Customer VLAN Tag (C-TAG). The set of Information Elements related to B-TAG reuses the existing Information Elements, because B-TAG structure and semantics are identical to  that of C-TAG and S-TAG. This section modifies existing Descriptions and Reference related to C-TAG and S-TAG as follows:
</t>

<section title="dot1qVlanId">
<t>Description:</t>
<t>
<list>
<t>The value of the 12-bit VLAN Identifier portion of the Tag Control Information field of an Ethernet frame. The structure and semantics within the Tag Control Information field are defined in <xref target="IEEE802.1Q" />. In Provider Bridged Networks, it represents the Service VLAN identifier in the S-TAG Tag Control Information (TCI) field or the Customer VLAN identifier in the C-TAG Tag Control Information (TCI) field as described in <xref target="IEEE802.1Q" />. In Provider Backbone Bridged Networks, it represents the Backbone VLAN identifier in the B-TAG Tag Control Information (TCI) field as described in <xref target="IEEE802.1Q" />. In a virtual link between a host system and EVB bridge, it represents the Service VLAN identifier indicating S-channel as described in <xref target="IEEE802.1Qbg" />.
</t>
<t>
In the case of multi-tagged frame, it represents the outer tag's VLAN identifier except for I-TAG.
</t>
</list>
</t>

<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 243</t>
<t>Status: current</t>
<t>Reference:</t>
<t>
<list style="format (%d)" counter="1">
<t><xref target="IEEE802.1Q" /></t>
<t><xref target="IEEE802.1Qbg" /></t>
</list>
</t>
</section>

<section title="dot1qPriority">
<t>Description:</t>
<t>
<list>
<t>The value of the 3-bit User Priority portion of the Tag Control Information field of an Ethernet frame. The structure and semantics within the Tag Control Information field are defined in <xref target="IEEE802.1Q" />. In the case of multi-tagged frame, it represents the 3-bit Priority Code Point (PCP) portion of the outer tag's Tag Control Information (TCI) field as described in <xref target="IEEE802.1Q" /> except for I-TAG.</t>
</list>
</t>

<t>Abstract Data Type: unsigned8</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 244</t>
<t>Status: current</t>
<t>Reference:</t>
<t>
<list style="format (%d)" counter="2">
<t><xref target="IEEE802.1Q" /></t>
</list>
</t>
</section>

<section title="dot1qCustomerVlanId">
<t>Description:</t>
<t>
<list>
<t>The value represents the Customer VLAN identifier in the C-TAG Tag Control Information (TCI) field as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>

<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 245</t>
<t>Status: current</t>
<t>Reference:</t>
<t>
<list style="format (%d)" counter="3">
<t><xref target="IEEE802.1Q" /></t>
</list>
</t>
</section>

<section title="dot1qCustomerPriority">
<t>Description:</t>
<t>
<list>
<t>The value represents the 3-bit Priority Code Point (PCP) portion of the C-TAG Tag Control Information (TCI) field as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>

<t>Abstract Data Type: unsigned8</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 246</t>
<t>Status: current</t>
<t>Reference:</t>
<t>
<list style="format (%d)" counter="4">
<t><xref target="IEEE802.1Q" /></t>
</list>
</t>
</section>

</section> <!-- 5 -->


<section title="The relationship between Ethernet header fields and Information Elements"> <!-- 6 -->

<t></t>
<t>The following figures shows summary of various Ethernet header fields and the Informational Elements which would be used to represent each of the fields.</t>

<figure title="Figure 1: Customer tagged frame header fields">
<artwork><![CDATA[

 <--- 6 --> <--- 6 --> <--- 4 --> <---- 2 ----->
+----------+----------+----------+--------------+
+          +          +          +              +
+   C-DA   +   C-SA   +   C-TAG  +  Length/Type +
+    a     +    b     +     c    +       d      +
+----------+----------+----------+--------------+

a.(Information Element)  destinationMacAddress (80)
b.(Information Element)  sourceMacAddress (56)
c.(Information Elements) dot1qVlanId (243), dot1qPriority (244)
d.(Information Element)  ethernetType (256)
]]></artwork>
</figure>

<figure title="Figure 2: Service tagged frame header fields">
<artwork><![CDATA[

 <--- 6 --> <--- 6 --> <--- 4 --> <--- 4 --> <---- 2 ----->
+----------+----------+----------+----------+--------------+
+          +          +          +          +              +
+   C-DA   +   C-SA   +   S-TAG  +   C-TAG  +  Length/Type +
+    a     +    b     +     c    +     d    +       e      +
+----------+----------+----------+----------+--------------+

a.(Information Element)  destinationMacAddress (80)
b.(Information Element)  sourceMacAddress (56)
c.(Information Elements) dot1qVlanId (243), dot1qPriority (244)
d.(Information Elements) dot1qCustomerVlanId (245),
                         dot1qCustomerPriority (246)
e.(Information Element)  ethernetType (256)
]]></artwork>
</figure>


<figure title="Figure 3: Backbone VLAN tagged frame header fields">
<artwork><![CDATA[

 <--- 6 --> <--- 6 --> <--- 4 --> <----- 16 ----> <--- 4 --> <----- 2 ---->
+----------+----------+----------+---------------+----------+--------------+
+          +          +          +               +          +              +
+   B-DA   +   B-SA   +   B-TAG  +     I-TAG     +   C-TAG  +  Length/Type +
+    a     +    b     +     c    +       d       +     e    +       f      +
+----------+----------+----------+---------------+----------+--------------+

a.(Information Element)  destinationMacAddress (80)
b.(Information Element)  sourceMacAddress (56)
c.(Information Elements) dot1qVlanId (243, dot1qPriority (244)
d.(Information Elements) dot1qServiceInstanceTag (TBD04), or 
                         a set of dot1qServiceInstanceId (TBD05),
                         dot1qServiceInstancePriority (TBD06),
                         dot1qCustomerSourceMacAddress (TBD07)
                         dot1qCustomerDestinationMacAddress (TBD08),
e.(Information Elements) dot1qCustomerVlanId (245),  
                         dot1qCustomerPriority (246)
f.(Information Element)  ethernetType (256)

]]></artwork>
</figure>

</section> <!-- 6 -->


<section title="Security Considerations"> <!-- 7 -->
	<t>The recommendations in this document do not introduce any additional security issues beyond those already mentioned in <xref target="RFC7011"/> and <xref target="RFC5477"/>.</t>
</section> <!-- 6 -->

<section title="IANA Considerations"> <!-- 8 -->
<t>This document requests that existing IPFIX Information Elements <xref target="IANA-IPFIX"/> are modified as indicated in sections 3.1, 4, and 5 above.</t>
<t>This document requests that new IPFIX Information Elements <xref target="IANA-IPFIX"/> are allocated as shown in section 3.2 above.</t>
</section> <!-- 8 -->


<section title="Acknowledgments"> <!-- 9 -->
<t>
Thanks to Brian Trammell and IPFIX members who contributed to mailing-list discussions throughout the development of this document, and especially to Pat Thaler for her help with the IEEE 802 aspects of this work.
</t>
</section> <!-- 9 -->

</middle>

<back>
<references title="Normative References">
&rfc0791;
&rfc2119;
&rfc2460;
&rfc2804;
&rfc3031;
&rfc3032;
&rfc7011;
&rfc5477;
&rfc6313;

<reference anchor="IEEE802.1Q">
	<front>
	<title>
IEEE Standard for Local and metropolitan area networks: Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks
	</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE Computer Society</organization>
	</author>
	<date month="August" year="2011" />
	</front>
	<seriesInfo name="IEEE Std" value="802.1Q-2011" />
</reference>

<reference anchor="IEEE802.1BR">
	<front>
	<title>
IEEE Standard for Local and metropolitan area networks: Virtual Bridged Local Area Networks: Bridge Port Extension
	</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE Computer Society</organization>
	</author>
	<date month="July" year="2012" />
	</front>
	<seriesInfo name="IEEE Std" value="802.1BR-2012" />
</reference>

<reference anchor="IEEE802.1Qbg">
	<front>
	<title>
IEEE Standard for Local and metropolitan area networks: Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks: Amendment 21: Edge Virtual Bridging
</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE Computer Society</organization>
	</author>
	<date month="July" year="2012" />
	</front>
	<seriesInfo name="IEEE Std" value="802.1Qbg-2012" />
</reference>

<reference anchor="IEEE802.3">
	<front>
	<title>
IEEE Standard for Ethernet
	</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE Computer Society</organization>
	</author>
	<date month="December" year="2012" />
	</front>
	<seriesInfo name="IEEE Std" value="802.3-2012" />
</reference>

<reference anchor="IEEE802.11">
	<front>
	<title>
IEEE Standard for Information technology. Telecommunications and information exchange between systems Local and metropolitan area networks. Specific requirements Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications
	</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE Computer Society</organization>
	</author>
	<date month="March" year="2012" />
	</front>
	<seriesInfo name="IEEE Std" value="802.11-2012" />
</reference>

</references>


<references title="Informative References">

<reference anchor="IEEE802.1D">
	<front>
	<title>
IEEE Standard for Local and metropolitan area networks: Media Access Control (MAC) Bridges</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE Computer Society</organization>
	</author>
	<date month="June" year="2004" />
	</front>
	<seriesInfo name="IEEE Std" value="802.1D-2004" />
</reference>

<reference anchor="ISO_IEC.7498-1_1994">
	<front>
	<title>Information technology -- Open Systems Interconnection -- Basic Reference Model: The Basic Mode</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="International Organization for Standardization">International Organization for Standardization</organization>
	</author>
	<date month="June" year="1996" />
	</front>
	<seriesInfo name="ISO Standard" value="7498-1:1994" />
</reference>

<reference anchor="IANA-IPFIX">
	<front>
	<title>IANA IPFIX Information Element Registry</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="IANA">Internet Assigned Numbers Authority</organization>
	</author>
	<date year="http://www.iana.org/assignments/ipfix/ipfix.xhtml"/>
	</front>
	
</reference>

</references>

<section title="Tagged Frame Formats"> <!-- Appendix A -->

<figure title="Figure A-1: Untagged frame format">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-2: C-TAG tagging frame format">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        C-TAG TPID=0x8100      |C-PCP|C|         C-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-3: S-TAG tagging frame format in Provider Bridged Networks">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        S-TAG TPID=0x88a8      |S-PCP|D|         S-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-4: S-TAG and C-TAG tagging frame format in Provider Bridged Networks">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        S-TAG TPID=0x88a8      |S-PCP|D|         S-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        C-TAG TPID=0x8100      |C-PCP|C|         C-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-5: B-TAG and I-TAG tagging frame format in Provider Backbone Bridged Networks">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              B-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              B-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        B-TAG TPID=0x88a8      |B-PCP|D|         B-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        I-TAG TPID=0x88e7      |I-PCP|D|U| Res |     I-SID     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             I-SID             |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-DA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-SA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |          Length/Type          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-6: B-TAG, I-TAG and C-TAG tagging frame format in Provider Backbone Bridged Networks">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              B-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              B-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        B-TAG TPID=0x88a8      |B-PCP|D|         B-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        I-TAG TPID=0x88e7      |I-PCP|D|U| Res |     I-SID     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             I-SID             |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-DA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-SA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |        C-TAG TCI=0x8100       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|C-PCP|C|         C-VID         |          Length/Type          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-7: S-TAG tagging frame format for S-channel over the link between an end station and its adjacent bridge">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        S-TAG TPID=0x88a8      |S-PCP|D|         S-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>
<t>
Note that this frame format is identical to the format in Figure A-3.
</t>

<figure title="Figure A-8: S-TAG and C-TAG tagging frame format over the link between an end station and its adjacent bridge">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        S-TAG TPID=0x88a8      |S-PCP|D|         S-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        C-TAG TPID=0x8100      |C-PCP|C|         C-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>
<t>
This frame format is identical to the format in Figure A-4.
</t>

<figure title="Figure A-9: E-TAG tagging frame format over the link between a Controlling Bridge and a Bridge Port Extender">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        E-TAG TPID=0x893F      |E-PCP|D|   Ingress_E-CID_base  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Res|GRP|      E-CID_base       |Ingre_E-CID_ext|    E-CID_ext  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-10: E-TAG and C-TAG tagging frame format over the link between a Controlling Bridge and a Bridge Port Extender">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        E-TAG TPID=0x893F      |E-PCP|D|   Ingress_E-CID_base  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Res|GRP|      E-CID_base       |Ingre_E-CID_ext|    E-CID_ext  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        C-TAG TPID=0x8100      |C-PCP|C|         C-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>
</section> <!-- Appendix A -->

<section title="Template Formats Example"> <!-- Appendix B -->
<figure title="Figure B-1: Template Format Example">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Set ID (0x0002)        |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Template ID (0x0103)     |      Field Count (0x0008)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   ingressInterface (0x000A)   |     Field Length (0x0004)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   egressInterface (0x000E)    |     Field Length (0x0004)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|observationTimeSeconds (0x0142)|     Field Length (0x0008)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   dataLinkFrameSize (0x0138)  |     Field Length (0x0002)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| dataLinkFrameSection (0x013B) |     Field Length (0xFF40)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   dataLinkFrameType (0x015B)  |     Field Length (0x0002)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     sectionOffset (0x015C)    |     Field Length (0x0002)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|sectionObservedOctets (0x015D) |     Field Length (0x0002)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>
</section> <!-- Appendix B -->

</back>
</rfc>
