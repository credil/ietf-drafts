<?xml version="1.0" encoding="iso-8859-1"?>
<!-- 
     vim: set softtabstop=2 shiftwidth=2 expandtab
     RCAS: uploaded version
     version=201302121230
-->
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="no" ?>
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC3945 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3945.xml">
<!ENTITY RFC4206 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4206.xml">
<!ENTITY RFC4397 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4397.xml">
<!ENTITY RFC5150 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5150.xml">
<!ENTITY RFC6163 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6163.xml">
]>


<rfc category="std" docName="draft-ogrcetal-ccamp-flexi-grid-fwk-02" ipr="trust200902" >
  <front>
    <title abbrev="GMPLS Flexi-grid Framework">Framework and Requirements for GMPLS based control of Flexi-grid DWDM networks</title>

    <author fullname="Oscar Gonzalez de Dios" initials="O." role="editor" surname="Gonzalez de Dios">
      <organization>Telefónica I+D</organization>
      <address>
        <postal>
          <street>Don Ramon de la Cruz 82-84</street>
          <city>Madrid</city>
          <region></region>
          <code>28045</code>
          <country>Spain</country>
        </postal>
        <phone>+34913128832</phone>
        <email>ogondio@tid.es</email>
      </address>
    </author>

    <author fullname="Ramon Casellas" initials="R." role="editor" surname="Casellas">
      <organization>CTTC</organization>
      <address>
        <postal>
          <street>Av. Carl Friedrich Gauss n.7</street>
          <city>Castelldefels</city>
          <region></region>
          <code>Barcelona</code>
          <country>Spain</country>
        </postal>
        <phone>+34 93 645 29 00</phone>
        <email>ramon.casellas@cttc.es</email>
      </address>
    </author>

    <author fullname="Fatai Zhang" initials="F."  surname="Zhang">
      <organization>Huawei</organization>
      <address>
        <postal>
          <street>Huawei Base, Bantian, Longgang District</street>
          <city>Shenzhen</city>
          <region></region>
          <code>518129</code>
          <country>China</country>
        </postal>
        <phone>+86-755-28972912</phone>
        <email>zhangfatai@huawei.com</email>
      </address>
    </author>

    <author fullname="Xihua Fu" initials="X"  surname="Fu">
      <organization>ZTE</organization>
      <address>
        <postal>
          <street>Ruanjian Avenue</street>
          <city>Nanjing</city>
          <region></region>
          <code></code>
          <country>China</country>
        </postal>
        <email>fu.xihua@zte.com.cn</email>
      </address>
    </author> 

    <author fullname="Daniele Ceccarelli" initials="D."  surname="Ceccarelli">
      <organization>Ericsson</organization>
      <address>
        <postal>
          <street>Via Calda 5</street>
          <city>Genova</city>
          <region></region>
          <code></code>
          <country>Italy</country>
        </postal>
        <phone>+39 010 600 2512</phone>
        <email>daniele.ceccarelli@ericsson.com</email>
      </address>
    </author>

    <author fullname="Iftekhar Hussain" initials="I." surname="Hussain">
      <organization>Infinera</organization>
      <address>
        <postal>
          <street>140 Caspian Ct.</street>
          <city>Sunnyvale</city>
          <region></region>
          <code>94089</code>
          <country>USA</country>
        </postal>
        <phone>408-572-5233</phone>
        <email> ihussain@infinera.com</email>
      </address>
    </author>


    <date year="2013" />
    <area>Routing</area>
    <workgroup>Network Working Group</workgroup>
    <keyword>DWDM</keyword>
    <keyword>flexi-grid</keyword>
    <keyword>GMPLS</keyword>

    <abstract>
      <t>This document defines a framework and the associated control plane
        requirements for the GMPLS based control of flexi-grid DWDM networks.
        To allow efficient allocation of optical spectral bandwidth for high
        bit-rate systems, the International Telecommunication Union
        Telecommunication Standardization Sector (ITU-T) has extended the
        recommendations <xref target="G.694.1"/> and <xref target="G.872"/> to
        include the concept of flexible grid: a new DWDM grid has been
        developed within the ITU-T Study Group 15 by defining a set of nominal
        central frequencies, smaller channel spacings and the concept of
        "frequency slot". In such environment, a data plane connection is
        switched based on allocated, variable-sized frequency ranges within 
        the optical spectrum.</t>
    </abstract>
</front>

<middle>
  <!-- ===================================================================
         Requirements Language
       =================================================================== -->
  <section title ="Requirements Language">
    <t> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <xref target="RFC2119"/>.
    </t>
  </section>


  <!-- ===================================================================
       Introduction
       =================================================================== -->
  <section title="Introduction">

    <t>The term "Flexible grid" (flexi-grid for short) as defined by the
      International Telecommunication Union Telecommunication Standardization
      Sector (ITU-T) Study Group 15 in the latest version of <xref
        target="G.694.1"/>, refers to the updated set of nominal central
      frequencies (a frequency grid), channel spacings and optical spectrum
      management/allocation considerations that have been defined in order to
      allow an efficient and flexible allocation  and configuration of optical
      spectral bandwidth for high bit-rate systems.</t>

    <t>A key concept of flexi-grid is the "frequency slot"; a variable-sized
      optical frequency range that can be allocated to a data connection. As
      detailed later in the document, a frequency slot is characterized by its
      nominal central frequency and its slot width which, as per  <xref
        target="G.694.1"/>, is constrained to be a multiple of a given slot
      width granularity.</t>

    <t>Compared to a traditional fixed grid network, which uses fixed size
      optical spectrum frequency ranges or "frequency slots" with typical
      channel separations of 50 GHz, a flexible grid network can select
      its media channels with a more flexible choice of slot widths,
      allocating as much optical spectrum as required, allowing high bit rate signals
      (e.g., 400G, 1T or higher) that do not fit in the fixed grid. </t>

    <t>From a networking perspective, a flexible grid network is assumed to be
      a layered network <xref target="G.872"/><xref target="G.800"/> in which
      the flexi-grid layer (also referred to as the media layer) is the server
      layer and the OCh Layer (also referred to as the signal layer) is the
      client layer. In the media layer, switching  is based on a frequency
      slot, and the size of a media channel is given by the properties of the
      associated frequency slot. In this layered network, the media channel
      itself can be dimensioned to contain one or more Optical Channels.</t>

    <t>As described in <xref target="RFC3945"/>, GMPLS extends MPLS from
      supporting only Packet Switching Capable (PSC) interfaces and switching
      to also support four new classes of interfaces and switching that include
      Lambda Switch Capable (LSC).</t>

    <t>A Wavelength Switched Optical Network (WSON), addressed in <xref
        target="RFC6163"/>, is a term commonly used to refer to the
      application/deployment of a Generalized Multi-Protocol Label Switching
      (GMPLS)-based control plane for the control (provisioning/recovery, etc)
      of a fixed grid WDM network. [editors' note: we need to think of the
      relationship of WSON and OCh switching. Are they equivalent? WSON
      includes regeneration, OCh does not? decoupling of lambda/OCh/OCC]</t> 

    <t>This document defines the framework for a GMPLS-based control of
      flexi-grid enabled DWDM networks (in the scope defined by ITU-T layered Optical     Transport Networks <xref target="G.872"/>, as well as a set of associated control plane requirements. An important design consideration relates to the decoupling of the management of the optical spectrum resource and the client signals to be transported.  [Editor's note: a point was raised during the meeting that WSON has not made the separation between Och and Lambda (spectrum and signal are bundled). The document will consider and evaluate the relationship later]. </t>

    <t>[Editors' note: this document will track changes and evolutions of <xref
        target="G.694.1"/> <xref target="G.872"/> documents until their final
      publication. This document is not expected to become RFC until then.]
    </t>

    <t>[Editor's note: -00 as agreed during IETF83, the consideration of the
      concepts of Super-channel (a collection of one or more frequency slots to
      be treated as unified entity for management and control plane) and
      consequently Contiguous Spectrum Super-channel (a super-channel with a
      single frequency slot) and Split-Spectrum super-channel (a super-channel
      with multiple frequency slots) is postponed until the ITU-T data plane
      includes such physical layer entities, e.g., an ITU-T contribution
      exists. ITU-T is still discussing B100G Architecture]</t> 

    <t>[Editors' note: -01 this version reflects the agreements made during
      IETF84, notably concerning the focus in the media layer, terminology
      updates post ITU-T September meeting in Geneva and the deprecation of
      the ROADM term, in favor of the more concrete media layer switching
      element (media channel matrix).] </t>

    <t>[Editors' note: -01 in partial answer to Gert question on the layered
      model, <xref target="G.872"/> footnote explains that this separation 
      is necessary to allow the description of media elements that may act 
      on more than a single OCh-P signal. See appendix IV within.]</t>

  </section>

<!-- ===================================================================
       Acronyms
     =================================================================== -->
  <section title="Acronyms">
    <t>FS: Frequency Slot</t>
    <t>NCF: Nominal Central Frequency</t>
    <t>OCh: Optical Channel</t>
    <t>OCh-P: Optical Channel Payload</t>
    <t>OCh-O: Optical Channel Overhead</t>
    <t>OCC: Optical Channel Carrier</t>
    <t>SWG: Slot Width Granularity</t>
  </section>


<!-- ===================================================================
         Terminology
     =================================================================== -->
  <section title="Terminology">

    <t>The following is a list of terms (see <xref target="G.694.1"/> and <xref
        target="G.872"/>) reproduced here for completeness.  [Editors' note:
      regarding wavebands, we agreed NOT to use the term in flexi-grid. The term
      has been used inconsistently in fixed-grid networks and overlaps with the
      definition of frequency slot. If need be, a question will be sent to
      ITU-T asking for clarification regarding wavebands.]</t>

    <t>Where appropriate, this documents also uses terminology and lexicography from
      <xref target="RFC4397"/>.</t>

    <t>[Editors' note: *important* these terms are not yet final and they
      may change / be replaced or obsoleted at any time.]</t>

    <section title="Frequency Slots">
      <t>
        <list style="symbols">
          <!--
        <t>Optical Channel Slot (definition in the scope of a fixed grid DWDM
          network, to be adapted to a flexi-grid). The optical spectrum
          frequency range (portion of optical spectrum) allocated / occupied by
          a single optical channel.  Each optical channel signal has a defined
          carrier central frequency and required frequency slot width (the
          supported optical channel signal bandwidth plus source stability).
          Optical Channel slots within an optical multiplex section may be
          allocated (in-service) or may be unallocated (out-of-service). An
          in-service Optical Channel Slot may be carrying an Optical Channel
          Signal or not. Optical Channel Slots are switched in an Optical
          Channel Matrix.</t>
          -->

        <t>Nominal Central Frequency Granularity: 6.25 GHz (note: sometimes
          referred to as 0.00625 THz).</t>

        <t>Nominal Central Frequency: each of the allowed frequencies as per the
          definition of flexible DWDM grid in  <xref target="G.694.1"/>. The
          set of nominal central frequencies can be built using the following
          expression f = 193.1 THz + n x 0.00625 THz, where 193.1 THz is ITU-T
          ''anchor frequency'' for transmission over the C band, n is a
          positive or negative integer including 0.
          <figure anchor="anchor_frequency" title="Anchor frequency and set of nominal central frequencies">
            <artwork>
              <![CDATA[
   -5 -4 -3 -2 -1  0  1  2  3  4  5     <- values of n
 ...+--+--+--+--+--+--+--+--+--+--+-
                   ^ 
                   193.1 THz <- anchor frequency
                   ]]>
             </artwork>
          </figure>
        </t>

        <t>Slot Width Granularity: 12.5 GHz, as defined in <xref
            target="G.694.1"/>.</t>

        <t>Slot Width: The slot width determines the "amount" of optical
          spectrum regardless of its actual "position" in the frequency axis. A
          slot width is constrained to be m x SWG (that is, m x 12.5 GHz),
          where m is an integer greater than or equal to 1.</t>

        <t>Frequency Slot: The frequency range allocated to a slot within the
          flexible grid and unavailable to other slots.  A frequency slot is
          defined by its nominal central frequency and its slot width.
          Assuming a fixed and known central nominal frequency granularity, and
          assuming a fixed and known slot width granularity, a frequency slot
          is fully characterized by the values of 'n' and 'm'.  Note that an
          equivalent characterization of a frequency slot is given by the start
          and end frequencies (i.e., a frequency range) which can, in turn, be
          defined by their respective values of 'n'.
          <!--
          Note that a bidirectional optical transmission section layer network
          connection may be supported by one optical fiber for both directions
          (single fiber), or each direction of the connection may be supported
          by different fibers (pair of fibers). Since a frequency slot is a
          unidirectional entity (the same nominal central frequency cannot be
          used in two directions of transmission), the single fiber case is
          carried out by a pair of unidirectional frequency slots on the same
          fiber, and the pair of fibers case may have frequency slots that use
          the same nominal central frequencies.
          -->

        <figure anchor="example_frequency_slots" title="Example Frequency slots">
            <artwork>
              <![CDATA[
      Frequency Slot 1     Frequency Slot 2 
       -------------     -------------------  
       |           |     |                 |  
   -3 -2 -1  0  1  2  3  4  5  6  7  8  9 10 11     
..--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--... 
       -------------     ------------------- 
             ^                    ^ 
     Central F = 193.1THz    Central F = 193.14375 THz 
     Slot width = 25 GHz     Slot width = 37.5 GHz 
          ]]>
            </artwork>
          </figure>          
           <list>
           <t>The symbol '+' represents the allowed nominal central frequencies,
          the '--' represents the nominal central frequency granularity, and
          the '^' represents the slot nominal central frequency. The number on
          the top of the '+' symbol represents the 'n' in the frequency
          calculation formula. The nominal central frequency is 193.1 THz when
          n equals zero. Note that over a single frequency slot, one or
          multiple Optical Channels may be transported. </t> 

          <t>Note that when there are multiple optical signals within frequency
          slot, then each signal still has its own central frequency. That is,
          the term "central frequency" applies to an Optical signal and the
          term "nominal central frequency" applies to a frequency slot. In
          other words, the Frequency Slot central frequency is independent of
          the signals central frequencies.</t>
        </list>
        </t>
        <t>Effective Frequency Slot: the effective frequency slot of a media channel is the common part of the frequency slots along the media channel through a particular path through the optical network.  It is a logical construct derived from the (intersection of) frequency slots allocated to each device in the path. The effective frequency slot is an attribute of a media channel and, being a frequency slot, it is described by its nominal central frequency and slot width.</t>

           <t>As an example, if there are two filters having slots with the same n
          but different m, then the common frequency slot has the smaller of
          the two m values. [Editor's note: within the GMPLS label swapping
          paradigm, the switched resource corresponds to the local frequency
          slot defined by the observable filters of the media layer switching
          element. The GMPLS label MUST identify the switched resource locally,
          and (as agreed during IETF84) is locally scoped to a link, even if
          the same frequency slot is allocated at all the hops of the path.
          Note that the requested slot width and the finally allocated slot
          width by a given node may be different, e.g., due to restrictions in
          the slot width granularity of the nodes. Due to the symmetric
          definition of frequency slot, allocations seem to be constrained to
          have the same nominal central frequency. It is important to note that
          if n changes along the path, it cannot be guaranteed that there is a
          valid common frequency slot. We must determine if different n's are
          allowed. We need to explain this rationale. e.g.  what happens when
          the resulting slot cannot be characterized with n and m, see
          <xref target="effective_frequency_slot"/> and <xref target="invalid_effective_frequency_slot"/>.].

          <figure anchor="effective_frequency_slot" title="Effective Frequency Slot">
            <artwork>
              <![CDATA[
                     Frequency Slot 1   
             -------------    
             |           |    
   -3 -2 -1  0  1  2  3  4  5  6  7  8  9 10 11     
   ..--+--+--+--+--X--+--+--+--+--+--+--+--+--+--+--+--... 

          Frequency Slot 2 
          -------------------
          |                 |
   -3 -2 -1  0  1  2  3  4  5  6  7  8  9 10 11     
   ..--+--+--+--+--X--+--+--+--+--+--+--+--+--+--+--+--... 

=============================================== 
        Effective Frequency Slot 
             -------------
             |           |
   -3 -2 -1  0  1  2  3  4  5  6  7  8  9 10 11     
   ..--+--+--+--+--X--+--+--+--+--+--+--+--+--+--+--+--... 
          ]]>
            </artwork>
          </figure>      
          <figure anchor="invalid_effective_frequency_slot" title="Invalid Effective Frequency Slot">
            <artwork>
              <![CDATA[
      Frequency Slot 1   
       -------------    
       |           |    
   -3 -2 -1  0  1  2  3  4  5  6  7  8  9 10 11     
   ..--+--+--X--+--+--+--+--+--+--+--+--+--+--+--+--+--... 

          Frequency Slot 2 
          -------------------
          |                 |
   -3 -2 -1  0  1  2  3  4  5  6  7  8  9 10 11     
   ..--+--+--+--+--X--+--+--+--+--+--+--+--+--+--+--+--... 

=============================================== 
        Invalid Effective Frequency Slot - (n, m?)
          ----------
          |        |
   -3 -2 -1  0  1  2  3  4  5  6  7  8  9 10 11     
   ..--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--... 
          ]]>
            </artwork>
          </figure>      
        </t>
      </list>
    </t>
    </section>


    <section title="Media Layer, Elements and Channels">
      <t>
        <list style="symbols">

          <t>Media Element:  a media element only directs the optical signal or
            affects the properties of an optical signal, it does not modify the
            properties of the information that has been modulated to produce the
            optical signal. Examples of media elements include fibers,
            amplifiers, filters, switching matrices[Note: the data plane
            component of a LSR in the media layer is a media element, but not all
            media elements correspond to data plane nodes in the GMPLS network
            model.</t>

          <t>Media Channel: a media association that represents both the
            topology (i.e., path through the media) and the resource (frequency
            slot) that it occupies. As a topological construct, it represents a
            (effective) frequency slot supported by a concatenation of media
            elements (fibers, amplifiers, filters, switching matrices...). This
            term is used to identify the end-to-end physical layer entity with
            its corresponding (one or more) frequency slots local at each link
            filters.</t> 

          <t>Network Media Channel: a media channel (media association) that
            supports a single OCh-P network connection. It represents the
            concatenation of all media elements between an OCh-P source and an
            OCh-P sink.  [TODO: |Malcolm| explain the use case rationale to
            support a hierarchy of media channels, where a media channel acts as
            "pipe" for one or more network media channels and they are both
            separate entities (IETF84). This may be tied to the concept of a
            "waveband" or express channel, as stated in  <xref target="G.872"/>
            footnote 4.]</t>

          <t>OCh-P Frequency Slot:  The spectrum allocated to a single OCh signal
            supported on a Network Media Channel. </t>
        </list>
      </t>

      <t>Note that by definition a network media channel only supports a single
        OCh-P network connection, but the architecture is flexible enough to
        support the case where a single Optical Channel Payload (OCh-P) is
        transported over multiple (N) network media channels (see <xref
          target="och_p_over_n_nmc"/>) which are non-necessarily adjacent
        (e.g., there may not exist an equivalent network media channel that can
        be represented as the union of media channels with a single, valid
        equivalent frequency slot). Whether a single OCh-P is transported over
        just one or more network media channels is an aspect that corresponds
        to the mapping of the signal layer to the media layer. </t>

          <figure anchor="och_p_over_n_nmc" title="A single OCh-P transported over multiple network media channels">
            <artwork>
              <![CDATA[
                                   OCh-P                Signal Layer
                             +--------X----------+
                                 /           \          Media Layer
                                /             \
          Network Media Channel #1     ...   Network Media Channel #N
          +------------o-----------+         +----------X-----------+   
          |                        |         |                      | 
...  +---+---+---+---+---+---+---+---+---+---+---+--+---+---+---+---+---... 
        ]]>
            </artwork>
          </figure>          
    </section>

    <section title="Media Layer Switching">
      <t> [Editors' note:  we are not discarding O/E/O. If defined in a ITU-T
        network reference model with trail/terminations, considering optical
        channels i.e. with well-defined interfaces, reference points, and
        architectures.  The implications of O/E/O will be also addressed once we
        have another context that includes them. In OTN from an OCh point of view
        end to end means from transponder to transponder, so if there is a 3R
        from ingress to egress there are 2 OCh which can have different 'n' and
        'm'].

        <list style="symbols">
          <t>Media Channel Matrixes: the media channel matrix provides flexible
            connectivity for the media channels. That is, it represents a point
            of flexibility where relationships between the media ports at the
            edge of a media channel matrix may be created and broken. The
            relationship between these ports is called a matrix channel.
            (Network) Media Channels are switched in a Media Channel
            Matrix.</t> 
        </list>
      </t>

      <t>In summary, the concept of frequency slot is a logical abstraction
        that represents a frequency range while the media layer represents the
        underlying media support. Media Channels are media associations,
        characterized by their (effective) frequency slot, respectively; and
        media channels are switched in media channel matrixes.  In <xref
          target="media_channel_example"/> , a Media Channel has been
        configured and dimensioned to support two OCh-P, each transported in
        its own OCh-P frequency slot.  

          <figure anchor="media_channel_example" title="Example of Media Channel / Network Media Channels and associated frequency slots">
            <artwork>
              <![CDATA[
                         Media Channel Frequency Slot 
     +-------------------------------X------------------------------+
     |                                                              |
     |      OCh-P Frequency Slot             OCh-P Frequency Slot   |
     |  +------------X-----------+       +----------X-----------+   |
     |   |       OCh-P           |       |      OCh-P           |   |
     |   |           o           |       |          o           |   |
     |   |           |           |       |          |           |   |
    -4  -3  -2  -1   0   1   2   3   4   5   6   7  8   9  10  11  12  
...  +---+---+---+---+---+---+---+---+---+---+---+--+---+---+---+---+---... 

...      <- Network Media Channel->     <- Network Media Channel->

...  <------------------------ Media Channel ----------------------->

     X - Frequency Slot Central Frequency

     o - signal central frequency
        ]]>
            </artwork>
          </figure>          
        </t>
      </section>

      <section title="Control Plane Terms">
        <t>The following terms are defined in the scope of a GMPLS control plane.

          <list style="symbols">

            <t>SSON: Spectrum-Switched Optical Network. Refers to an optical network in which
              a LSP is switched based on an frequency slot of a variable slot width
              of a media channel, rather than based on a fixed grid and fixed slot
              width.  Please note that a Wavelength Switched Optical Network (WSON)
              can be seen as a particular case of SSON in which all slot widths are
              equal and depend on the used channel spacing.  </t>

            <t>RSA: Routing and Spectrum Assignment. As opposed to the typical
              Routing and Wavelength Assignment (RWA) problem of traditional WDM
              networks, the flexibility in SSON leads to spectral contiguous
              constraint, which means that when assigning the spectral resources to
              single connections, the resources assigned to them must be contiguous
              over the entire connections in the spectrum domain. </t>

          </list>
        </t>
      </section>
    </section>



<!-- ===================================================================
           Network element models
     =================================================================== -->

  <section title="DWDM flexi-grid enabled network element models">

    <t>Similar to fixed grid networks, a flexible grid network is also
      constructed from subsystems that include Wavelength Division Multiplexing
      (WDM) links, tunable transmitters and receivers, i.e, media elements
      including media layer switching elements (media matrices), as well as
      electro-optical network elements, all of them with flexible grid
      characteristics.</t>

    <t>[Editors' Note: In the scope of this document, and despite is informal
      use, the term Reconfigurable Optical Add / Drop Multiplexer,  (ROADM) is
      avoided, in favor on media matrix. This avoid ambiguity. A ROADM can be
      implemented in terms on media matrices. Informationally, this document
      may provide an appendix on possible implementations of flexi-ROADMs in
      terms of media layer switching elements or matrices. XF: Whether ROADM is
      used or not doesn't matter with GMPLS Control Plane. I suggest to delete
      this statement. We may check G.798.  Likewise, modeling of filters is out
      of scope of the current document IETF84, and is also considered
      implementation specific.]</t>

    <t>As stated in <xref target="G.694.1"/> the flexible DWDM grid defined in
      Clause 7 has a nominal central frequency granularity of 6.25 GHz and a
      slot width granularity of 12.5 GHz. However, devices or applications that
      make use of the flexible grid may not be capable of supporting every
      possible slot width or position. In other words, applications may be
      defined where only a subset of the possible slot widths and positions are
      required to be supported.  For example, an application could be defined
      where the nominal central frequency granularity is 12.5 GHz (by only
      requiring values of n that are even) and that only requires slot widths
      as a multiple of 25 GHz (by only requiring values of m that are
      even).</t>


    <section title="Network element constraints">
      <t>[TODO: section needs to be rewritten, remove redundancy].</t>

      <t> Optical transmitters/receivers may have different tunability
        constraints, and media channel matrixes may have switching
        restrictions. Additionally, a key feature of their implementation is
        their highly asymmetric switching capability which is described in
        <xref target="RFC6163"/> in detail.  Media matrices include line side
        ports which are connected to DWDM links and tributary side input/output
        ports which can be connected to transmitters/receivers.</t>
        
      <t>A set of common constraints can be defined:
        <list style="symbols"> 
          <t>The minimum and maximum slot width.</t>

          <t>Granularity: the optical hardware may not be able to select
            parameters with the lowest granularityy (e.g. 6.25 GHz for nominal
            central frequencies or 12.5 GHz for slot width granularity).</t>

          <t>Available frequency ranges: the set or union of frequency ranges
            that are not allocated (i.e. available).  The relative grouping and
            distribution of available frequency ranges in a fiber is usually
            referred to as ''fragmentation''. </t>

          <t>Available slot width ranges: the set or union of slot width ranges
            supported by media matrices. It includes the following information.

            <list style="symbols"> 
              <t>Slot width threshold: the minimum and maximum Slot Width supported
                by the media matrix.  For example, the slot width can be from 50GHz to
                200GHz.</t>

              <t>Step granularity: the minimum step by which the optical filter
                bandwidth of the media matrix can be increased or decreased. This parameter is
                typically equal to slot width granularity (i.e. 12.5GHz) or integer
                multiples of 12.5GHz.</t>
            </list>
          </t>
        </list>
      </t>

      <t>[Editor's note: different configurations such as C/CD/CDC will be
        added later. This section should state specifics to media channel
        matrices, ROADM models need to be moved to an appendix].
      </t>

    </section>
  </section>



<!-- ===================================================================
           Layered model
     =================================================================== -->
  <section title="Layered Network Model">

    <t>This section presents an overview of the OCh / flexi-grid layered network model defined by ITU-T. [Editors' note: OTN hierarchy is not fully covered. It is important to
      understand, where the FSC sits in the OTN hierarchy. This is also
      important from control plane perspective as this layer becomes the
      connection end points of optical layer service].

      <figure anchor="layered_network_model" title="Layered Network Model according to G.805">
        <artwork><![CDATA[

 OCh AP                     Trail (OCh)                        OCh AP
  O- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - O
  |                                                                  |
 --- OCh-P                                                    OCh-P ---
 \ / source                                                   sink  \ /
  +                                                                  +
  | OCh-P                 OCh-P Network Connection             OCh-P |
  O TCP - - - - - - - - - - - - - - - - - - - - - - - - - - - - -TCP O
  |                                                                  |
  |Channel Port            Network Media Channel        Channel Port |
  O - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  O
  |                                                                  |
+--------+                 +-----------+                   +----------+
|  \ (1) |  OCh-P LC       |    (1)    |  OCh-P LC         |   (1)  / |
|   \----|-----------------|-----------|-------------------|-------/  |
+--------+ Link Channel    +-----------+  Link Channel     +----------+
Media Channel              Media Channel                   Media Channel
  Matrix                     Matrix                          Matrix

(1) - Matrix Channel
      ]]></artwork>
  </figure>          

    </t>

    <t>[Editors' note: we are replicating the figure here for reference, until
      the ITU-T document is official.</t>
  </section>



<!-- ===================================================================
         GMPLS applicability
     =================================================================== -->
  <section title="GMPLS applicability">
    <t>The goal of this section is to provide an insight of the application of GMPLS to flexi-grid networks, while specific requirements are covered in the next section. The present framework is aimed at controlling the so called media layer within the OTN hierarchy. Specifically, the GMPLS control of the media layer deals with the establishment of media channels, which are switched in media channel matrixes. GMPLS
      labels locally represent the media channel and its associated frequency
      slot. [Editors'note: As agreed during IETF84, current focus is on the media
      layer.]</t>

    <t>Also, this sections provides a mapping of the  mapping ITU-T G.872 architectural aspects to
      GMPLS/Control plane terms, and see the relationship between the
      architectural concept/construct of media channel and its control plane
      representations (e.g. as a TE link). </t>
<section title="Considerations on TE Links">
    <t>From a theoretical / abstract point of view, a fiber can be modeled has
      having a frequency slot that ranges from (-inf, +inf). This representation
      helps understand the relationship between frequency slots / ranges.</t>

    <t>The frequency slot is a local concept that applies locally to a
      component / element. When applied to a media channel, we are referring to its
      effective frequency slot as defined in <xref target="G.872"/>.</t>

    <t>The association of a filter, a fiber and a filter is a media channel in
      its most basic form, which from the control plane perspective may modeled as a
      (physical) TE-link with a contiguous optical spectrum at start of day. A means to represent this is that the
      portion of spectrum available at time t0 depends on which filters are placed at
      the ends of the fiber and how they have been configured. Once filters are
      placed we have the one hop media channel. In practical terms, associating a fiber with 
      the terminating filters determines the usable optical spetrum. </t>

    <t>
      <figure anchor="media_channel_te_link" title="(Basic) Media channel and TE link">
        <artwork>
          <![CDATA[
-----------------+                                +-----------------+
                 |                                |
        +--------+                                +--------+
        |        |                                |        |  +---------
    ---o|        ==================================        o--|
        |        |             Fiber              |        |  | --\  /-- 
    ---o|        |                                |        o--|    \/
        |        |                                |        |  |    /\
    ---o|        ==================================        o--| --/  \--
        | Filter |                                | Filter |  |
        |        |                                |        |  +---------
        +--------+                                +--------+
                 |                                |              
              |---------- Basic Media Channel  ---------|
-----------------+                                +-----------------+


      --------+                                         +--------+                                                  
              |-----------------------------------------|
       LSR    |                TE link                  |  LSR
              |-----------------------------------------|
     +--------+                                         +--------+                                                  
          ]]>
        </artwork>
      </figure>          
    </t>


    <t>Additionally, when a cross-connect for a specific frequency slot is
      considered, the underlying media support is still a media channel, augmented,
      so to speak, with a bigger association of media elements and a resulting
      effective slot.  When this media channel is the result of the association of
      basic media channels and media layer matrix cross-connects, this architectural
      construct can be represented as / corresponds to a Label Switched Path (LSP)
      from a control plane perspective.  In other words, It is possible to
      "concatenate" several media channels (e.g.  Patch on intermediate nodes) to
      create a single media channel.</t>

      <figure anchor="media_channel_te_link2" title="Extended Media Channel">
        <artwork>
          <![CDATA[
------------+       +--------------------------------+       +----------
            |       |                                |       |                  
     +------+       +------+                  +------+       +------+
     |      |       |      |   +----------+   |      |       |      |
 ---o|      =========      o---|          |---o      =========      o--
     |      | Fiber |      |   | --\  /-- |   |      | Fiber |      |
 ---o|      |       |      o---|    \/    |---o      |       |      o--
     |      |       |      |   |    /\    |   |      |       |      |
 ---o|      =========      o---***********|---o      =========      o--
     |Filter|       |Filter|   |          |   |Filter|       |Filter|
     |      |       |      |                  |      |       |      |
     +------+       +------+                  +------+       +------+
            |       |                                |       |
        <- Basic Media ->     <- Matrix ->        <- Basic Media-> 
            |Channel|            Channel             |Channel|
------------+       +--------------------------------+       +----------
       
         <---------------------  Media Channel  -----------------> 
    
   -----+                   +---------------+                   +-------
        |-------------------|               |-------------------|
   LSR  |        TE link    |       LSR     |   TE link         |   LSR
        |-------------------|               |-------------------|
   -----+                   +---------------+                   +-------
          ]]>
        </artwork>
      </figure>          


      <t> Additionally, if appropriate, it can also be represented as a TE link
        or Forwarding Adjacency (FA), augmenting the control plane network model. </t>

      <figure anchor="media_channel_te_link3" title="Extended Media Channel / TE Link / FA">
        <artwork>
          <![CDATA[
-----------+       +--------------------------------+       +-----------
           |       |                                |       |                  
    +------+       +------+                  +------+       +------+
    |      |       |      |   +----------+   |      |       |      |
 --o|      =========      o---|          |---o      =========      o---
    |      | Fiber |      |   | --\  /-- |   |      | Fiber |      |
 --o|      |       |      o---|    \/    |---o      |       |      o---
    |      |       |      |   |    /\    |   |      |       |      |
 --o|      =========      o---***********|---o      =========      o---
    |Filter|       |Filter|   |          |   |Filter|       |Filter|
    |      |       |      |                  |      |       |      |
    +------+       +------+                  +------+       +------+
           |       |                                |       |
-----------+       +--------------------------------+       +-----------
       
        <---------------------------  Media Channel  -----------> 
      
 +-----+                                                        +------
       |--------------------------------------------------------| 
 LSR   |                                 TE link                |  LSR
       |--------------------------------------------------------| 
 +-----+                                                        +------
          ]]>
        </artwork>
      </figure>          
</section>
<section title="Considerations on Labeled Switched Path (LSP) in Flexi-grid">
      <t>The flexi-grid LSP is seen as a control plane representation of a media channel.
        Since network media channels are media channels, an LSP may also be the control
        plane representation of a network media channel, in a particular context. From
        a control plane perspective, the main difference (regardless of the actual
        effective frequency slot which may be dimensioned arbitrarily) is that the LSP
        that represents a network media channel also includes the endpoints
        (transceivers) , including the cross-connects at the ingress / egress nodes.
        The ports towards the client can still be represented as interfaces from the
        control plane perspective.</t>

      <t><xref target="lsp_mchan1"/> describes an LSP routed along 3 nodes.  The LSP is terminated before
        the optical matrix of the ingress and egress nodes and can represent a Media
        Channel.  This case does NOT (and cannot) represent a network media channel as
        it does not include (and cannot include) the transceivers.</t>

      <figure anchor="lsp_mchan1" title="Flex-grid LSP representing a media channel that starts at the filter of the outgoing interface of the ingress LSR and ends at the filter of the incoming interface of the egress LSR">
        <artwork>
          <![CDATA[
----------+       +------------------------------------+       +--------------
          |       |                                    |       |                  
   +------+       +--------+                  +--------+       +------+
   |      |       |        |   +----------+   |        |       |      |
 -o|      =========        o---|          |---o        =========      o---
   |      | Fiber |        |   | --\  /-- |   |        | Fiber |      |
 -o|>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>o---
   |      |       |        |   |    /\    |   |        |       |      |
 -o|      =========        o---***********|---o        =========      o---
   |Filter|       | Filter |   |          |   | Filter |       |Filter|
   |      |       |        |                  |        |       |      |
   +------+       +--------+                  +--------+       +------+
          |       |                                    |       |
----------+       +------------------------------------+       +--------------
       
        >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> LSP >>>>>>>>>>>>>>>>>>>>>>>>
   -----+                      +---------------+                    +-----                               
        |----------------------|               |--------------------|
   LSR  |           TE link    |       LSR     |          TE link   | LSR
        |----------------------|               |--------------------|
   -----+                      +---------------+                    +----- 
          ]]>
        </artwork>
      </figure>

      <t>In <xref target="lsp_mchan2"/> a Network Media Channel is represented
        as terminated at the DWDM side of the transponder, this is commonly named as
        OCh-trail connection.</t>

      <figure anchor="lsp_mchan2" title="LSP representing a network media channel (OCh-Trail)">
        <artwork>
          <![CDATA[
|-------------------------- Network Media Channel ---------------------------|

     +------------------------+                 +------------------------+
     |                        |                 |                        |
     +------+          +------+                 +------+          +------+
     |      | +------+ |      |                 |      | +------+ |      |OCh-P
OCh-P|      o-|      |-o      |    +-----+      |      o-|      |-o      |sink
 src |      | |      | |      =====+-+ +-+======|      | |      | |      O---|R
T|***o******o****************************************************************** 
     |      | | \  / | |           | | | |      |      | | \  / | |      |
     |      o-|  \/  |-o      =====| | | |======|      o-|  \/  |-o      |
     |      | |  /\  | |      |    +-+ +-+      |      | |  /\  | |      |
     |      o-| /  \ |-o      |    |  \/ |      |      o-| /  \ |-o      |
     |Filter| |      | |Filter|    |  /\ |      |Filter| |      | |Filter|
     +------+ |      | +------+    +------+     +------+ |      | +------+
     |        |      |        |                 |        |      |        |
     +------------------------+                 +------------------------+
                                        LSP 
<---------------------------------------------------------------------------->

                                        LSP 
 <-------------------------------------------------------------------------->
      +-----+                       +--------+                    +-----+
 o--- |     |-----------------------|        |--------------------|     |---o
      | LSR |       TE link         |  LSR   |       TE link      | LSR |
      |     |-----------------------|        |--------------------|     |
      +-----+                       +--------+                    +-----+ 
          ]]>
        </artwork>
      </figure>

      <t>In a third case, a Network Media Channel terminated on the Filter
        ports of the Ingress and Egress nodes. This is named in G.872 as OCh-NC (we
        need to discuss the implications, if any, once modeled at the control plane
        level of models B and C).</t>

      <figure anchor="lsp_mchan3" title="LSP representing a network media channel (OCh-P NC)">
        <artwork>
          <![CDATA[
    |-----------------------  Network Media Channel --------------------|
    
    +------------------------+                 +------------------------+
    +------+          +------+                 +------+          +------+
    |      | +-----+  |      |                 |      | +------+ |      |
    |      o-|      |-o      |    +------+     |      o-|      |-o      |
    |      | |      | |      =====+-+  +-+=====|      | |      | |      O---|R
T|--o******o*************************************************************
    |      | | \  / | |           | |  | |     |      | | \  / | |      |
    |      o-|  \/  |-o      =====| |  | |=====|      o-|  \/  |-o      |
    |      | |  /\  | |      |    +-+  +-+     |      | |  /\  | |      |
    |      o-| /  \ |-o      |    |  \/  |     |      o-| /  \ |-o      |
    |Filter| |      | |Filter|    |  /\  |     |Filter| |      | |Filter|
    +------+ |      | +------+    +------+     +------+ |      | +------+
    |        |      |        |                 |        |      |        |
    +------------------------+                 +------------------------+
    <------------------------------------------------------------------->
                                       LSP 

                                       LSP 
    <----------------------------------------------------------------->
    +-----+                      +--------+                      +-----+
o---|     |----------------------|        |----------------------|     |---o
    | LSR |         TE link      |  LSR   |        TE link       | LSR |
    |     |----------------------|        |----------------------|     |
    +-----+                      +--------+                      +-----+ 
          ]]>
        </artwork>
      </figure>
      <t>[Note: not clear the difference, from a control plane perspective,
        of figs <xref target="lsp_mchan2"/> and <xref target="lsp_mchan3"/>.]
      </t>

      <t>Applying the notion of hierarchy at the media layer, by using the LSP as a FA, the media channel created can support multiple (sub) media channels.  [Editot note : a specific behavior related to Hierarchies will be verified at a later point in time].
        <figure anchor="mrn_mln_topology_view" title="MRN/MLN topology view with TE link / FA">
          <artwork>
            <![CDATA[
+--------------+                            +--------------+
|    OCh-P     |             TE             |     OCh-P    |  Virtual TE 
|              |            link            |              |    link
|    Matrix    |o- - - - - - - - - - - - - o|    Matrix    |o- - - - - -  
+--------------+                            +--------------+
               |       +---------+          |
               |       |  Media  |          |
               |o------| Channel |---------o|
                       |         | 
                       | Matrix  | 
                       +---------+
          ]]>
        </artwork>
      </figure>          
    </t>

    <t>Note that there is only one media layer switch matrix (one
      implementation is FlexGrid ROADM) in SSON, while "signal layer LSP is
      mainly for the purpose of management and control of individual optical
      signal". Signal layer LSPs (OChs) with the same attributions (such as
      source and destination) could be grouped into one media-layer LSP
      (media channel), which has advantages in spectral efficiency
      (reduce guard band between adjacent OChs in one FSC) and LSP management.
      However, assuming some network elements indeed perform signal layer
      switch in SSON, there must be enough guard band between adjacent OChs in
      one media channel, in order to compensate filter concatenation
      effect and other effects caused by signal layer switching elements. In
      such condition, the separation of signal layer from media layer cannot
      bring any benefit in spectral efficiency and in other aspects, but make
      the network switch and control more complex.  If two OChs must switch to
      different ports, it is better to carry them by diferent FSCs and the
      media layer switch is enough in this scenario. </t>
    </section>

  </section>





<!-- ===================================================================
     Control plane requirements
     =================================================================== -->
  <section title="Control Plane Requirements">

    <t>[Editor's note: The considered topology view is a layered network, in
      which the media layer corresponds to the  server layer (flexigrid) and
      the signal layer corresponds to the client layer (Och). This data plane
      modeling considers the flexigrid and the OCh as separate layers,
      However, this has implications on the interop/interworking with WSON and
      OCh switching. We need to manage a MRN for OCh and stitching for WSON?
      In other words, a key part of the fwk is to define how can we have
      MRN/MLN hierarchical relationship with Och/FS and yet stitching 1:1
      between WSON and SSON?  In this line: how does OCh switching and WSON
      relate, actually?]</t>

    <t>[Editor's note: formal requirements such as noted in the comments will
      be added in a later version of the document].</t>

    <t>The data plane model decouples media and signal. The data plane definition relative to the the signal mapping are still ongoing. Until they are closed, the Control Plane considered is based on a MRN/MLN network in which the Control Plane differentiates signal LSPs and media LSPs. This will be revised when the data plane definition are finalized.</t> 
    <t>The signal does impose restriction on the flexi-LS by constraining the effective frequency slot. The central frequency of each hop should be same along end-to-end media or signal LSP because of Spectrum Continuity Constraint. 
  [Editors Note: the effective frequency slot should fit, which clause mandate that the central frequency is the same ??] Otherwise some nodes need to conver the central frequency along media or signal LSP.</t>

    <section title="Media Layer Resource Allocation considerations">
      <t>[Editors' note: preliminary text based on IETF85 side-meeting
        minutes]</t>

      <t>A media channel has an associated effective frequency slot. From the
        perspective of network control and management, this effective slot is seen as
        the "usable" frequency slot end to end. The establishment of an LSP related the
        establishment of the media channel and effective frequency slot.</t>

      <t>In this context, when used unqualified, the frequency slot is a local
        term, which applies at each hop.  An effective frequency slot applies at the
        media chall (LSP) level</t>

        <t>A "service" request is characterized as a minimum, by its required effective slot width.  This does not preclude that the request may add additional constraints such as imposing also the nominal central frequency.  A given frequency slot is requested for the media channel say, with the Path message.  Regardless of the actual encoding, the Path message sender descriptor sender_tspec shall specify a minimum frequency slot width that needs to be fulfilled.</t>

   <t>In order to allocate a proper effective frequency slot for a LSP, the
   signaling should specify its required slot width.</t>

      <t>An effective frequency slot must equally be described in terms of a
        central nominal frequency and its slot width (in terms of usable spectrum of
        the effective frequency slot). That is, one must be able to obtain an
        end-to-end equivalent n and m parameters. We refer to this as the "effective
        frequency slot of the media channel/LSP must be valid".</t>

 <t>In GMPLS the requested effective frequency slot is represented to the
   TSpec and the effective frequency slot is mapped to the FlowSpec.</t> 

   <t>The switched element corresponds in GMPLS to the 'label'. As in flexi-grid the switched element is a frequency slot, the label represents a frequency slot. Consequently, the label in flexi-grid must convey the necessary information to obtain the frequency slot characteristics (i.e, center and width, the n and m parameters). The frequency slot is locally identified by the label</t>

      <t>The local frequency slot may change at each hop, typically given
        hardware constraints (e.g. a given node cannot support the finest
        granularity). Locally n and m may change. As long as a given downstream node allocates
        enough optical spectrum, m can be different along the path. This covers the
        issue where concrete media matrices can have different slot width
        granularities. Such "local" m will appear in the allocated label that encodes
        the frequency slot as well as the flow descriptor flowspec.</t>

      <t>Different modes are considered: RSA with explicit label control , and
        for R+DSA, the GMPLS signaling procedure is similar to the one described in
        section 4.1.3 of <xref target="RFC6163"/> except that the label set should
        specify the available nominal central frequencies that meet the slot width
        requirement of the LSP.  The intermediate nodes can collect the
        acceptable central frequencies that meet the slot width requirement hop by hop.
        The tail-end node also needs to know the slot width of a LSP to assign the
        proper frequency resource. Compared with <xref target="RFC6163"/>, except
        identifying the resource (i.e., fixed wavelength for WSON and frequency
        resource for flexible grids), the other signaling requirements (e.g.,
        unidirectional or bidirectional, with or without converters) are the same as
        WSON described in the section 6.1 of <xref target="RFC6163"/>. </t>

      <t>Regarding how a GMPLS control plane can assign n and m, different cases can apply:
        <list>
          <t>a) n and m can both change. It is the effective slot what matters.
            Some entity needs to make sure the effective frequency slot remains valid.</t>
          <t>b) m can change; n needs to be the same along the path. This
            ensures that the nominal central frequency stays the same.</t>
          <t>c) n and m need to be the same. </t>
          <t>d)n can change, m needs to be the same.</t>
        </list>
      </t>

      <t>In consequence, an entity such as a PCE can make sure that the n and m
        stay the same along the path. Any constraint (including frequency slot and
        width granularities) is taken into account during path computation.
        alternatively, A PCE (or a source node) can compute a path and the actual
        frequency slot assignment is done, for example, with a distributed (signaling)
        procedure: 
        <list>
          <t>Each downstream node ensures that m is >= requested_m. </t>

          <t>Since a downstream node cannot foresee what an upstream node will
            allocate in turn, a way we can ensure that the effective frequency slot is
            valid is then by ensuring that the same "n" is allocated. By forcing the same
            n, we avoid cases where the effective frequency slot of the media
            channel is invalid (that is, the resulting frequency slot cannot be described
            by its n and m parameters). </t>

          <t>Maybe this is a too hard restriction, since a node (or even a
            centralized/combined RSA entity) can make sure that the resulting end to end
            (effective) frequency slot is valid, even if n is different locally. That
            means, the effective (end to end) frequency slot that characterizes the
            media channel is one and determined by its n and m, but are logical,
            in the sense that they are the result of the intersection of local (filters)
            freq slots which may have different freq. slots </t>
        </list>
      </t>

      <t>For Figure <xref target="effslot1"/> the effective slot is valid by
        ensuring that the minimum m is greater than the requested m.  The effective
        slot (intersection) is the lowest m (bottleneck).</t>

      <t>For Figure <xref target="effslot2"/> the effective slot is valid by
        ensuring that it is valid at each hop in the upstream direction. The
        intersection needs to be computed. Invalid slots could result otherwise. 
      
        <figure anchor="effslot1" title="Distributed allocation with different m and same n">
          <artwork>
            <![CDATA[
          |Path(m_req)     |                  ^                 |
          |--------->      |                  #                 |
          |                |                  #                 ^  
         -^----------------^------------------#-----------------#--
Effective #                #                  #                 #
FS n, m   # . . . . . . . .#. . . . . . . . . # . . . . . .. . .# <-fixed
          #                #                  #                 #   n
         -v----------------v------------------#-----------------#---
          |                |                  #                 v
          |                |                  #           Resv  |
          |                |                  v         <------ |
          |                |                  | flowspec(n, m_a)|
          |                |         <--------|                 |
          |                |    flowspec (n,  |                     
                  <--------|        min(m_a, m_b))
             flowspec (n,  |                   
               min(m_a, m_b, m_c))
            ]]>
          </artwork>
        </figure>
             
        <figure anchor="effslot2" title="Distributed allocation with different m and different n">
          <artwork>
            <![CDATA[
          |Path(m_req)     ^                  |
          |--------->      #                  |                 |
          |                #                  ^                 ^  
         -^----------------#------------------#-----------------#----------
Effective #                #                  #                 #
FS n, m   #                #                  #                 # 
          #                #                  #                 # 
         -v----------------v------------------#-----------------#----------
          |                |                  #                 v
          |                |                  #           Resv  |
          |                |                  v         <------ |
          |                |                  |flowspec(n_a, m_a) 
          |                |         <--------|                 |
          |                |    flowspec (FSb [intersect] FSa)
                  <--------|        
             flowspec ([intersect] FSa,FSb,FSc)
            ]]>
          </artwork>
        </figure>

      
      
      
      </t>

      <t>Note, when a media channel is bound to one OCh-P (i.e is a Network
        media channel), the EFS  must be the one of the Och-P. The media channel setup
        by the LSP may contains the EFS of the network media channel EFS. This is an
        endpoint property, the egress and ingress SHOULD constrain the EFS to Och-P EFS
        [q: can't the endpoint be configured based on the final allocation? constraint
        or output?].</t>

      <t>Also note that the case d) applies for one cannot assume that m =
        m_requested. If m = m_requested, one cannot ensure that the effective slot is
        valid unless all n are equal but, more generically,  different n and same m can
        be possible, provided that the intersection of the two most distant local slots
        is >= requested width. (See figure below, in the case where m = mreq then -> nb
        = na).
        <figure anchor="effslot3" title="Valid frequency slot case d)">
          <artwork>
            <![CDATA[
0 1 2 3 4 ...
|<-------2m---------->|
|--------na-----------|

---------X---------------X------------

             |----------nb--------|
             |<-------2m--------->|     
------------------------------------
             |<2mreq>|

(na + m) - (nb - m) >= 2mreq  where nb >= na
(nb - na) <= 2(m - mreq)]]>
            </artwork>
        </figure>
      </t>
      <t>[cyrils' summary of key aspects:
        <list>
          <t>the label is local and represent the local frequency slot.</t> 
          <t>the requested FS is mapped to the TSPec, it may differ from the labels,  (so likely to carry n and m) .</t>
          <t>the effective FS needs to be known at ingress, the following protocol mechanism could be used: label recording, flowspec (ADSpec?)</t>
        </list>
      </t>
    </section>

    <section title="Neighbor Discovery and Link Property Correlation">
      <t>[Editors' note: text from draft-li-ccamp-grid-property-lmp-01]</t>

      <t>Potential interworking problems between fixed-grid DWDM and
        flexible-grid DWDM nodes, may appear. Additionally, even two
        flexible-grid optical nodes may have different grid properties, leading
        to link property conflict.</t> 

      <t>Devices or applications that make use of the flexible-grid may not be
        able to support every possible slot width.  In other words,
        applications may be defined where different grid granularity can be
        supported.  Taking node F as an example, an application could be
        defined where the nominal central frequency granularity is 12.5 GHz
        requiring slot widths being multiple of 25 GHz.  Therefore the link
        between two optical nodes with different grid granularity must be
        configured to align with the larger of both granularities.  Besides,
        different nodes may have different slot width tuning ranges.</t>

      <t>In summary, in a DWDM Link between two nodes, at least the following properties
        should be negotiated:
        <list>
          <t>Grid capability (channel spacing) - Between fixed-grid and
            flexible-grid nodes.</t>

          <t>Grid granularity - Between two flexible-grid nodes.</t>

          <t>Slot width tuning range - Between two flexible-grid nodes.</t>
        </list>
      </t>
    </section>


    <section title="Path Computation / Routing and Spectrum Assignment (RSA)">
      <t> Much like in WSON, in which if there is no (available) wavelength
        converters in an optical network, an LSP is subject to the ''wavelength
        continuity constraint'' (see section 4 of <xref target="RFC6163"/>), if
        the capability of shifting or converting an allocated frequency slot, the
        LSP is subject to the Optical ''Spectrum Continuity Constraint''.</t>

      <t>Because of the limited availability of wavelength/spectrum converters
        (sparse translucent optical network) the wavelength/spectrum continuity
        constraint should always be considered. When available, information
        regarding spectrum conversion capabilities at the optical nodes may be
        used by RSA mechanisms.</t>

      <t>The RSA process determines a route and frequency slot for a LSP.
        Hence, when a route is computed the spectrum assignment process (SA)
        should determine the central frequency and slot width based on the slot
        width and available central frequencies information of the transmitter
        and receiver, and the available frequency ranges information and
        available slot width ranges of the links that the route traverses.</t>

      <section title="Architectural Approaches to RSA">

        <t>Similar to RWA for fixed grids, different ways of performing RSA in
          conjunction with the control plane can be considered. The approaches
          included in this document are provided for reference purposes only;
          other possible options could also be deployed. </t>

        <section title="Combined RSA (R&amp;SA)">
          <t>In this case, a computation entity performs both routing and
            frequency slot assignment. The computation entity should have the
            detailed network information, e.g.  connectivity topology constructed
            by nodes/links information, available frequency ranges on each link,
            node capabilities, etc. </t> 

          <t>The computation entity could reside either on a PCE or the
            ingress node.</t>
        </section>

        <section title="Separated RSA (R+SA)">
          <t>In this case, routing computation and frequency slot assignment
            are performed by different entities. The first entity computes the
            routes and provides them to the second entity; the second entity
            assigns the frequency slot.</t> 

          <t>The first entity should get the connectivity topology to compute
            the proper routes; the second entity should get the available
            frequency ranges of the links and nodes' capabilities information to
            assign the spectrum.</t>
        </section>

        <section title=" Routing and Distributed SA (R+DSA)">
          <t>In this case, one entity computes the route but the frequency slot
            assignment is performed hop-by-hop in a distributed way along the
            route. The available central frequencies which meet the spectrum
            continuity constraint should be collected hop by hop along the route.
            This procedure can be implemented by the GMPLS signaling protocol.</t>
        </section>

      </section>
    </section>



    <section title="Routing / Topology dissemination">

      <t>In the case of combined RSA architecture, the computation
        entity needs to get the detailed network information, i.e. connectivity
        topology, node capabilities and available frequency ranges of the
        links. Route computation is performed based on the connectivity
        topology and node capabilities; spectrum assignment is performed based
        on the available frequency ranges of the links [Editors note: alternatively, it can based the available media channels] . The computation entity
        may get the detailed network information by the GMPLS routing protocol.
        Compared with <xref target="RFC6163"/>, except wavelength-specific
        availability information, the connectivity topology and node
        capabilities are the same as WSON, which can be advertised by GMPLS
        routing protocol (refer to section 6.2 of <xref target="RFC6163"/>.
        This section analyses the necessary changes on link information brought
        by flexible grids.</t>

      <section title="Available Frequency Ranges/slots of DWDM Links">
        <t>In the case of flexible grids, channel central frequencies span from
          193.1 THz towards both ends of the C band spectrum with 6.25 GHz
          granularity.  Different LSPs could make use of different slot widths
          on the same link. Hence, the available frequency ranges should be
          advertised.
        </t> 
      </section>

      <section title="Available Slot Width Ranges of DWDM Links">
        <t>The available slot width ranges needs to be advertised, in
          combination with the Available frequency ranges, in order to verify
          whether a LSP with a given slot width can be set up or not; this is
          is constrained by the available slot width ranges of the media matrix
          Depending on the availability of the slot width ranges, it is
          possible to allocate more spectrum than strictly needed by the
          LSP.</t>
      </section>

      <section title="Spectrum Management">
        <t>[Editors' note: the part on the hierarchy of the optical spectrum
          could be confusing, we can discuss it].  The total available spectrum
          on a fiber could be described as a resource that can be divided by a
          media device into a set of Frequency Slots. In terms of managing
          spectrum, it is necessary to be able to speak about different
          granularities of managed spectrum. For example, a part of the spectrum
          could be assigned to a third party to manage. This need to partition
          creates the impression that spectrum is a hierarchy in view of
          Management and Control Plane. The hierarchy is created within a
          management system, and it is an access right hierarchy only. It is a
          management hierarchy without any actual resource hierarchy within
          fiber.  The end of fiber is a link end and presents a fiber port which
          represents all of spectrum available on the fiber. Each spectrum
          allocation appears as Link Channel Port (i.e., frequency slot port)
          within fiber.
        </t>

      </section>


      <section title="Information Model">
      <t>Fixed DM grids can also be described via suitable choices of slots in
        a flexible DWDM grid. However, devices or applications that make use of
        the flexible grid may not be capable of supporting every possible slot
        width or central frequency position. Following is the definition of
        information model, not intended to limit any IGP encoding
        implementation. For example, information required for routing/path
        selection may be the set of available nominal central frequencies from
        which a frequency slot of the required width can be allocated. A
        convenient encoding for this information (may be as a frequency slot or
        sets of contiguous slices) is further study in IGP encoding
        document.
      </t>

      <t>[Editor's note: to be discussed]
        <figure anchor="routing_information_model" title="Routing Information model">
          <artwork><![CDATA[
<Available Spectrum in Fiber for frequency slot> ::= 
    <Available Frequency Range-List>
    <Available Central Frequency Granularity >
    <Available Slot Width Granularity>
    <Minimal Slot Width>
    <Maximal Slot Width>

<Available Frequency Range-List> ::= 
    <Available Frequency Range >[< Available Frequency Range-List>]

<Available Frequency Range >::= 
  <Start Spectrum Position><End Spectrum Position> | 
  <Sets of contiguous slices>

<Available Central Frequency Granularity> ::= n × 6.25GHz, 
  where n is positive integer, such as 6.25GHz, 12.5GHz, 25GHz, 50GHz
  or 100GHz

<Available Slot Width Granularity> ::= m × 12.5GHz, 
  where m is positive integer

<Minimal Slot Width> ::= j x 12.5GHz, 
  j is a positive integer

<Maximal Slot Width> ::= k x 12.5GHz, 
    k is a positive integer (k >= j)
              ]]>
            </artwork>
        </figure>
      </t>
      </section>
    </section>


    <section title="Signaling requirements">

      <section title="Relationship with MRN/MLN">
        <section title="OCh Layer">
        </section>

        <section title="Media (frequency slot) layer">
        </section>
      </section>
    </section> <!-- end signaling requirements -->


  </section> <!-- end control plane requirements -->




<!-- ===================================================================
       Control plane procedures
     =================================================================== -->
  <section title="Control Plane Procedures">
    <t>FFS. Postpone procedures such as resizing existing LSP(s) without
      deletion, which refers to increase or decrease of slot width value 'm'
      without changing the value of 'n', etc. until requirements have been
      identified.  At present no hitless resizing protocol has been defined for
      OCh. Hitless resizing is defined for an ODU entity only.</t>
  </section>




<!-- ===================================================================
     Backwards compatibility / WSON interworking
     =================================================================== -->
  <section title="Backwards (fixed-grid) compatibility, and WSON interworking">
    <t>A SSON (network) refers to the GMPLS control of flexi-grid enabled DWDM
      optical networks and it encompasses both the signal and media layers.
      The WSON also encompasses the signal and media layers but, since there is
      no formal separation between OCh and OCC (1:1) this layer separation is
      often not considered. A WSON is a particular case of SSON in the which
      all slot widths are equal and depend on the channel spacing. In other
      words, since there is only a 1:1 relationship between OCh : OCC there is
      no need to have separate controlled layers, as if both layers are
      collapsed into one.

      <figure anchor="sson_wson_comparison" title="Table Comparison WSON/SSON ">
      <artwork><![CDATA[
+=======================================+
|     WSON         |          SSON      |
+=======================================+
|      OCh         |         OCh        | Signal Layer
+------------------+--------------------+
|                  |  Frequency Slot    |
| Optical Channel  |                    | Media Layer
| Carrier          |                    |
+------------------+--------------------+
|     1:1          |       N:1          | Relationship
| single layer     |    MRN/MLN         |  SL : ML
|   network        |     (* TBD)        |
+------------------+--------------------+
      ]]></artwork>
      </figure>          
    </t>

    <t>
      <list style="symbols">	
        <t>SSON as evolution of WSON, same LSC, different Swcap?</t>

        <t>Potential problems with having the same swcap but the label format
          changes w.r.t. wson </t>

        <t>A new SwCap may need to be defined, LSC swcap already defined ISCD
          which can not be modified</t>

        <t>Role of LSP encoding type?</t>

        <t>Notion of hierarchy?  There is no notion of hierarchy between WSON
          and flexi-grid / SSON - only interop / interwork.</t>
      </list>
    </t>

    <t>Arguments for LSC switching capability</t>

    <t>[QW] A LSP for an optical signal which has a bandwidth of 50GHz
      passes through both a fixed grid network and a flexible grid network. We
      assume that no OEOs exist in the LSP, so both the fixed grid path and
      flexible grid path occupy 50GHz. From the perspective of data plane, there
      is no change of the signal and no multiplexing when the fixed grid path
      interconnects with flexible grid path. From this scenario we can conclude
      that both fixed grid network path and flexible grid network path belong to
      the same layer. No notion of hierarchy exists between them.</t>

    <t>[QW] stitching LSP which is described in <xref target="RFC5150"/> can
      be applied in one layer.  LSP hierarchy allows more than one LSP to be
      mapped to an H-LSP, but in case of S-LSP, at most one LSP may be associated
      with an S-LSP. This is similar to the scenario of interconnection between
      fixed grid LSP and flexible grid LSP. Similar to an H-LSP, an S-LSP could
      be managed and advertised, although it is not required, as a TE link,
      either in the same TE domain as it was provisioned or a different one. Path
      setup procedure of stitching LSP can be applied in the scenario of
      interconnection between fixed grid path and flexible grid path.</t>

    <figure anchor="lsp_stitching" title="LSP Stitching [RFC5150] and relationship with fixed-flexi">
      <artwork><![CDATA[
        e2e LSP
        +++++++++++++++++++++++++++++++++++> (LSP1-2)

                  LSP segment (flexi-LSP)
                ====================> (LSP-AB)
                    C --- E --- G
                   /|\    |   / |\
                  / | \   |  /  | \
        R1 ---- A \ |  \  | /   | / B --- R2
                   \|   \ |/    |/
                    D --- F --- H

   fixed grid --A-- flexi-grid    --B-- fixed grid

        ]]></artwork>
    </figure>          
  </section>


<!-- ===================================================================
     Open Issues and Misc 
     =================================================================== -->
  <section title="Misc &amp; Summary of open Issues [To be removed at later versions]">
    <t>
      <list style="symbols">	
        <t>Will reuse a lot of work / procedures / encodings defined in the
          context of WSON</t>

        <t>At data rates of GBps / TBps, encoding bandwidths with bytes per
          second unit and IEEE 32-bit floating may be problematic / non
          scalable.</t>

        <t>Bandwidth fields not relevant since there is not a 1-to-1 mapping
          between bps and Hz, since it depends on the modulation format, fec,
          either there is an agreement on assuming best / worst case
          modulations and spectral efficiency.</t>

        <t>Label I: "m" is inherent part of the label, part of the switching,
          allows encode the "lightpath" in a ERO using Explicit Label Control,
          Still maintains that feature a cross-connect is defined by the tuple
          (port-in, label-in, port-out, label-out), allows a kind-of "best
          effort LSP"</t>

        <t>Label II: "m" is not part of the label but of the TSPEC, neds to be
          in the TSPEC to decouple client signal traffic specification and
          management of the optical spectrum, having in both places is
          redundant and open to incoherences, extra error checking.</t>

        <t>Label III: both, It reflects both the concept of resource request
          allocation / reservation and the concept of being inherent part of
          the switching.</t> 
      </list>
    </t>
  </section>



<!-- ===================================================================
         SECURITY CONSIDERATIONS
     =================================================================== -->
  <section title="Security Considerations">
    <t>TBD</t>
  </section>


<!-- ===================================================================
           CONTRIBUTING AUTHORS
     =================================================================== -->
  <section title="Contributing Authors">
    <t>
      <list>
        <t>
          Qilei Wang<vspace blankLines='0'/>
          ZTE<vspace blankLines='0'/>
          Ruanjian Avenue, Nanjing, China<vspace blankLines='0'/>
          wang.qilei@zte.com.cn<vspace blankLines='0'/>
        </t>
        <t>
          Malcolm Betts<vspace blankLines='0'/>
          ZTE<vspace blankLines='0'/>
          malcolm.betts@zte.com.cn<vspace blankLines='0'/>
        </t>
        <t>
          Xian Zhang<vspace blankLines='0'/>
          Huawei<vspace blankLines='0'/>
          zhang.xian@huawei.com<vspace blankLines='0'/>
        </t>
        <t>
          Cyril Margaria<vspace blankLines='0'/>
          Nokia Siemens Networks<vspace blankLines='0'/>
          St Martin Strasse 76, Munich,   81541, Germany<vspace blankLines='0'/>
          +49 89 5159 16934<vspace blankLines='0'/>
          cyril.margaria@nsn.com<vspace blankLines='0'/>
        </t>
        <t>
          Sergio Belotti<vspace blankLines='0'/>
          Alcatel Lucent<vspace blankLines='0'/>
          Optics CTO<vspace blankLines='0'/>
          Via Trento 30 20059 Vimercate (Milano) Italy<vspace blankLines='0'/>
          +39 039 6863033<vspace blankLines='0'/>
          sergio.belotti@alcatel-lucent.com<vspace blankLines='0'/>
        </t>
        <t>
          Yao Li<vspace blankLines='0'/>
          Nanjing University<vspace blankLines='0'/>
          wsliguotou@hotmail.com<vspace blankLines='0'/> 
        </t>
        <t>
          Fei Zhang<vspace blankLines='0'/>
          ZTE<vspace blankLines='0'/>
          Zijinghua Road, Nanjing, China<vspace blankLines='0'/>
          zhang.fei3@zte.com.cn<vspace blankLines='0'/>
        </t>
        <t>
          Lei Wang<vspace blankLines='0'/>
          ZTE<vspace blankLines='0'/>
          East Huayuan Road, Haidian district, Beijing, China<vspace blankLines='0'/>
          wang.lei131@zte.com.cn <vspace blankLines='0'/>
        </t>
        <t>
          Guoying Zhang<vspace blankLines='0'/>
          China Academy of Telecom Research<vspace blankLines='0'/>
          No.52 Huayuan Bei Road, Beijing, China<vspace blankLines='0'/>
          zhangguoying@ritt.cn<vspace blankLines='0'/>
        </t>
        <t>
          Takehiro Tsuritani<vspace blankLines='0'/>
          KDDI R&amp;D Laboratories Inc.<vspace blankLines='0'/>
          2-1-15 Ohara, Fujimino, Saitama, Japan<vspace blankLines='0'/>
          tsuri@kddilabs.jp<vspace blankLines='0'/>
        </t>
        <t>
          Lei Liu<vspace blankLines='0'/>
          KDDI R&amp;D Laboratories Inc.<vspace blankLines='0'/>
          2-1-15 Ohara, Fujimino, Saitama, Japan<vspace blankLines='0'/>
          le-liu@kddilabs.jp<vspace blankLines='0'/>
        </t>
        <t>
          Eve Varma<vspace blankLines='0'/>
          Alcatel-Lucent<vspace blankLines='0'/>
          +1 732 239 7656<vspace blankLines='0'/>
          eve.varma@alcatel-lucent.com<vspace blankLines='0'/>
        </t>
        <t>
          Young Lee<vspace blankLines='0'/>
          Huawei<vspace blankLines='0'/>
        </t>
        <t>
          Jianrui Han<vspace blankLines='0'/>
          Huawei<vspace blankLines='0'/>
        </t>
        <t>
          Sharfuddin Syed<vspace blankLines='0'/>
          Infinera<vspace blankLines='0'/>
        </t>
        <t>
          Rajan Rao<vspace blankLines='0'/>
          Infinera<vspace blankLines='0'/>
        </t>
        <t>
          Marco Sosa<vspace blankLines='0'/>
          Infinera<vspace blankLines='0'/>
        </t>
        <t>
          Biao Lu<vspace blankLines='0'/>
          Infinera<vspace blankLines='0'/>
        </t>
        <t>
          Abinder Dhillon<vspace blankLines='0'/>
          Infinera<vspace blankLines='0'/>
        </t>
        <t>
          Felipe Jimenez Arribas<vspace blankLines='0'/>
          Telefónica I+D<vspace blankLines='0'/>
        </t>
        <t>
          Andrew G. Malis<vspace blankLines='0'/>
          Verizon<vspace blankLines='0'/>
        </t>
        <t>
          Adrian Farrel<vspace blankLines='0'/>
          Old Dog Consulting<vspace blankLines='0'/>
        </t>
        <t>
          Daniel King<vspace blankLines='0'/>
          Old Dog Consulting<vspace blankLines='0'/>
        </t>
        <t>
          Huub van Helvoort<vspace blankLines='0'/>
        </t>
      </list>
    </t>
  </section>


<!-- ===================================================================
                                 ACKNOWLEDGEMENTS
     =================================================================== -->
  <section title="Acknowledgments">
    <t>The authors would like to thank Pete Anslow for his insights and
      clarifications.</t>
  </section>
</middle>


<back>
  <references title="Normative References">
    &RFC2119;
    &RFC3945;
    &RFC4206;
    &RFC5150;
    &RFC6163;
    <reference anchor="G.800">
      <front>
        <title>ITU-T Recommendation G.800: Unified functional architecture of transport networks.</title>
        <author> <organization abbrev="ITU-T">International Telecomunications Union</organization></author>
        <date year="2012" month="February"/>
      </front>
    </reference>

    <reference anchor="G.805">
      <front>
        <title>ITU-T Recommendation G.805: Generic functional architecture of transport networks.</title>
        <author> <organization abbrev="ITU-T">International Telecomunications Union</organization></author>
        <date year="2000" month="March"/>
      </front>
    </reference>

    <reference anchor="G.709">
      <front>
        <title>ITU-T Recommendation G.709: Interfaces for the Optical Transport Network (OTN).</title>
        <author> <organization abbrev="ITU-T">International Telecomunications Union</organization></author>
        <date year="2009" month="March"/>
      </front>
    </reference>
  </references> 



  <references title="Informative References">
    &RFC4397;
    <reference anchor="G.694.1">
      <front>
        <title>ITU-T Recommendation G.694.1, Spectral grids for WDM applications: DWDM frequency grid, draft v1.6 2011/12</title>
        <author> <organization abbrev="ITU-T">International Telecomunications Union</organization></author>
        <date year="2011"/>
      </front>
    </reference>

    <reference anchor="G.872">
      <front>
        <title>ITU-T Recommendation G.872, Architecture of optical transport networks, draft v0.16 2012/09 (for discussion)</title>
        <author><organization abbrev="ITU-T">International Telecomunications Union</organization></author>
        <date year="2012"/>
      </front>
    </reference>

    <reference anchor="WD12R2">
      <front>
        <title>Proposed media layer terminology for G.872</title>
        <author><organization abbrev="ITU-T">International Telecomunications Union, WD12R2, Q12-SG15, ZTE, Ciena WP3</organization></author>
        <date year="2012" month="05"/>
      </front>
    </reference>
  </references> 
</back>
</rfc>
