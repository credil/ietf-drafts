<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="info" docName="draft-ietf-ltans-validate-02" ipr="full3978">
  <front>
    <title abbrev="validate">Validation and long term verification data for Evidence Records and signed documents</title>
	<author initials="T." surname="Gondrom" fullname="Tobias Gondrom">
      <organization></organization>
      <address>
        <postal>
          <street>Werner-von-Siemens-Ring 20</street>
          <city>Grasbrunn</city>
          <region>Munich</region>
          <code>D-85630</code>
          <country>Germany</country>
        </postal>
		<phone>+49 (0) 89 4629-1816</phone>
        <facsimile>+49 (0) 89 4629-33-1816</facsimile>
        <email>tobias.gondrom@opentext.com</email>
      </address>
    </author>
	<author initials="S." surname="Fischer-Dieskau" fullname="Stefanie Fischer-Dieskau">
      <organization></organization>
      <address>
      </address>
    </author>
    <date day="17" month="November" year="2007" />
    <area>Security Area</area>

    <workgroup>LTANS</workgroup>

    <keyword>long term archive</keyword>
    <keyword>security</keyword>
    <keyword>timestamp</keyword>
    <keyword>validate</keyword>
    <keyword>verify</keyword>
    <keyword>verification</keyword>
    <keyword>policy</keyword>

    <abstract>
      <t>Digitally signed documents and data in a LTANS service receive the
   signature renwal procedures and non-repudiation services.  As
   documents can be stored for very long (theoretically inifinite)
   times, it is very important to understand which data is and will be
   necessary for the verification of the contained digital signatures
   and the applied timestamps and the evidence records.  This document
   shall describe various pieces of information which SHOULD and MUST be
   provided to effectively verify evidence records and their protected
   data and signatures.</t>
    </abstract>
    <note title="Conventions used in this document">
    <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].</t>
  </note>
  </front>
  
  
  <middle>
    <section title="Introduction">
      
      <t>
   Data and documents stored in a Long term archiving services may contain
   digitally signed or encrypted data and their integrity may be assured
   with the use of timestamps and archivetimestamps as specified in
   ERS.  As such data and it's proof of existence and non-repudiation
   may be verified at a point in time very far in the future, it is 
   important to analyse and understand what information may be needed
   for this verification and what controls need to be implemented to
   ensure the availability and integrity of this data.
    </t>

    </section>
  
      <section title="Terminology">
        <list>
        <t>
        Archived data object: Data unit that is archived and has to be
        preserved for a long time by the Long-term Archive Service.            
        </t>
        <t>
        Archived data object group: A multitude of data objects, which for
        some reason belong together.  E.g. a document file and a signature
        file could be a archived data object group, which represent signed
        data.            
        </t>
        <t>
        Archive Timestamp: Is a timestamp and lists of hash values, which
        allows to verify the existence of several data objects at a
        certain time.    
        </t>
        <t>
        Evidence: Information that may be used to resolve a dispute about
        various aspects of authenticity of archived data objects.            
        </t>
        <t>
        Evidence record: Collection of evidence compiled for one or more
        given archived data objects over time.  An evidence record
        includes all Archive Timestamps (within structures of Archive
        Timestamp Chains and Archive Timestamp Sequences) and additional
        verification data, like certificates, revocation information,
        trust anchors, policy details, role information, etc.            
        </t>
        <t>
        Long-term Archive Service(LTA): A service responsible for
        preserving data for long periods of time, including generation and
        collection of evidence, storage of archived data objects and
        evidence, etc.           
        </t>
        <t>
        hash-tree: a hash tree as decribed by Merkle in [MER1980] 
        is a list of sorted hash values ordered in a tree where the child nodes 
        are combined and hashed to generate the father nodes up to one top node. 
        This hash-tree can also be reduced to a list as decribed in ERS.             
        </t>
        <t>
        Timestamp: A cryptographically secure confirmation generated by a
        Time Stamping Authority (TSA) [RFC3161] specifies a structure for
        timestamps and a protocol for communicating with a Time-stamp
        Authority (TSA).  Besides this, other data structures and
        protocols may also be appropriate, e.q., such as defined in
        [ISO-18014-1.2002], [ISO-18014-2.2002], [ISO-18014-3.2004], and
        [ANSI.X9-95.2005].           
        </t>
        <t>
        Trust Center: A Trust Center may be operated as a Trusted Third Party (TTP) 
        service (as also specified in RFC 3161), though other operational models may be 
        appropriate. Depending on local laws and criteria the services of a trust center 
        may include to provide certificates, OCSP responses and CRL for a guarantted period 
        of time. The Trust center can also function as the Trusted Third party connecting 
        (and guaranteeing the identity of the owner of a certificate with a certain person.              
        </t>    
        </list>          
      </section>    
      
      <section title="General Considerations">
      <section title="Basic assessment of environment of verification data">
         <t>Due to the lack of a common, international wide applicable understanding 
         of terms used in respect of digital signature related objects some basic 
         assessments have to be presumed and are discussed in this section.</t>
      </section>
	  <section title="Types of trust centers (fully trusted â€“ partially trusted)">
          <t>
          Depending on local laws and authorities trust centers can be of different 
          levels of trust which can have impact on the verification data needed for 
          a later verification of the digital signatures, time stamps and ERS. <vspace blankLines="0" />
          Typically two types of trust centers can be envisioned:     
          </t>
          <section title="Fully trusted trust center">
           <t>
           A trust center that has been accredited by a local government authority or 
           a private office declared as competent from such, the accreditation saying 
           that all relevant requirements to ensure a certain security level are fulfilled 
           (as typically done in most of the European countries) can be classified as a 
           fully trusted at least in the national context. In case of multinational mutual 
           acceptance agreements this trust can be extended to regions or globally. 
           Based on the accreditation and the national interest in these trust centers it 
           can be assumed that it would be publicly known that and when a private key of 
           such a trust center was compromised. 
           </t>   
          </section>  
          <section title="Partially trusted Trust Center">
          <t>
          Partially trusted centers could e.g. be private organizations which function 
          as a kind of common notary but whose security and protection is not accredited 
          by a government authority. This usually means that the validity and availability 
          of the verification data can not be guaranteed. This implies that the LTA (Long term archive) 
          has to ensure at least the availability and usually also the integrity of the data 
          itself including all OCSP responses and or CRLs. 
          </t>
          </section>  
          <section title="Layer model versus chain model">
              <t>
              Typically a signature depends on other instances that issue a certificate which 
              again have their certificates issued by another instance. E.g. a person could 
              get his certificate issued by a local (or company) trust center, which in turn 
              gets its own certificate issued by a government authority of fully trusted trust center. 
              So for verifiying a signature it is necessary to verify all certificates up to the root 
              which must be trusted if the signature shall be verified positively. 
              </t>
              <t>
              This raises the question if it is necessary that all certificates up to the roof have 
              to be valid at the time of signing (layer model),  or if it is sufficient that only the 
              latest signature is not yet expired at the time of signing and all signature algorithms 
              used in the chain are still considered secure (chain model). 
              </t>
              <t>
              Both models have pros and cons regarding the consequences occurring from different scenarios. 
              As the layer model is established on the international level more respected and accepted point of view. 
              </t>
              <t>
              Based on discussion in the working group the layer model is necessary for verifying a 
              chain of certificates when you verify a signature. 
              </t>
              <t>
              This would mean that all signatures in the certificates must be valid at the time of signing. 
              This means all used algorithms must still be secure and none of them must have been revoked. 
              (note: both cases would mean that the chain could have been compromised at this level and 
              below and which means the final signature can not be trusted.)                  
              </t>
              <t>
              Note: the layer model for the validity of the signatures in the certificates does not 
              imply that all certificates have not been expired. In the contrary, concerning the expiry 
              dates of certificates this means only you need to verify that the last certificate has not 
              been expired when the signature has been done. It is of no interest whether certificates in 
              the chain have already been expired as long as they have been valid at the time when they 
              were used to sign (issue) the lower certificates. 
              </t>
          </section>    
      </section>  
      </section>
      
      <section title="Verification data for Evidence Records">
      <section title="List of verification data">
          <t>
          Evidence Records contain hashtrees secured with time stamps. 
          The security and verification of the hashtrees themselves only depend on
          the used hash algorithm and its possible parameters. Despite the generally 
          available list of algorithms and their validity period (which could be documented 
          in a general policy) no further external verification data is necessary to 
          validate the integrity of the hashtrees. 
          </t>
          <t>
          The time stamps used in the Evidence Record are based on digital Signatures. 
          To validate these signatures in respect of their authenticity additional verification data 
          like certificates of all parties involved in the issuance of the time stamp certificate, 
          Certificate Revocation Lists (CRLs) and/or OCSP responses are needed.          
          </t>
          <t>
          To correctly verify the time stamps in the Evidence Record an expert needs to verify that 
          the used private key has not been compromised when it has been used. The time 
          information provided by a trusted time stamp authority allows to determine the 
          reference date to which the used private key had to be valid.     
          </t>
          <t>
          Additionally to fully evaluate the certificate used in respect of the time stamp signature 
          the correct chain of issuers of all certificates up to the root need to be checked.    
          </t>
          <t>
          Knowing the reference date the verifier needs an OCSP response or a CRL to verify 
          that the used certificate has not been revoked at the moment of signature creation. 
          Note: OSCP responses are not needed when a misuse of the certificate can be excluded 
          before its owner has obtained it, as could be the case with accredited time stamp authorities.    
          </t>
          <t>
         In cases where a specially accredited authority is the trusted time stamp authority 
         (refer to 2.1.1 a) fully trusted trust center), it could be assumed that the compromise 
         of used keys would have so much impact that it would be publicly known even without directly 
         checking the CRL or OCSP status of the used certificate. This situation can justify that it is only
         necessary to store all certificates but no CRL or OCSP response with the time stamp used in the 
         Evidence Record. Additionally based on the accreditation criteria it can also be the case that 
         certain availability of verification data is guaranteed by the local government. (E.g. in Germany for 30 years).     
          </t>
      </section>          
                   
      <section title="Location to store verification data">
          <t>
          All verification data necessary for the verification of the time stamp has to be stored 
          in a non-repudiation system as long as a later verification may be needed. And as this 
          verification data contain electronic signatures which used algorithms may expire further 
          renewals of these electronic signatures may be necessary[S2]. E.g. in RFC3161 time stamps 
          the verification data can be directly integrated into the time stamp, and is by this integrated, 
          protected and automatically renewed with the ERS using the time stamp. 
          </t>
      </section>  
      <section title="Verification Data retrieved from an SCVP server">
          <t>
          The necessary verification data can also be stored separately in an SCVP server an be retrived 
          from there. This relieves the archiving party from integrating all evidence right at the time of archival 
          right into the document. The system can only store the data and some subset of the verification data, 
          e.g. only the end entity certificates into the documents and their signatures and leave it to an 
          SCVP server to store and protect the remaining required verification data. The SCVP server can provide 
          this data and their according protecting evidence recprds via ERS/SCVP <xref target='LTANS-ERS-SCVP' />. 
          </t>
      </section>
                  
      </section>

      <section title="Verification data for the signed documents secured by the Evidence Records">
         <section title="List of required verification data">
         <t>
         In respect of the verification data needed to secure a long term validation of the electronic 
         signature all the above mentioned requirements are applicable. The only differences refer to 
         the fact that the signature is not issued by a time stamp authority as owner of the certificate but a person. 
         </t>
         <t>
         Therefore a special reference time regarding the validity of the certificate at the time of signature 
         creation is needed to verify that the used private key has not been compromised before it has been used. 
         </t>
         <t>
         With reference to the above the correct chain of issuers of all certificates up to the root need 
         to be verified to fully evaluate the certificate used in respect of the signature. A CRL is needed 
         to verify that the used certificate has not been revoked at the moment of signature creation. 
         To verify the authenticity of the CRL the issuer of it has to be checked by verifying the 
         signature of the CRL. Therefore the correct chain of issuers of all certificates up to the root needs to be verified.
         </t>
         </section> 
         <section title="Location / structure to store verification data">
         <t>
         All verification data necessary for the verification of the time stamp have to be stored in a 
         non-repudiation system as long as a later verification may be needed. As these verification data 
         contain electronic signatures which algorithms may expire further renewals of these electronic 
         signatures may be necessary. 
         </t>
         <t>
         This explicitly includes OCSP or CRL data and all certificates (including the complete chains for the used signatures.
         </t>
         </section>
      </section> 
      
      <section title="Validation policy">
          <t>
          To validate signatures, time stamps and evidence records it is useful for a validation authority 
          to define and apply a verification policy. In this policy the verifier defines which algorithms 
          are considered valid and secure in which time frames.
          A policy is defined in "Data Structure for Security Suitabilities of Cryptographic Algorithms" 
          <xref target='LTANS-DSSC'/>
          </t>
          <t>
          Basically the policy simply contains the algorithm identifier and the two dates valid from and 
          expires. With this information the verifier can check that all algorithms have only been used 
          at the time when they have been considered secure. Any deviation from this in the historic 
          time line of an Evidence Record or a signature SHOULD lead to the failure of the verification.    
          </t>
          <t>
          Following examples should lead to a failure of the verification:
              <list style="numbers">
              <t>
              a signature of time stamp used an algorithm which has been secure at the time of application 
              but is no longer considered secure (i.e. expired in the policy) and has not been protected 
              by more secure time stamps in an applied ERS SHOULD fail to be verified
              </t>
              <t>
              an ERS with a timestamp in the latest structure that is not considered secure SHOULD fail to verify.
              </t>
              <t>
              Whenever in the structure of an ERS a later ArchiveTimestamp is applied after the algorithm in the 
              timestamp of the preceding ArchiveTimeStamp is expired (as defined per policy) the verification MUST fail.
              </t>
              <t>
              Whenever in the structure of an ERS a ArchiveTimeStampChain is applied after the hash algorithm 
              of the preceding ArchiveTimeStampChain is no longer secure (as defined in the verification policy) 
              the verification MUST fail.
              </t>
              </list>
          </t>
          

          
          
      </section>

      
      
      	
    <section anchor="Security" title="Security Considerations">
    <t>Long term availability and integrity of verification data</t>

   <t>The verification data has to be stored and available including non-repudiation for all verification data.</t>
	   
    </section>
    
    
    
<!--    
<section title="">
</section>

<vspace blankLines="0" />

<list style="numbers">
</list>

<figure><artwork>
</artwork></figure>
 
    <section anchor="IANA" title="IANA Considerations">
      <t>This document makes no request of IANA.</t>

      <t>Note to RFC Editor: this section may be removed on publication as an
      RFC.</t>
    </section>-->

  </middle>

  <back>
    <references title="Normative References">


<reference anchor='RFC2026'>

<front>
<title>The Internet Standards Process -- Revision 3</title>
<author initials='S.' surname='Bradner' fullname='Bradner, S.'>
<organization /></author>
<date year='1996'/></front>

<seriesInfo name='RFC' value='2026' />
<format type='TXT' target='http://www.ietf.org/rfc/rfc2026.txt' />
</reference>

<reference anchor='RFC2119'>

<front>
<title>Key Words for Use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='Bradner, S.'>
<organization /></author>
<date year='1997'/></front>

<seriesInfo name='RFC' value='2119' />
<format type='TXT' target='http://www.ietf.org/rfc/rfc2119.txt' />
</reference>

<reference anchor='RFC3126'>

<front>
<title>Electronic Signature Formats for long term electronic signatures</title>
<author initials='C.' surname='Adams' fullname='Adams, C.'>
<organization /></author>
<author initials='D.' surname='Pinkas' fullname='Pinkas, D.'>
<organization /></author>
<author initials='J.' surname='Ross' fullname='Ross, J.'>
<organization /></author>
<author initials='N.' surname='Pope' fullname='Pope, N.'>
<organization /></author>
<date year='2001'/></front>

<seriesInfo name='RFC' value='3126' />
<format type='TXT' target='http://www.ietf.org/rfc/rfc3126.txt' />
</reference>


<reference anchor='RFC3161'>
<front>
<title>Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)</title>
<author initials='C.' surname='Adams' fullname='C. Adams'>
<organization /></author>
<author initials='P.' surname='Cain' fullname='P. Cain'>
<organization /></author>
<author initials='D.' surname='Pinkas' fullname='D. Pinkas'>
<organization /></author>
<author initials='R.' surname='Zuccherato' fullname='R. Zuccherato'>
<organization /></author>
<date year='2001' month='August' /></front>

<seriesInfo name='RFC' value='3161' />
<format type='TXT' target='http://www.ietf.org/rfc/rfc3161.txt' />
</reference>

<reference anchor='RFC3280'>
<front>
<title>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</title>
<author initials='R.' surname='Housley' fullname='R. Housley'>
<organization /></author>
<author initials='W.' surname='Polk' fullname='W. Polk'>
<organization /></author>
<author initials='W.' surname='Ford' fullname='W. Ford'>
<organization /></author>
<author initials='D.' surname='Solo' fullname='D. Solo'>
<organization /></author>
<date year='2001' month='August' /></front>

<seriesInfo name='RFC' value='3280' />
<format type='TXT' target='http://www.ietf.org/rfc/rfc3280.txt' />
</reference>
        

        

<reference anchor='RFC3852'>
<front>
<title>Cryptographic Message Syntax (CMS)</title>
<author initials='R.' surname='Housley' fullname='Housley, R.'>
<organization /></author>
<date year='2004' month='July'/></front>
<seriesInfo name='RFC' value='3852' />
<format type='TXT' target='http://www.ietf.org/rfc/rfc3852.txt' />
</reference>
    

<reference anchor='ANSX995'>
<front>
<title>Trusted Timestamp Management and Security</title>
<author><organization>American National Standard for Financial Services</organization></author>
<date year='2005' month='June' day='28'/></front>
<seriesInfo name='ANSX' value='X9.95-2005' />
</reference>

<reference anchor='I180141'>
<front>
<title>Time stamping services â€“ Part 1: Framework</title>
<author><organization>ISO/IEC JTC 1/SC 27</organization></author>
<date year='2002' month='February' day='8'/></front>
<seriesInfo name='ISO' value='ISO-18014-1' />
</reference>
   
<reference anchor='I180142'>
<front>
<title>Time stamping services â€“ Part 2: Mechanisms producing independent tokens</title>
<author><organization>ISO/IEC JTC 1/SC 27</organization></author>
<date year='2002' month='December' day='10'/></front>
<seriesInfo name='ISO' value='ISO-18014-2' />
</reference>
   
<reference anchor='I180143'>
<front>
<title>Time stamping services â€“ Part 3: Mechanisms producing linked tokens</title>
<author><organization>ISO/IEC JTC 1/SC 27</organization></author>
<date year='2004' month='February' day='9'/></front>
<seriesInfo name='ISO' value='ISO-18014-3' />
</reference>
      
    </references>

    <references title="Informative References">

<reference anchor='ETSI2003'>
<front>
<title>Algorithms and Parameters for Secure Electronic Signatures</title>
<author>
<organization>European Telecommunication Standards Institute (ETSI),
Electronic Signatures and Infrastructures (ESI);</organization>
</author>
<date year='2003' month='March'/></front>
<seriesInfo name="ETSI" value="SR 002 176 V1.1.1"/>
</reference>

<reference anchor='LTANS-DSSC'>
<front>
<title>Data Structure for Security Suitabilities of Cryptographic Algorithms (DSSC)</title>
<author>
<organization>IETF</organization>
</author>
<date year='2007' month='October'/></front>
</reference>

<reference anchor='LTANS-ERS-SCVP'>
<front>
<title>Using SCVP to Convey Long-term Evidence Records</title>
<author>
<organization>IETF</organization>
</author>
<date year='2007' month='November'/></front>
</reference>
        
        
        
<reference anchor='MER1980'>
<front>
<title>Protocols for Public Key Cryptosystems,
             Proceedings of the 1980 IEEE Symposium on Security and 
             Privacy (Oakland, CA, USA)</title>
<author initials='R.' surname='Merkle' fullname='Merkle, R.'>
<organization></organization>
</author>
<date year='1980' month='April'/></front>
<seriesInfo name="pages" value="122-134"/>
</reference>

<reference anchor='REQ2004'>
<front>
<title>Long-term Archive Service Requirements</title>
<author initials='C.' surname='Wallace' fullname='Wallace, C.'>
<organization/></author>
<author initials='R.' surname='Brandner' fullname='Brandner, R.'>
<organization/></author>
<author initials='U.' surname='Pordesch' fullname='Pordesch, U.'>
<organization/></author>
<date year='2005'/></front>
<seriesInfo name="I-D" value="???"/>
</reference>
 

<!--      <reference anchor="InfRef">
        <front>
          <title></title>

          <author>
            <organization></organization>
          </author>

          <date year="2004" />
        </front>
      </reference> -->
      
    </references>

 
  </back>
</rfc>
