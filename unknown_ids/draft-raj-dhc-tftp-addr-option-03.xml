<?xml version="1.0"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<rfc ipr="full3978" docName="draft-raj-dhc-tftp-addr-option-03.txt"
abbrev="VoIP Configuration Server Address Option" category="info">

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
    <!ENTITY rfc2119 PUBLIC '' 
'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>

    <!ENTITY rfc2131 PUBLIC ''
'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2131.xml'>

    <!ENTITY rfc2132 PUBLIC '' 
'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2132.xml'>

    <!ENTITY rfc1034 PUBLIC '' 
'http://xml.resource.org/public/rfc/bibxml/reference.RFC.1034.xml'>

    <!ENTITY rfc3118 PUBLIC '' 
'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3118.xml'>

    <!ENTITY rfc3942 PUBLIC '' 
'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3942.xml'>

]>


<front>
<title>VoIP Configuration Server Address Option
</title>

<author initials="R.A." surname="Johnson" fullname="Richard A. Johnson">
<organization>Cisco Systems, Inc.</organization>
<address>
<postal>
<street>170 W. Tasman Dr.</street>
<city>San Jose</city> <region>CA</region> <code>95134</code>
<country>US</country>
</postal>
<phone>+1 408 526 4000</phone>
<email>raj@cisco.com</email>
</address>
</author>

<date month="November" year="2007" />
<area>Internet</area>
<keyword>RFC</keyword>
<keyword>Request for Comments</keyword>
<keyword>I-D</keyword>
<keyword>Internet-Draft</keyword>
<keyword>XML</keyword>
<keyword>Extensible Markup Language</keyword>

<abstract>
<t>This memo documents existing usage for the "VoIP Configuration Server Address 
Option" (previously known as the "TFTP Server IP Address Option". The option number 
currently in use is 150. This memo documents the current usage of the option in 
agreement with <xref target="RFC3942" />, which declares that any pre-existing 
usages of option numbers in the range 128 - 223 should be documented and the working
group will try to officially assign those numbers to those options.
</t></abstract>

</front>

<middle>
<section title="Introduction">
<t>
Voice over IP ("VoIP") devices, such as IP phones, have a need to download their
configuration from a configuration server on the network.  There are commonly
accepted methods to discover this server via DHCP; the "sname" field in the
DHCP header <xref target="RFC2131" />, the "TFTP Server name" option (#66)
<xref target="RFC2132" />. Both of these sources of information, however, 
contain the TFTP server's hostname.  That hostname must then be translated to 
an IP address.  The usual method to accomplish this would be DNS.
<xref target="RFC1034" />
This means the firmware in a VoIP device (with possibly limited 
flash, memory, and/or processing resources) would need to implement 
the DNS protocol in order to perform this translation.  This would 
also introduce an additional unnecessary point of failure whereby 
the device is dependent on the DNS server infrastructure in order 
to boot up and communicate with its call agent.
</t>
<t>
In order to eliminate DNS as a point of failure keep the firmware 
in such a VoIP device to a minimum the "VoIP Configuration Server 
Address" option (150) was introduced.  This option allows the DHCP server to
pass one or more IP addresses of the VoIP Configuration Server(s) instead 
of the hostname, thus making the information directly usable by the VoIP device.
</t>
<t>
Other reasons for this option are that, (1) the "siaddr" field is not configurable 
on some DHCP servers, (2) the "siaddr" field only allows for one IPv4 address and 
it is desirable to have the ability to configure multiple IP addresses for redundancy, 
(3) some DHCP servers have been found to fill in their own IPv4 address as siaddr,
and (4) some customers were already using the "siaddr" field for other purposes.
(5) The configuration server may use a protocol other than TFTP to serve 
configuration files, making the use of the "TFTP Server name" opion (#66) 
in inappropriate.
</t>
<t>
In cases where other download server address information also appears in the response packet,
such as "sname" and "TFTP Server name", it is left to the device to decide which piece of
information to use.
</t>
</section>

<section title="Conventions">

<t>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119 <xref target="RFC2119" />.
</t>

</section>

<section title="VoIP Configuration Server Address Option Definition">
<t>
The VoIP Configuration Server Address option is a DHCP option <xref target="RFC2132"
/>.  The option contains one or more IPv4 addresses of the VoIP Configuration Server
which the client should use, if needed.
</t>

<figure anchor="format">
<preamble>The format of the option is:</preamble>
<artwork>
 Code   Len   IPv4 Configuration Server Address(es)
+-----+-----+-----+-----+-----+-----+
| 150 |  n  |     IPv4 address      | ...
+-----+-----+-----+-----+-----+-----+

</artwork>
</figure>

<t>The option minimum length (n) is 4.</t>

<t>
The "Len" field must specify a length which is an integral multiple of
4 octets (4, 8, 12, etc.).  If an option is received where this is not
the case, the option information SHOULD be ignored.
Dividing this "Len" value by 4 will give
number of IPv4 VoIP Configuration Server addresses which are specified in the
option.
</t>
<t>
The option SHOULD NOT be specified by the DHCP Client as it is intended only 
to be returned from the DHCP Server. If the DHCP Client wants to receive this 
information from the server, it SHOULD include the number 150 in the DHCP 
"Parameter List" option (55)."
</t>
<t>
Server addresses SHOULD be listed in order of preference.
</t>
<t>
The client may use as many or as few of the addresses provided. For
example, if client is only capable of accepting 2 configuration server
addresses, it may ignore any other addresses provided after the
second address. A client SHOULD accept an offer that contains
more addresses than it is capable of utilizing and ignore those
that it is not capable of using.
</t>

</section>

<section title="Security Considerations">
<t>
A rogue DHCP Server could use this option in order to coerce a Client
into downloading configuration from an alternate Configuration Server and thus gain
control of the device's configuration.  This is easier done with the
VoIP Configuration Server Address option than it was with the "TFTP Server Name"
option, because in the later case the attack would need to control DNS
responses as well as inserting the rogue DHCP option information.  If
this is a concern, then either DHCP Authentication may be used, or
the "TFTP Server Name" option may be used instead.
</t>
<t>
Message authentication in DHCP for intradomain use where the out-of-
band exchange of a shared secret is feasible is defined in 
<xref target="RFC3118" />.  Potential exposures to attack are discussed in section 7 of the
DHCP protocol specification in <xref target="RFC2131" />.
</t>
<t>
Other out-of-band methods of verifying the validity of the VoIP Configuration Server 
Address, such as certificates of trust, could be used to mitigate some security concerns.
</t>
</section>

<section title="IANA Considerations">
<t>
IANA is requested to assign DHCP option number 150 for this option, in
accordance with <xref target="RFC3942"/>.
</t>

</section>

</middle>

<back>
<references>

&rfc2119;
&rfc2131;
&rfc2132;
&rfc1034;
&rfc3118;
&rfc3942;

</references>
</back>

</rfc>
