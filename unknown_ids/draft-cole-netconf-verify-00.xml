<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced. 
     An alternate method (rfc include) is described in the references. -->
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC3552 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3552.xml">
<!ENTITY RFC4741 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4741.xml">
<!ENTITY I-D.narten-iana-considerations-rfc2434bis SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.narten-iana-considerations-rfc2434bis.xml">
]>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs), 
     please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) 
     that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->

<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->

<?rfc toc="yes"?>
<!-- generate a ToC -->

<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->

<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->

<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space 
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="info" docName="draft-cole-netconf-verify-00" ipr="trust200902">
  <!-- category values: std, bcp, info, exp, and historic
     ipr values: full3667, noModification3667, noDerivatives3667
     you can add the attributes updates="NNNN" and obsoletes="NNNN" 
     they will automatically be output with "(if approved)" -->

  <!-- ***** FRONT MATTER ***** -->

  <front>
    <!-- The abbreviated title is used in the page header - it is only necessary if the 
         full title is longer than 39 characters -->

    <title abbrev="NETCONF Verify">A Verification Proceedure for Configuration Management
                                      within NETCONF</title>

    <!-- add 'role="editor"' below for the editors if appropriate -->

    <!-- Another author who claims to be an editor -->

    <author fullname="Robert G. Cole" initials="R.G." role=""
            surname="Cole">
      <organization>U.S. Army CERDEC</organization>

      <address>
        <postal>
          <street>328 Hopkins Road</street>
          <city>Aberdeen Proving Ground</city>
          <region>MD</region>
          <code>21005</code>
          <country>USA</country>
        </postal>

        <phone>+1.410.278.6779</phone>
        <email>robert.g.cole@us.army.mil</email>
        <uri>http://www.cs.jhu/~rgcole/</uri>
        <!-- uri and facsimile elements may also be added -->
      </address>
    </author>

    <author fullname="Dan Romascanu" initials="D." role="" surname="Romascanu">
       <organization>Avaya</organization>

       <address>
          <postal>
              <street>Atidim Technology Park, Bldg. #3</street>
              <city>Tel Aviv</city>
              <code>61131</code>
              <country>Israel</country>
          </postal>

          <email>dromasca@avaya.com</email>
       </address>
    </author>

    <author fullname="Andy Bierman" initials="A." role="" surname="Bierman">
       <organization>InterWorking Labs</organization>

       <address>
          <postal>
              <street>303 Potrero Street, Suite 52</street>
              <city>Santa Cruz, CA</city>
              <code>95060-2760</code>
              <country>USA</country>
          </postal>

          <email>andyb@iwl.com</email>
       </address>
    </author>

    <date month="July" year="2010" />

    <!-- If the month and year are both specified and are the current ones, 
         xml2rfc will fill 
         in the current day for you. 
         If only the current year is specified, xml2rfc will fill 
	 in the current day and month for you. 
         If the year is not the current one, it is 
	 necessary to specify at least a month 
         (xml2rfc assumes day="1" if not specified for the 
	 purpose of calculating the expiry date).  
         With drafts it is normally sufficient to 
	 specify just the year. -->

    <!-- Meta-data Declarations -->

    <area>General</area>

    <workgroup>Internet Engineering Task Force</workgroup>

    <!-- WG name at the upperleft corner of the doc,
         IETF is fine for individual submissions.  
	 If this element is not present, the default is "Network Working Group",
         which is used by the RFC Editor as a nod to the history of the IETF. -->

    <keyword>configuration management, verification, manets, dtns</keyword>

    <!-- Keywords will be incorporated into HTML output
         files in a meta tag but they have no effect on text or nroff
         output. If you submit your draft to the RFC Editor, the
         keywords will be used for the search engine. -->

    <abstract>
      <t>This document extends the capabilities of the NETCONF configuration
         management protocol in order to standardize mechanisms to
         perform sets of active tests (i.e., verification)
         against servers' running configuration
         over a period of time to afford the client and
         server a more robust and resilient configuration management
         capability.  This is of value to commercial enterprise and public
         networks as well as  wireless emergency and military networks.  We
         propose an initial new NETCONF capability, i.e., verify. The verify
         capability is defined in the context of the verify.yang module listed in
         the appendix of this document.  Associated with the verify operation
         are various test.yang modules to be defined elsewhere.  However, this
         document defines a set of interoperability requirements on the development
         of the test.yang modules in order to be controlled through the verify
         capability.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>This document identifies enhancements to NETCONF
         capabilities to achieve a more robust model of 
         configuration management for future IETF systems.  
         Most network management systems which are required to provide a highly robust
         network service rely upon some form of 
         out-of-band access for configuration management.
         This provides an alternative management entry into devices in the event that
         in-band access is unavailable due to, e.g.,  mis-configuration.
         However, not all network deployments can afford the luxury of alternative networks
         for management access to all networking devices, nor should this be necessary.
         Examples include Mobile Ad-Hoc Wireless Networks (MANETs) and other forms of
         Disruption Tolerant Networks (DTNs).
         All managed networks, as well, would benefit from 
         a more robust and extensive configuration
         management capability from the IETF, e.g., to provide equivalent network 
         reliability at reduced infrastructure costs.  
         To accomplish this, the NETCONF protocol <xref target="RFC4741">RFC 4741</xref>
         requires extension of
         capabilities to define and manage active tests
         and assess success, i.e., Verification, (from both the
         client and the servers)
         involving server-side running configuration.
         This document defines the verify capability within NETCONF.</t>

      <t>As an example, we
         envision a NETCONF client-server interaction model
         shown in the below figure.  Here, the client issues
         a &lt;commit&gt; with the confirming option.
         As part of testing prior to issuing the confirming
         &lt;commit&gt; the client wishes to execute a set
         of verification tests from the server.  It issues
         the new &lt;verify&gt; operation to manage this
         aspect of verification testing.
         The client passes a reference to the server indicating
         instances of specific pre-configured tests that define the
         verification test suite.  The server executes these
         as part of the NETCONF &lt;verify&gt; testing process.  
         Simultaneously,
         the client may also run a set of tests to gain confidence in the
         proposed configuration changes to the server.  Once the server
         completes its test execution, it indicates success through
         notification messages.  Once the client is comfortable
         with its own tests and those of the server, it
         issues the confirming &lt;commit&gt; to the server
         which forces the server to commit to the proposed
         configuration change.</t>

      <figure align="center" anchor="interaction_model_1">
          <preamble></preamble>
          <artwork align="left"><![CDATA[
  +------+                              +------+
  |Client|                              |Server|
  +------+                              +------+

         +------------------------------>
          Sets up <candidate> config

         +------------------------------>
          Sets up test control

---      +------------------------------>
 |        Sends <commit>
(set             - timeout
 timeout)        - confirm option
 |
 |
 |       +------------------------------>
 |        Sends <verify>
 |               - timeout
 |               - test-template:instanceIDs
 |
(running                                  (running
 client-side                               server-side tests)
 tests)                                   +--------+
 |                                                 |
 |                                                 |
 |                                        <--------+
 |                                        (server-side tests
 |                                         complete)
 |        <-----------------------------+
 |                 <verifyComplete = ok> notification
 |
 |
 |        +----------------------------->
 |         Sends <commit>
 |
 |
---

          ]]></artwork>
          <postamble></postamble>
      </figure>

      <t>This, and other Use Cases, are discussed further in the
         'Framework' section below.</t>

      <t>NETCONF defines the term 'validation' as the
          set of checks performed on proposed configuration code up to the
          point that the server
          places it into its running-configuration.</t>

      <t>We use the term 'verification' as the act of performing active 
          tests against configuration code in the running-configuration on the
          server.  (Note: strictly, verification probably should
          also cover the act of loading new configuration into the
          &lt;running&gt; configuration as this may fail, e.g.,
          due to undocumented configuration constraints.  However, here we
          focus on aspects of running active tests to measure
          network behavior as a form of verification testing.)  
          Verification tests can be executed from either the NETCONF
          client or the NETCONF server, or from a NETCONF server(a) against
          running configuration code on a NETCONF server(b), or all combinations.</t>

      <t>We define the new :verify capability as a set of stand-alone operations,
         notifications, and requirements on the definition of test modules for the
         purpose of managing verification testing on remote
         servers through standardized mechanisms.  This allows for extensible
         verification testing of configuration across the base of
         IETF compliant devices.  This leads to more resilient configuration
         management for operators manging multi-vendor networks of devices.
         This will promote future integrated network management capabilities
         as opposed to device management capabilities.</t>

      <t>A more detailed presentation of the
         operation of the proposed :verify capability
         is given in the below figure.  
         Here the client issues the
         &lt;verify&gt; operation indicating the timeout
         period, the set of tests which comprise the
         overall verification test suite, and the
         nature of the reporting from the server
         using the associated notification
         messages.  The 'verifyStatus=true' indicates
         that the server should send intermediate
         status reports following completion of
         each test set in the suite.  At the completion
         of the entire verification test suite, the server sends
         the final &lt;verifyComplete&gt; notification
         to the client.</t>

      <t>The &lt;verifyStatus&gt; and &lt;verifyComplete&gt; notifications
         carry indications of test success or failure
         based upon pre-configured thresholds and
         metrics defined within the test module(s)
         resident on the server.  Further, the 
         &lt;verify&gt; operation carries test instance
         identifiers and switches for various types
         of reporting, i.e., summary or extended.
         In total, these place requirements on the
         definition of interoperable test modules
         to be developed in support of the :verify
         capability.  We give an example of a 
         ping.test module in Appendix B.
         Our intent is to define (in other associated documents)
         a set of connectivity, protocol and transaction
         test modules to fill out the utility of this verify
         capability.</t> 

      <figure align="center" anchor="interaction_model_2">
          <preamble></preamble>
          <artwork align="left"><![CDATA[
  +------+                              +------+
  |Client|                              |Server|
  +------+                              +------+

         +------------------------------>
          Sends <verify>
                 - timeout
                 - test-template:instanceID=1,
                   test-template:instanceID=263,
                   test-template:instanceID=51
                 - verifyStatus=true
                 - extendedResults=false
--- 
 |                                        +-------+
 |                                                | tests 1
(set                                              |
 timeout)                                 <-------+  
 |        <-----------------------------+
 |                 <verifyStatus = ok> notification
 |
 |                                        +-------+
 |                                                | tests 263
 |                                                |
 |                                        <-------+
 |        <-----------------------------+
 |                 <verifyStatus = ok> notification
 |
 |                                        +-------+
 |                                                | tests 51
 |                                                |
 |                                        <-------+
 |        <-----------------------------+
 |                 <verifyStatus = ok> notification
 |        <-----------------------------+
 |               <verifyComplete = ok> notification
 |
 |
 |
---

          ]]></artwork>
          <postamble></postamble>
      </figure>




      <section title="Benefits of This Work">
        <t>Our objective is to further develop a robust and resilient network
           configuration capability, building upon the improvements afforded
           by the NETCONF protocol and it's associated modeling language,
           <xref target="YANG">YANG</xref>.</t>

        <t>The envisioned benefits of a standardized set of mechanisms and capabilities for
           verification testing include:</t>
        <t><list style="symbols">
            <t>Minimize faulty configuration and network disconnects,</t>
            <t>Provide for uniform methods for control, execution and
               reporting of verification testing in multi-vendor networks,</t>
            <t>Improve automation of extensive verification testing,</t>
            <t>Provide opportunity for device modelers to associate/recommend
               tests tied to specific configuration items, and</t>
            <t>Improve efficiency of coordinated network upgrades.</t>
        </list></t>

      </section>



      <section title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in 
        <xref target="RFC2119">RFC 2119</xref>.</t>
      </section>



      <section title="Outline">
      <t>In the remainder of this document we next give a 
          set of definitions to be adhered
          to for the remainder of this discussion.
          We then provide a new :verify capability which achieves
          initial aspects of the Robust-NETCONF capabilities.
          We then examine in the Framework section the
          relationship of the :verify mechanisms, their
          relationship to test modules and definitions of
          metrics and success criteria.  The 'Framework' section
          also covers use cases of the :verify capability.
          Then 'Acknowledgments' and 'IANA Considerations' are
          presented.  A section on 'Security Considerations' is provided
          concluding the main body of the document.</t>

      <t>Various appendices are provided to compliment the text of the main
         body.  Prominent appendices are 'Appendix A: verify.yang' which
         presents the yang module for the :verify capability and
         'Appendix B: ping.yang' which presents a simple example test module
         which complies with the requirements of the :verify capability.</t>
      </section>
    </section>




    <?rfc needLines="8" ?>
       <!-- This PI places the pagebreak correctly 
            (before the section title) in the text output. -->
    <section title="Definitions">
      <t>In this section we provide definitions strictly adhered to throughout
         this document.</t>
 
      <t>The NETCONF specification maintains the following terms:</t>
      <t><list style="symbols"> 
         <t>NETCONF Client (or client) - this is the management application
            responsible for the configuration management of network devices.</t>
         <t>NETCONF Server (or server) - this is the device being 
            managed in the network.</t> 
      </list></t>

      <t>We maintain the following distinction between 
         Validation checks and Verification tests:</t>
      <t><list style="symbols"> 
         <t>Validation checks - checking non-running
            configuration code against a set of
            rules, constraints or other requirements.  
            This addresses the total set of checks
            performed prior to the Server placing the code into its
            running-configuration.</t>
         <t>Verification tests - measuring behavior of running configuration code
            against a set of expectations or success criteria.  This may be
            performed through active testing or passivie observation
            and comparison of 
            results against expectations.</t>
         <t>Active measurements perform Verification while rule-based
            checks perform Validation.</t>
         </list></t>

      <t>We maintain the following definitions in the
         descriptions of the :verify capability:</t>
      <t><list style="symbols"> 
         <t>Verification test (or test set) - a set of identical measurements identified
            through a single instance identifier and defined in a test
            module which is pre-configured on the server.</t>
         <t>Verification test suite - the total set of verification tests identified
            by a set of instance identifiers passed to the server as
            parameters in the same &lt;verify&gt; message.</t>
         </list></t>

    </section>




    <section title="The Verify Capability">
      <t>In this section we describe a protocol development which we refer to as the
         :verify capability.
         The Yang module for this procedure, i.e., verify.yang, is
         listed in Appendix A below.
         An example test module, which complies with the requirements for test modules
         as spelled out in this document, is the ping.yang module in Appendix B below.</t>

        <section title="Verify Capability">
          <t></t>

            <section title="Overview">
              <t>The :verify capability provides a set of standard tools allowing the
                 client to direct verifications tests from remote servers and to
                 collect and uniformly interpret verification test reports related to the success or failure
                 of the tests.</t>      

              <t>Note: this capability has several prerequisites, including support for
                 &lt;candidate&gt; configuration and notifications.</t>

              <t>Additionally, there will be secondary modules for 
                 definition of specific verification tests.
                 We present our example in terms of a ping.yang module
                 in Appendix B below. Other test modules will be developed in other
                 documents.</t>

              <t>So, a typical client/server interaction
                 would hold:</t>

              <t><list style="numbers"> 
                 <t>Client sets up the &lt;candidate&gt; configuration on all relevant agents.</t>

                 <t>Client sets up all the relevant test control configuration
                    needed for the verification tests on all relevant agents.</t>

                 <t>Client sends &lt;verify&gt; to all agents
                    with parameters (timeout:seconds,
                    test-template:instance-identifier,verifyStatus:true,
                    extendedStatus:false), i.e.,

                    <figure align="center" anchor="example1">
                       <preamble></preamble>
                       <artwork align="left"><![CDATA[
<rpc xmlns="netconf-base" message-id="101">
  <verify xmlns="verify-module">
     <timeout>3600</timeout>
     <test-template xmlns:as="ping-module">
        /at:ping/at:pingEntry[at:pingControlIndex=21]
        /at:ping/at:pingEntry[at:pingControlIndex=42]
        /at:ping/at:pingEntry[at:pingControlIndex=48]
     </test-template>
     <verifyStatus>true</verifyStatus>
     <extendedStatus>false</extendedStatus>
  </verify>
</rpc>
                       ]]></artwork>
                       <postamble></postamble>
                    </figure></t>

                 <t>Server returns &lt;ok/&gt;.</t>

                 <t>The Server runs the tests with the
                    specified (e.g., pingControlEntry) configuration subtree.</t>

                 <t>For each completed test set, the server sends a report in a
                    &lt;verifyStatus&gt; notification.</t>

                 <t>At the completion of the entire verification test suite,
                    the server sends a summary report in a
                    &lt;verifyComplete&gt; notification message.</t>
               </list></t>

               <t>The client can adjust the nature of the reporting through the
                  'verifyStatus' and the 'extendedResults' parameters of the
                  &ly;verify&gt; operation.  The former determines whether or not
                  &lt;verifyStatus&gt; notifications are sent from the server
                  following the completion of each test set.  The later determines
                  whether or not the &lt;verifyStatus&gt; notifications carry
                  raw test data (as defined within the test modules).</t>

               <t>Further, the client can decide to immediately cancel all
                  ongoing verification testing by issuing the
                  &lt;cancel-verify&gt; operation.  Or the client can decide
                  to cut short the testing by issuing the &lt;complete-verify&gt;
                  operation which instructs the server to complete only the in-progress
                  test set and follow up with &lt;verifyStatus&gt; notification for that
                  completed test set if the client had required this notification message and
                  to wrap up the verification process by sending the
                  &lt;verifyComplete&gt; notification.</t>
            </section>

            <section title="Dependencies">
              <t>The :verify capability requires the existence of test modules resident
                 on servers which comply with the following requirements:</t>
              <t><list style="symbols">
                 <t>Must contain a 'list' keyed by a controlIndex which defines a
                    verification test set.</t>
                 <t>The 'list' must define an unequivocal means to determine the
                    Boolean result (success or failure) of the specific verification test set.  This
                    information is passed in the &lt;verifyStatus&gt; notification.</t>
                 <t>The 'list' must define a 'leaf-list' of raw results which may be
                    passed to the client through the &lt;verifyStatus&gt;
                    notification.</t>
              </list></t>
            </section>

            <section title="Capability Identifier">
              <t>The :verify capability is identified by the following capability
                 string:</t>

              <t>urn:ietf:params:netconf:capability:verify:1.0</t>
            </section>

            <section title="New Operations">
              <t></t>

                <section title="&lt;verify&gt;">
                 <t>The &lt;verify&gt; operation starts the verification tests on the server.
                    The &lt;verify&gt; operation has four parameters:</t>
                    <t><list style="symbols">
                       <t>timeout - the timeout period associated with the verification
                          test suite.  If the timeout expires, the server should
                          complete the in-progress test, send the &lt;verifyStatus&gt;
                          notification for the test if the 'verifyStatus' parameter is
                          set to 'true' and send the &lt;verifyComplete&gt;
                          notification.</t> 
                       <t>test-template - this 'leaf-list' parameter uniquely identifies
                          the verification test set to be performed by the server.
                          Each verification test is identified by an 'instance-identifier'
                          indexing a test definition on a test module resident on the
                          server.  Multiple test sets comprise a test suite.</t> 
                       <t>verifyStatus - this parameter is a switch which defaults
                          to 'false' indicating no &lt;verifyStatus&gt; notifications
                          are to be sent from the server to the client.  When set
                          to 'true' the server should send a &lt;verifyStatus&gt;
                          notification following the completion of each verification
                          test.</t> 
                       <t>extendedResults - this parameter is a switch which
                          defaults to 'false' indicating no 'anyxml extendedResults'
                          are to be sent in the &lt;verifyStatus&gt; notification.
                          This parameter can only be set to 'true' if the 'verifyStatus'
                          parameter is also set to 'true'.  This indicates that the
                          &lt;verifyStatus&gt; notifications should include the
                          raw measurement results carried in the 'anyxml extendResults'.</t> 
                    </list></t>
                </section>

                <section title="&lt;cancel-verify&gt;">
                 <t>The &lt;cancel-verify&gt; operation immediately cancels a verify
                    test suite in progress on the server.  The server terminates
                    in-progress tests immediately and is not required to send any
                    followup notification messages carrying test results.</t>
                </section>

                <section title="&lt;complete-verify&gt;">
                 <t>The &lt;complete-verify&gt; operation tells the server to complete
                    the in-progress verification test and to send any required followup
                    notifications carrying test results for the current test set and for the test suite.</t>
                </section>

                <section title="&lt;verifyStatus&gt;">
                 <t>The &lt;verifyStatus&gt; notification carries the results
                    for each verification test set comprising the entire verification test suite.
                    This notification may also carry raw extended results.  This
                    notification is optional and is requested explicitly by the
                    client sending the 'verifyStatus=true' parameter in the
                    &lt;verify&gt; operation.</t>
                </section>

                <section title="&lt;verifyComplete&gt;">
                 <t>The &lt;verifyComplete&gt; notification is mandatory (unless canceled
                    by the &lt;cancel-verify&gt; operation) and carries a summary
                    result covering the entire verification test suite.</t>
                </section>
            </section>

            <section title="Modifications to Existing Operations">
              <t>None.</t>
            </section>
        </section>

    </section>





    <section title="NETCONF Verify Framework">
       <t>Note: should rewrite this section to discuss the relationship between
          :verify capability and supporting test.yang modules.
          Also discuss the way metrics and thresholds are defined in order
          to assess test 'pass/failure' decisions.  This section should also contain
          a presentation of the use cases for the :verify capability.</t>

       <section title="Test Modules">
          <t>NOTE: Need to include a discussion of the test modules,
             their necessary requirements
             for interoperability and thoughts on the 
             definition of metrics and thresholds.</t>
       </section>

       <section title="Use Cases">
          <t>NOTE: Need to include a discussion of the use cases for the &lt;verify&gt;
             operation.</t>

          <t>These include:</t>
          <t><list style="symbols">
             <t>Used within a &lt;commit&gt; operation with the 'confirmed'
                parameter.</t>
             <t>Used to verify the configuration of server(a) following the re-configuration
                of server(b).</t>
             <t>Used to verify the &lt;running&gt; configuration prior to copying it
                into the &lt;startup&gt; configuration.</t>
          </list></t>
       </section>


    </section>



    <section anchor="Acknowledgements" title="Acknowledgements">
      <t>The authors wish to thank the many useful suggestions by and discussions with Martin
         Bjorklund on this capability proposal.</t>
    </section>



    <!-- Possibly a 'Contributors' section ... -->

    <section anchor="IANA" title="IANA Considerations">
      <t>This memo includes no request to IANA.</t>

      <t>All drafts are required to have an IANA considerations section (see
      <xref target="I-D.narten-iana-considerations-rfc2434bis">the update of
      RFC 2434</xref> for a guide). If the draft does not require IANA to do
      anything, the section contains an explicit statement that this is the
      case (as above). If there are no requirements for IANA, the section will
      be removed during conversion into an RFC by the RFC Editor.</t>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>This section presents the required security considerations for all
         IETF protocols and capabilities.
         This section was developed following guidelines within
         <xref target="RFC3552">RFC 3552</xref>.</t>

      <t>This section addresses the security concerns and objectives for the
         :verify capability within NETCONF.
         (NOTE: This section is currently TBD.)</t>
  
      <t>Security issues related to the :verify capability should
         address issues specific to the proposed NETCONF operations.
         They should also address security issues associated with the development
         of associated test modules for the purpose of running
         verification tests.
         Here is an initial list of potential considerations:</t>

       <t><list style="symbols">
          <t>Verification requires server-side tests that
             require that packets to be injected
             into the network for the purpose of measuring some performance
             characteristics.  As such, associated test modules will contain sensitive
             network and application data; e.g., user IDs and passwords.  
             Further, if security is compromised, this capability could provide a source
             for denial-of-service, and potential other, attacks.</t>
          <t>The configuration of verification tests may require passing
             sensitive network information.  For this reason, this
             configuration information should be encrypted prior to
             transport over the network.</t>
          <t>Some test attributes configure username and password information for some
             application-level protocols as indicated above.  Access to these
             attributes may provide unauthorized use of resources.</t>
          <t>Some test attributes configure the size and rate of traffic flows for the
             purpose of performance measurements.  Access to these attributes may
             exacerbate the use of this capability in denial-of-service attacks.
             It is recommended that test modules define a maximum packet rate on the 
             device and to indicate this rate. Other objects that control
             aspects of the test packets related to packet size and rate are
             will exist in test modules and bounds on these should be set.</t>
          <t>Test module objects will exist which set
             the source and destination addresses on the
             packet headers.  The server should not
             allow the setting of source addresses on the test packets other than
             those that are administratively configured onto the server.</t>
       </list></t>

    </section>
  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <!-- References split into informative and normative -->

    <!-- There are 2 ways to insert reference entries from the citation libraries:
     1. define an ENTITY at the top, and use "ampersand character"RFC2629; here (as shown)
     2. simply use a PI "less than character"?rfc include="reference.RFC.2119.xml"?> here
        (for I-Ds: include="reference.I-D.narten-iana-considerations-rfc2434bis.xml")

     Both are cited textually in the same manner: by using xref elements.
     If you use the PI option, xml2rfc will, by default, try to find included 
     files in the same
     directory as the including file. 
     You can also define the XML_LIBRARY environment variable
     with a value containing a set of directories to search.  
     These can be either in the local
     filing system or remote ones accessed by http (http://domain/dir/... ).-->


    <references title="Normative References">
      <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?-->

      &RFC2119;
      &RFC4741;

    </references>



    <references title="Informative References">
      <!-- Here we use entities that we defined at the beginning. -->

      &RFC3552;

      &I-D.narten-iana-considerations-rfc2434bis;

      <reference anchor="YANG">
        <front>
          <title>YANG - A data modeling language for NETCONF</title>
          <author initials="M." surname="Bjorklund">
            <organization></organization>
          </author>
          <date month="June" year="2010" />
        </front>
      </reference>


    </references>




<!-- **********Start the Appendices Here****************** -->


    <section anchor="appendixA" title="verify.yang Module">
      <t>In this appendix we list the verify.yang model for use in conjunction
         with the robust-netconf capabilities.</t>

      <t>Note: this capability has several prerequisites, including support for
         notifications and recommended support for the confirmed-commit:
         capability.</t>

      <figure align="center" anchor="verify">
         <preamble></preamble>
         <artwork align="left"><![CDATA[
=========Contents of "verify.yang"==================

module verify {

      namespace 
        "file:///draft-cole-netconf-verify-00.txt";

      prefix "ver";

      organization  "IETF";

      contact "[add contact info here].";

      description
        "NETCONF verify procedure.";

      revision 2010-01-21 {
          description  "Initial version.";
      }

      rpc verify {
          description
            "The verify procedure is started by
             invoking this operation.

               * A verify proceedure is comprised of
                 multiple verification test sets, each
                 indicated by an instance-identifier
                 within the 'test-template leaf-list'
                 of the <verify> operation.  Multiple
                 test sets comprise a test suite.

               * the agent will cancel the verify
                 procedure if the <cancel-verify>
                 operation is invoked.

               * the agent will complete the current
                 verification test set and generate the 
                 <verifyStatus> and <verifyComplete>
                 notifications if the <cancel-verify>
                 operation is invoked.

               * the agent will start, monitor, and report
                 the verification test(s) during the time
                 interval after this operation, and before
                 the 'timeout' interval has expired.

               * the agent will generate the <verifyStatus>
                 notification for each verification test set specified
                 in the 'test-template leaf-list', indicating the
                 result of each verification test set.

               * the agent will generate the <verifyComplete>
                 notification at the completion of the entire
                 test suite, indicating the
                 final verify procedure status.

               * the definition of this capability places requirements
                 on the development of test.yang modules to provide
                 the following set of features:
                     - test sets identified by 'instanceId's,
                     - test suites identified by the collection of
                       instanceIds,
                     - test suites unambiguously identify: 
                       metric and target, Boolean
                       (pass/fail) threshold, (optional) raw data
                       capability.
                 These requirements are defined in section 3.1.2.

               * <verifyStatus> is sent follow each verification test
                 and indicates pass/fail status of test based upon
                 (metric, target, threshold) triplet.  It may also
                 carry raw data values from the 'rawResults' node
                 carried within the <verifyStatus>'s
                 'anyxml extendedStatus'.
            ";

          input {
              leaf timeout {
                  description
                    "The time interval the agent has to perform
                     the verify operation.  If not complete at
                     timeout, then server must issue <verifyStatus>
                     indicating partial test results and that
                     verification tests are being terminated.";
                  type uint32;
                  units seconds;
                  default 600;
              }

              leaf-list test-template {
                  description
                    "Identifies a verification test control entry
                     or entries for the agent to use for the 
                     verification procedure.

                     The verification test control entry must conform
                     to the requirements specified in section 3.1.2,
                     and the agent must be capable of starting,
                     monitoring, and reporting the results of
                     the verification test, as required.

                     The agent will also generate the
                     <verifyStatus> notification,
                     as specified for each verification test st
                     control entry indicated by this parameter.";
                  ordered-by user;
                  type instance-identifier;
                  min-elements 1;
              }

              leaf verifyStatus {
                  description
                    "A switch indicating the use of the
                     <verifyStatus notification.  If 'false'
                     the client does not want to receive
                     the <verifyStatus> notification 
                     associated with each verification test set
                     in the verification test suite.  Instead,
                     it only wants to receive the final
                     <verifyComplete> notification which
                     contains a summarized pass/fail result
                     for the verification test suite.

                     If 'true', then the client is requesting
                     that the server generates <verifyStatus>
                     notifications for each verification test set
                     in the verification test suite.";
                  type boolean;
                  default false;
              }

              leaf extendedResults {
                  description
                    "A switch indicating that the client is
                     requesting raw test results through
                     the 'anyxml extendedResults'.  This
                     defaults to 'false'.

                     This can only be set to 'true' if the
                     proceeding 'verifyStatus' leaf is set
                     to 'true'.  Else, the server should
                     generate an error response to this
                     request.";
                  type boolean;
                  default false;
              }

          }
      }



      rpc cancel-verify {
          description
            "Cancel a verify procedure already in progress.

             If no verify procedure is currently in
             progress, then an 'operation-failed' error is
             generated, and the value 'no-verify'
             is used for the error-app-tag field.

             If the verify procedure in progress
             cannot be canceled for any reason, then an
             'operation-failed' error is returned, and
             the value 'cancel-failed' is used in the
             error-app-tag field.

             If any verification test sets associated with this
             verify procedure are still in progress,
             they will be canceled by this operation.

             If the verify procedure in progress
             is canceled, then the agent will return <ok/>.
            ";
      }

      rpc complete-verify {
          description
            "Complete a verify procedure already in progress.

             If no verify procedure is currently in
             progress, then an 'operation-failed' error is
             generated, and the value 'no-verify'
             is used for the error-app-tag field.

             If the verify procedure in progress
             cannot be completed for any reason, then an
             'operation-failed' error is returned, and
             the value 'complete-failed' is used in the
             error-app-tag field.

             If any verification test sets associated with
             this verify test suite are still in progress,
             they will be canceled by this operation
             following the completion of the current
             test set.

             If the verify procedure in progress
             is completed, then the agent will return <ok/>.
            ";
      }

      notification verifyStatus {
          description
            "Contains the current or final status of
             a verification test being invoked on behalf
             of the current verify procedure.";

          list eachTest {
              key "testIdentifier";

              leaf testIdentifier {
                  description
                    "Indicates which verification test this
                     status report is associated with.
                     This value will identify the same node
                     as specified in a 'test-template'
                     parameter instance provided in the
                     <verify> operation.";
                  type instance-identifier;
                  mandatory true;
              }

              leaf statusType {
                  description
                    "Indicates the type of status report that
                     this notification contains.";
                  type enumeration {
                      enum partial {
                          description
                            "Indicates this is a partial status result
                             for this verification test
                             which is still in progress.";
                      }
                      enum final {
                          description
                            "Indicates this is the final status result
                             and this verification test which completed
                             or canceled.";
                      }
                  }
                  mandatory true;
              }

              leaf status {
                  description
                    "Indicates the NETCONF error-tag value most
                     closely associated with the test status.
                     The string 'ok' is used to indicate that
                     the pass threshold for the test has been
                     exceeded.";
                  type string;
                  reference "RFC 4741bis, Appendix A";
                  mandatory true;
              }

              anyxml extendedStatus {
                  description
                    "Indicates verification test-specific status data.
                     The requirements for verification tests
                     (section 3.1.2) describes how the semantics
                     of this structure are determined.";
              }
          }
      }

      notification verifyComplete {
          description
            "Contains the final status of the
             current verify test suite.";

          leaf status {
              description
                "Indicates the NETCONF error-tag value most
                 closely associated with the test status.
                 The string 'ok' is used to indicate that
                 the pass thresholds were exceeded for
                 all tests in the verification test suite.";
              type string;
              reference "RFC 4741bis, Appendix A";
              mandatory true;
          }
      }

  }

         ]]></artwork>
         <postamble></postamble>
      </figure>
    </section>





    <section anchor="appendixB" title="Example ping.yang Module">
      <t>In this appendix we list an example ping.yang model for use in conjunction
         with the :verify capability.</t>

      <t>Specifically, the &lt;verify&gt; operation passes the instance-identifiers
         in the 'test-template' parameter.  Each instance-identifier
         identifies a specific ping test.  The &lt;verify&gt; operation manages
         the identification, execution and reporting of multiple tests within
         a single verification test procedure.</t>

      <figure align="center" anchor="verify_operation">
         <preamble></preamble>
         <artwork align="left"><![CDATA[

<rpc xmlns="netconf-base" message-id="101">
  <verify xmlns="verify-module">
     <timeout>3600</timeout>
     <test-template xmlns:as="ping-module">
        /at:ping/at:pingEntry[at:pingControlIndex=21]
        /at:ping/at:pingEntry[at:pingControlIndex=42]
        /at:ping/at:pingEntry[at:pingControlIndex=48]
     </test-template>
     <verifyStatus>true</verifyStatus>
     <extendedStatus>false</extendedStatus>
  </verify>
</rpc>

         ]]></artwork>
         <postamble></postamble>
      </figure>


      <figure align="center" anchor="ping_model">
         <preamble></preamble>
         <artwork align="left"><![CDATA[
=========Contents of "ping.yang"==================

module ping {

       namespace "unassigned";
       prefix "at";

       import ietf-yang-types { prefix yang; }
       import ietf-inet-types { prefix inet; }


       organization "IETF";

       contact
           "Andy Bierman
            InterWorking Labs
            EMail: andyb@iwl.com

            Robert G. Cole
            US Army CERDEC
            Email: robert.g.cole@us.army.mil

            Dan Romascanu
            Avaya
            Email:dromasca@avaya.com";

            description
                "The module for entities implementing
                 the ping test.";

            revision 2010-01-27 {
                description "Second revision:
                    Added 'pingEntry' list to hold multiple
                    pre-defined test specifications.  Added
                    (metric, target, threshold) triplet
                    for pass/fail determination.  Added
                    raw data collection and reporting
                    (optional).";
            }


            leaf test-reference {
                type string;
                config false;
                description "URL for the definition of this
                             test";
            }

            list pingEntry {
                key "pingControlIndex";
                config true;

                leaf pingControlIndex {
                    type uint32;
                    description
                        "Identifies the specific control table
                         row of the ping test template to be
                         executed, which represents the
                         verification tests to be performed
                         on the device as part of the verified
                         commit operation.";

                }

                leaf dstAddr {
                    type inet:ip-address;
                    description
                        "Identifies the destination address in
                         the packet header of the ping message.";
                }

                leaf srcAddr {
                    type inet:ip-address;
                    description
                        "Identifies the source address in the
                         packet header of the ping message.";
                }

                leaf spacing {
                    type uint32;
                    description
                        "The number of seconds between sending
                         subsequent ping packets.";
                }

                leaf startTime {
                    type yang:date-and-time;
                    config false;
                    description
                        "The time the first ping packet
                         was sent for the previous test.
                         This is set each time the test
                         is initiated from a client.  When this
                         value is reset, the value of the
                         'result' node is set to
                         'indeterminant' and the value of the
                         'received' node is set to zero.";

                }

                leaf number {
                    type uint32;
                    description
                        "The number of ping packets to be sent.";
                }

                leaf metric {
                    type enumeration;
                        enum loss {
                            description
                               "Holds the indication of whether
                                the transaction was successful (1)
                                or failed (0).";
                        }
                        enum delay {
                            description
                               "Holds the number of milliseconds
                                for the successful transaction
                                or '0' if the transaction failed.";
                        }
                        enum throughput {
                            description
                               "Holds the measured throughput
                                in units of bytes/millisecond for
                                the transaction if successful
                                or '0' if failed.";
                        }
                    default "loss";
                    description
                        "The metric tracked by this specific test.
                         These values are held on the rawResults
                         if the specific test indicates storage
                         of raw data values.";
                }

                leaf target {
                    type uint32;
                    description
                        "The preformance target for each transaction
                         measurement.  A measured transaction is deemed
                         successful if its measured 'metric' value
                         falls within the limits defined by this
                         'target'.  E.g.,
                             if 'metric = loss', then 'target' must
                                equal '1' indicating success if repsonse
                                recieved.
                             if 'metric = delay', then responses
                                received within 'target' milliseconds
                                are counted as successful.
                             if 'metric = throughput', then responses
                                recieved with throughputs greater than
                                'target' are counted as successful.  

                         The target value carries the
                         units defined by the 'metric', i.e.,
                             unitless if 'metric = loss', 
                             milliseconds if 'metric = delay', 
                             bytes/milliseconds if 
                             'metric = throughput'.

                         The server counts the number of transaction
                         measurements that are deemed successful.  This
                         count is compared against 'threshold' to
                         determine overall success or failure of the
                         test.";
                    default "1";
                }

                leaf threshold {
                    type uint32;
                    description
                        "The threshold value that determines the
                         pass/fail status reported to the client
                         by this server in the 'verifyStatus'
                         notification."; 
                }

                leaf received {
                    type uint32;
                    config false;
                    description
                        "The number of successful
                         ping transactions received during
                         the previous test.  This value 
                         is initialized to zero prior to 
                         the instantiation of the test 
                         and is incremented by one for
                         each received ping packet.  This
                         is set each time the test is 
                         initiated from a client.";
                }

                leaf result {
                    type enumeration {
                        enum indeterminant{
                            description
                               "Set to 'indeterminant' upon
                                the initiation of a test.";
                        }
                        enum success{
                            description
                               "Set to 'success' if the
                                number of successful pings
                                exceeded the 'threshold'.";
                        }
                        enum failure{
                            description
                               "Set to 'failure' if the
                                number of successful pings is less
                                than or equal to the 'threshold'.";
                        }
                    config false;
                    description
                        "The result of the previous test.";
                }

                leaf rawResultCollection {
                    type enumeration;
                        enum off {
                            description
                               "Indicates that the server will
                                not store the raw transaction
                                measurement values of type indicated
                                by metric.";
                        }
                        enum on {
                            description
                               "Indicates that the server will
                                store the raw transaction
                                measurement values of type indicated
                                by metric.  Further, these raw
                                measurement values will be passed
                                to the client throught 'verifyStatus'
                                notification's 'extendedStatus' 
                                node.";
                        }
                    config true;
                    default "off";
                    description
                        "A switch to turn ON or OFF the raw
                         data collection and notification.";
                }

                leaf-list rawResults {
                    description
                      "Holds the raw metric value for each transaction
                       successfully recorded as part of the specific
                       test.  The units used for these values conform
                       to the units defined with the 'metric' measured.

                       Upon completion of this specific test, the server
                       passes this measurement data to the requesting
                       client through the 'verifyStatus' notification's
                       'anyxml extendedStatus'.";
                    ordered-by system;
                    type uint32;
                    config false;
                    min-elements 1;
                }


            }

   }

         ]]></artwork>
         <postamble></postamble>
      </figure>
    </section>


    <!-- Change Log
v00 2010-06-12  RGC   Initial version, developed from previous
                      <draft-cole-robust-netconf-02.txt> draft.
                      Now focused solely on the definition of the verify
                      capability and requirements for associated test modules.

     -->
  </back>
</rfc>
