

Diameter Maintenance and                                    J. Bournelle
Extensions (DIME)                                     France Telecom R&D
Internet-Draft                                               G. Giaretta
Intended status: Standards Track                                Qualcomm
Expires: January 9, 2008                                   H. Tschofenig
                                                  Nokia Siemens Networks
                                                             M. Nakhjiri
                                                              Huawei USA
                                                            July 8, 2007


    Diameter Mobile IPv6: Support for Home Agent to Diameter Server
                              Interaction
                   draft-ietf-dime-mip6-split-04.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on January 9, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   Mobile IPv6 deployments may want to bootstrap their operations
   dynamically based on an interaction between the Home Agent and the



Bournelle, et al.        Expires January 9, 2008                [Page 1]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   Diameter server of the Mobile Service Provider (MSP).  This document
   specifies the interaction between a Mobile IP Home Agent and the
   Diameter server.  Two different mechanisms for authentication of a MN
   to the HA are supported.  The first method consists of performing the
   Internet Key Exchange v2 (IKEv2) protocol along with the Extensible
   Authentication Protocol (EAP) with the Diameter server, while the
   second method utilizes the Mobile IPv6 Authentication option, as
   defined in RFC 4285.  For Internet Key Exchange v2 with EAP-based
   authentication, the Diameter Mobile IPv6 application, defined in this
   document, reuses the commands defined in the Diameter EAP
   application, while for supporting the RFC 4285-style MIPv6
   Authentication Options, a new Diameter application and new command
   codes are defined.






































Bournelle, et al.        Expires January 9, 2008                [Page 2]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  5
   3.  Advertising Application Support  . . . . . . . . . . . . . . .  5
   4.  Overview . . . . . . . . . . . . . . . . . . . . . . . . . . .  5
   5.  Protocol Description . . . . . . . . . . . . . . . . . . . . .  6
     5.1.  Support for Mobile IPv6 with IKEv2 and IPsec . . . . . . .  6
     5.2.  Support for the Mobile IPv6 Authentication Protocol  . . .  8
     5.3.  Mobile IPv6 Session Management . . . . . . . . . . . . . .  9
       5.3.1.  Session-Termination-Request Command  . . . . . . . . .  9
       5.3.2.  Session-Termination-Answer Command . . . . . . . . . .  9
       5.3.3.  Abort-Session-Request Command  . . . . . . . . . . . .  9
       5.3.4.  Abort-Session-Answer Command . . . . . . . . . . . . . 10
     5.4.  Accounting for Mobile IPv6 services  . . . . . . . . . . . 10
       5.4.1.  Accounting-Request Command . . . . . . . . . . . . . . 10
       5.4.2.  Accounting-Answer Command  . . . . . . . . . . . . . . 11
   6.  Command-Code and AVP Values  . . . . . . . . . . . . . . . . . 11
     6.1.  Command Code for EAP-based Authentication  . . . . . . . . 11
       6.1.1.  Diameter-EAP-Request (DER) . . . . . . . . . . . . . . 12
       6.1.2.  Diameter-EAP-Answer (DEA)  . . . . . . . . . . . . . . 12
     6.2.  Command Codes for RFC 4285 Support . . . . . . . . . . . . 13
       6.2.1.  MIP6-Request-Message . . . . . . . . . . . . . . . . . 13
       6.2.2.  MIP6-Answer-Message  . . . . . . . . . . . . . . . . . 14
       6.2.3.  Diameter AVPs  . . . . . . . . . . . . . . . . . . . . 15
   7.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 18
     7.1.  Command Codes  . . . . . . . . . . . . . . . . . . . . . . 18
     7.2.  Result-Code AVP Values . . . . . . . . . . . . . . . . . . 18
     7.3.  Application Identifier . . . . . . . . . . . . . . . . . . 18
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . . 18
   9.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 18
   10. References . . . . . . . . . . . . . . . . . . . . . . . . . . 19
     10.1. Normative References . . . . . . . . . . . . . . . . . . . 19
     10.2. Informative References . . . . . . . . . . . . . . . . . . 20
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 20
   Intellectual Property and Copyright Statements . . . . . . . . . . 22















Bournelle, et al.        Expires January 9, 2008                [Page 3]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


1.  Introduction

   Performing the Mobile IPv6 protocol [1], requires the Mobile Node
   (MN) to own a Home Address (HoA) and assignment of a Home Agent (HA)
   to MN.  The MN needs to register its Mobile IPv6 session with the HA
   in order facilitate its reachability and mobility, when away from
   home.  The registration process itself requires establishment of
   IPsec security associations (SA) and cryptographic material between
   the MN and HA.  Providing the collection of home address, HA address
   and keying material to establish the IP SA is generaally referred to
   as the Mobile IPv6 bootstrapping problem [reference to RFC4640].  The
   purpose of this specification is to provide Diameter support for such
   bootstrapping in a split scenario [2] in a manner that satisfies the
   requirements defined in [13].

   From an operator (mobility service provider, MSP) perspective, it is
   important to verify that the MN is authenticated and authorized to
   utilize Mobile IPv6 service and that such services are accounted for.
   Only when the MN is authenticated and authorized, the MSP allows the
   boostrapping of Mobile IPv6 parameters at the MN and HA.  Thus, prior
   to processing the Mobile IPv6 service requests, the HA, participates
   in the authentication of the MN to verify the MN's identity.  The HA
   also participates in the Mobile IPv6 authorization process involving
   the Diameter infrastrucure.  The HA due to its role in traffic
   forwarding, also performs accounting for the Mobile IPv6 service
   provided to the MN.

   Mobile IPv6 specifications allow two different methods for MN
   authentication, one based on IKEv2 and EAP [3], and another based on
   the Mobile IPv6 Authentication Option [4].  The goal of this document
   is to specify the Diameter procedures associated with the Mobile IPv6
   bootstrapping between the HA and the Diameter server for these two
   Mobile IP authentication approaches.

   For that reason the Diameter Mobile IPv6 application provides two
   different sets of commands.  The first set of commands reuse the
   command already define in Diameter EAP application (though using the
   Diameter Mobile IPv6 Application-Id), while the second set of
   commands are new for Diameter and provide support the Mobile IPv6
   Authentication Option, defined in RFC 4285.

   For authorization signaling and management of Mobile IPv6 session for
   the MN, this specification will use the existing procedures from base
   Diameter specification [5].

   For accounting of Mobile IPv6 services provided to the MN, this
   specification uses the accounting application defined in [5].




Bournelle, et al.        Expires January 9, 2008                [Page 4]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [6].

   The MIPv6 bootstrapping terminology is taken from [7].


3.  Advertising Application Support

   Diameter nodes conforming to this specification MUST advertise
   support by including the Diameter Mobile IPv6 Application ID value of
   [TO BE ASSIGNED BY IANA] in the Auth-Application-Id AVP of the
   Capabilities-Exchange-Request and Capabilities-Exchange-Answer
   command [5].  The Acct-Application-id AVP needs to include the
   Diameter Base Accounting Application ID value of 3 (to support the
   split accounting model [draft-ietf-dime-app-design-guide]).


4.  Overview

   One task of the Mobile IPv6 bootstrapping procedure is to assign an
   appropriate HA to the MN.  Furthermore, authorization and successful
   delivery of Mobile IPv6 to a MN through a HA, requires the HA to act
   as a client to the Diameter infrastructure interconnecting it to the
   MSP.  As a Diameter client, the HA needs to perform the following
   operations:

   Authentication:  Asserting or helping in assertion of the correctness
      of the MN identity.  As a Diameter client supporting the new
      Diameter Mobile IPv6 application, the HA may need to support two
      different types of authentication by supporting the different
      command sets that are required for each authentication method.

   Authorization:  The HA must verify that the user is authorized to use
      the Mobile IPv6 service using the assistance of the MSP Diameter
      servers.  This is accomplised through use of new Diameter commands
      specifically designed for performing Mobile IPv6 authorization
      decisions.  This document defines these commands and requires the
      HA to support use of these authorization commands and to
      participate in this authorization signaling.

   Accounting:  For billing purposes and capacity planning, it is
      required of the HA to provide accounting report to the Diameter
      infrastructure and thus to support the related Diameter accounting
      procedures.




Bournelle, et al.        Expires January 9, 2008                [Page 5]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   Figure 1 depicts the architecture.


        +---------------------------+  +-----------------+
        |Visited MSP                |  | Home MSP/MSA    |
        |                           |  |                 |
        |                           |  |                 |
        | +--------+                |  |    +--------+   |
        | |Local   |      Diameter  |  |    |Home    |   |
        | |Diameter|<---------------------->|Diameter|   |
        | |Proxy   |                |  |    |Server  |   |
        | +--------+                |  |    +--------+   |
        |     ^                     |  |        ^        |
        |     |                     |  |        |        |
        |     | Diameter            |  |Diameter|        |
        |     v                     |  |        v        |
        | +-------+                 |  |     +-------+   |
        | |Home   |                 |  |     |Home   |   |
        | |Agent  |                 |  |     |Agent  |   |
        | +-------+                 |  |     +-------+   |
        |     ^                     |  |        ^        |
        +-----|---------------------+  +--------|--------+
              |                                 |
              |                                 |
              |          +---------+            |
              |          | Mobile  |            |
              +--------->| Node    |<-----------+
       IKEv2 or RFC 4285 +---------+ IKEv2 or RFC 4285

                      Figure 1: Architecture Overview

   [Editor's Note: A description of the relationship with the front-end
   protocols is needed.]


5.  Protocol Description

5.1.  Support for Mobile IPv6 with IKEv2 and IPsec

   The use of IKEv2 between the MN and the HA allows the HA to
   authenticate the MN.  When EAP is used with IKEv2, the Diameter EAP
   application, as defined in [8], is re-used.  AVPs specific to Mobile
   IPv6 bootstrapping are added to this command.

   Figure 2 shows the message flow involved during the authentication
   phase when EAP is used.





Bournelle, et al.        Expires January 9, 2008                [Page 6]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


     Mobile                  Home                    Diameter
     Node                    Agent                   Server
     ------                  -----                   --------
            IKE_SA_INIT     (1,2)
   <------------------------------>

   HDR, SK{IDi,[CERTREQ,] [IDr,]
           [CP(CFG_REQUEST),]
            SAi2, TSi, TSr}  (3)
   ------------------------------->
                                    DER (EAP-Response) (4)
                                    ------------------------>
                                       DEA (EAP-Request) (5)
                                    <------------------------
    HDR, SK {IDr, [CERT,] AUTH,
             EAP }
   <-------------------------------
    HDR, SK {EAP}
   -------------------------------->
                                    DER (EAP-Response)
                                    ------------------------>
                                       DEA (EAP-Request)
                                    <------------------------
    HDR, SK{EAP-Request}
   <-------------------------------
    HDR, SK{EAP-Response}
   -------------------------------->
                                       DER (EAP-Response)
                                    ------------------------>
             ...                           ...

                                       DEA (EAP-Success)
                                    <------------------------
    HDR, SK{EAP-Success}
   <-------------------------------
    HDR, SK{AUTH}
   ------------------------------->
    HDR, SK {AUTH, [CP(CFG_REPLY,] SAr2, TSi, TSr }
   <-------------------------------

                 Figure 2: IKEv2 Diameter EAP Message Flow

   The MN and the HA start the interaction with an IKE_SA_INIT exchange.
   In this phase cryptographic algorithms are negotiated, nonces and
   Diffie-Hellman parameters are exchanged.  Message (3) starts the
   IKE_AUTH phase.  This second phase authenticates the previous
   messages, exchanges identities and certificates and establishes the
   first CHILD_SA.  It is used to mutually authenticate the MN (acting



Bournelle, et al.        Expires January 9, 2008                [Page 7]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   as an IKEv2 Initiator) and the HA (acting as an IKEv2 Responder).
   The identity of the user/MN is provided in the IDi field.  The MN
   indicates its willingness to be authenticated via EAP by omitting the
   AUTH field in message 3 (see [9]).

   As part of the authentication process, the MN MAY request a Home-
   Address, a Home Prefix or suggests one, see [2], using a CFG_REQUEST
   payload in the message 3.

   The HA extracts the IDi field from the message 3 and sends a
   Diameter-EAP-Request (DER) message towards the authenticating
   Diameter server.

   This message is routed to the MNs Diameter server/EAP server.  The
   Diameter server selects the EAP method and replies with the DEA
   Message.  Depending on the type of EAP method chosen, a number of DER
   and DEA messages carry the method specific exchanges between the MN
   and the Diameter server/EAP server.

   At the end of the EAP authentication phase, the Diameter server
   indicates the result of the authentication in the Result-Code AVP and
   provides the corresponding EAP packet (EAP Success or EAP Failure).
   The last IKEv2 message sent by the HA contains the Home Address or
   the Home Prefix.  In the latter case, a CREATE_CHILD_SA exchange is
   necessary to setup IPsec SAs for Mobile IPv6 signalling.

   In some deployment scenario, the HA may also acts as a IKEv2
   Responder for IPsec VPN access.  A problem in this case is that the
   IKEv2 responder may not know if IK Ev2 is used for MIP6 service or
   for IPsec VPN access.  A network operator needs to be aware of this
   limitation.

5.2.  Support for the Mobile IPv6 Authentication Protocol

   Figure 3 describes the sequence of messages sent and received between
   the MN, the HA and the Diameter server during the registration when
   RFC 4285 is used.  Binding Update (BU) and Binding Acknowledgement
   (BA) messages are used in the registration process.  This exchange
   triggers the Diameter interaction.

   According to [4] the MN uses the Mobile Node Identifier Option,
   specifically the MN-NAI mobility option as defined in [14] to
   identify itself while authenticating with the HA.

   The MN may use the Message Identifier option for additional replay
   protection.  The authentication option may be used by the MN to
   transfer authentication data when the MN and the HA are utilizing a
   mobility SPI.



Bournelle, et al.        Expires January 9, 2008                [Page 8]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   The BU initiates a MIP6-Request-Message to the Diameter server and
   the corresponding response is carried in a MIP6-Answer-Message.


     Mobile                                Home                   AAA
     Node                                  Agent                 Server
       |                                     |                     |
       |                                     |                     |
       |       Binding Update                |MIP6-Request-Message |
    (a)|------------------------------------>|-------------------->|
       | (including MN-ID option,            |                     |
       |  Message ID option [optional],      |                     |
       |  authentication option)             |                     |
       |                                     |                     |
       |                                     |                     |
       |       Binding Acknowledgement       |MIP6-Answer-Message  |
    (b)|<------------------------------------|<--------------------|
       | (including MN-ID option,            |  (MN-HA key)        |
       |  Message ID option [optional],      |                     |
       |  authentication option)             |                     |

               Figure 3: MIPv6 Bootstrapping using RFC 4285

5.3.  Mobile IPv6 Session Management

   The Diameter server may maintain state or may be stateless.  This is
   indicated in the Auth-Session-State AVP (or its absence).  The HA
   MUST support the Authorization Session State Machine defined in [5].
   Moreover the following 4 commands may be exchanged between the HA and
   the Diameter server.

5.3.1.  Session-Termination-Request Command

   The Session-Termination-Request (STR) message [5] is sent by the HA
   to inform the Diameter server that an authorized session is being
   terminated.

5.3.2.  Session-Termination-Answer Command

   The Session-Termination-Answer (STA) message [5] is sent by the
   Diameter server to acknowledge the notification that the session has
   been terminated.

5.3.3.  Abort-Session-Request Command

   The Abort-Session-Request (ASR) message [5] is sent by the Diameter
   server to terminates the session.  This fulfills one of the
   requirement described in [13].



Bournelle, et al.        Expires January 9, 2008                [Page 9]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


5.3.4.  Abort-Session-Answer Command

   The Abort-Session-Answer (ASA) message [5] is sent by the Home Agent
   in response to an ASR message.

5.4.  Accounting for Mobile IPv6 services

   The HA MUST be able act as a Diameter client collecting accounting
   records needed for service control and charging.  The HA MUST support
   the accounting procedures (specifically the command codes mentioned
   below) and the Accounting Session State Machine as defined in [5].
   The command codes, exchanged between the HA and Diameter server for
   accounting purposes, are provided in the following subsections.

   The Diameter application design guideline [15] defines two separate
   model for accounting:

   Split accounting model:

      According to this model, the accounting messages use the Diameter
      base accounting application ID (value of 3).  Since accounting is
      treated as an independent application, accounting commands may be
      routed separately from the rest of application messages and thus
      the accounting messages generally end up in a central accounting
      server.  Since Diameter Mobile IPv6 application does not define
      its own unique accounting commands, this is the prefered choice,
      since it permits use of centralized accounting for several
      applications.

   Coupled accounting model:

      In this model, the accounting messages will use the application ID
      of the Mobile IPv6 application.  This means that accounting
      messages will be routed like any other Mobile IPv6 application
      messages.  This requires the Diameter server in charge of Mobile
      IPv6 application to handle the accounting records (e.g., sends
      them to a proper accounting server)..

   As mentioned above, the prefered choice is to use the split
   accounting model and thus choose Diameter base accounting application
   ID (value of 3) for accounting messages.

5.4.1.  Accounting-Request Command

   The Accounting-Request command [5] is sent by the HA to the Diameter
   server to exchange accounting information regarding the MN with the
   Diameter server.




Bournelle, et al.        Expires January 9, 2008               [Page 10]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


5.4.2.  Accounting-Answer Command

   The Accounting-Answer command [5] is sent by the Diameter server to
   the HA to acknowledge receiving an Accounting-Request.


6.  Command-Code and AVP Values

   The following commands are defined in this section:


  Command-Name                 Abbrev.   Code     Reference  Application
  ----------------------------------------------------------------------
  MIP6-Request-Message         MRM       XXX      TBD        MIP6
  MIP6-Answer-Message          MAM       XXX      TBD        MIP6

                        Figure 4: New Command Codes

   The following defines the command codes used by the Diameter Mobile
   IPv6 application:


  Command-Name                 Abbrev.   Code     Reference  Application
  ----------------------------------------------------------------------
  Diameter-EAP-Request         DER       268      RFC 4072   EAP
  Diameter-EAP-Answer          DEA       268      RFC 4072   EAP
  MIP6-Request-Message         MRM       XXX      TBD        MIP6
  MIP6-Answer-Message          MAM       XXX      TBD        MIP6
  Session-Termination-Request  STR       275      RFC 3588   BASE
  Session-Termination-Answer   STA       275      RFC 3588   BASE
  Abort-Session-Request        ASR       275      RFC 3588   BASE
  Abort-Session-Answer         ASA       275      RFC 3588   BASE
  Accounting-Request           ACR       271      RFC 3588   BASE
  Accounting-Answer            ACA       271      RFC 3588   BASE


                          Figure 5: Command Codes

6.1.  Command Code for EAP-based Authentication

   This document re-uses the Diameter EAP application commands.  The
   following commands are used to carry MIPv6 related bootstrapping
   AVPs:








Bournelle, et al.        Expires January 9, 2008               [Page 11]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   Command-Name             Abbrev.   Code     Reference  Application
   ------------------------------------------------------------------
   Diameter-EAP-Request      DER       268      RFC 4072   EAP
   Diameter-EAP-Answer       DEA       268      RFC 4072   EAP

   Figure 6: Diameter EAP command codes used for MIPv6 Bootstrapping HA
                             to HAAA Interface

6.1.1.  Diameter-EAP-Request (DER)

   The Diameter-EAP-Request (DER) message [8], indicated by the Command-
   Code field set to 268 and the 'R' bit set in the Command Flags field,
   is sent by the HA to the Diameter server to initiate a Mobile IPv6
   service authentication and authorization procedure.  The DER message
   format is the same as defined in [8].  The Application-ID field of
   the Diameter Header MUST be set to the Diameter Mobile IPv6
   Application ID [TO BE ASSIGNED TO IANA].


     <Diameter-EAP-Request> ::= < Diameter Header: 268, REQ, PXY >
                                < Session-Id >
                                { Auth-Application-Id }
                                { Origin-Host }
                                { Origin-Realm }
                                { Destination-Realm }
                                { Auth-Request-Type }
                                [ Destination-Host ]
                                [ NAS-Identifier ]
                                [ NAS-IP-Address ]
                                [ NAS-IPv6-Address ]
                                [ NAS-Port-Type ]
                                [ User-Name ]
                                { EAP-Payload }

                                [ MIP6-Feature-Vector ]
                                [ MIP-Mobile-Node-Address ]

                                ...
                              * [ AVP ]

6.1.2.  Diameter-EAP-Answer (DEA)

   The Diameter-EAP-Answer (DEA) message defined in [8], indicated by
   the Command-Code field set to 268 and 'R' bit cleared in the Command
   Flags field, is sent in response to the Diameter-EAP-Request message
   (DER).  If the Mobile IPv6 authentication procedure was successful
   then the response MAY include any set of bootstrapping AVPs.




Bournelle, et al.        Expires January 9, 2008               [Page 12]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   The DEA message format is the same as defined in [8].  The
   Application-Id field in the Diameter header MUST be set to the
   Diameter Mobile IPv6 Application-Id [TO BE ASSIGNED BY IANA].


     <Diameter-EAP-Answer> ::= < Diameter Header: 268, PXY >
                               < Session-Id >
                               { Auth-Application-Id }
                               { Auth-Request-Type }
                               { Result-Code }
                               { Origin-Host }
                               { Origin-Realm }

                               [ User-Name ]
                               { EAP-Payload }
                               [ Authorization-Lifetime ]

                               [ MIP-Mobile-Node-Address ]
                               [ MIP6-Feature-Vector ]

                               ...
                             * [ AVP ]

6.2.  Command Codes for RFC 4285 Support

   This section defines Command-Code [5] values that MUST be supported
   by all Diameter implementations conforming to this specification.
   The following Command Codes are defined in this specification.


      Command-Name             Abbreviation    Code           Section
      ------------------------------------------------------------------
      MIP6-Request-Message         MRM         TBD         Section 6.2.1
      MIP6-Answer-Message          MAM         TBD         Section 6.2.2

6.2.1.  MIP6-Request-Message

   The MIP6-Request-Message (MRM), indicated by the Command-Code field
   set to TBD and the 'R' bit set in the Command Flags field, is sent by
   the HA, acting as a Diameter client, in order to request the
   authentication and authorization of a MN.  The HA uses information
   found in the Binding Update to construct the following AVPs, to be
   included as part of the MRM:

   o  Home Address (MIP-Mobile-Node-Address AVP)
   o  Mobile Node NAI (User-Name AVP [5])





Bournelle, et al.        Expires January 9, 2008               [Page 13]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   o  MN-AAA Authentication Extension (MIP-MN-AAA-Auth AVP)

   If the MN's home address is zero, the HA MUST NOT include a MIP-
   Mobile-Node-Address AVP.

   If the MN's home address is all ones, the HA MUST include a MIP-
   Mobile-Node-Address AVP, set to all ones.

   The message format is shown below:


           <MIP6-Request-Message> ::= < Diameter Header: XXX, REQ, PXY >
             < Session-ID >
             { Auth-Application-Id }
             { User-Name }
             { Destination-Realm }
             { Origin-Host }
             { Origin-Realm }
             [ Acct-Multi-Session-Id ]
             [ Destination-Host ]
             [ Origin-State-Id ]
             [ NAS-Identifier ]
             [ NAS-IP-Address ]
             [ NAS-IPv6-Address ]
             [NAS-Port-Type]

             [ MIP6-Feature-Vector ]
             [ MIP-MN-AAA-Auth ]
             [ MIP-Mobile-Node-Address ]

             [ Authorization-Lifetime ]
             [ Auth-Session-State ]
             * [ Proxy-Info ]
             * [ Route-Record ]
             * [ AVP ]

6.2.2.  MIP6-Answer-Message

   The MIP6-Answer-Message (MAM) message, indicated by the Command-Code
   field set to TBD and the 'R' bit cleared in the Command Flags field,
   is sent by the Diameter server in response to the MIP6-Request-
   Message message.  The User-Name MAY be included in the MAM if it is
   present in the MRM.  The Result-Code AVP MAY contain one of the
   values defined in Section 6.2.3.2, in addition to the values defined
   in RFC 3588 [5].

   An MAM message with the Result-Code AVP set to DIAMETER_SUCCESS MUST
   include the MIP-Mobile-Node-Address AVP.  The MIP-Home-Agent-Address



Bournelle, et al.        Expires January 9, 2008               [Page 14]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   AVP contains the HA assigned to the MN, while the MIP-Mobile-Node-
   Address AVP contains the home address that was assigned.

   The message format is shown below:


      <MIP6-Answer-Message> ::= < Diameter Header: XXX, PXY >
               < Session-Id >
               { Auth-Application-Id }
               { Result-Code }
               { Origin-Host }
               { Origin-Realm }
               [ Acct-Multi-Session-Id ]
               [ User-Name ]
               [ Authorization-Lifetime ]
               [ Auth-Session-State ]
               [ Error-Message ]
               [ Error-Reporting-Host ]
               [ Re-Auth-Request-Type ]

               [ MIP6-Feature-Vector ]
               [ MIP-MN-to-HA-MSA ]
               [ MIP-HA-to-MN-MSA ]
               [ MIP-MSA-Lifetime ]
               [ MIP-Session-Key]
               [ MIP-Mobile-Node-Address ]
             * [ MIP-Filter-Rule ]

               [ Origin-State-Id ]
               * [ Proxy-Info ]
               * [ AVP ]

   [Editor's Note: The MIP-Filter-Rule is based on IPFiltrRule, which is
   currently being revised.  Hence, this document should refer to the
   updated functionality.  Furthermore, the requirements document
   indicates that QoS parameters may need to conveyed to the HA.  Hence,
   the revised version of the QoS-Filter-Rule / QoSFilterRule being
   developed with [10] has to be used.]

6.2.3.  Diameter AVPs

   The Diameter client uses AVPs dependent on the usage of RFC 4285 [4]
   or RFC 4877 [3].

   To provide support for RFC 4285 [4] the following AVPs defined in
   [11] are reused in this application:





Bournelle, et al.        Expires January 9, 2008               [Page 15]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   o  MIP-HA-to-MN-MSA AVP,
   o  MIP-MN-to-HA-MSA AVP,
   o  MIP-Session-Key AVP
   o  MIP-Algorithm-Type AVP
   o  MIP-Replay-Mode AVP
   o  MIP-MN-AAA-Auth AVP
   o  MIP-MN-AAA-SPI AVP
   o  MIP-Auth-Input-Data-Length AVP
   o  MIP-Authenticator-Length AVP
   o  MIP-Authenticator-Offset AVP
   o  MIP-MSA-Lifetime AVP
   o  MIP-Mobile-Node-Address (with an IPv6 address)

6.2.3.1.  Accounting AVPs

   This document reuses the accounting AVPs defined in Diameter Mobile
   IPv4 application [11], namely:

   Accounting-Input-Octets:

      Number of octets in IP packets received from the user
   Accounting-Output-Octets:

      Number of octets in IP packets sent by the user
   Accounting-Input-Packets:

      Number of IP packets received from the user
   Accounting-Output-Packets:

      Number of IP packets sent by the user.

6.2.3.2.  Result-Code AVPs

   This section defines new Result-Code [5] values that MUST be
   supported by all Diameter implementations that conform to this
   specification.

   [Editor's Note: This section needs to list the result codes that are
   used by this application.]

6.2.3.3.  AVP Occurence Tables

   The following table describes the Diameter AVPs defined by this
   document; their AVP Code values, types, and possible flag values; and
   whether the AVP MAY be encrypted.






Bournelle, et al.        Expires January 9, 2008               [Page 16]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


6.2.3.3.1.  Support for Mobile IPv6 with IKEv2 and IPsec


                                            +--------------------------+
                                            |    AVP Flag rules        |
                                            +----+-----+----+-----+----+
                   AVP  Defined             |    |     |SHLD| MUST|MAY |
   Attribute Name  Code in       Value Type |MUST| MAY | NOT|  NOT|Encr|
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP-Mobile-                              |    |     |    |     |    |
  |Node-Address    334  RFC4004   Address   | M  |  P  |    |  V  | Y  |
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP6-Feature-                            |    |     |    |     |    |
  |Vector           TBD 4.7.4    Unsigned64 |    |  P  |    | M,V | Y  |
  +-----------------------------------------+----+-----+----+-----+----+

   The MIP6-Feature-Vector is defined in Section 4.7.4 of [12].

6.2.3.3.2.  Support for the Mobile IPv6 Authentication Protocol


                                            +--------------------------+
                                            |    AVP Flag rules        |
                                            +----+-----+----+-----+----+
                   AVP  Section             |    |     |SHLD| MUST|MAY |
   Attribute Name  Code Defined  Value Type |MUST| MAY | NOT|  NOT|Encr|
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP-MN-AAA-Auth  322 RFC4004  Grouped    | M  |  P  |    |  V  | Y  |
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP-Auth-Input-  338 RFC4004  Unsigned32 | M  |  P  |    |  V  | Y  |
  |  Data-Length                            |    |     |    |     |    |
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP-             339 RFC4004  Unsigned32 | M  |  P  |    |  V  | Y  |
  |  Authenticator-Length                   |    |     |    |     |    |
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP-             340 RFC4004  Unsigned32 | M  |  P  |    |  V  | Y  |
  |  Authenticator-Offset                   |    |     |    |     |    |
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP-MN-AAA-SPI   341 RFC4004  Unsigned32 | M  |  P  |    |  V  | Y  |
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP-Mobile-          RFC4004  Address    |    |     |    |     |    |
  |Node-Address     333 7.3                 | M  |  P  |    |  V  | Y  |
  +-----------------------------------------+----+-----+----+-----+----+
  |MIP6-Feature-                            |    |     |    |     |    |
  |Vector           TBD 4.7.4    Unsigned64 |    |  P  |    | M,V | Y  |
  +-----------------------------------------+----+-----+----+-----+----+

   The MIP6-Feature-Vector is defined in Section 4.7.4 of [12].



Bournelle, et al.        Expires January 9, 2008               [Page 17]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


7.  IANA Considerations

   This section contains the namespaces that have either been created in
   this specification or had their values assigned to existing
   namespaces managed by IANA.

7.1.  Command Codes

   This specification reuses the values 260 and 262 from the Command
   Code namespace defined in [5].  See Section 6 for the assignment of
   the namespace in this specification.

7.2.  Result-Code AVP Values

   This specification assigns the values TBD - TBD from the Result-Code
   AVP (AVP Code 268) value namespace defined in [5].  See
   Section 6.2.3.2 for the assignment of the namespace in this
   specification.

7.3.  Application Identifier

   This specification uses the value TBD to the Application Identifier
   namespace defined in [5].


8.  Security Considerations

   The security considerations for the Diameter interaction required to
   accomplish the split scenario are described in in [2].  Additionally,
   the security considerations of the Diameter Base protocol [5],
   Diameter EAP application [8] are applicable to this document.  This
   document does not introduce new security vulnerabilities.


9.  Acknowledgements

   The authors would like to thanks Jari Arkko, Tolga Asversen, Pasi
   Eronen, Santiago Zapata Hernandez, Jouni Korhonen, Anders Kristensen,
   Avi Lior, John Loughney, Ahmad Muhanna and Lionel Morand and
   Yoshihiro Ohba for all the useful discussions.  Jouni Korhonen
   provided a detailed draft review in June 2007.

   Hannes Tschofenig would like to thank the European Commission support
   in the co-funding of the ENABLE project, where this work is partly
   being developed.

   Julien Bournelle would like to thank GET/INT since he began this work
   while he was under their employ.



Bournelle, et al.        Expires January 9, 2008               [Page 18]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


10.  References

10.1.  Normative References

   [1]   Johnson, D., Perkins, C., and J. Arkko, "Mobility Support in
         IPv6", RFC 3775, June 2004.

   [2]   Giaretta, G., "Mobile IPv6 bootstrapping in split scenario",
         draft-ietf-mip6-bootstrapping-split-05 (work in progress),
         May 2007.

   [3]   Devarapalli, V. and F. Dupont, "Mobile IPv6 Operation with
         IKEv2 and the Revised IPsec Architecture", RFC 4877,
         April 2007.

   [4]   Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury,
         "Authentication Protocol for Mobile IPv6", RFC 4285,
         January 2006.

   [5]   Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko,
         "Diameter Base Protocol", RFC 3588, September 2003.

   [6]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", BCP 14, RFC 2119, March 1997.

   [7]   Patel, A. and G. Giaretta, "Problem Statement for bootstrapping
         Mobile IPv6 (MIPv6)", RFC 4640, September 2006.

   [8]   Eronen, P., Hiller, T., and G. Zorn, "Diameter Extensible
         Authentication Protocol (EAP) Application", RFC 4072,
         August 2005.

   [9]   Kaufman, C., "Internet Key Exchange (IKEv2) Protocol",
         RFC 4306, December 2005.

   [10]  Korhonen, J., "Quality of Service Attributes for Diameter and
         RADIUS", draft-ietf-dime-qos-attributes-00 (work in progress),
         July 2007.

   [11]  Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P.
         McCann, "Diameter Mobile IPv4 Application", RFC 4004,
         August 2005.

   [12]  Korhonen, J., "Diameter Mobile IPv6: Support for Network Access
         Server to Diameter Server  Interaction",
         draft-ietf-dime-mip6-integrated-04 (work in progress),
         May 2007.




Bournelle, et al.        Expires January 9, 2008               [Page 19]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


10.2.  Informative References

   [13]  Giaretta, G., "AAA Goals for Mobile IPv6",
         draft-ietf-mip6-aaa-ha-goals-03 (work in progress),
         September 2006.

   [14]  Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury,
         "Mobile Node Identifier Option for Mobile IPv6 (MIPv6)",
         RFC 4283, November 2005.

   [15]  Fajardo, V., "Diameter Applications Design Guidelines",
         draft-ietf-dime-app-design-guide-01 (work in progress),
         June 2007.

   [16]  Hakala, H., Mattila, L., Koskinen, J-P., Stura, M., and J.
         Loughney, "Diameter Credit-Control Application", RFC 4006,
         August 2005.

   [17]  Chowdhury, K. and A. Yegin, "MIP6-bootstrapping for the
         Integrated Scenario",
         draft-ietf-mip6-bootstrapping-integrated-dhc-04 (work in
         progress), June 2007.


Authors' Addresses

   Julien Bournelle
   France Telecom R&D
   38-4O rue du general Leclerc
   Issy-Les-Moulineaux  92794
   France

   Email: julien.bournelle@orange-ftgroup.com


   Gerardo Giaretta
   Qualcomm


   Email: gerardo.giaretta@gmail.com











Bournelle, et al.        Expires January 9, 2008               [Page 20]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


   Hannes Tschofenig
   Nokia Siemens Networks
   Otto-Hahn-Ring 6
   Munich, Bavaria  81739
   Germany

   Email: Hannes.Tschofenig@nsn.com
   URI:   http://www.tschofenig.com


   Madjid Nakhjiri
   Huawei USA
   USA

   Email: mnakhjiri@huawei.com




































Bournelle, et al.        Expires January 9, 2008               [Page 21]

Internet-Draft      Diameter MIP6: HA-to-AAAH Support          July 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Bournelle, et al.        Expires January 9, 2008               [Page 22]


