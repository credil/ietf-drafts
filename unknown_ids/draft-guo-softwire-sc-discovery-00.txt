Network Working Group                                      Dayong Guo 
Internet Draft                                            Sheng Jiang 
Intended status: Standards Track          Huawei Technologies Co., Ltd 
Expires: December 19, 2009                               June 23, 2009 
                                    


               Softwire Concentrator Discovery Using DHCP 
                                    
                 draft-guo-softwire-sc-discovery-00.txt 


Status of this Memo 

   This Internet-Draft is submitted to IETF in full conformance with the 
   provisions of BCP 78 and BCP 79. 

   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups. Note that other 
   groups may also distribute working documents as Internet-Drafts. 

   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at any 
   time. It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress." 

   The list of current Internet-Drafts can be accessed at 
        http://www.ietf.org/ietf/1id-abstracts.txt 

   The list of Internet-Draft Shadow Directories can be accessed at 
        http://www.ietf.org/shadow.html 

   This Internet-Draft will expire on December 19, 2009. 

    

Copyright Notice 

   Copyright (c) 2009 IETF Trust and the persons identified as the 
   document authors. All rights reserved. 

   This document is subject to BCP 78 and the IETF Trust's Legal 
   Provisions Relating to IETF Documents in effect on the date of 
   publication of this document (http://trustee.ietf.org/license-info). 
   Please review these documents carefully, as they describe your rights 
   and restrictions with respect to this document. 

    


 
 
 
Guo & Jiang           Expires December 19, 2009               [Page 1] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

    

Abstract 

   Several types of Carrier-Grade-NATs (CGNs) have been proposed to 
   simplify IPv4/IPv6 transition of the edge network by integrating 
   tunnels and NAT. A very common scenario is that many users set up 
   softwires (i.e. tunnels) to a softwire concentrator for public or 
   private access services. In order to establish softwires successfully, 
   a new mechanism is required to enable users in the edge network to 
   discover the information of the concentrator. This document describes 
   how a host or CPE (Customer Premises Equipment) discovers the remote 
   softwire concentrator or CGN in a hub and spoke network using DHCP. 
   Based on two new Softwire Concentrator or CGN Discovery DHCP Options, 
   proposed in the document, a user can obtain softwire concentrator or 
   CGN information and then set up a tunnel to the softwire concentrator 
   or CGN. 

    

Table of Contents 

   1. Introduction................................................3 
   2. DHCP Solution for Softwire Concentrator Discovery............4 
      2.1. DHCPv4 Softwire Concentrator Discovery (SCD) Option......4 
      2.2. DHCPv6 Softwire Concentrator Discovery (SCD) Option......5 
   3. Security Considerations......................................7 
   4. IANA Considerations.........................................7 
      4.1. DHCPv4 SCD Option SC Types..............................7 
      4.2. DHCPv6 SCD Option SC Types..............................7 
      4.3. Tunnel Types...........................................8 
   5. Acknowledgments.............................................8 
   6. References..................................................8 
      6.1. Normative References....................................8 
      6.2. Informative References..................................8 
   Author's Addresses............................................10 
    









 
 
Guo & Jiang           Expires December 19, 2009               [Page 2] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

    
1. Introduction 

   Transition is an important factor for user experience in IPv4 and 
   IPv6 coexistence phase. The transition of the edge network is the 
   most complicated because it is near lots of users and uses multiple 
   network technologies. Recently, several types of Carrier-Grade-NATs 
   (CGNs) have been proposed to simplify IPv4/IPv6 transition of the 
   edge network by integrating tunnels and NAT. Incremental CGN 
   [Incremental CGN] describes how dispersed IPv6 users bridge with the 
   IPv6 Internet by tunnel spanning ipv4 infrastructure. The dual-stack 
   lite technology [Ds-lite CGN] is intended for maintaining 
   connectivity to legacy IPv4 devices and networks using IPv4-over-IPv6 
   softwires while a service provider deploys an IPv6-only network. A 
   very common scenario is that many users set up softwires or tunnels 
   to a softwire concentrator for public or private access services.  

   In order to establish a softwire successfully, users must know the 
   information of a softwire concentrator or CGN, such as address, 
   tunnel type, protocol type in tunnel. Additionally, the discovery 
   process may also support load-sharing and recovery from a single 
   point of failure. 

   The aforementioned scenarios have been abstracted as hub and spoke 
   networks in the IETF Softwire working group, and several 
   encapsulation techniques have been defined [RFC4925] [RFC5512] 
   [RFC5571] discloses a mechanism in mesh network by BGP extension for 
   users to discover the information of a tunnel end point. However, the 
   nodes in an edge network do not have BGP capability generally. Manual 
   configuration is not suitable because the address and other attribute 
   of the concentrator may change. A new mechanism is required to enable 
   users in edge network to discover the information of the concentrator 
   automatically. 

   The Dynamic Host Configuration Protocol (DHCP [RFC2131], [RFC3315]) 
   is widely used in edge networks to enable auto-configuration. This 
   document extends DHCP to support discovery of a softwire concentrator 
   or CGN. This mechanism is general for incremental CGN, DS-Lite and 
   Port-range Router [Port-range, PR-v6]. It can also be extended to 
   support the discovery of other concentrators with tunnels. 

   In the absence of DHCP, PPP or Router Advertisements could be used to 
   find a softwire concentrator or CGN automatically, but this document 
   does not discuss these methods in detail. 



 
 
Guo & Jiang           Expires December 19, 2009               [Page 3] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

2. DHCP Solution for Softwire Concentrator Discovery 

   In order to support softwire concentrator or CGN discovery, two new 
   DHCP options are defined. 

   When a DHCP server answers a client request message, softwire 
   concentrator information can be carried in a DHCP reply message. Thus 
   a client is configured the address and other attribute of a softwire 
   concentrator or CGN and can automatically set up a tunnel. 

   For load sharing or single-point failure recovery purposes, a DHCP 
   reply message may carry information of more than one softwire 
   concentrators.  

   Section 2.1 defines a new DHCPv4 Softwire Concentrator Discovery (SCD) 
   option while Section 2.2 defines DHCPv6 SCD option. 

2.1. DHCPv4 Softwire Concentrator Discovery (SCD) Option 

   The DHCPv4 Softwire Concentrator Discovery (SCD) Option is mainly 
   used when an IPv6 host or CPE in an IPv4 ISP network wants to obtain 
   an IPv4 address of an IPv6 access point or an incremental CGN. The 
   Option is carried in DHCPv4. 

   A DHCP message may carry more than one SCD Option.  

   The DHCPv4 SCD Option is structured as follows: 

       0                   1                   2                   3 
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |      Code     |      Len      |    SC Type    |   Preference  | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |             Softwire Concentrator or CGN Address              | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |  Tunnel Type  | Protocol Type |          Sub Options          | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 

      Code          TBD1. 

      Len           6 + length of sub options in octets. 

      SC Type       SC type, 0 for softwire concentrator, 1 for  
                    Incremental CGN, 2 for Port-range PRR. 

      Preference    This indicates the preference level for a softwire  
                    concentrator or CGN. 0 is the highest. When  
 
 
Guo & Jiang           Expires December 19, 2009               [Page 4] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

                    receiving multiple options, the user chooses a  
                    primary softwire concentrator among them based on  
                    the preference. The others are backup softwire  
                    concentrators. The service provider assigns  
                    different preference for each softwire concentrator  
                    to support traffic engineering. 

      Softwire Concentrator or CGN Address   The outer layer IPv4  
                    address of softwire concentrator, which is used to  
                    establish tunnel. 

      Tunnel Type   Tunnel type which users connect to softwire  
                    concentrators or CGN. 1 for L2TPv2, 2 for L2TPv3, 3  
                    for GRE, 4 for IP in IP, 5 for IPsec. 

      Protocol Type This designates either IPv4 or IPv6 packet  
                    encapsulated in tunnel, of the types defined in 
                    [IANA-AF] as ETHER TYPEs. 

      Sub Options   An optional, variable length field is used to carry  
                    other information, such as GRE Key. 

2.2. DHCPv6 Softwire Concentrator Discovery (SCD) Option 

   The DHCPv6 Softwire Concentrator Discovery (SCD) Option is mainly 
   used when an IPv4 host or CPE in an IPv6 ISP network wants to learn 
   an IPv6 address of an IPv4 access point or a DS-lite CGN. The Option 
   is carried in DHCPv6. 

   A DHCPv6 Reply message can carry more than one SCD Option.  

   The DHCPv6 SCD Option is structured as follows: 














 
 
Guo & Jiang           Expires December 19, 2009               [Page 5] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

       0                   1                   2                   3 
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |           Option_SCD          |      Option-len               | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                                                               | 
      |             Softwire Concentrator or CGN Address              | 
      |                                                               | 
      |                                                               | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |    SC Type    |   Preference  |  Tunnel Type  | Protocol Type | 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
      |                          Sub Options                          | 
      .                                                               . 
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 

      Option-code   Option_SCD (TBD2). 

      Option-len    20 + length of sub options in octets. 

      Softwire Concentrator or CGN Address   The outer layer IPv6  
                    address of softwire concentrator, which is used to  
                    establish tunnel. 

      SC Type       SC type, 0 for softwire concentrator, 1 for ds-lite  
                    CGN, and 2 for Port-range PRR. 

      Preference    This indicates the preference level for a softwire  
                    concentrator or CGN. 0 is the highest. When  
                    receiving multiple options, user chooses a primary  
                    softwire concentrator among them based on the  
                    preference. The others are backup softwire  
                    concentrators. The service provider assigns  
                    different preference of each softwire concentrator  
                    to support traffic engineering. 

      Tunnel Type   Tunnel type which users connect to softwire  
                    concentrators or CGN. 1 for L2TPv2, 2 for L2TPv3, 3  
                    for GRE, 4 for IP in IP, 5 for IPsec. 

      Protocol Type This designates IPv4 or IPv6 packet encapsulated in  
                    tunnel, of the types defined in [IANA-AF] as ETHER  
                    TYPEs. 

      Sub Options   An optional, variable length field is used to carry  
                    other information, such as GRE Key. 

 
 
Guo & Jiang           Expires December 19, 2009               [Page 6] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

3. Security Considerations 

   The mechanisms based on DHCPv6 are all vulnerable by man-in-middle 
   attacks. Proper use of DHCPv6 autoconfiguration facilities [RFC3315], 
   such as AUTH option or Secure DHCP [SDHCP] can prevent these threats, 
   provided that a configuration token is known to both the client and 
   the server. 

4. IANA Considerations 

   IANA is requested to allocate one DHCPv4 SCD Option code TBD1 and one 
   DHCPv6 Option code TBD2. 

   This document defines three new name spaces: 

      - DHCPv4 SCD Option SC Types 
      - DHCPv6 SCD Option SC Types 
      - Tunnel Types 

4.1. DHCPv4 SCD Option SC Types 

   Section 2.1 defines the following SC Types, which should be assigned 
   by IANA for use within DHCPv4 SCD Option. IANA set up a registry for 
   "DHCPv4 SCD Option SC Types". This is a registry of one-octet values 
   (0-255), to be assigned on a first-come, first-served basis. The 
   initial assignments are as follows: 

      Softwire Concentrator / CGN Name        Type 
      --------------------------------        ----- 
      Softwire concentrator                     0 
      Incremental CGN                           1 
      Port-range PRR                            2 

4.2. DHCPv6 SCD Option SC Types 

   Section 2.2 defines the following SC Types, which should be assigned 
   by IANA for use within DHCPv6 SCD Option. IANA set up a registry for 
   "DHCPv6 SCD Option SC Types". This is a registry of one-octet values 
   (0-255), to be assigned on a first-come, first-served basis. The 
   initial assignments are as follows: 

      Softwire Concentrator / CGN Name        Type 
      --------------------------------        ----- 
      Softwire concentrator                     0 
      DSlite CGN                                1 
      Port-range PRR                            2 

 
 
Guo & Jiang           Expires December 19, 2009               [Page 7] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

4.3. Tunnel Types 

   Section 2.1 & 2.2 defines the following Tunnel Types, which should 
   assigned by IANA for use within DHCPv4 & DHCPv6 SCD Option. IANA set 
   up a registry for "Tunnel Types for DHCP SCD Option". This is a 
   registry of one-octet values (0-255), to be assigned on a first-come, 
   first-served basis. The initial assignments are as follows: 

      Tunnel Name                             Type 
      ---------------                         ----- 
      Reserved                                  0 
      L2TPv2                                    1 
      L2TPv3                                    2 
      GRE                                       3 
      IP in IP                                  4 
      IPsec                                     5 

5. Acknowledgments 

   The authors would like to thank Wei Cao for been involved in the 
   early requirement identification. 

6. References 

6.1. Normative References 

   [RFC2131] R. Droms, "Dynamic Host Configuration Protocol", RFC 2131, 
             March 1997. 

   [RFC3315] R. Droms, et al., "Dynamic Host Configure Protocol for 
             IPv6", RFC3315, July 2003. 

   [RFC5512] P. Mohapatra, E. and Rosen, "The BGP Encapsulation 
             Subsequent Address Family Identifier (SAFI) and the BGP 
             Tunnel Encapsulation Attribute", RFC 5512, April 2009. 

   [RFC5571] B. Storer, et al., "Softwire Hub & Spoke Deployment 
             Framework with L2TPv2", RFC 5571, June 2009. 

6.2. Informative References 

   [RFC4925] X. Li, S. Dawkins, D. Ward, and A. Durand, "Softwire 
             Problem Statement", RFC 4925, July 2007.  




 
 
Guo & Jiang           Expires December 19, 2009               [Page 8] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

   [Ds-lite CGN] A. Durand, R. Droms, B. Haberman, and J. Woodyatt, 
             "Dual-stack lite broadband deployments post IPv4 
             exhaustion", draft-ietf-softwire-dual-stack-lite-00, work 
             in progress, March 2009.  

   [Incremental CGN] S. Jiang, D. Guo, and B. Carpenter, "An Incremental 
             Carrier-Grade NAT (CGN) for IPv6 Transition" draft-jiang-
             v6ops-incremental-cgn-00, work in progress, May 2009 

   [Port-range] B. Storer, et al., "IPv4 Connectivity Access in the 
             Context of IPv4 Address Exhaustion", draft-boucadair-port-
             range-01.txt, work in progress, January 2009. 

   [PR-v6]  M. Boucadair, et al., "Flexible IPv6 Migration Scenarios in 
             the Context of IPv4 Address Shortage", draft-boucadair-
             behave-ipv6-portrange-01, work in progress, March 2009.  

   [IANA-AF] "Address Family Numbers", http://www.iana.org/. 

   [SDHCP]  S. Jiang and S. Shen, "Secure DHCPv6 Using CGAs", draft-
             jiang-dhc-secure-dhcpv6-01.txt, work in progress, January 
             2009. 
























 
 
Guo & Jiang           Expires December 19, 2009               [Page 9] 

Internet-Draft   draft-guo-softwire-sc-discovery-00          June 2009 
    

Author's Addresses 

   Dayong Guo 
   Huawei Technologies Co., Ltd 
   KuiKe Building, No.9 Xinxi Rd., 
   Shang-Di Information Industry Base, Hai-Dian District, Beijing 100085 
   P.R. China 
   Phone: 86-10-82836077 
   Email: guoseu@huawei.com 
    
   Sheng Jiang 
   Huawei Technologies Co., Ltd 
   KuiKe Building, No.9 Xinxi Rd., 
   Shang-Di Information Industry Base, Hai-Dian District, Beijing 100085 
   P.R. China 
   Phone: 86-10-82836081 
   Email: shengjiang@huawei.com 
    




























 
 
Guo & Jiang           Expires December 19, 2009              [Page 10]