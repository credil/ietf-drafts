<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY rfc1034 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.1034.xml'>
  <!ENTITY rfc2119 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>
  <!ENTITY rfc2181 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2181.xml'>
  <!ENTITY rfc2606 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2606.xml'>
  <!ENTITY rfc2782 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2782.xml'>
  <!ENTITY rfc2821 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2821.xml'>
  <!ENTITY rfc2822 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2822.xml'>
  <!ENTITY rfc4033 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4033.xml'>
  <!ENTITY rfc4034 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4034.xml'>
  <!ENTITY rfc4686 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4686.xml'>
  <!ENTITY rfc4871 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4871.xml'>
  <!ENTITY rfc5016 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5016.xml'>
  <!ENTITY rfc5234 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5234.xml'>
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<?rfc toc="yes" ?>
<?rfc tocindent="yes" ?>
<?rfc tocdepth="2" ?>
<?rfc symrefs="yes" ?>
<?rfc sortrefs="yes"?>
<?rfc iprnotified="no" ?>
<rfc category="std" docName="draft-otis-dkim-adsp-04" ipr="full3978">
  <front>
    <title abbrev="ADSP">DKIM Author Domain Signing Practices (ADSP)</title>
    <author fullname="Douglas Otis" initials="D." surname="Otis">
      <organization>Trend Micro, NSSG</organization>
      <address>
         <postal>
           <street>10101 N. De Anza Blvd</street>
           <city>Cupertino</city>
           <region>CA</region>
           <code>95014</code>
           <country>USA</country>
         </postal>
         <phone>+1.408.257-1500</phone>
         <email>doug_otis@trendmicro.com</email>
       </address>
    </author>

    <date day="25" month="June" year="2008"/>
    <area>Internet Area</area>
    <workgroup>DKIM Working Group</workgroup>

    <keyword>email, e-mail, rfc2822, rfc 2822, rfc822, rfc 822, rfc2821, rfc 2821, rfc821, rfc 821,
      rfc4871, rfc 4871, DKIM, domain keys, domainkeys, ADSP, ADSP, SSP, architecture, mta, user,
      delivery, smtp, submission, email, e-mail, smtp, Internet, mailfrom, mail from, author, return
      address, sender signing, signing practices, key domain, author key domain, author address,
      author domain</keyword>

    <abstract>
      <t>DomainKeys Identified Mail (DKIM) as described in <xref target="RFC4871"/>, defines a
        domain-level authentication framework for email to permit verification of the source and
        contents of messages. This document specifies an adjunct mechanism to aid in assessing
        messages that lack valid DKIM signatures for domains used in the author's address. It
        defines a record that can advertise the extent to which a domain signs outgoing mail that is
        publicly exchanged on SMTP port 25, as described in <xref target="RFC2821"/>. Also, how
        other hosts can access those records.</t>

      <t>Advertisements, defined by this document, may also increase DKIM signature expectations for
        messages received by Mail User Agents (MUAs) or for messages which might have been exchanged
        over protocols other than SMTP. In some circumstances, author domains may wish to have
        accommodations for protocol failures or for mixed public protocol messaging not to be made.</t>

      <t>In addition, DKIM's identity parameters related to the author address are decisive only
        when a corresponding DKIM key local-part template precludes an author address. DKIM in
        conjunction with ADSP is to provide methods for detecting the spoofing of known domains, but
        not for making strong assertions about the identity of the message author.</t>
    </abstract>

  </front>
  <middle>
    <section title="Introduction">
      <t>DomainKeys Identified Mail (DKIM) defines a mechanism by which email messages can be
        cryptographically signed, permitting a Key Domain to claim responsibility for the
        introduction of a message. Receiving hosts can verify the signature by querying the Key
        Domain to retrieve the appropriate public key, and thereby confirming that a message has
        been attested to by a party in possession of the private key and in control of a portion of
        the Key Domain.</t>

      <t>However, the legacy of the Internet is such that not all messages will be signed or will
        retain a valid signature, and that absence of a valid signature on a message is not an
          <spanx style="verb">a priori</spanx> indication of forgery. In fact, during early phases
        of deployment, it is likely that most messages will remain unsigned. However, some domains
        might decide to sign all of their outgoing mail, for example, to better protect their brand
        name. It is desirable for such domains to be able to advertise that fact to other hosts.
        This is the premise of Author Domain Signing Practices (ADSP).</t>

      <t>Receiving hosts implementing this specification ensure greater safety by first inquiring
        into the validity of the SMTP domain before attempting a series of transactions related to
        DKIM validations. The transactions pertaining to this document determine Author Domain
        Signing Practices advertised by the Author Domains. This determination is called ADSP
        Discovery.</t>

      <t>The detailed requirements for Author Domain Signing Practices are given in <xref
          target="RFC5016"/>. This document refers extensively to <xref target="RFC4871"/> and
        assumes the reader is familiar with it.</t>
      <t>
        <list style="hanging">
          <t hangText="Requirements Notation:"> The key words "MUST", "MUST NOT", "REQUIRED",
            "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in
            this document are to be interpreted as described in <xref target="RFC2119"/>
          </t>
        </list>
      </t>
    </section>

    <section title="Language and Terminology">
      <section title="Terms Imported from DKIM Signatures Specification">
        <t>Some terminology used herein is derived directly from <xref target="RFC4871"/>. In
          several cases, references in that document to Sender have been changed to Author here, to
          emphasize the relationship to the Author address(es) in the From: header field described
          in <xref target="RFC2822"/>.</t>

        <t>In addition, <xref target="RFC4871"/> requires that a valid signature having a
          restrictive local-part template, the key's <spanx style="verb">g=</spanx> tag and value,
          must match against an undefined <spanx style="verb">signing address</spanx>. The <spanx
            style="verb">signing address</spanx> could be understood to be the email address
          associated with the signature's <spanx style="verb">on behalf of</spanx> identity which
          would be the <spanx style="verb">i=</spanx> tag and value or its default, but the benefit
          of this check is limited since DKIM signatures are not normally displayed. This document
          seeks to clearly define the <spanx style="verb">signing address</spanx> used in
          conjunction with a restrictive key's local-part template as being the <spanx style="verb"
            >Author Address</spanx>. Briefly, <list style="symbols">

            <t>The <spanx style="verb">local-part</spanx> is the part of an address preceding the
                <spanx style="verb">@</spanx> sign, as defined in <xref target="RFC2822"/> and used
              in <xref target="RFC4871"/>.</t>
          </list></t>
      </section>

      <section title="Valid Signature">
        <t>A <spanx style="verb">Valid Signature</spanx> is any message signature which correctly
          verifies using procedures described in section 6.1 of <xref target="RFC4871"/>.</t>
      </section>

      <section title="Valid Author Signature">
        <t>A <spanx style="verb">Valid Author Signature</spanx> is any message signature which
          correctly verifies using procedures described in section 6.1 of <xref target="RFC4871"/>,
          and where the local-part template, the key <spanx style="verb">g=</spanx> tag and value,
          and the Key Domain, match against the Author Address.</t>
      </section>

      <section title="Key Domain">
        <t>The <spanx style="verb">Key Domain</spanx> is the domain listed in the <spanx
            style="verb">d=</spanx> tag of a Valid Signature.</t>
      </section>

      <section title="Author Key Domain">
        <t>The <spanx style="verb">Author Key Domain</spanx> is the domain listed in the <spanx
            style="verb">d=</spanx> tag of a Valid Author Signature that is at or above the Author
          Domain. The Author Key Domain must match all of its domain components with that of the
          Author Domain. When a referenced Key contains a <spanx style="verb">t=s</spanx> tag and
          value, the Author Key Domain will contain the entire Author Domain for the signature to be
          valid.</t>
      </section>

      <section title="Author Address">
        <t>An <spanx style="verb">Author Address</spanx> is an email address in the From header
          field of a message <xref target="RFC2822"/>. If the From header field contains multiple
          addresses, the message has multiple Author Addresses.</t>
      </section>

      <section title="Author Domain">
        <t>An <spanx style="verb">Author Domain</spanx> is determined by the entire right-hand-side
          of the Author Address (the portion that is to the right of the <spanx style="verb"
          >@</spanx>, excluding the <spanx style="verb">@</spanx> itself).</t>
      </section>

      <section title="Author Domain Signing Practices">
        <t><spanx style="verb">Author Domain Signing Practices</spanx> (or just <spanx style="verb"
            >practices</spanx>) consist of a machine-readable record published at the <spanx
            style="verb">_adsp.</spanx> subdomain of the Author Domain. The ADSP record includes
          statements about outgoing mail practices for messages containing the Author Domain.</t>
      </section>
    </section>

    <section title="Operation Overview">
      <t>Domain owners can publish Author Domain Signing Practices via a distribution service, such
        as the Domain Name System; specific details related to the use of DNS are given in <xref
          target="dnsrep"/>.</t>

      <t>Hosts can obtain Author Domain Signing Practices of the domain(s) specified by the Author
        Domain as described in <xref target="checkproc"/>. If a message has multiple Author
        Addresses, ADSP Discovery SHOULD be performed independently. This standard will not cover
        the consolidation of combined ADSP Discovery results.</t>

      <section title="ADSP Discovery Results Usage">
        <t>A receiving host might obtain varying amounts of useful information through ADSP
          Discovery. Such as:<list style="symbols">

            <t>When a message has a Valid Author Signature, the ADSP Discovery result is of no
              benefit since the message is compliant with any possible ADSP assertion.</t>

            <t>When a message has a Valid Signature that is not also a Valid Author Signature, the
              ADSP Discovery result, in conjunction with the Key Domain of the Valid Signature, is
              directly relevant to message assessment.</t>

            <t>When a message is without a Valid Signature, the ADSP Discovery result at the Author
              Domain is directly relevant to message assessment.</t>
          </list></t>
      </section>

      <section title="ADSP Discovery Results">
        <t>Author Domain Signing Practices Discovery at an Author Domain provide four possible
            results:<list style="symbols">

            <t>Message contains an Author Domain that does not advertise practices.</t>

            <t>Message contains an Author Domain that advertises practices indicating they do not
              ensure messages are initially signed by an Author Key Domain.</t>

            <t>Message contains an Author Domain that advertises practices indicating they ensure
              messages are initially signed by an Author Key Domain.</t>

            <t>Message contains an Author Domain that advertises practices indicating they ensure
              messages are initially signed, and they recommend dismissing messages not signed by an
              Author Key Domain.</t>
          </list></t>
      </section>
    </section>

    <section title="Detailed Description">
      <section title="DNS Representation" anchor="dnsrep">
        <t>Author Signing Practices records are published using the DNS TXT resource record type.
            <list style="hanging">
            <t hangText="NON-NORMATIVE DISCUSSION [to be removed before publication]:"> There has
              been considerable discussion on the DKIM WG mailing list regarding the relative
              advantages of TXT and a new resource record (RR) type. Read the archive for
            details.</t>
          </list></t>

        <t>The RDATA for ADSP resource records is textual in format, with specific syntax and
          semantics relating to their role in describing Author Domain Signing Practices. The <spanx
            style="verb">Tag=Value List</spanx> syntax described in section 3.2 of <xref
            target="RFC4871"/> is to be used. Records not in compliance with that syntax or with the
          syntax of individual tags described in Section 4.3 MUST be ignored, although they MAY
          cause the logging of warning messages via an appropriate system logging mechanism. If the
          RDATA contains multiple character strings, the strings are to be logically concatenated
          with no delimiters placed between the strings.</t>

        <t>The ADSP record for an Author Domain is published at a <spanx style="verb">_adsp.</spanx>
          subdomain directly below the Author Domain; e.g., the ADSP record for <spanx style="verb"
            >example.com</spanx> would be a TXT record that is published at <spanx style="verb"
            >_adsp.example.com</spanx>. A domain MUST NOT publish more than one ADSP record; the
          semantics of an ADSP transaction returning multiple ADSP records for a single domain are
          undefined. (Note that <spanx style="verb">example.com</spanx> and <spanx style="verb"
            >mail.example.com</spanx> are different domains.)</t>
      </section>

      <section title="Publication of ADSP Records">
        <t>Author Domain Signing Practices are intended to apply to all mail containing the Author
          Domain. As a defensive strategy against subdomain spoofing, ADSP records can be placed at
          domains that might appear to support SMTP.</t>

        <t>Wildcards within a domain that is also publishing ADSP records will not pose a problem.
          This is discussed in more detail in <xref target="wildcards"/>.</t>

        <section title="Record Syntax" anchor="syntax">
          <t>ADSP records use the "tag=value" syntax described in section 3.2 of <xref
              target="RFC4871"/>. Terms used to describe signing practices employ a metaphor of a
            door to avoid connotations that might differ from definitions given in this document.</t>

          <t>Tags used in ADSP records are described below. Unrecognized tags MUST be ignored. In
            the ABNF below, the WSP token is imported from <xref target="RFC2822"/>. The ALPHA and
            DIGIT tokens are imported from <xref target="RFC5234"/>. <vspace blankLines="1"/>
            <list style="hanging">

              <t hangText="dkim="> practices (plain-text; REQUIRED). Possible values are as follows:
                  <list style="hanging">
                  <t hangText="OPEN"> (Default) The Author Domain practice permits unsigned outbound
                    mail.</t>

                  <t hangText="CLOSED"> The Author Domain practice always initially signs mail
                    containing the Author Domain by an Author Key Domain.</t>

                  <t hangText="LOCKED"> The Author Domain practice always initially signs mail
                    containing the Author Domain by an Author Key Domain. Furthermore, when a
                    message is received without a Valid Author Signature, receiving hosts are
                    requested to dismiss such messages.</t>
                </list>
                <figure>
                  <preamble>ABNF:</preamble>
                  <artwork name="" type="ABNF" height="" width="" align="center" xml:space="preserve">
      adsp-dkim-tag = %x64.6b.69.6d *WSP "=" 
          *WSP ("OPEN" / "CLOSED" / "LOCKED")
                  </artwork>
                </figure>
              </t>
            </list></t>
        </section>

        <section anchor="checkproc" title="Author Signing Practices Discovery Procedure">
          <t>Hosts performing ADSP Discovery should first exclude SMTP clients with a demonstrated
            history of abuse. Also, the transactions needed for ADSP Discovery or DKIM signature
            validation should be subsequent to some confirmation that the Author Domain might
            support SMTP. In addition, hosts may consider some domains to be exempt, such as Top
            Level Domains (TLDs) listed in <xref target="RFC2606"/>, for example <spanx style="verb"
              >.invalid</spanx>. <xref target="RFC2606"/> does not represent a comprehensive list of
            all possible exempted domains which might also include <spanx style="verb"
            >.local</spanx>, therefore, appending to a list of exempted domains may be required.</t>

          <t>For the purposes of this section, a <spanx style="verb">valid ADSP record</spanx> is
            one that is both syntactically and semantically correct; in particular, it matches the
            ABNF for a <spanx style="verb">tag-list</spanx> and includes a defined <spanx
              style="verb">dkim=</spanx> tag.<list style="hanging">
              <t><spanx>ADSP Discovery.</spanx> The host SHOULD query DNS for a TXT record
                corresponding to the Author Domain prefixed by <spanx style="verb">_adsp.</spanx>
                (note the trailing dot). The results returned by this operation would be the value
                of the <spanx style="verb">dkim</spanx> tag or the value of <spanx style="verb"
                  >MISSING</spanx> when none exist.<vspace blankLines="1"/></t>

              <t hangText="NON-NORMATIVE DISCUSSION:"> Rather than placing ADSP records below the
                  <spanx style="verb">_domainkey.</spanx> prefix used by DKIM, <spanx style="verb"
                  >_adsp.</spanx> prefixed to the Author Domain reduces the number of DNS entities
                needed when ADSP records are desired at every address record. Delegation of a domain
                at or below <spanx style="verb">_domainkey.</spanx> and at <spanx style="verb"
                  >_adsp.</spanx> may be required when consolidating control of DNS entries related
                to DKIM.</t>
            </list></t>

          <t>When any of the DNS transactions involved in ADSP Discovery result in a temporary error
            condition, the algorithm terminates without returning a result; possible actions include
            queuing the message or returning an SMTP error indicating a temporary failure.</t>
          <t>
            <list style="hanging">
              <t hangText="NON-NORMATIVE NOTE:"> Within a DNS transaction, as defined by <xref
                  target="RFC1034"/> section 5.2.2 and <xref target="RFC4034"/> section 3, when a
                CNAME is returned, the alias name is to be processed as if it were the initial name.
                  <xref target="RFC2181"/> section 10.3 makes an exception for Exchange host names
                returned by MX records. An Exchange host name must not return a CNAME.</t>
            </list>
          </t>
        </section>

      </section>
    </section>
    <section title="IANA Considerations">
      <t>ADSP introduces the <spanx style="verb">_adsp</spanx> name into currently unregistered name
        space. Although domain names beginning with an underscore will not collide with host names,
        service names for <xref target="RFC2782"/> SRV records and labels for TXT records, defined
        by other protocols, reference underscore prefixed names to designate specific use. <list
          style="hanging">
          <t hangText="INFORMATIVE NOTE [to be removed before publication]:"> If at the time of
            publication no registry has been established or is planned for underscore prefixed
            names, this section may be removed.</t>
        </list></t>
    </section>

    <section title="Security Considerations">
      <t>Security considerations in the Author Domain Signing Practices mostly relate to attempts on
        the part of malicious senders to represent themselves as sending messages from the Author
        Domain for whom they are not authorized to use in their message. This is often done in an
        attempt to defraud recipients of the message.</t>

      <t>DKIM keys with a restrictive local-part template in the <spanx style="verb">g=</spanx> tag
        and value are likely to be employed for untrusted systems that are beyond the direct control
        of the Author Key Domain. As a result, additional care should be taken when a restrictive
        local-part template does not match against the Author Address. Signatures, where a
        restrictive local-part key <spanx style="verb">g=</spanx> tag and value and the Key Domain
        do not match against the Author Addresses, should be considered invalid.</t>

      <t>Signatures with restrictive local-part keys where the signing address is not that of the
        Author Address will be deceptive when marked as valid. Recipients are often unaware of the
        signature's <spanx style="verb">on behalf of</spanx> identity that is not normally
        displayed. In addition, these keys are prone to theft since they are also likely to be used
        by less secure mobile users, for example.</t>

      <t>Signatures with DKIM keys lacking a restrictive local-part template are only safely added
        when the Author Key Domain is able to directly evaluate signed header fields and content.
        Recognition of directly controlled signing improves security in several ways:<list
          style="hanging">
          <t>Discerns potentially deceptive signatures independent of ADSP Discovery.</t>
          <t>Permits the accurate indication of on whose behalf the signature was added, even when
            not on behalf of the Author Address.</t>
          <t>Permits the <spanx style="verb">on behalf of</spanx> identity to be derived from an
            account instead of being omitted when the Author Key Domain is unable or unwilling to
            affirm the identity of the Author Address.</t>
          <t>Permits the identity to track either the author or the account used. This ability can
            be useful to third-parties who are attempting to isolate bot-net 0wned systems. In
            response to a growing portion of the IP address space being blocked, bot-nets
            increasingly send their mail through a provider's outbound server after obtaining access
            to valid accounts.</t>
        </list></t>

      <t>Additional security considerations regarding Author Domain Signing Practices are found in
          <xref target="RFC4686">the DKIM threat analysis</xref>.</t>

      <section title="ADSP Threat Model">
        <t>Email recipients often have a core set of Author Domains that they trust. Common examples
          include those of financial institutions with which they have an existing relationship and
          Internet web commerce sites with which they conduct business. DKIM validation and ADSP
          Discovery results will not provide any benefit unless receiving hosts either treat the
          messages differently during delivery, or provide some indicator to the end recipient. Such
          email annotation is out of scope for this document.</t>

        <t>Bad actors often seek to exploit the name-recognition of a trusted Author Domain. This
          might be done by just spoofing display-names, or by placing user local-parts above
          subdomains or cousin domains in the From: header field. This problem is made worse by
          popular MUAs that do not display actual email addresses. As a result, there is no
          empirical evidence showing to what extent unauthorized use of a domain name contributes to
          recipient deception, nor that its elimination will provide a significant effect.
          Nevertheless, the automated accrual of behavioural feedback that ignores invalid
          identifiers better ensures that systematic confidence is retained for trusted Author Key
          Domains.</t>

        <t>Training recipients to use automated folder placement could also help reduce deceptions
          that utilize domain look-alike and subdomain based tactics. In addition, automated
          recognition facilitates optimized processing by receiver-side message filtering engines
          that attempt to curb unauthorized uses of domain names, organizations' names, and their
          logos elsewhere within the message. These attacks and their mitigation are also outside
          the scope of this document.</t>

        <t>The ADSP Discovery algorithm performs one DNS transaction per Author Domain. Since this
          transaction, as well as the ones needed to validate the DKIM signature, are driven by
          domain names in email message headers of possibly fraudulent email, receiving hosts
          attempting ADSP Discovery and DKIM validation can become participants in traffic
          multiplication attacks.</t>

        <t>These attacks often target servers consolidating and distributing behavioral information
          about bad-actor activities. Such attacks may dramatically impact the cost of offering the
          protective service. As a result, a reduction in number of those offering consolidated
          behavioral information places the remaining providers in greater jeopardy of receiving a
          larger portion of the abuse.</t>
      </section>

      <section title="DNS Attacks">
        <t>An attack might be waged against DNS infrastructure in an attempt to disable services
          dependent upon DNS. Such attacks could be made worse when receiving hosts employ ADSP
          Discovery and DKIM validation. A goal to <spanx style="verb">First, do no harm</spanx> is
          increasingly difficult to achieve when confronting massive bot-nets. For this reason, SMTP
          should consider eventually making MX records mandatory for the acceptance of public
          exchanges. The ADSP Discovery process is not expected to impact the likelihood of an
          attacker being successful at poisoning local DNS resolvers. In addition, such DNS security
          issues are addressed by <xref target="RFC4033">DNSSEC</xref>.</t>

        <t>Although a steady attack may not cause a denial of service, it can consume significant
          resources related to <spanx style="verb">in the cloud</spanx> consolidation and
          distribution of behavioral information. A typical strategy used by bad actors employing
          bot-nets is to rapidly transition from an active to a dormant state. The duration of
          activity experienced by an SMTP server is often brief, and is then followed by a fairly
          long dormant period. This tactic proves challenging for defensive strategies attempted by
          individual hosts. There is some evidence that there may be tens of millions of bot-net
          controlled systems in the active state, while hundreds of millions appear dormant to
          individual SMTP servers.</t>

        <t>Consolidating and distributing behavioral information offers receiving hosts a defensive
          tactic that can minimize the effectiveness of the blitzkrieg or fast-flux tactic.
          Unfortunately, often part of a bad-actor's strategy is to inundate behavioral repositories
          with virtual identifiers. For DKIM, the signature's identity, <spanx style="verb"
          >i=</spanx> tag and value, and key selector, <spanx style="verb">s=</spanx> tag and value,
          can be synthesized since wildcard domain support is possible, unlike for the Key Domain
            <spanx style="verb">d=</spanx> tag and value, or the location of the ADSP record.</t>

        <t>Because ADSP operates within the framework of the legacy e-mail system, the default
          result in the absence of an ADSP record is for the Author Domain to be considered <spanx
            style="verb">OPEN</spanx> where not all messages are expected to be signed by a Author
          Key Domain. It is therefore important that the ADSP clients distinguish a DNS failure such
          as <spanx style="verb">SERVFAIL</spanx> from other DNS errors, so that appropriate actions
          can be taken.</t>

        <t>It is likely that DKIM's and ADSP's combined roles will be to prevent deception when used
          in conjunction with automated folder placement of domains considered trustworthy. To
          ensure message reception remains viable for crucial systems when DNS fails, the IP
          addresses of crucial SMTP clients should be white-listed. This will allow ADSP and DKIM to
          be selectively bypassed during such events.</t>
      </section>

      <section title="DNS Wildcards" anchor="wildcards">
        <t>With the exception of wildcard MX records, wildcards within a domain that also publish
          ADSP records do not pose a significant problem. Although referencing SMTP related records
          will not provide <spanx style="verb">NXDOMAIN</spanx> results when a domain contains a
          wildcard, SMTP discovery records, such as MX or A records, still offer evidence of SMTP
          support. Whether AAAA records, absent MX or A records, can be considered evidence of SMTP
          support has not withstood widespread use of AAAA only servers.<vspace blankLines="1"/></t>
        <t>
          <list style="hanging">
            <t hangText="NON-NORMATIVE NOTE:"> Complete ADSP coverage for all subdomains of a domain
              remains possible. However, ADSP records would need to be published at every subdomain
              containing A records, in addition to subdomains containing MX records. When SMTP
              adopts an MX record mandate for the acceptance of public exchanges, only then could
              ADSP records be limited to subdomains containing the MX records. This strategy would
              also shelter domains not publishing MX records from the additional transactions
              associated with any number of Author Addresses and DKIM signatures that might be
              generated per message.</t>
          </list>
        </t>
      </section>
    </section>
  </middle>
  <back>
    <references title="References - Normative"> &rfc1034; &rfc2119; &rfc2181;
      &rfc2606; &rfc2821; &rfc2822; &rfc4033; &rfc4034; &rfc4686;
      &rfc4871; &rfc5234; </references>
    <references title="References - Informative"> &rfc2782; &rfc5016; </references>

    <section title="Usage Examples">
      <t>These examples are intended to illustrate typical uses of ADSP. They are not intended to be
        exhaustive, nor to apply to every domain's or mail system's individual situation.</t>

      <t>Administrators are advised to consider the ways that mail processing can modify messages in
        a manner that will invalidate existing DKIM signatures, such as mailing lists, courtesy
        forwarders, and other paths that could add or modify headers, or modify the message body. In
        that case, if these modifications invalidate DKIM signatures, receiving hosts will consider
        the mail not to have a Valid Author Signature, even though one was present when the mail was
        originally sent.</t>

      <section title="Single Location Domains">
        <t>A common mail system configuration handles all of a domain's users' incoming and outgoing
          mail through a single MTA or group of MTAs. In that case, the MTA(s) can be configured to
          sign outgoing mail with an Author Signature.</t>

        <t>In this situation, it might be appropriate to publish a <spanx style="verb"
          >CLOSED</spanx> ADSP record for the Author Domain, depending on whether users also send
          mail through other paths that do not apply an Author Key Domain signature. Such paths
          could include MTAs at hotels or hotspot networks used by travelling users, or web sites
          that provide <spanx style="verb">mail an article</spanx> features.</t>
      </section>

      <section title="Bulk Mailing Domains">
        <t>Another common configuration uses a domain solely for bulk or broadcast mail, with no
          individual human users, again, typically sending all the mail through a single MTA or
          group of MTAs that can apply an Author Key Domain signature. In this case, before
          publishing a <spanx style="verb">CLOSED</spanx> ADSP record, the domain's management
          should be confident that all of its outgoing mail will be sent through signing MTAs.
          Because it lacks individual users, the domain is unlikely to participate in mailing lists,
          but could still send mail through other paths that might invalidate signatures.</t>

        <t>Domain owners often use specialist mailing providers to send their bulk mail. In that
          case, the mailing provider needs access to a suitable signing key in order to apply an
          Author Key Domain signature. One possible method would be for the Author Key Domain owner
          to exchange keys with the mailing provider. Another would be for the Author Key Domain to
          delegate a subdomain below the <spanx style="verb">_domainkey.</spanx> label to the
          mailing provider. For example, <spanx style="verb">bigbank.example.com</spanx> might
          delegate <spanx style="verb">esp-00._domainkey.bigbank.example.com</spanx> to such a
          provider. As a result, the provider could generate keys and DKIM DNS records itself and
          thereby provide Author Key Domain signatures.</t>
      </section>

      <section title="Commonly Forged Transactional Messages">
        <t>In some cases, a domain might sign all its outgoing mail with an Author Key Domain
          signature, but prefer that receiving host systems dismiss mail without a valid Author Key
          Domain signature to avoid confusion with mail sent from fraudulent sources that are unable
          to apply an Author Key Domain signature. (This latter kind of mail is sometimes loosely
          called "forgeries".) In that case, it might be appropriate to publish a "LOCKED" ADSP
          record. Note that a domain SHOULD NOT publish a <spanx style="verb">LOCKED</spanx> ADSP
          record when it wishes to maximize the likelihood that its mail is delivered, since it
          could cause some fraction of the mail to become rejected or discarded.</t>
        <t>As a special case, if a domain sends no mail at all, it can safely publish a <spanx
            style="verb">LOCKED</spanx> ADSP record, since any mail with this Author Domain would be
          a forgery.</t>
      </section>
      <section title="Third Party Senders">
        <t>Another common use case is for a third party to enter into an agreement whereby that
          third party will send bulk or other mail on behalf of a designated Author Domain, using
          that domain in the RFC2822 From: or other headers. Due to the many and varied complexities
          of such agreements, third party signing is not addressed in this specification.</t>
      </section>
    </section>

    <section title="Acknowledgements">
      <t>This document was based upon the draft-ietf-dkim-ssp-003. Dave Crocker, Frank Ellermann,
        and Charles Lindsey inputs were valuable. However, inclusion of their names should not be
        misconstrued as an endorsement of this draft. This draft is an individual submission
        intended to illustrate a comprehensive solution that might help foreclose protracted debate
        when there is otherwise general agreement.</t>
    </section>

    <section title="Update History">
      <section title="Changes to draft-otis-dkim-adsp-00">
        <t>
          <list style="symbols">
            <t>Conditioned Author Signing Practices Discovery Procedure SMTP verification step to be
              made only when an MX record had not been found.</t>
          </list>
        </t>
      </section>
      <section title="Changes to draft-otis-dkim-adsp-01">
        <t>
          <list style="symbols">
            <t>Modified the Author Signing Practices Discovery Procedure to better conform with
              terms in RFC2821. In addition, a note now covers the issue of CNAMEs.</t>
          </list>
        </t>
      </section>
      <section title="Changes to draft-otis-dkim-adsp-02">
        <t>
          <list style="symbols">
            <t>Modified the abstract to include the language recommended by Dave Crocker, clarified
              the relationship this document has with DKIM, SMTP and other protocols, and clarified
              the extent of DKIM identity parameter. The general language describing the intent was
              taken from the WG charter.</t>
            <t>Included non retention of a valid signature and offered an admonishment to first
              validate from domain in the introduction.</t>
            <t>Added a separate definition for Valid Author Signatures by including the requirement
              the local-part template must match against the author addresses.</t>
            <t>Made a few minor changes to the Author Key Domain definition.</t>
            <t>Included the phrase "related to the use of DNS" to the operation Overview as well as
              expanding upon the term ADSP Discovery in several places.</t>
            <t>Modified ADSP Usage to Discovery Results Usage. The information provided was
              reorganized from least to most useful.</t>
            <t>Modified the terms in ADSP Discovery Results to be consistent with advertised
              practices to align more closely with Dave Crocker's Abstract.</t>
            <t>The Record syntax now mentions the terms used are a metaphor for a door, and the
              terms modified to be in closer alignment with the abstract.</t>
            <t>The ADSP Discovery procedure now warns about unlimited application of this process,
              and suggests some domains may require exemption, and introduces the term MISSING when
              no ADSP record is discovered.</t>
            <t>The IANA considerations where shortened based upon the assumption a registry may not
              be established for underscore prefixed TXT records.</t>
            <t>Change the beginning of the security section to clarify the domain and not the author
              identity is assured by DKIM and ADSP.</t>
            <t>Changed the wording related to the key "g=" parameter to be more consistent
              throughout the document.</t>
            <t>Mention in the threat model annotation is required, but is out of scope.</t>
            <t>Modified the paragraph that describes exploitation of trust to be about the domain
              and not the author identity.</t>
            <t>Mention that the target of an attack is often directed to behavioral information
              services.</t>
            <t>Add paragraph describing the typical nature of bot-net behaviour, and how the DKIM
              "i=" represents a significant vulnerability for the accrual of behavioral information.</t>
            <t>Add a sentence to highlight benefits using automatic folder placement.</t>
            <t>Expanded the DNS wildcard section to generally describe what might be involved when
              validating the domain's support of SMTP.</t>
          </list>
        </t>
      </section>
      <section title="Changes to draft-otis-dkim-adsp-03">
        <t>
          <list style="symbols">
            <t>Clarify the definition of signing address when used in conjunction with restrictive
              local-part templates by adding a paragraph to Section 2.1.</t>
            <t>Modified the list in Section 3.2 to include the case where the Author Domain has no
              ADSP record.</t>
            <t>Give examples in Section 4.2.2 regarding possibly exempt TLDs.</t>
            <t>Expand upon the recognition of direct versus indirect control of the DKIM signing
              process, and how this relates to the use of the "on behalf of" identity by adding two
              paragraphs to Section 6.</t>
            <t>Made several minor grammatical changes.</t>
          </list>
        </t>
      </section>
    </section>

  </back>
</rfc>
