


netext                                                            F. Xia
Internet-Draft                                               B. Sarikaya
Intended status: Standards Track                              Huawei USA
Expires: November 22, 2010                                   J. Korhonen
                                                  Nokia Siemens Networks
                                                           S. Gundavelli
                                                                   Cisco
                                                                D. Damic
                                                                 Siemens
                                                            May 21, 2010


                  RADIUS Support for Proxy Mobile IPv6
                   draft-ietf-netext-radius-pmip6-00

Abstract

   This document defines new attributes to facilitate Proxy Mobile IPv6
   operations using the RADIUS infrastructure.  The RADIUS interactions
   between the Mobile Access Gateway and the RADIUS server take place
   when the Mobile Node attaches, authenticates and authorizes to a
   Proxy Mobile IPv6 domain.  Furthermore, this document defines the
   RADIUS-based interface between the Local Mobility Anchor and the
   RADIUS server for authorizing received Proxy Binding Update messages
   for the MN's mobility session.  In addition to the mobility session
   setup related interactions, this document defines the baseline for
   the Mobile Access Gateway and the Local Mobility Anchor generated
   accounting.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 22, 2010.

Copyright Notice




Xia, et al.             Expires November 22, 2010               [Page 1]

Internet-Draft                RADIUS-PMIPv6                     May 2010


   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.



























Xia, et al.             Expires November 22, 2010               [Page 2]

Internet-Draft                RADIUS-PMIPv6                     May 2010


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  Solution Overview  . . . . . . . . . . . . . . . . . . . . . .  5
   4.  Attribute definitions  . . . . . . . . . . . . . . . . . . . .  8
     4.1.  MIP6-Feature-Vector  . . . . . . . . . . . . . . . . . . .  8
     4.2.  Mobile-Node-Identifier . . . . . . . . . . . . . . . . . . 10
     4.3.  PMIP6-Home-LMA-IPv6-Address  . . . . . . . . . . . . . . . 10
     4.4.  PMIP6-Visited-LMA-IPv6-Address . . . . . . . . . . . . . . 11
     4.5.  PMIP6-Home-LMA-IPv4-Address  . . . . . . . . . . . . . . . 12
     4.6.  PMIP6-Visited-LMA-IPv4-Address . . . . . . . . . . . . . . 13
     4.7.  PMIP6-Home-LMA-Identifier  . . . . . . . . . . . . . . . . 14
     4.8.  PMIP6-Visited-LMA-Identifer  . . . . . . . . . . . . . . . 15
     4.9.  PMIP6-Home-HL-Prefix . . . . . . . . . . . . . . . . . . . 16
     4.10. PMIP6-Visited-HL-Prefix  . . . . . . . . . . . . . . . . . 17
     4.11. PMIP6-Home-Interface-ID  . . . . . . . . . . . . . . . . . 18
     4.12. PMIP6-Visited-Interface-ID . . . . . . . . . . . . . . . . 19
     4.13. PMIP6-Home-IPv4-HoA  . . . . . . . . . . . . . . . . . . . 20
     4.14. PMIP6-Visited-IPv4-HoA . . . . . . . . . . . . . . . . . . 21
     4.15. PMIP6-Home-DHCP4-Server-Address  . . . . . . . . . . . . . 22
     4.16. PMIP6-Visited-DHCP4-Server-Address . . . . . . . . . . . . 23
     4.17. PMIP6-Home-DHCP6-Server-Address  . . . . . . . . . . . . . 24
     4.18. PMIP6-Visited-DHCP6-Server-Address . . . . . . . . . . . . 25
     4.19. Service-Selection  . . . . . . . . . . . . . . . . . . . . 26
     4.20. Calling-Station-Id . . . . . . . . . . . . . . . . . . . . 27
   5.  MAG to RADIUS AAA interface  . . . . . . . . . . . . . . . . . 27
     5.1.  General  . . . . . . . . . . . . . . . . . . . . . . . . . 27
     5.2.  Table of Attributes  . . . . . . . . . . . . . . . . . . . 27
   6.  LMA to RADIUS AAA interface  . . . . . . . . . . . . . . . . . 28
     6.1.  General  . . . . . . . . . . . . . . . . . . . . . . . . . 28
     6.2.  Table of Attributes  . . . . . . . . . . . . . . . . . . . 28
   7.  Accounting . . . . . . . . . . . . . . . . . . . . . . . . . . 29
     7.1.  Accounting at LMA  . . . . . . . . . . . . . . . . . . . . 29
     7.2.  Accounting at MAG  . . . . . . . . . . . . . . . . . . . . 29
     7.3.  Table of Attributes  . . . . . . . . . . . . . . . . . . . 29
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . . 30
   9.  IANA consideration . . . . . . . . . . . . . . . . . . . . . . 30
     9.1.  Attribute Type Codes . . . . . . . . . . . . . . . . . . . 30
     9.2.  Namespaces . . . . . . . . . . . . . . . . . . . . . . . . 30
   10. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 31
   11. References . . . . . . . . . . . . . . . . . . . . . . . . . . 32
     11.1. Normative References . . . . . . . . . . . . . . . . . . . 32
     11.2. Informative references . . . . . . . . . . . . . . . . . . 32
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 33






Xia, et al.             Expires November 22, 2010               [Page 3]

Internet-Draft                RADIUS-PMIPv6                     May 2010


1.  Introduction

   Proxy Mobile IPv6 (PMIPv6) [RFC5213] is network based mobility
   management protocol which allows IP mobility session continuity for a
   Mobile Node (MN) without its involvement in mobility management
   signaling.  A Mobile Access Gateway (MAG) represents the MN and is
   authorized to send mobility management signaling messages on behalf
   of the MN.  Before the MAG is able to perform the required mobility
   management signaling, it needs to know at minimum the Local Mobility
   Anchor (LMA) address and the MN Identifier (MN-ID).  This per MN
   Policy Profile (PP) information is stored in a Policy Store (PS),
   which may be local to the MAG or remote accessible, for example,
   through an authentication, authorization and accounting (AAA)
   infrastructure.

   This document defines the RADIUS [RFC2865] based profile and the
   corresponding attributes to be used on the AAA interface between the
   MAG and the RADIUS server.  This interface is used to download the
   per MN Policy Profile from the remote Policy Store to the MAG, at the
   point when MN attaches to a PMIPv6 Domain.  Furthermore, this
   document also defines a RADIUS-based interface between the LMA and
   the RADIUS server for authorization of the received Proxy Binding
   Update (PBU) messages for the mobility service session.  The AAA
   interactions defined in this document cover both deployment models,
   the scenario when the MN connects via the Visited access network, and
   the case when MN directly attaches in its Home network.


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   The terminology in this document is based on the definitions found in
   [RFC5213] and [I-D.ietf-netlmm-pmip6-ipv4-support].  The following
   additional or clarified terms are used in this document:

   Network Access Server (NAS):

      A device that provides the access service for a user to a network.
      In the context of this document the NAS may be integrated into or
      co-located with the MAG.  The NAS device contains the RADIUS
      Client function.







Xia, et al.             Expires November 22, 2010               [Page 4]

Internet-Draft                RADIUS-PMIPv6                     May 2010


   Home AAA (HAAA):

      An Authentication, Authorization, and Accounting (AAA) server
      located in MN's home network.  In scope of this document the HAAA
      corresponds to a RADIUS server that includes the role of the
      PMIPv6 Policy Store.

   Visited AAA (VAAA):

      An Authentication, Authorization, and Accounting (AAA) server
      located in MN's visited network.  In this document the VAAA is the
      AAA server that acts as a RADIUS Proxy when the MN moves or
      attaches through the Visited network.  The VAAA receives an
      authentication (or accounting) request from an AAA client such as
      a NAS, forwards the request to the HAAA server, receives the reply
      from the HAAA, and sends that reply back to the AAA client,
      potentially adding changes to reflect local administrative policy.



3.  Solution Overview

   This document defines the RADIUS-based AAA interactions on two PMIPv6
   interfaces:
   o  between the MAG and the AAA, and
   o  between the LMA and the AAA.

   The Policy Profile is downloaded from the corresponding AAA server to
   the MAG during the MN attachment to the PMIPv6 domain, while the LMA
   seeks authorization from the RADIUS server upon receiving the Proxy
   Binding Update (PBU) messages for the mobility service session.

   When a MN attaches to a PMIPv6 Domain, a network access
   authentication procedure is started.  The choice of the
   authentication mechanism is specific to the access network
   deployment, but could be based on the Extensible Authentication
   Protocol (EAP) [RFC3748].  During the network access authentication,
   the MAG acting as a Network Access Server (NAS) queries the HAAA
   through the AAA infrastructure using RADIUS protocol.  If the HAAA
   detects that the subscriber is authorized for the PMIPv6 services,
   the policy profile including the PMIPv6-specific information is
   returned along with the successful network access authentication
   answer to the MAG.

   After the MN has been successfully authenticated, the MAG sends a PBU
   to the LMA based on the MN's policy profile information.  Upon
   receiving the PBU, the LMA interacts with the HAAA, and fetches the
   relevant portion of the subscriber policy profile and authorization



Xia, et al.             Expires November 22, 2010               [Page 5]

Internet-Draft                RADIUS-PMIPv6                     May 2010


   information for the mobility service session.

   This document adds support for three distinct MN's mobility use
   cases, taking into account the administrative domains to which the
   attended MAG and the LMA belong to.  The observed network topologies
   are identified by following conditions:
   1.  the MAG and LMA are both in the home network,
   2.  the MAG and LMA are both in the visited network, or
   3.  the MAG is in the visited network while the LMA is in the home
       network.

   Figure 1 shows participating network entities for the PMIPv6 mobility
   session which are located in the home network.  The MAG and LMA
   interact only with the HAAA.


       +--------+
       | HAAA & |  RADIUS  +-----+
       | Policy |<-------->| LMA |
       | Profile|          +-----+
       +--------+             | <--- LMA-Address
            ^                 |
            |               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // <- Tunnel1  \\ <- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +---->|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                     |                 |
                   [MN1]             [MN2]


          Figure 1: The MAG and LMA are both in the home network

   Figure 2 shows both the LMA and the MAG are in the visited network.
   The MAG and LMA exchange signaling with the HAAA through the VAAA
   which acts as a Proxy.  The visited network may append additional
   information to the replies from HAAA to the MAG and LMA in order to
   reflect the local policy.





Xia, et al.             Expires November 22, 2010               [Page 6]

Internet-Draft                RADIUS-PMIPv6                     May 2010


                       +---------------+
                       |    HAAA &     |
            +----------| Policy Profile|
            |          +---------------+
            |
       +--------+
       | VAAA & |  RADIUS  +-----+
       | Policy |<-------->| LMA |
       | Profile|          +-----+
       +--------+             | <--- LMA-Address
            ^               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // <- Tunnel1  \\ <- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +---->|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                   [MN1]             [MN2]


         Figure 2: The MAG and LMA are both in the visited network

   Figure 3 illustrates topology where MAG resides in the visited
   network while the LMA is associated from MN's home network.  Any
   message between the MAG and the HAAA passes through the VAAA that
   acts as a Proxy.  During the network authentication, the visited
   network's specific policy may also be downloaded from the VAAA to the
   MAG.  The LMA has a direct access the HAAA.

















Xia, et al.             Expires November 22, 2010               [Page 7]

Internet-Draft                RADIUS-PMIPv6                     May 2010


                       +---------------+
                       |    HAAA &     |
            +----------| Policy Profile|
            |          +---------------+
            |                 |
            |               RADIUS
       +--------+             |
       | VAAA & |          +-----+
       | Policy |          | LMA |
       | Profile|          +-----+
       +--------+             | <--- LMA-Address
            ^               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // <- Tunnel1  \\ <- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +---->|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                   [MN1]             [MN2]


               Figure 3: Only MAG is in the visited network


4.  Attribute definitions

4.1.  MIP6-Feature-Vector

   Diameter [RFC3588] reserves AVP Code space 1-255 as RADIUS attribute
   compatibility space.  The MIP6-Feature-Vector AVP (AVP Code 124)
   defined in [RFC5447] is of type Unsigned64 and contains a 64-bit
   flags field of supported mobility capabilities.  This document
   reserves a new capability bit according to the rules in [RFC5447],
   and reuses the capability bits defined by [RFC5779].  The following
   capability flag bits are used or defined in this document:

   PMIP6_SUPPORTED (0x0000010000000000)

      This is defined in [RFC5779].  When the MAG/NAS sets this bit in
      the MIP6-Feature-Vector attribute, it is an indication to the
      RADIUS AAA that the NAS supports PMIPv6.  When the AAA sets this
      bit in the response MIP6-Feature-Vector AVP, it indicates that the



Xia, et al.             Expires November 22, 2010               [Page 8]

Internet-Draft                RADIUS-PMIPv6                     May 2010


      AAA has PMIPv6 support.  This capability flag bit can also be used
      to allow PMIPv6 mobility support in a subscription granularity.

   IP4_HOA_SUPPORTED (0x0000020000000000)

      This is defined in [RFC5779].  Assignment of the IPv4-HoA is
      supported by [I-D.ietf-netlmm-pmip6-ipv4-support].  When the MAG
      sets this bit in the MIP6-Feature-Vector attribute, it indicates
      that the MAG implements a minimal functionality of a DHCP server
      (and a DHCP relay) and is able to deliver IPv4-HoA to the MN.
      When the RADIUS server sets this flag bit in the response MIP6-
      Feature-Vector attribute, it indicates that the AAA has authorized
      the use of IPv4-HoA for the MN.  When the bit is unset in the
      responding MIP6-Feature-Vector, the AAA does not authorize
      configuration of the IPv4 address.

   LOCAL_MAG_ROUTING_SUPPORTED (0x0000040000000000)

      This is defined in [RFC5779].  When a MAG sets this flag bit in
      the MIP6-Feature-Vector, it indicates that routing IP packets
      between MNs anchored to the same MAG is supported, without reverse
      tunneling packets via the LMA or requiring any Route Optimization
      related signaling.  When the flag bit is unset in the responding
      MIP6-Feature-Vector AVP, the AAA does not authorize direct routing
      capability.  The MAG and AAA SHOULD support this policy feature
      per MN and subscription basis.

   IP4_TRANSPORT_SUPPORTED (0x0000080000000000)

      This document defines the new capability bit for negotiation of
      the IPv4 transport support between the MAG and AAA.  When the MAG
      sets this flag bit in the MIP6-Feature-Vector, it indicates its
      ability to use IPv4 transport (i.e., IPv4-based encapsulation) for
      carrying IP traffic between the MAG and the LMA.  If this flag bit
      is unset in the returned MIP6-Feature-Vector AVP, the AAA does not
      authorize the use IPv4 transport on the MAG-to-LMA tunnel.


   The MIP6-Feature-Vector attribute is also used on the LMA to the
   RADIUS AAA interface.  Using this capability announcement attribute
   it is possible to perform a simple capability negotiation between the
   LMA and the AAA.  Those capabilities that are announced by both
   parties in the MIP6-Feature-Vector are known to be mutually
   supported.  Additionally, the LMA may use this mechanism for the
   particular MN to check PMIPv6 feature permissions while authorizing
   the received PBU against the AAA.





Xia, et al.             Expires November 22, 2010               [Page 9]

Internet-Draft                RADIUS-PMIPv6                     May 2010


4.2.  Mobile-Node-Identifier

   The Mobile-Node-Identifier attribute is of String and contains the
   mobile node identifier (MN-Identifier, see [RFC5213]) in a NAI
   [RFC4282] format.  This AVP is used on the MAG to the RADIUS server
   interface.  The Mobile-Node-Identifier attribute is designed for
   deployments where the MAG does not have a way to find out such MN
   identity that could be used in subsequent PBU/PBA exchanges (e.g.,
   due to identity hiding during the network access authentication) or
   when the HAAA wants to assign periodically changing identities to the
   MN.

   The Mobile-Node-Identifier attribute is returned in the Access-Accept
   message that ends a successful authentication (and possibly the
   authorization) exchange between the MAG and the HAAA, assuming the
   HAAA is also able to provide the MAG with the MN-Identifier in the
   first place.


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Mobile Node Identifier...   ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

     Mobile-Node-Identifier to be defined by IANA.

   Length:

      >= 3 octets

   Mobile Node Identifier:

      This field is of type String and contains the MN-ID
      of the MN to be used in the PBUs.


4.3.  PMIP6-Home-LMA-IPv6-Address

   Before the MAG can engage in Proxy Mobile IPv6 signaling with the
   LMA, it should know the IP address of the LMA either by means of pre-
   configuration, or by dynamically discovering it.  After the MN has
   been successfully authenticated, the MAG can retrieve the IPv6
   address of the LMA by fetching MN's policy profile information from
   the AAA.




Xia, et al.             Expires November 22, 2010              [Page 10]

Internet-Draft                RADIUS-PMIPv6                     May 2010


   When the LMA is located in the home network, this attribute MAY be
   sent by the HAAA to the MAG in an Access-Accept packet.  The
   attribute carries the home LMA IPv6 address being assigned to the
   MAG.


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |    Home LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                                             . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         Home LMA IPv6 address             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

     PMIP6-Home-LMA-IPv6-Address to be defined by IANA.

   Length:

      = 18 octets

   Home LMA IPv6 address:

      128-bit IPv6 address of the assigned home LMA IPv6 address.



4.4.  PMIP6-Visited-LMA-IPv6-Address

   Figure 1 shows the interactions between the MAG, LMA, and HAAA.  When
   the mobile node moves into the visited network, the MAG interacts
   with the HAAA through a visited AAA, and a visited LMA may be
   assigned by the visited AAA during the interaction.

   This attribute MAY be sent by the MAG to the VAAA in an Access-
   Request packet as a proposal by the MAG to allocate the particular
   LMA for the MN.  This attribute MAY be sent by the VAAA to the MAG in
   an Access-Accept packet.  If included in the RADIUS response, the
   attribute carries the IPv6 address of the visited LMA being assigned
   on the MAG for the specific MN.




Xia, et al.             Expires November 22, 2010              [Page 11]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Visited LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                                             . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      Visited LMA IPv6 address             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

     PMIP6-Visited-LMA-IPv6-Address to be defined by IANA.

   Length:

      = 18 octets

   Visited LMA IPv6 address:

      128-bit IPv6 address of the assigned visited LMA IPv6 address.



4.5.  PMIP6-Home-LMA-IPv4-Address

   [I-D.ietf-netlmm-pmip6-ipv4-support] supports Proxy Mobile IPv6
   signaling exchange between the MAG and LMA using the IPv4 transport.
   That is, scenario is supported when LMA and MAG employ IPv4 addresses
   to source the signaling messages, and to establish the IPv4-based
   transport path for the MN's payload.

   The PMIP6-Home-LMA-IPv4-Address attribute contains the IPv4 address
   of the LMA assigned by the HAAA.  When the LMA is located in the home
   network, this attribute MAY be sent by the HAAA to the MAG in an
   Access-Accept packet.











Xia, et al.             Expires November 22, 2010              [Page 12]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home LMA IPv4 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Home LMA IPv4 address       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

     PMIP6-Home-LMA-IPv4-Address to be defined by IANA.

   Length:

      = 6 octets

   Home LMA IPv4 address:

      32-bit IPv4 address of the assigned LMA.



4.6.  PMIP6-Visited-LMA-IPv4-Address

   When the LMA with an IPv4 address is located in the visited network,
   the VAAA may assign this LMA to the MAG during the MN network
   authentication process.

   PMIP6-Visited-LMA-IPv4-Address attribute MAY be included by the MAG
   to VAAA in an Access-Request packet as a proposal to allocate the
   particular LMA to the MN.  The VAAA MAY include this attribute in the
   Access-Accept packet sent to the MAG to indicate authorization of the
   specific network topology.


















Xia, et al.             Expires November 22, 2010              [Page 13]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |    Visited LMA IPv4 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      Visited LMA IPv4 address     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

     PMIP6-Visited-LMA-IPv4-Address to be defined by IANA.

   Length:

      = 6 octets

   IPv4 LMA address:

      32-bit IPv4 address of the assigned LMA.



4.7.  PMIP6-Home-LMA-Identifier

   This attribute carries an identifier of the assigned LMA that is
   located in MN's home network.  The attribute MAY be sent by the HAAA
   to the MAG in an Access-Accept packet.

   The identifier SHOULD be unique in the context of the mobility
   session, and can be used by the MAG to derive additional information
   about the LMA.  The common type of identifier type expected is the
   Fully Qualified Domain Name (FQDN) of the LMA.  The MAG can perform
   DNS query with the FQDN to derive the LMA address.


















Xia, et al.             Expires November 22, 2010              [Page 14]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Identifier of home LMA....
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

      PMIP6-Home-LMA-Identifier to be defined by IANA.

   Length:

      Variable length.

   String:

      The data field contains an appropriate LMA identifier string.
      The format is application specific, unless for FQDN in which case
      format described in RFC 1035 MUST be considered.



4.8.  PMIP6-Visited-LMA-Identifer

   This attribute carries an identifier of the assigned LMA that is
   located in the visited network.  It MAY be sent by the MAG to VAAA in
   an Access-Request packet as a proposal to allocate the particular LMA
   to the MN.  The attribute MAY be sent by the VAAA to the MAG in an
   Access-Accept packet, however MUST be present if the previous Access-
   Request included it.

   The identifier SHOULD be unique in the context of the mobility
   session, and can be used by the MAG to derive additional information
   about the LMA.  The common type of identifier type expected is the
   Fully Qualified Domain Name (FQDN) of the LMA.
















Xia, et al.             Expires November 22, 2010              [Page 15]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Identifier of visited LMA...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

      PMIP6-Visited-LMA-Identifier to be defined by IANA.

   Length:

      Variable length.

   String:

      The data field contains an appropriate LMA identifier string.
      The format is application specific, unless for FQDN in which case
      format described in RFC 1035 MUST be considered.



4.9.  PMIP6-Home-HL-Prefix

   Mobile Node's Home Network Prefix (MN-HNP) is a prefix assigned to
   the link between the MN and the MAG.  The MN configures its IP
   interface from its home network prefix(es).  When the LMA is located
   in the home network, PMIP6-Home-HL-Prefix attribute is used to
   deliver the MN-HNP from the HAAA to the MAG.  The low 64 bits of the
   prefix MUST be set to all zeroes.

   The PMIP6-Home-HL-Prefix attribute is also used on the LMA-to-HAAA
   interface containing the prefix assigned to the MN.  If the LMA
   delegates the MN-HNP assignment to the HAAA, the attribute MUST
   contain all zeroes address (i.e., 0::0) in the request message.  The
   attribute MUST be present in Access-Accept when the prior request
   included it, and SHOULD carry the MN-HNP the HAAA assigned.














Xia, et al.             Expires November 22, 2010              [Page 16]

Internet-Draft                RADIUS-PMIPv6                     May 2010


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Type     |   Length      |   Reserved    | Prefix-Length |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                       Home Link Prefix                        .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Type:

   PMIP6-Home-HL-Prefix to be defined by IANA.

Length:

   = 20 octets.

Reserved:

   Reserved for future use.  The bits MUST be set to zero by the
   sender, and MUST be ignored by the receiver.

Prefix-Length:

   This field indicates the prefix length of the Home Link Prefix (maximum 16 octets).

Home Link Prefix:

   Home link prefix for the MN's IPv6 address configuration.


4.10.  PMIP6-Visited-HL-Prefix

   When the LMA is located in the visited network, PMIP6-Visited-HL-
   Prefix attribute is used to deliver the MN-HNP, from the VAAA to the
   MAG.  The low 64 bits of the prefix MUST be set to all zeroes.

   The PMIP6-Visited-HL-Prefix attribute is also used on the LMA to VAAA
   interface containing the prefix assigned to the MN.  If the LMA
   delegates the assignment of the MN-HNP to the VAAA, the AVP MUST
   contain all zeroes address (i.e., 0::0) in the request message.  The
   attribute MUST be present in Access-Accept when the prior request
   included it, and SHOULD carry the MN-HNP the VAAA assigned.







Xia, et al.             Expires November 22, 2010              [Page 17]

Internet-Draft                RADIUS-PMIPv6                     May 2010


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Type     |   Length      |   Reserved    | Prefix-Length |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                     Visited Home Link Prefix                  .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Type:

   PMIP6-Visited-HL-Prefix to be defined by IANA.

Length:

   = 20 octets.

Reserved:

   Reserved for future use.  The bits MUST be set to zero by the
   sender, and MUST be ignored by the receiver.

Prefix-Length:

   This field indicates the prefix length of the Home Link (maximum 16 octets).

Visited Home Link Prefix:

   Home link prefix for the MN's IPv6 address configuration.


4.11.  PMIP6-Home-Interface-ID

   For Proxy Mobile IPv6 the home link prefixes assigned to the mobile
   node have to be maintained on a per-interface basis.  When the LMA is
   located in the home network, PMIP6-Home-Interface-ID attribute
   conveys 64 bits interface identifier representing a particular MN's
   interface.  The attribute is assigned by the HAAA to the MAG for
   derivation of the MN-HoA.

   This attribute MAY be sent by the LMA or the MAG to the HAAA in an
   Access-Request packet as a proposal.  This attribute MAY be sent by
   HAAA to the LMA in an Access-Accept packet, however MUST be present
   if the prior request included it.






Xia, et al.             Expires November 22, 2010              [Page 18]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       Home Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Home Interface Identifier     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

      PMIP6-Home-Interface-ID to be defined by IANA.

   Length:

      = 10 octets.

   Home Interface Identifier:

      The home interface identifier field is 8 octets.


4.12.  PMIP6-Visited-Interface-ID

   For Proxy Mobile IPv6 the visited link prefixes assigned to the
   mobile node have to be maintained on a per-interface basis.  When the
   LMA is located in the visited network, the attribute conveys 64 bits
   interface identifier representing a particular MN's interface.  The
   attribute is assigned by the VAAA to MAG for the derivation of MN-
   HoA.

   This attribute MAY be sent by the LMA or the MAG to the VAAA in an
   Access-Request packet as a proposal.  This attribute MAY be sent by
   HAAA to the LMA in an Access-Accept packet, however MUST be present
   if the prior request included it.















Xia, et al.             Expires November 22, 2010              [Page 19]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Visited Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       Visited Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Visited Interface Identifier  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:

      PMIP6-Visited-Interface-ID to be defined by IANA.

   Length:

      = 10 octets.

   Visited Interface Identifier:

      The visited interface identifier field is 8 octets.


4.13.  PMIP6-Home-IPv4-HoA

   [I-D.ietf-netlmm-pmip6-ipv4-support] specifies extensions to Proxy
   Mobile IPv6 protocol which enable IPv4 home address mobility support
   to the MN.  The PMIP6-Home-IPv4-HoA attribute is of type Address and
   contains the IPv4-HoA of the MN.  The primary use of this attribute
   is to deliver the assigned IPv4-HoA from HAAA to the MAG.

   The PMIP6-Home-IPv4-HoA is also used on the LMA-to-HAAA interface.
   If the LMA in the home network delegates the assignment of the IPv4-
   HoA to the HAAA, the attribute MUST contain all zeroes address in the
   request message.  The attibute MUST be included in by HAAA in the
   response if the previous request included it, and it contains the
   IPv4-HoA assigned to the MN.














Xia, et al.             Expires November 22, 2010              [Page 20]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |        Home IPv4 HoA
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
            Home IPv4 HoA          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Type:

     PMIP6-Home-IPv4-HoA to be defined by IANA.

   Length:

      = 6 octets

   Home IPv4 HoA:
      This field is of type Address and contains the  IPv4 home
      address of the MN in the home network.


4.14.  PMIP6-Visited-IPv4-HoA

   When both MAG and the LMA are in the visited network, the PMIP6-
   Visited-IPv4-HoA attribute is used to exchange the information about
   the IPv4-HoA assignment to the MN between the VAAA nad the MAG.  This
   attribute is of type Address and used

   The PMIP6-Visited-IPv4-HoA is also used on the LMA-to-VAAA interface.
   If the LMA delegates the assignment of the IPv4-HoA to the VAAA, the
   attribute MUST contain all zeroes address in the request message.
   The Access-Accept message MUST have the attribute present if the
   prior request to VAAA included it, the value should be the IPv4-HoA
   allocated for the MN.
















Xia, et al.             Expires November 22, 2010              [Page 21]

Internet-Draft                RADIUS-PMIPv6                     May 2010


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |        Visited IPv4 HoA
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
           Visited IPv4 HoA        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Type:

     PMIP6-Visited-IPv4-HoA to be defined by IANA.

   Length:

      = 6 octets

   Visited IPv4 HoA:

      This field is of type Address and contains the IPv4 home
      address of the MN in the visited network.


4.15.  PMIP6-Home-DHCP4-Server-Address

   The PMIP6-Home-DHCP4-Server-Address contains the IP address of the
   DHCPv4 server in the home network.  The particular DHCP server is
   indicated to the MAG that serves the attaching MN, and associated
   with its mobility session.  The HAAA MAY assign a DHCP server to the
   MAG in deployments where the MAG acts as a DHCP Relay, as defined in
   [I-D.ietf-netlmm-pmip6-ipv4-support].




















Xia, et al.             Expires November 22, 2010              [Page 22]

Internet-Draft                RADIUS-PMIPv6                     May 2010


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Type     |   Length      |          Reserved             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              Home DHCPv4 server address                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type:

  PMIP6-Home-DHCP4-Server-Address to be defined by IANA.

Length:

   = 8 octets

Reserved:

   Reserved for future use.  The bits MUST be set to zero by the
   sender, and MUST be ignored by the receiver.

Home DHCPv4 server address:

   This field is of type Address and contains a 4-octet IPv4 address of the DHCP server.


4.16.  PMIP6-Visited-DHCP4-Server-Address

   When both MAG and the LMA are in the visited network, the PMIP6-
   Visited-DHCP4-Server-Address attribute provides the IP address of the
   DHCPv4 server in the visited network indicated to the MAG that serves
   the MN.  The VAAA MAY assign a DHCPv4 server to the MAG in
   deployments where the MAG acts as a DHCP Relay, as defined in
   [I-D.ietf-netlmm-pmip6-ipv4-support].
















Xia, et al.             Expires November 22, 2010              [Page 23]

Internet-Draft                RADIUS-PMIPv6                     May 2010


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Type     |   Length      |          Reserved             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              Visited DHCPv4 server address                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type:

  PMIP6-Visited-DHCP4-Server-Address to be defined by IANA.

Length:

   = 8 octets

Reserved:

   Reserved for future use.  The bits MUST be set to zero by the
   sender, and MUST be ignored by the receiver.

Visited DHCPv4 server address:

   This field is of type Address and contains a 4-octet IPv4 address of the DHCPv4
   server


4.17.  PMIP6-Home-DHCP6-Server-Address

   The PMIP6-Home-DHCP6-Server-Address contains the IP address of the
   DHCPv6 server in the home network indicated to the MAG that serves
   the newly attached MN.  The HAAA MAY assign a DHCPv6 server to the
   MAG in deployments where the MAG acts as a DHCP Relay, as defined in
   [RFC5213].
















Xia, et al.             Expires November 22, 2010              [Page 24]

Internet-Draft                RADIUS-PMIPv6                     May 2010


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Type     |   Length      |          Reserved             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                  Home DHCPv6 server address                   .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type:

  PMIP6-Home-DHCP6-Server-Address to be defined by IANA.

Length:

   = 20 octets

Reserved:

   Reserved for future use.  The bits MUST be set to zero by the
   sender, and MUST be ignored by the receiver.

Home DHCPv6 server address:

   This field is of type Address and contains 16-octet IPv6 address of the DHCPv6 server.


4.18.  PMIP6-Visited-DHCP6-Server-Address

   When both MAG and the LMA are located in the visited network, the
   PMIP6-Visited-DHCP6-Server-Address attribute is used to provide the
   IP address of the DHCPv6 server in the visited network to the MAG
   that serves the MN.  The VAAA MAY assign a DHCPv6 server to the MAG
   in deployments where the MAG acts as a DHCP Relay, as defined in
   [RFC5213].














Xia, et al.             Expires November 22, 2010              [Page 25]

Internet-Draft                RADIUS-PMIPv6                     May 2010


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Type     |   Length      |          Reserved             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                  Visited DHCPv6 server address                .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


Type:

  PMIP6-Visited-DHCP6-Server-Address to be defined by IANA.

Length:

   = 20 octets

Reserved:

   Reserved for future use.  The bits MUST be set to zero by the
   sender, and MUST be ignored by the receiver.

Visited DHCPv6 server address:

   This field is of type Address and contains the 16-octet IPv6 address of the DHCPv6 server.


4.19.  Service-Selection

   The Service-Selection attribute contains the name of the service or
   the external network that the mobility service for the particual MN
   SHOULD be associated with.  The AAA MAY return the Service-Selection
   attribute to the MAG and in that way indicate to the MAG the MN's
   default service.  On the LMA-to-AAA interface, the LMA MAY populate
   the Service-Selection attribute in the request message using the
   service information found in the received PBU, if such mobility
   option was included [RFC5149].












Xia, et al.             Expires November 22, 2010              [Page 26]

Internet-Draft                RADIUS-PMIPv6                     May 2010


  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Type     |   Length      |    Service Identifier...      ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

 Type:

   Service-Selection to be defined by IANA.

 Length:

    >= 3 octets

 Service Identifier:
    This field is of type UTF8String and contains the Service Identifier
    the MN is associated with.


4.20.  Calling-Station-Id

   The Calling-Station-Id attribute (31) is of type String and contains
   a Link-Layer Identifier of the MN.  This identifier may correspond to
   a real physical interface identifier or a value that the MAG has
   generated.


5.  MAG to RADIUS AAA interface

5.1.  General

   The MAG to the RADIUS server interface is used for downloading the
   Policy Profile (i.e., for bootstrapping of the Proxy Mobile IPv6
   mobility service session) when a MN tries to attach, authenticate and
   authorize to a PMIPv6 domain.  Whenever the MAG sends a RADIUS
   request message to the AAA server, the User-Name attribute (1) SHOULD
   contain the MN identity.  At minimum, the home realm of the MN MUST
   be available at the MAG when the network access authentication takes
   place.  Otherwise the MAG will not be able to route the RADIUS
   Access-Request messages towards the correct AAA server.  The MN
   identity MUST be in Network Access Identifier (NAI) [RFC4282] format.

5.2.  Table of Attributes

   The following table provides a guide to attributes that may be found
   in authentication and authorization RADIUS messages.





Xia, et al.             Expires November 22, 2010              [Page 27]

Internet-Draft                RADIUS-PMIPv6                     May 2010


   Request   Accept   Reject   Challenge   #    Attribute
   0         0-1      0        0           TBD  PMIP6-Home-LMA-IPv6-Address
   0-1       0-1      0        0           TBD  PMIP6-Visited-LMA-IPv6-Address
   0         0-1      0        0           TBD  PMIP6-Home-LMA-IPv4-Address
   0-1       0-1      0        0           TBD  PMIP6-Visited-LMA-IPv4-Address
   0         0-1      0        0           TBD  PMIP6-Home-LMA-Identifier
   0-1       0-1      0        0           TBD  PMIP6-Visited-LMA-Identifier
   0         0-1      0        0           TBD  PMIP6-Home-HL-Prefix
   0         0-1      0        0           TBD  PMIP6-Visited-HL-Prefix
   0         0-1      0        0           TBD  PMIP6-Home-Interface-ID
   0         0-1      0        0           TBD  PMIP6-Visited-Interface-ID
   0         0-1      0        0           TBD  PMIP6-Home-IPv4-HoA
   0         0-1      0        0           TBD  PMIP6-Visited-IPv4-HoA
   0         0-1      0        0           TBD  PMIP6-Home-DHCP4-Server-Address
   0-1       0-1      0        0           TBD  PMIP6-Visited-DHCP4-Server-Address
   0         0-1      0        0           TBD  PMIP6-Home-DHCP6-Server-Address
   0-1       0-1      0        0           TBD  PMIP6-Visited-DHCP6-Server-Address
   0         1        0        0           TBD  Mobile-Node-Identifier
   0-1       0-1      0        0           124  MIP6-Feature-Vector
   0-1       0-1      0        0           TBD  Service-Selection
   0-1       0        0        0           31   Calling-Station-Id



6.  LMA to RADIUS AAA interface

6.1.  General

   The LMA-to-HAAA interface may be used for multiple purposes.  These
   include the authorization of the incoming PBU, updating the LMA
   address to the HAAA, accounting and PMIPv6 session management.

6.2.  Table of Attributes

   The following table provides a guide to which attributes may be found
   in authentication and authorization process.


   Request   Accept   Reject   Challenge   #    Attribute
   0-1       0-1      0        0           TBD  PMIP6-Home-HL-Prefix
   0-1       0-1      0        0           TBD  PMIP6-Home-IPv4-HoA
   0         0-1      0        0           TBD  PMIP6-Home-Interface-ID
   0-1       0        0        0           TBD  PMIP6-Home-LMA-Identifier
   0-1       0        0        0           TBD  PMIP6-Visited-LMA-Identifier
   0         0-1      0        0           TBD  PMIP6-Visited-Interface-ID
   1         0        0        0           TBD  Mobile-Node-Identifier
   0-1       0-1      0        0           124  MIP6-Feature-Vector
   0-1       0-1      0        0           TBD  Service-Selection



Xia, et al.             Expires November 22, 2010              [Page 28]

Internet-Draft                RADIUS-PMIPv6                     May 2010


   0-1       0        0        0           31   Calling-Station-Id



7.  Accounting

7.1.  Accounting at LMA

   The accounting at the LMA to AAA server interface is based on
   [RFC2865] and [RFC2866].  This interface must support the transfer of
   accounting records needed for service control and charging.  These
   records should include (but may not be limited to): time of binding
   cache entry creation and deletion, number of the octets sent and
   received by the MN over the bi-directional tunnel, etc.

7.2.  Accounting at MAG

   The accounting at the MAG to AAA server interface is based on
   [RFC2865] and [RFC2866].  The interface must also support the
   transfer of accounting records which should include: time of binding
   cache entry creation and deletion, number of the octets sent and
   received by the MN over tge bi-directional tunnel, etc.

   If there is data traffic between a visiting MN and a correspondent
   node that is locally attached to an access link connected to the same
   MAG, the mobile access gateway MAY optimize on the delivery efforts
   by locally routing the packets instead of using reverse tunneling to
   the mobile node's LMA.  In this case, the local data traffic too MUST
   be reported to AAA Accounting servers by means of RADIUS protocol.

7.3.  Table of Attributes

   The following table provides a list of attributes that may be
   included in the RADIUS Accounting messages.


         Request   Interim  Stop     Attribute
         0-1       0        0-1      PMIP6-Home-LMA-IPv6-Address
         0-1       0        0-1      PMIP6-Visited-LMA-IPv6-Address
         0-1       0        0-1      PMIP6-Home-LMA-IPv4-Address
         0-1       0        0-1      PMIP6-Visited-LMA-IPv4-Address
         0-1       0        0-1      PMIP6-Home-HL-Prefix
         0-1       0        0-1      PMIP6-Visited-HL-Prefix
         0-1       0        0-1      PMIP6-Home-IPv4-HoA
         0-1       0        0-1      PMIP6-Visited-IPv4-HoA
         0-1       0        0-1      Service-Selection
         0-1       0        0-1      MIP6-Feature-Vector
         0-1       0-1      0-1      Mobile-Node-Identifier



Xia, et al.             Expires November 22, 2010              [Page 29]

Internet-Draft                RADIUS-PMIPv6                     May 2010


         0-1       0        0-1      Calling-Station-Id



8.  Security Considerations

   The RADIUS messages may be transported between the MAG and/or the LMA
   to the RADIUS server via one or more AAA brokers or RADIUS proxies.
   In this case the LMA to the RADIUS AAA server communication relies on
   the security properties of the intermediate AAA brokers and RADIUS
   proxies.


9.  IANA consideration

9.1.  Attribute Type Codes

   This specification defines the following new RADIUS attribute type
   codes:


           Mobile-Node-Identifier             is set to TBD
           PMIP6-Home-LMA-IPv6-Address        is set to TBD
           PMIP6-Visited-LMA-IPv6-Address     is set to TBD
           PMIP6-Home-LMA-IPv4-Address        is set to TBD
           PMIP6-Visited-LMA-IPv4-Address     is set to TBD
           PMIP6-Home-LMA-FQDN                is set to TBD
           PMIP6-Visited-LMA-FQDN             is set to TBD
           PMIP6-Home-HL-Prefix               is set to TBD
           PMIP6-Visited-HL-Prefix            is set to TBD
           PMIP6-Home-Interface-ID            is set to TBD
           PMIP6-Visited-Interface-ID         is set to TBD
           PMIP6-Home-IPv4-HoA                is set to TBD
           PMIP6-Visited-IPv4-HoA             is set to TBD
           PMIP6-Home-DHCP4-Server-Address    is set to TBD
           PMIP6-Visited-DHCP4-Server-Address is set to TBD
           PMIP6-Home-DHCP6-Server-Address    is set to TBD
           PMIP6-Visited-DHCP6-Server-Address is set to TBD


9.2.  Namespaces

   This specification defines new values to the Mobility Capability
   registry (see [RFC5447]) for use with the MIP6- Feature-Vector AVP:


     Token                             | Value
     ----------------------------------+--------------------



Xia, et al.             Expires November 22, 2010              [Page 30]

Internet-Draft                RADIUS-PMIPv6                     May 2010


     IP4_TRANSPORT_SUPPORTED           | 0x0000080000000000



10.  Acknowledgements

   The authors would like to thank Glen Zorn, Avi Lior and Alan DeKok
   for reviewing the document.  The authors would also like to thank the
   authors of [RFC5779] as this document re-uses some procedural ideas
   of the mentioned specification.









































Xia, et al.             Expires November 22, 2010              [Page 31]

Internet-Draft                RADIUS-PMIPv6                     May 2010


11.  References

11.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2865]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              RFC 2865, June 2000.

   [RFC5213]  Gundavelli, S., Leung, K., Devarapalli, V., Chowdhury, K.,
              and B. Patil, "Proxy Mobile IPv6", RFC 5213, August 2008.

   [RFC4282]  Aboba, B., Beadles, M., Arkko, J., and P. Eronen, "The
              Network Access Identifier", RFC 4282, December 2005.

   [RFC5447]  Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C.,
              and K. Chowdhury, "Diameter Mobile IPv6: Support for
              Network Access Server to Diameter Server Interaction",
              RFC 5447, February 2009.

   [RFC3588]  Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J.
              Arkko, "Diameter Base Protocol", RFC 3588, September 2003.

11.2.  Informative references

   [RFC2866]  Rigney, C., "RADIUS Accounting", RFC 2866, June 2000.

   [RFC3748]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, "Extensible Authentication Protocol (EAP)",
              RFC 3748, June 2004.

   [RFC5149]  Korhonen, J., Nilsson, U., and V. Devarapalli, "Service
              Selection for Mobile IPv6", RFC 5149, February 2008.

   [RFC3775]  Johnson, D., Perkins, C., and J. Arkko, "Mobility Support
              in IPv6", RFC 3775, June 2004.

   [RFC5779]  Korhonen, J., Bournelle, J., Chowdhury, K., Muhanna, A.,
              and U. Meyer, "Diameter Proxy Mobile IPv6: Mobile Access
              Gateway and Local Mobility Anchor Interaction with
              Diameter Server", RFC 5779, February 2010.

   [I-D.ietf-netlmm-pmip6-ipv4-support]
              Wakikawa, R. and S. Gundavelli, "IPv4 Support for Proxy
              Mobile IPv6", draft-ietf-netlmm-pmip6-ipv4-support-18
              (work in progress), February 2010.



Xia, et al.             Expires November 22, 2010              [Page 32]

Internet-Draft                RADIUS-PMIPv6                     May 2010


Authors' Addresses

   Frank Xia
   Huawei USA
   1700 Alma Dr. Suite 500
   Plano, TX  75075

   Phone: +1 972-509-5599
   Email: xiayangsong@huawei.com


   Behcet Sarikaya
   Huawei USA
   1700 Alma Dr. Suite 500
   Plano, TX  75075

   Phone: +1 972-509-5599
   Email: sarikaya@ieee.org


   Jouni Korhonen
   Nokia Siemens Networks

   Email: jouni.nospam@gmail.com


   Sri Gundavelli
   Cisco
   170 West Tasman Drive
   San Jose, CA  95134

   Email: sgundave@cisco.com


   Damjan Damic
   Siemens
   Heinzelova 70a
   Zagreb  10000
   Croatia

   Email: damjan.damic@siemens.com










Xia, et al.             Expires November 22, 2010              [Page 33]


