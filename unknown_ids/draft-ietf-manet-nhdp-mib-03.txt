


Internet Engineering Task Force                               U. Herberg
Internet-Draft                                  LIX, Ecole Polytechnique
Intended status: Standards Track                                 R. Cole
Expires: September 9, 2010                      Johns Hopkins University
                                                             I. Chakeres
                                                                  CenGen
                                                           March 8, 2010


 Definition of Managed Objects for the Neighborhood Discovery Protocol
                      draft-ietf-manet-nhdp-mib-03

Abstract

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in the Internet community.
   In particular, it describes objects for configuring aspects of the
   Neighborhood Discovery Protocol (NHDP) process on a router.  The NHDP
   MIB also reports state information, performance information and
   notifications.  This additional state and performance information is
   useful to management stations troubleshooting neighbor discovery
   problems.

Status of This Memo

   This Internet-Draft is submitted to IETF in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on September 9, 2010.

Copyright Notice




Herberg, et al.         Expires September 9, 2010               [Page 1]

Internet-Draft                The NHDP MIB                    March 2010


   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the BSD License.

Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  The Internet-Standard Management Framework . . . . . . . . . .  3
   3.  Conventions  . . . . . . . . . . . . . . . . . . . . . . . . .  3
   4.  Overview . . . . . . . . . . . . . . . . . . . . . . . . . . .  3
     4.1.  Terms  . . . . . . . . . . . . . . . . . . . . . . . . . .  3
   5.  Structure of the MIB Module  . . . . . . . . . . . . . . . . .  4
     5.1.  The Configuration Group  . . . . . . . . . . . . . . . . .  4
       5.1.1.  Interface Parameters . . . . . . . . . . . . . . . . .  4
       5.1.2.  Router Parameters  . . . . . . . . . . . . . . . . . .  6
     5.2.  The State Group  . . . . . . . . . . . . . . . . . . . . .  6
     5.3.  The Performance Group  . . . . . . . . . . . . . . . . . .  7
     5.4.  Notifications  . . . . . . . . . . . . . . . . . . . . . . 17
   6.  Relationship to Other MIB Modules  . . . . . . . . . . . . . . 18
     6.1.  Relationship to the SNMPv2-MIB . . . . . . . . . . . . . . 18
     6.2.  MIB modules required for IMPORTS . . . . . . . . . . . . . 18
   7.  Definitions  . . . . . . . . . . . . . . . . . . . . . . . . . 18
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . . 61
   9.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 63
   10. Contributors . . . . . . . . . . . . . . . . . . . . . . . . . 63
   11. References . . . . . . . . . . . . . . . . . . . . . . . . . . 64
     11.1. Normative References . . . . . . . . . . . . . . . . . . . 64
     11.2. Informative References . . . . . . . . . . . . . . . . . . 64
   Appendix A.  Change Log  . . . . . . . . . . . . . . . . . . . . . 65
   Appendix B.  Open Issues . . . . . . . . . . . . . . . . . . . . . 66
   Appendix C.    . . . . . . . . . . . . . . . . . . . . . . . . . . 67











Herberg, et al.         Expires September 9, 2010               [Page 2]

Internet-Draft                The NHDP MIB                    March 2010


1.  Introduction

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in the Internet community.
   In particular, it describes objects for configuring aspects of the
   Neighborhood Discovery Protocol (NHDP) [NHDP] process on a router.
   The NHDP MIB also reports state information, performance information
   and notifications.  This additional state and performance information
   is useful to management stations troubleshooting neighbor discovery
   problems.

2.  The Internet-Standard Management Framework

   For a detailed overview of the documents that describe the current
   Internet-Standard Management Framework, please refer to section 7 of
   RFC 3410 [RFC3410].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  MIB objects are generally
   accessed through the Simple Network Management Protocol (SNMP).
   Objects in the MIB are defined using the mechanisms defined in the
   Structure of Management Information (SMI).  This memo specifies a MIB
   module that is compliant to the SMIv2, which is described in STD 58,
   RFC 2578 [RFC2578], STD 58, RFC 2579 [RFC2579] and STD 58, RFC 2580
   [RFC2580].

3.  Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

4.  Overview

   The NHDP protocol allows a router in a Mobile Ad-Hoc Network (MANET)
   to discover and track topological information of routers up to two
   hops away by virtue of exchanging HELLO messages.  This information
   is useful for routers running various routing and multicast flooding
   protocols developed within the IETF MANET Working Group.

4.1.  Terms

   The following definitions apply throughout this document:

   o  Configuration Objects - switches, tables, objects which are
      initialized to default settings or set through the management
      interface defined by this MIB.




Herberg, et al.         Expires September 9, 2010               [Page 3]

Internet-Draft                The NHDP MIB                    March 2010


   o  State Objects - automatically generated values which define the
      current operating state of the NHDP protocol process in the
      router.

   o  Performance Objects - automatically generated values which help an
      administrator or automated tool to assess the performance of the
      NHDP protocol process on the router and the overall discovery
      performance within the NHDP domain.

   o  Notification Objects - define triggers and associated notification
      messages allowing for asynchronous tracking of pre-defined events
      on the managed device.

5.  Structure of the MIB Module

   This section presents the structure of the NHDP MIB module.  The MIB
   is arranged into the following structure:

   o  nhdpObjects - defining objects within this MIB.  The objects are
      arranged into the following groups:

      *  Configuration Group - defining objects related to the
         configuration of the NHDP instance on the device.

      *  State Group - defining objects which reflect the current state
         of the NHDP instance running on the device.

      *  Performance Group - defining objects which are useful to a
         management station when characterizing the performance of NHDP
         on the device and in the MANET.

   o  nhdpNotifications - objects defining NHDP MIB notifications.

   o  nhdpConformance - defining the minimal and maximal conformance
      requirements for implementations of this MIB.

5.1.  The Configuration Group

   The device is configured with a set of controls.  The list of
   configuration controls for the NHDP-MIB (found in [NHDP]), are
   discussed in the following subsections.  For all of the configuration
   parameters, the same constraints apply as specified in [NHDP].  The
   default values of these parameters are defined in [NHDP]

5.1.1.  Interface Parameters

   The Interface Parameters include:




Herberg, et al.         Expires September 9, 2010               [Page 4]

Internet-Draft                The NHDP MIB                    March 2010


5.1.1.1.  Message Intervals

   o  HELLO_INTERVAL - is the maximum time between the transmission of
      two successive HELLO messages on this MANET interface.

   o  HELLO_MIN_INTERVAL - is the minimum interval between transmission
      of two successive HELLO messages, on this MANET interface.

   o  REFRESH_INTERVAL - is the maximum interval between advertisements,
      in a HELLO message on this MANET interface, of each 1-hop
      neighbor.

5.1.1.2.  Information Validity Times

   Parameters related to the Information Validity Times include:

   o  L_HOLD_TIME - is the period of advertisement, on this MANET
      interface, of former 1-hop neighbor network addresses as lost in
      HELLO messages, allowing recipients of these HELLO messages to
      accelerate removal of this information from their Link Sets.

   o  H_HOLD_TIME - is used as the Value in the VALIDITY_TIME Message
      TLV included in all HELLO messages on this MANET interface.  It is
      then used by each router receiving such a HELLO message to
      indicate the validity of the information taken from that HELLO
      message and recorded in the receiving router's Information Bases.

5.1.1.3.  Link Quality

   Parameters related to the Link Quality include:

   o  HYST_ACCEPT - is the link quality threshold at or above which a
      link becomes usable, if it was not already so.

   o  HYST_REJECT - is the link quality threshold below which a link
      becomes unusable, if it was not already so.

   o  INITIAL_QUALITY - is the initial quality of a newly identified
      link.

   o  INITIAL_PENDING - if true, then a newly identified link is
      considered pending, and is not usable until the link quality has
      reached or exceeded the HYST_ACCEPT threshold.








Herberg, et al.         Expires September 9, 2010               [Page 5]

Internet-Draft                The NHDP MIB                    March 2010


5.1.1.4.  Jitter

   If jitter, as defined in [RFC5148], is used then these parameters are
   as follows:

   o  HP_MAXJITTER - represents the value of MAXJITTER used in [RFC5148]
      for periodically generated HELLO messages on this MANET interface.

   o  HT_MAXJITTER - represents the value of MAXJITTER used in [RFC5148]
      for externally triggered HELLO messages on this MANET interface.

5.1.2.  Router Parameters

   The following Router Parameters apply:

5.1.2.1.  Information Validity Time

   o  N_HOLD_TIME - is used as the period during which former 1-hop
      neighbor network addresses are advertised as lost in HELLO
      messages, allowing recipients of these HELLO messages to
      accelerate removal of this information from their 2-Hop Sets.

   o  I_HOLD_TIME - is the period for which a recently used local
      interface network address is recorded.

5.2.  The State Group

   The State Subtree reports current state information, including
   neighbor tables.  These are separately discussed below.

   The Local Information Base (LIB), contains the network addresses of
   the interfaces (MANET and non-MANET) of this router.  The contents of
   this Information Base are not changed by signaling.  The LIB contains
   two tables:

   o  The "Local Interface Set", which records its local interfaces.  It
      consists of Local Interface Tuples, one per interface.  Note that
      the information from this set is contained in the
      nhdpInterfaceTable, which is defined by this MIB document.
      Therefore, the Local Interface Set is not defined as an object in
      this MIB.

   o  The "Removed Interface Address Set", which records network
      addresses which were recently used as local interface network
      addresses.  It consists of Removed Interface Address Tuples, one
      per network address.

   The Interface Information Based (IIB), recording information



Herberg, et al.         Expires September 9, 2010               [Page 6]

Internet-Draft                The NHDP MIB                    March 2010


   regarding links to this MANET interface and symmetric 2-hop neighbors
   which can be reached through such links.  The IIB contains two
   tables:

   o  A "Link Set", which records information about current and recently
      lost links between this interface and MANET interfaces of 1-hop
      neighbors.  The Link Set consists of Link Tuples, each of which
      contains information about a single link.

   o  A "Two-Hop Set", which records the existence of bidirectional
      links between symmetric 1-hop neighbors of this MANET interface
      and other routers (symmetric 2-hop neighbors).  The 2-Hop Set
      consists of 2-Hop Tuples, each of which records an interface
      address of a symmetric 2-hop neighbor, and all interface addresses
      of the corresponding symmetric 1-hop neighbor.

   The Neighbor Information Base (NIB), records information regarding
   current and recently lost 1-hop neighbors of this router.  The NIB
   contains two tables:

   o  A "Neighbor Set", which records all network addresses of each
      1-hop neighbor.  It consists of Neighbor Tuples, each representing
      a single 1-hop neighbor

   o  A "Lost Neighbor Set", which records network addresses of routers
      which recently were symmetric 1-hop neighbors, but which are now
      advertised as lost.  It consists of Lost Neighbor Tuples, each
      representing a single such network address

5.3.  The Performance Group

   The Performance Group reports values relevant to system performance.
   This section lists objects for NHDP performance monitoring, some of
   which explicitly appear in the NHDP-MIB and others which are
   obtainable through a combination of base objects from this MIB and
   reports available through the REPORT-MIB [REPORT].  Throughout this
   section those objects will be pointed out that are intended as base
   objects which will be explicitly defined within this MIB and those
   objects which are derived through a combination of the base objects
   and capabilities afforded by the REPORT-MIB.

   The objects described in the following can be useful for determining
   certain properties of the NHDP instance.  Notably unstable neighbors
   or 2-hop neighbors and frequent changes of sets can have a negative
   influence on the performance of NHDP.  The following objects allow
   management applications to acquire information related to the
   stability and performance of NHDP:




Herberg, et al.         Expires September 9, 2010               [Page 7]

Internet-Draft                The NHDP MIB                    March 2010


   The following objects return some of the statistics related to HELLO
   messages:

   o  Total number of sent HELLO messages on an interface

         This is a Base Object.

         Object name: nhdpIfHelloMessageXmits

         Object type: Counter32

   o  Total number of received HELLO messages on an interface

         This is a Base Object.

         Object name: nhdpIfHelloMessageRecvd

         Object type: Counter32

   o  Total number of sent periodic HELLO messages on an interface

         This is a Base Object.

         Object name: nhdpIfHelloMessagePeriodicXmits

         Object type: Counter32

   o  Total number of sent triggered HELLO messages on an interface

         This is a Base Object.

         Object name: nhdpIfHelloMessageTriggeredXmits

         Object type: Counter32

   o  Acquire history of HELLO message scheduling instance for the given
      time duration on an interface

         It is desirable to develop the history of the exact timestamps
         of each HELLO message that has been sent as well as the type of
         the message (triggered or periodical).  The list of events
         starts at the given point of time t0 and ends at the given time
         t1.

         This is a Derived Object to be pulled from the REPORT-MIB.  It
         is derived from, e.g., the nhdpIfHelloMessagePeriodicXmits Base
         Object from the NHDP-MIB along with the capabilities derived
         from the reportHistoryGroup from the REPORT-MIB.



Herberg, et al.         Expires September 9, 2010               [Page 8]

Internet-Draft                The NHDP MIB                    March 2010


         Object type: SEQUENCE OF (TimeStamp, nhdpMessageType)

   o  Histogram of the intervals between HELLO messages on an interface

         It is desirable to track the values (in a 2-dimensional array)
         that represent a histogram of intervals between HELLO messages,
         separated by periodic and triggered HELLOs.  The histogram
         would display the distribution of intervals between two
         consecutive HELLOs of the same type (triggered or periodical)
         using a given bin size.  It includes all HELLOs that have been
         sent after the given time t0 and before the given time t1.

         This is a Derived Object to be pulled from the REPORT-MIB.  It
         can be derived from, e.g., the nhdpIfHelloMessagePeriodicXmits
         Base Object from the NHDP-MIB along with the capabilities
         derived from the reportHistoryGroup from the REPORT-MIB.  The
         network management application could convert this information
         into the desired histogram.

         Object type: SEQUENCE OF (nhdpMessageType, TimeTicks,
         Unsigned32)

   o  Changes of the frequency of the message scheduling on an interface

         This object will divide the given time interval from t0 to t1
         into a given number of equal parts.  It then creates a
         histogram for each part and calculate the distances (using the
         Bhattacharyya distance) between each two adjacent histograms in
         time.  A higher value between two histograms means more
         difference between the histograms.  For instance, that could
         happen if suddenly many triggered HELLO messages are sent,
         whereas before there have been only very few such triggered
         messages.

         This is a Derived Object to be pulled from the REPORT-MIB, as
         previously discussed, albeit this is a bit more complex with
         respect to the management application.

         Object type: SEQUENCE OF (nhdpMessageType, TimeStamp, Float32)

   o  Average number of sent HELLO messages per second between the given
      time t0 and t1 on an interface

         This is a Derived Object to be pulled from the
         reportSampledGroup from the REPORT-MIB.  It is derived from,
         e.g., the nhdpIfHelloMessageXmits Base Object.





Herberg, et al.         Expires September 9, 2010               [Page 9]

Internet-Draft                The NHDP MIB                    March 2010


         Object type: Float32

   o  Average number of received HELLO messages per second on an
      interface between the given time t0 and t1

         This is a Derived Object to be pulled from the REPORT-MIB.  See
         the previous discussion.

         Object type: Float32

   o  Total accumulated size in octets of sent HELLO messages on an
      interface

         This is a Base Object.

         Object name: nhdpIfHelloMessageXmitAccumulatedSize

         Object type: Counter32

   o  Total accumulated size in octets of received HELLO messages on an
      interface

         This is a Base Object.

         Object name: nhdpIfHelloMessageRecvdAccumulatedSize

         Object type: Counter32

   o  Average size in octets of sent HELLO messages between the given
      time t0 and t1 on an interface.

         This is a Derived Object to be pulled from the
         reportSampledGroup from the REPORT-MIB.  It is derived from,
         e.g., the nhdpIfHelloMessageRecvdAccumulatedSize Base Object
         from this NHDP-MIB.

         Object type: Float32

   o  Average size in octets of received HELLO messages between the
      given time t0 and t1 on an interface

         This is a Derived Object to be pulled from the REPORT-MIB.  See
         previous discussion.

         Object type: Float32






Herberg, et al.         Expires September 9, 2010              [Page 10]

Internet-Draft                The NHDP MIB                    March 2010


   o  Total accumulated number of advertized symmetric neighbors in
      HELLOs on that interface.

         This is a Base Object.

         Object name:
         nhdpIfHelloMessageXmitAccumulatedSymmetricNeighborCount

         Object type: Counter32

   o  Total accumulated number of advertized heard neighbors in HELLOs
      on that interface

         This is a Base Object.

         Object name:
         nhdpIfHelloMessageXmitAccumulatedHeardNeighborCount

         Object type: Counter32

   o  Total accumulated number of advertized lost neighbors in HELLOs on
      that interface

         This is a Base Object.

         Object name: nhdpIfHelloMessageXmitAccumulatedLostNeighborCount

         Object type: Counter32

   o  Number of expected packets from a given neighbor based on the
      packet sequence number on an interface

         This is a Base Object.

         Object name: nhdpDiscIfExpectedPackets

         Object type: Counter32

   o  Success rate of received packets (number of received packets
      divided by number of expected packets based on the packet sequence
      number).

         This is a Derived Object to be pulled from this NHDP-MIB.  It
         is derived from, e.g., the nhdpDiscIfRecvdPackets and the
         nhdpDiscIfExpectedPackets Base Objects defined in this MIB.
         This metric is then computed by the network management
         application.




Herberg, et al.         Expires September 9, 2010              [Page 11]

Internet-Draft                The NHDP MIB                    March 2010


         Object type: Float32

   The following objects inspect the frequency of all Neighbor Set
   changes:

   o  Number of Neighbor Set changes

         This object counts each Neighbor Set change.  A change occurs
         whenever a new Neighbor Tuple has been added, a Neighbor Tuple
         has been removed or any entry of a Neighbor Tuple has been
         modified.

         This is a Base Object.

         Object name: nhdpNibNeighborSetChanges

         Object type: Counter32

   o  Acquire history of Neighbor Set changes

         This object returns the history of the exact timestamps of each
         time the Neighbor Set has been changed.

         This is a Derived Object to be pulled from the
         reportHistoryGroup of the REPORT-MIB.  It is derived from the
         previously discussed Base Object.

         Object type: SEQUENCE OF TimeStamp

   o  Histogram of the intervals between Neighbor Set changes

         Returns the values (in a 2-dimensional array) that represent a
         histogram of intervals between Neighbor Set changes.

         This is a Derived Object to be pulled from the
         reportHistoryGroup from the REPORT-MIB.  It is derived from the
         previously discussed Base Object.  The network management
         application would develop the histograms based upon lists
         obtained from the REPORT-MIB.

         Object type: SEQUENCE OF (TimeTicks, Unsigned32)

   o  Changes of the frequency of the Neighbor Set changes

         This object will divide the given time interval from t0 to t1
         into a given number of equal parts.  It then creates a
         histogram for each part and calculate the distances (using the
         Bhattacharyya distance) between each two adjacent histograms in



Herberg, et al.         Expires September 9, 2010              [Page 12]

Internet-Draft                The NHDP MIB                    March 2010


         time.  A higher value between two histograms means more
         difference between the histograms.

         This is a Derived Object to be pulled from the
         reportHistoryGroup from the REPORT-MIB.  It is derived from the
         previously discussed Base Object.  The network management
         application could then compute the desired metrics.

         Object type: SEQUENCE OF (TimeStamp, Float32)

   The next objects examine the uptime of a given neighbor:

   o  Number of changes of a Neighbor Tuple

         Returns the number of changes to the given Neighbor Tuple.

         This is a Base Object.

         Object name: nhdpDiscNeighborNibNeighborSetChanges

         Object type: Counter32

   o  Neighbor uptime

         Returns the number of milliseconds since the Neighbor Tuple
         corresponding to the given neighbor exists.

         This is a Base Object.

         Object name: nhdpDiscNeighborNibNeighborSetUpTime

         Object type: Unsigned32

   o  Acquire history of change of onlink status of a given neighbor

         This object returns the history of the exact timestamps of each
         time the neighbor becomes onlink or offlink.  A neighbor is
         said to become "onlink" if a new Neighbor Tuple is created that
         corresponds to the given neighbor.  It becomes "offlink" if
         such a tuple has been deleted.

         This is a Derived Object to be pulled from the
         reportHistoryGroup of the REPORT-MIB.  It is derived from,
         e.g., the nhdpDiscNeighborNibNeighborSetChanges Base Object
         defined in this MIB.






Herberg, et al.         Expires September 9, 2010              [Page 13]

Internet-Draft                The NHDP MIB                    March 2010


         Object type: SEQUENCE OF TimeStamp

   o  Histogram of the intervals between a change of the onlink status
      of a given neighbor

         Returns the values that represent a histogram of intervals
         between a change of the onlink status of a given neighbor.  The
         histogram includes all changes that have been made after the
         given time t0 and before the given time t1.

         This is a Derived Object to be pulled from the
         reportHistoryGroup of the REPORT-MIB.  It is derived from, e.g.
         the nhdpDiscNeighborNibNeighborSetChanges Base Object defined
         in this MIB.  This object sits in the
         nhdpDiscNeighborSetPerfTable which is indexed by the
         nhdpDiscNeighborSetRouterId.

         Object name: nhdpNeighborStatusHistogram

         Object type: SEQUENCE OF (TimeTicks, Unsigned32)

   The following objects examine the stability of a neighbor.  A
   neighbor is said to be unstable if it "flaps" frequently between
   several links.  It is said to be stable if the set of Link Tuples
   that correspond to the given neighbor is stationary.

   o  Count the changes of the interface over which a given neighbor can
      be reached.

         This object counts each time the neighbor changes the interface
         over which it is reachable.  That means that the corresponding
         Link Tuple of the given link moves from the Link Set of one
         interface to another interface.

         This is a Base Object.

         Object name: nhdpDiscNeighborNibNeighborSetReachableLinkChanges

         Object type: Counter32

   o  Acquire history of changes of the interface over which a given
      neighbor can be reached.

         This object returns the history of the exact timestamps of each
         time the neighbor changes the interface over which it is
         reachable.  That means that the corresponding Link Tuple of the
         given link moves from the Link Set of one interface to another
         interface.



Herberg, et al.         Expires September 9, 2010              [Page 14]

Internet-Draft                The NHDP MIB                    March 2010


         This is a Derived Object to be pulled from the
         reportHistoryGroup of the REPORT-MIB.  It is derived from,
         e.g., the nhdpDiscNeighborNibNeighborSetReachableLinkChanges
         Base Object.  The network management could develop the desired
         histogram based upon the information retrieved from the REPORT-
         MIB.

         Object name: nhdpNeighborIfChangeHistory

         Object type: SEQUENCE OF (TimeStamp)

   o  Histogram of the intervals between a change of the interface over
      which a given neighbor is reachable

         Returns the values that represent a histogram of intervals
         between a change of the interface over which a given neighbor
         is reachable after the given time t0 and before the given time
         t1.

         This is a Derived Object to be pulled from the
         reportHistoryGroup from the REPORT-MIB.  It is derived from the
         previously discussed Base Object.  The network management
         application would develop the histograms based upon lists
         obtained from the REPORT-MIB.

         Object name: nhdpNeighborIfChangeHistogram

         Object type: SEQUENCE OF ( TimeTicks, Unsigned32))

   The following objects inspect the stability of a given 2-hop
   neighbor:

   o  Count the changes of the N2_neighbor_iface_addr_list of a given
      2-hop neighbor

         This object returns the count of the times the 2-hop neighbor
         changes its N2_neighbor_iface_addr_list, i.e. the neighbor over
         which it is reachable.

         This is a Base Object.

         Object name: nhdpIib2HopSetPerfChanges

         Object type: Counter32

   o  Acquire history of changes of the N2_neighbor_iface_addr_list of a
      given 2-hop neighbor (Note: Not sure what the Base Object is for
      this set and not clear how to capture in the REPORT-MIB.)



Herberg, et al.         Expires September 9, 2010              [Page 15]

Internet-Draft                The NHDP MIB                    March 2010


         This object returns the history of the exact timestamps of each
         time the 2-hop neighbor changes its
         N2_neighbor_iface_addr_list, i.e. the neighbor over which it is
         reachable.

         This is a Derived Object to be pulled from the
         reportHistoryGroup of the REPORT-MIB.  It is derived from the
         previously discussed Base Object.

         Object name: nhdpN2ReachabilityChangeHistory

         Object type: SEQUENCE OF (TimeStamp)

   o  Histogram of the intervals between a change of a 2-hop neighbor's
      N2_neighbor_iface_addr_list

         Returns the values that represent a histogram of intervals
         between a change of the 2-hop neighbor's
         N2_neighbor_iface_addr_list after the given time t0 and before
         the given time t1.

         This is a Derived Object to be pulled from the
         reportHistoryGroup from the REPORT-MIB.  It is derived from the
         previously discussed Base Object.  The network management
         application would develop the histograms based upon lists
         obtained from the REPORT-MIB.

         Object name: nhdpN2ReachabilityChangeHistogram

         Object type: SEQUENCE OF (TimeTicks, Unsigned32)

   The next objects examine the uptime of a given 2-hop neighbor:

   o  2-hop Neighbor uptime

         Returns the number of milliseconds since the 2-Hop Tuple
         corresponding to the given 2-hop neighbor IP address exists.

         This is a Base Object.

         Object name: nhdpIib2HopSetPerfUpTime

         Object type: Unsigned32

   o  Acquire history of change of onlink status of a given 2-hop
      neighbor





Herberg, et al.         Expires September 9, 2010              [Page 16]

Internet-Draft                The NHDP MIB                    March 2010


         This object returns the history of the exact timestamps of each
         time the 2-hop neighbor becomes onlink or offlink.  A 2-hop
         neighbor is said to become "onlink" if a new 2-hop Tuple is
         created that corresponds to the given 2-hop neighbor.  It
         becomes "offlink" if such a tuple has been deleted.

         This is a Derived Object to be pulled from the
         reportHistoryGroup of the REPORT-MIB.  It is derived from the
         previously discussed Base Object.

         Object name: nhdpN2StatusHistory

         Object type: SEQUENCE OF (TimeStamp)

   o  Histogram of the intervals between a change of the onlink status
      of a given 2-hop neighbor

         Returns the values that represent a histogram of intervals
         between a change of the onlink status of a given 2-hop
         neighbor.  The histogram includes all changes that have been
         made after the given time t0 and before the given time t1.

         This is a Derived Object to be pulled from the
         reportHistoryGroup from the REPORT-MIB.  It is derived from the
         previously discussed Base Object.  The network management
         application would develop the histograms based upon lists
         obtained from the REPORT-MIB.

         Object name: nhdpN2StatusHistogram

         Object type: SEQUENCE OF (TimeTicks, Unsigned32)

5.4.  Notifications

   The Notifications subtree contains the list of notifications
   supported within the NHDP MIB and their intended purpose or utility.
   The following notifications are specified:

   o  nhdpNbrStateChange is a notification sent each time the status of
      a neighbor has changed.  Possible status values are down,
      asymmetric, and symmetric.

   o  nhdp2hopNbrStateChange is a notification sent each time the status
      of a neighbor has changed.  Possible status values are down and
      up.

   o  nhdpIfRxBadMessage is a notification sent each time an incoming
      HELLO message has not been succesfully parsed on an interface.



Herberg, et al.         Expires September 9, 2010              [Page 17]

Internet-Draft                The NHDP MIB                    March 2010


   o  nhdpIfStateChange is a notification sent each time the status of
      an interface of the designated router has changed (i.e. an IP
      address has been added or removed to the interface, or the
      interface has changed its status from up to down or vice versa).

6.  Relationship to Other MIB Modules

   This section specifies the relationship of the MIB modules contained
   in this document to other standards, particularly to standards
   containing other MIB modules.  Definitions imported from other MIB
   modules and other MIB modules that SHOULD be implemented in
   conjunction with the MIB module contained within this document are
   identified in this section.

6.1.  Relationship to the SNMPv2-MIB

   The 'system' group in the SNMPv2-MIB [RFC3418] is defined as being
   mandatory for all systems, and the objects apply to the entity as a
   whole.  The 'system' group provides identification of the management
   entity and certain other system-wide data.  The NHDP-MIB does not
   duplicate those objects.

6.2.  MIB modules required for IMPORTS

   The following NHDP MIB module IMPORTS objects from SNMPv2-SMI
   [RFC2578], SNMPv2-TC [RFC2579], SNMPv2-CONF [RFC2580], IF-MIB
   [RFC2863], INET-ADDRESS-MIB [RFC4001], and SMIng [RFC3781].

7.  Definitions


NHDP-MIB DEFINITIONS ::= BEGIN

-- This MIB is currently in an initial stage.
-- Not all proposed objects have been identified yet
-- in the current draft.

IMPORTS

    Float32
                 FROM SMIng  --[RFC3781]

    MODULE-IDENTITY, OBJECT-TYPE, NOTIFICATION-TYPE, Counter32,
    Integer32, Unsigned32, mib-2
                 FROM SNMPv2-SMI  --[RFC2578]

    TEXTUAL-CONVENTION, StorageType, TimeStamp,
    TruthValue, RowStatus



Herberg, et al.         Expires September 9, 2010              [Page 18]

Internet-Draft                The NHDP MIB                    March 2010


                 FROM SNMPv2-TC  --[RFC2579]

    MODULE-COMPLIANCE, OBJECT-GROUP, NOTIFICATION-GROUP
                 FROM SNMPv2-CONF  --[STD58]

    InetAddressType, InetAddress,
    InetAddressPrefixLength
                 FROM INET-ADDRESS-MIB  --[RFC4001]

    InterfaceIndexOrZero
                 FROM IF-MIB  --[RFC2863]
    ;

nhdpMIB MODULE-IDENTITY
       LAST-UPDATED "201003081000Z" -- March 08,2010
       ORGANIZATION "IETF MANET working group"
       CONTACT-INFO
       "WG E-Mail: manet@ietf.org

        WG Chairs: ian.chakeres@gmail.com
                   jmacker@nrl.navy.mil


        Editors:   Ulrich Herberg
                   Ecole Polytechnique
                   LIX
                   91128 Palaiseau Cedex
                   France
                   ulrich@herberg.name
                   http://www.herberg.name/

                   Robert G. Cole
                   Johns Hopkins University
                   Department of Computer Science
                   3400 North Charles Street
                   NEB Room 213
                   Baltimore, MD 21218
                   USA
                   +1 443 910-4420
                   rgcole01@comcast.net
                   http://www.cs.jhu.edu/~rgcole/

                   Ian D Chakeres
                   CenGen
                   9250 Bendix Road North
                   Columbia, Maryland  21045
                   USA
                   ian.chakeres@gmail.com



Herberg, et al.         Expires September 9, 2010              [Page 19]

Internet-Draft                The NHDP MIB                    March 2010


                   http://www.ianchak.com/"

       DESCRIPTION
           "This NHDP MIB module is applicable to devices
            implementing the Neighborhood Discovery Protocol
            defined in [XXX].

            Copyright (C) The IETF Trust (2009). This version
            of this MIB module is part of RFC xxxx; see the RFC
            itself for full legal notices."

       -- revision
       REVISION    "201003081000Z"   -- March 08, 2010
       DESCRIPTION
         "The sixth version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-03.txt.
          Added the local nhdpIfIndex to the
          nhdpIibLinkSetTable."
       REVISION    "200911091000Z"   -- November 09, 2009
       DESCRIPTION
         "The fifth version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-02.txt.
          Cleaned up a few things and updated to newest
          revision of NHDP draft."
       REVISION    "200910211000Z"   -- October 21, 2009
       DESCRIPTION
         "The fourth version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-01.txt.
          Added objects pertaining to the performance
          group."
       REVISION    "200905031500Z"   -- May 3, 2009
       DESCRIPTION
         "The third version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-00.txt.
          No major revisions to this draft.  Mainly rev'd
          as a new working group document.  But also cleaned
          syntax errors, typos and other issues discovered
          with 'smilint'."
       REVISION    "200902151500Z"   -- February 15, 2009
       DESCRIPTION
         "The second version of this MIB module,
          published as draft-cole-manet-nhdp-mib-01.txt.  Major
          update adding objects for configuration and state."
       REVISION    "200804251500Z"   -- April 25, 2008
       DESCRIPTION
         "The original version of this MIB module,
          published as draft-cole-manet-nhdp-mib-00.txt."
       -- RFC-Editor assigns XXXX



Herberg, et al.         Expires September 9, 2010              [Page 20]

Internet-Draft                The NHDP MIB                    March 2010


       ::= { mib-2 998 }   -- to be assigned by IANA

--
-- Top-Level Components of this MIB
--
nhdpNotifications OBJECT IDENTIFIER ::= { nhdpMIB 0 }
nhdpObjects       OBJECT IDENTIFIER ::= { nhdpMIB 1 }
nhdpConformance   OBJECT IDENTIFIER ::= { nhdpMIB 2 }


--
-- Textual Conventions
--

NeighborIfIndex ::= TEXTUAL-CONVENTION
    DISPLAY-HINT "d"
    STATUS       current
    DESCRIPTION
        "A locally arbitrary unique identifier associated with an
        NHDP neighbor interface.

        All objects of type NeighborIfIndex are assigned by the agent
        out of a common number space. In other words, NeighborIfIndex
        values assigned to entries in one table must not overlap with
        NeighborIfIndex values assigned to entries in another
        table.

        The NeighborIfIndex defines a discovered interface of a 1-hop
        or 2-hop neighbor of the local router.  The agent identifies a
        unique neighbor interface through the reciept of an address
        list advertised through an NHDP HELLO message.

        The value for each discovered neighbor interface must remain
        constant at least from one re-initialization of the entity's
        network management system to the next re-initialization, except
        that if an application is deleted and re-created.

        The specific value is meaningful only within a given SNMP
        entity. An NeighborIfIndex value must not be re-used until the
        next agent restart."
    SYNTAX       Unsigned32 (1..2147483647)


NeighborRouterId ::= TEXTUAL-CONVENTION
    DISPLAY-HINT "d"
    STATUS       current
    DESCRIPTION
        "A locally arbitrary unique identifier associated with an



Herberg, et al.         Expires September 9, 2010              [Page 21]

Internet-Draft                The NHDP MIB                    March 2010


        NHDP discovered peer router.

        All objects of type NeighborRouterId are assigned by the agent
        out of a common number space.

        The NeighborRouterId defines a discovered NHDP peer of
        the local router.  The agent identifies a
        unique neighbor through the reciept of an address
        list advertised through an NHDP HELLO message and the
        associated  .....

        The value for each discovered neighbor ID must remain
        constant at least from one re-initialization of the entity's
        network management system to the next re-initialization, except
        that if an application is deleted and re-created.

        The specific value is meaningful only within a given SNMP
        entity. An NeighborRouterId value must not be re-used until the
        next agent restart."
    SYNTAX       Unsigned32 (1..2147483647)



--
-- nhdpObjects
--

--    Configuration Objects Group - ...
--    State Objects Group - ...
--    Performance Objects Group - ...



--
-- nhdpConfigurationObjGrp
--

-- Contains the NHDP objects which configure specific options
-- which determine the overall performance and operation of the
-- discovery protocol.

nhdpConfigurationObjGrp OBJECT IDENTIFIER ::= { nhdpObjects 1 }


   nhdpInterfaceTable  OBJECT-TYPE
      SYNTAX      SEQUENCE OF NhdpInterfaceEntry
      MAX-ACCESS  not-accessible
      STATUS      current



Herberg, et al.         Expires September 9, 2010              [Page 22]

Internet-Draft                The NHDP MIB                    March 2010


      DESCRIPTION
         "The NHDP Interface Table describes the
          configuration of the interfaces of this NHDP device.
          The ifIndex is from the interfaces group
          defined in the Interfaces Group MIB.

          The object 'nhdpIfStatus' provides the functionality
          expected by the NHDP in the Local Interface Base (LIB)
          Local Interface Set Table.  Hence, the Local Interface
          Set Table will not be defined below."
      REFERENCE
         "RFC 2863 - The Interfaces Group MIB, McCloghrie,
          K., and F. Kastenholtz, June 2000."
   ::= { nhdpConfigurationObjGrp 1 }

   nhdpInterfaceEntry OBJECT-TYPE
      SYNTAX      NhdpInterfaceEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The NHDP interface entry describes one NHDP
          local interface configuration as indexed by
          its ifIndex as defined in the Standard MIB II
          Interface Table (RFC2863)."
      INDEX { nhdpIfIndex }
   ::= { nhdpInterfaceTable 1 }

   NhdpInterfaceEntry ::=
      SEQUENCE {
         nhdpIfIndex
            InterfaceIndexOrZero,
         nhdpIfStatus
            TruthValue,
         nhdpHelloInterval
            Unsigned32,
         nhdpHelloMinInterval
            Unsigned32,
         nhdpRefreshInterval
            Unsigned32,
         nhdpLHoldTime
            Unsigned32,
         nhdpHHoldTime
            Unsigned32,
         nhdpHystAcceptQuality
            Unsigned32,
         nhdpHystRejectQuality
            Unsigned32,
         nhdpInitialQuality



Herberg, et al.         Expires September 9, 2010              [Page 23]

Internet-Draft                The NHDP MIB                    March 2010


            Unsigned32,
         nhdpInitialPending
            TruthValue,
         nhdpHpMaxJitter
            Unsigned32,
         nhdpHtMaxJitter
            Unsigned32,
         nhdpIfRowStatus
            RowStatus
         }

   nhdpIfIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The ifIndex for this interface."
      ::= { nhdpInterfaceEntry 1 }

   nhdpIfStatus  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhpdIfStatus indicates whether this interface is
         a MANET interface. A value of true(1) indicates
         that the interface is a MANET interface.  A value of
         false(2) indicates that the interface is not a MANET
         interface. This corresponds to the I_manet parameter
         in the Local Interface Set, which is omitted in this MIB
         due to the redundancy with the nhdpInterfaceTable."
      DEFVAL { 2 }
   ::= { nhdpInterfaceEntry 2 }


   --
   -- Interface Parameters - Message Intervals
   --

   nhdpHelloInterval  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhpdHelloInterval is the maximum time
         between the transmission of two successive
         HELLO messages on this MANET interface.



Herberg, et al.         Expires September 9, 2010              [Page 24]

Internet-Draft                The NHDP MIB                    March 2010


         The following constraints apply to this
         parameter:
             nhpdHelloInterval >= 0
             nhpdHelloInterval >= nhdpHelloMinInterval"
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 2000 }
   ::= { nhdpInterfaceEntry 3 }


   nhdpHelloMinInterval  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhpdHelloMinInterval is the minimum interval
         between transmission of two successive HELLO
         messages, on this MANET interface.

         The following constraints apply to this
         parameter:
             nhdpHelloMinInterval >= 0"
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 500 }
   ::= { nhdpInterfaceEntry 4 }


   nhdpRefreshInterval  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhpdRefreshInterval is the maximum interval
         between advertisements, in a HELLO message on this
         MANET interface, of each 1-hop neighbor network
         address and its status.

         The following constraint applies to this
         parameter:
             nhdpRefreshInterval >= nhdpHelloInterval"
      REFERENCE



Herberg, et al.         Expires September 9, 2010              [Page 25]

Internet-Draft                The NHDP MIB                    March 2010


         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 2000 }
   ::= { nhdpInterfaceEntry 5 }

   --
   -- Interface Parameters - Information Validity times
   --

   nhdpLHoldTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpLHoldTime is used to define the time
          for which a recently used and replaced
          originator address is used to recognize
          the router's own messages.

          The following constraint applies to this
          parameter:
              nhdpLHoldTime >= 0"
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 6000 }
   ::= { nhdpInterfaceEntry 6 }

   nhdpHHoldTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHHoldTime is used to define the time
          for which a recently used and replaced
          originator address is used to recognize
          the router's own messages.

          The following constraint applies to this
          parameter:
              nhdpHHoldTime >= 0"
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and



Herberg, et al.         Expires September 9, 2010              [Page 26]

Internet-Draft                The NHDP MIB                    March 2010


          Constraints."
      DEFVAL { 6000 }
   ::= { nhdpInterfaceEntry 7 }

   --
   -- Interface Parameters - Link Quality
   -- (is optional and settings define operation)
   --

   -- Note: Can we set a Float32 value here ranging
   -- from 0.0 to 1.0?
   nhdpHystAcceptQuality  OBJECT-TYPE
      SYNTAX      Unsigned32 (0..255)
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHystAcceptQuality is the
          link quality threshold at or above
          which a link becomes usable,
          if it was not already so.

          The following constraint applies to this
          parameter:
              0 < = nhdpHystRejectQuality
                < = nhdpHystAcceptQuality < = 255"
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 255 }
   ::= { nhdpInterfaceEntry 8 }

   nhdpHystRejectQuality  OBJECT-TYPE
      SYNTAX      Unsigned32 (0..255)
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHystRejectQuality is the
          link quality threshold below which
          a link becomes unusable, if it
          was not already so.

          The following constraint applies to this
          parameter:
              0 < = nhdpHystRejectQuality
                < = nhdpHystAcceptQuality < = 255"
      REFERENCE
         "The NHDP draft.



Herberg, et al.         Expires September 9, 2010              [Page 27]

Internet-Draft                The NHDP MIB                    March 2010


          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 0 }
   ::= { nhdpInterfaceEntry 9 }

   nhdpInitialQuality  OBJECT-TYPE
      SYNTAX      Unsigned32 (0..255)
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpInitialQuality is the
          initial quality of a newly
          identified link.

          The following constraint applies to this
          parameter:
              0 < = nhdpInitialQuality < = 255"
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 255 }
   ::= { nhdpInterfaceEntry 10 }

   -- Note: Probably wnat to move this following object
   -- `nhdpInitialPending' to the State Objects Group.

   nhdpInitialPending  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpInitialPending is defined as
          follows:

          If true, then a newly identified link
          is considered pending, and is not
          usable until the link quality has
          reached or exceeded the
          nhdpHystAccept threshold."
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 2 }
   ::= { nhdpInterfaceEntry 11 }

   --



Herberg, et al.         Expires September 9, 2010              [Page 28]

Internet-Draft                The NHDP MIB                    March 2010


   -- Interface Parameters - Jitter
   --


   nhdpHpMaxJitter  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHpMaxJitter represents the
          value of MAXJITTER used in [4] for
          periodically generated HELLO messages
          on this MANET interface."
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 500 }
   ::= { nhdpInterfaceEntry 12 }


   nhdpHtMaxJitter  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHtMaxJitter represents the
          value of MAXJITTER used in [4] for
          externally triggered HELLO messages
          on this MANET interface."
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 500 }
   ::= { nhdpInterfaceEntry 13 }

   nhdpIfRowStatus  OBJECT-TYPE
      SYNTAX      RowStatus
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "This object permits management of the table
         by facilitating actions such as row creation,
         construction, and destruction. The value of
         this object has no effect on whether other



Herberg, et al.         Expires September 9, 2010              [Page 29]

Internet-Draft                The NHDP MIB                    March 2010


         objects in this conceptual row can be
         modified."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpInterfaceEntry 14 }

   --
   -- Router Parameters - Information Validity Time
   --

   nhdpNHoldTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHHoldTime is used as the period
          during which former 1-hop neighbor
          addresses are advertised as lost in
          HELLO messages, allowing recipients of
          these HELLO messages to accelerate removal
          of information from their 2-Hop Sets.
          N_HOLD_TIME can be set to zero if
          accelerated information removal is not
          required.

          The following constraint applies to this
          parameter:
              nhdpHHoldTime >= 0"
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 6000 }
   ::= { nhdpConfigurationObjGrp 2 }


   nhdpIHoldTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpIHoldTime is the period
          for which a recently used local
          interface address is recorded.

          The following constraint applies to this



Herberg, et al.         Expires September 9, 2010              [Page 30]

Internet-Draft                The NHDP MIB                    March 2010


          parameter:
              nhdpIHoldTime >= 0  "
      REFERENCE
         "The NHDP draft.
          Section 5 on Protocol Parameters and
          Constraints."
      DEFVAL { 6000 }
   ::= { nhdpConfigurationObjGrp 3 }










--
-- nhdpStateObjGrp
--

-- Contains information describing the current state of the NHDP
-- process.

nhdpStateObjGrp    OBJECT IDENTIFIER ::= { nhdpObjects 2 }

   -- Before building the NHDP Information Bases, we define
   -- two new constructs for indexing into the following
   -- tables and indexing into other tables in other MIBs.
   -- The NeighborIfIndex defines a unique (to the local router)
   -- index referencing a discovered interface on another
   -- router within the NHDP MANET. The NeighborRouterId defines a
   -- unique (to the local router) index referencing a discovered
   -- router within the NHDP MANET.



   -- Note: This table is indexed by an IpAddr associated with
   -- NeighborIfIndex.  Multiple addresses can be associated
   -- with a given NeighborIfIndex.  Each NeighborIfIndex is
   -- associated with a NeighborRouterId.  Throughout this MIB,
   -- the NeighborIfIndex and the NeighborRouterId are used
   -- to define the set of IpAddrs related to the interface
   -- in discussion.


   nhdpDiscIfSetTable OBJECT-TYPE



Herberg, et al.         Expires September 9, 2010              [Page 31]

Internet-Draft                The NHDP MIB                    March 2010


      SYNTAX       SEQUENCE OF NhdpDiscIfSetEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
           "A router's set of discovered interfaces on
            neighboring routers."
       REFERENCE
          "The NHDP draft."
    ::= { nhdpStateObjGrp 1 }

    -- Note: need to describe how to age out
    --       the entries in this table?
    nhdpDiscIfSetEntry  OBJECT-TYPE
       SYNTAX      NhdpDiscIfSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The entries include the nhdpDiscRouterId of
           the discovered router, the nhdpDiscIfIndex
           of the discovered interface and the
           current set of addresses associated
           with this neighbor interface.  The
           nhdpDiscIfIndex has to uniquely identify
           the remote interface address sets.  It
           need not be unique across the MANET.
           It must be unique within this router."
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpDiscIfSetIpAddr }
    ::= { nhdpDiscIfSetTable 1 }

    NhdpDiscIfSetEntry ::=
       SEQUENCE {
          nhdpDiscIfSetRouterId
            NeighborRouterId,
          nhdpDiscIfSetIndex
            NeighborIfIndex,
          nhdpDiscIfSetIpAddrType
            InetAddressType,
          nhdpDiscIfSetIpAddr
            InetAddress,
          nhdpDiscIfSetIpAddrPrefixLen
            InetAddressPrefixLength
         }

   nhdpDiscIfSetRouterId  OBJECT-TYPE
      SYNTAX      NeighborRouterId
      MAX-ACCESS  read-only



Herberg, et al.         Expires September 9, 2010              [Page 32]

Internet-Draft                The NHDP MIB                    March 2010


      STATUS      current
      DESCRIPTION
         "The NHDP router ID (locally created)
          of a neigboring router.  Used for cross
          indexing into other NHDP tables and other
          MIBs."
      REFERENCE
         "This NHDP-MIB draft."
   ::= { nhdpDiscIfSetEntry 1 }

   nhdpDiscIfSetIndex  OBJECT-TYPE
      SYNTAX      NeighborIfIndex
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The NHDP interface index (locally created)
          of a neigbor's interface.  Used for cross
          indexing into other NHDP tables and other
          MIBs."
      REFERENCE
         "This NHDP-MIB draft."
   ::= { nhdpDiscIfSetEntry 2 }

   nhdpDiscIfSetIpAddrType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The type of the nhdpDiscIfSetIpAddr
          in the InetAddress MIB [RFC 4001]."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetEntry 3 }

   nhdpDiscIfSetIpAddr  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpDiscIfSetIpAddr is a
          recently used address of a neighbor
          of this router."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetEntry 4 }

   nhdpDiscIfSetIpAddrPrefixLen  OBJECT-TYPE
      SYNTAX      InetAddressPrefixLength



Herberg, et al.         Expires September 9, 2010              [Page 33]

Internet-Draft                The NHDP MIB                    March 2010


      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "Indicates the number of leading one bits that form the
          mask to be logical-ANDed with the destination address
          before being compared to the value in the
          nhdpDiscIfSetAddr field.  If the resulting
          address block is contained in a block in this
          table, then a match should be returned."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetEntry 5 }




   -- An NHDP router's Local Information Base (LIB)

      -- Local IF Set Table
      -- Entry (foreach IF): (IfAddrList,
      --                      PrefixMask,
      --                      Manet_indication)
      --
      -- Note:  This table is redundant with information in
      -- the nhdpInterfaceTable above.  Hence it is not present here.




      -- Removed Interface Addr Set Table
      -- Entry (foreach Addr): (IfAddrRemoved,
      --                        ExpirationTime)

    nhdpLibRemovedIfAddrSetTable OBJECT-TYPE
       SYNTAX       SEQUENCE OF NhdpLibRemovedIfAddrSetEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
          "A router's Removed Interface Address Set records
          network addresses which were recently used as local
          interface network addresses.  If a router's interface
          network addresses are immutable then the Removed
          Interface Address Set is always empty and MAY be omitted.
          It consists of Removed Interface Address Tuples, one
          per network address."
       REFERENCE
          "The NHDP draft."
    ::= { nhdpStateObjGrp 2 }



Herberg, et al.         Expires September 9, 2010              [Page 34]

Internet-Draft                The NHDP MIB                    March 2010


    nhdpLibRemovedIfAddrSetEntry  OBJECT-TYPE
       SYNTAX      NhdpLibRemovedIfAddrSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "A router's Removed Interface Address Set consists
          of Removed Interface Address Tuples, one per network
          address:

          (IR_local_iface_addr, IR_time)

          The association between these addrs and
          the router's Interface is found in the
          Standard MIB II's IP addr table
          (RFC1213)."
       REFERENCE
          "The NHDP draft."
       INDEX { nhdpLibRemovedIfAddrSetIpAddr }
    ::= { nhdpLibRemovedIfAddrSetTable 1 }

    NhdpLibRemovedIfAddrSetEntry ::=
       SEQUENCE {
          nhdpLibRemovedIfAddrSetIpAddrType
            InetAddressType,
          nhdpLibRemovedIfAddrSetIpAddr
            InetAddress,
          nhdpLibRemovedIfAddrSetIpAddrPrefixLen
            InetAddressPrefixLength,
          nhdpLibRemovedIfAddrSetIfIndex
            InterfaceIndexOrZero,
          nhdpLibRemovedIfAddrSetIrTime
            Unsigned32
         }

   nhdpLibRemovedIfAddrSetIpAddrType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The type of the nhdpLibRemovedIfAddrSetIpAddr
          in the InetAddress MIB [RFC 4001]."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpLibRemovedIfAddrSetEntry 1 }

   nhdpLibRemovedIfAddrSetIpAddr  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  not-accessible



Herberg, et al.         Expires September 9, 2010              [Page 35]

Internet-Draft                The NHDP MIB                    March 2010


      STATUS      current
      DESCRIPTION
         "The nhdpLibRemovedIfAddrSetAddr is a
          recently used address of an interface of
          this router."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpLibRemovedIfAddrSetEntry 2 }

   nhdpLibRemovedIfAddrSetIpAddrPrefixLen  OBJECT-TYPE
      SYNTAX      InetAddressPrefixLength
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "Indicates the number of leading one bits that form the
          mask to be logical-ANDed with the address
          to determine the network address to which
          this interface is attached.
          "
      REFERENCE
         "The NHDP draft."
   ::= { nhdpLibRemovedIfAddrSetEntry 3 }

   -- Note: need to identify a time type for the
   -- nhdpRemoveAddrSetIrTime.

     nhdpLibRemovedIfAddrSetIfIndex  OBJECT-TYPE
        SYNTAX      InterfaceIndexOrZero
        MAX-ACCESS  read-only
        STATUS      current
        DESCRIPTION
           "Specifies the local IfIndex from which this
            Ip addr was recently removed."
        REFERENCE
           "The NHDP draft."
     ::= { nhdpLibRemovedIfAddrSetEntry 4 }

     nhdpLibRemovedIfAddrSetIrTime  OBJECT-TYPE
        SYNTAX      Unsigned32
        MAX-ACCESS  read-only
        STATUS      current
        DESCRIPTION
           "Specifies when this Tuple expires and MUST be removed
            from this table."
        REFERENCE
           "The NHDP draft."
     ::= { nhdpLibRemovedIfAddrSetEntry 5 }




Herberg, et al.         Expires September 9, 2010              [Page 36]

Internet-Draft                The NHDP MIB                    March 2010


   -- Interface Information Base (IIB)

   --
   -- NHDP Interface Information Base (IIB)
   --

   --     IIB Link Set
   --         Entry (foreach 1-H neighbor): (NeighborIfAddrList,
   --                                        HeardTime,
   --                                        SymTime,
   --                                        Quality,
   --                                        Pending,
   --                                        Lost,
   --                                        ExpireTime)

   nhdpIibLinkSetTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpIibLinkSetEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
          "A Link Set of an interface records links from
           other routers which are, or recently
           were, 1-hop neighbors."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpStateObjGrp 3 }

    nhdpIibLinkSetEntry  OBJECT-TYPE
       SYNTAX      NhdpIibLinkSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "A Link Set consists of Link Tuples, each
           representing a single link indexed by the
           local and remote interface pair:

           (L_neighbor_iface_addr_list, L_HEARD_time,
            L_SYM_time, L_quality, L_pending,
            L_lost, L_time)."
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpIfIndex,
               nhdpIibLinkSet1HopIfIndex }
    ::= { nhdpIibLinkSetTable 1 }

    NhdpIibLinkSetEntry ::=
       SEQUENCE {
          nhdpIibLinkSet1HopIfIndex



Herberg, et al.         Expires September 9, 2010              [Page 37]

Internet-Draft                The NHDP MIB                    March 2010


            NeighborIfIndex,
          nhdpIibLinkSetIfIndex
            InterfaceIndexOrZero,
          nhdpIibLinkSetLHeardTime
            Unsigned32,
          nhdpIibLinkSetLSymTime
            Unsigned32,
          nhdpIibLinkSetLQuality
            Unsigned32,
          nhdpIibLinkSetLPending
            TruthValue,
          nhdpIibLinkSetLLost
            TruthValue,
          nhdpIibLinkSetLTime
            Unsigned32
         }

   nhdpIibLinkSet1HopIfIndex  OBJECT-TYPE
      SYNTAX      NeighborIfIndex
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSet1HopIfIndex is
          the value of the NeighborIfIndex (from
          table nhdpDiscIfSetTable above). This
          object is repeated here to support
          table walks to view the set of neighbors
          of this router."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 1 }

   nhdpIibLinkSetIfIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetIfIndex is
          is the local router's interface
          index associated with the symmetric
          link to this entries neighbor
          interface.

          The IP addr set associated with this
          neighbor's interface is found in the
          'nhdpDiscIfSetTable' above."
      REFERENCE
         "The NHDP draft."



Herberg, et al.         Expires September 9, 2010              [Page 38]

Internet-Draft                The NHDP MIB                    March 2010


   ::= { nhdpIibLinkSetEntry 2 }

   nhdpIibLinkSetLHeardTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLHeardTime is
          the time until which the MANET
          interface of the 1-hop neighbor
          would be considered heard if not
          considering link quality."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 3 }

   nhdpIibLinkSetLSymTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLSymTime is the
          time until which the link to the
          1-hop neighbor would be considered
          symmetric if not considering link
          quality."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 4 }

   -- (Note: Is this wise to include in a MIB?  What is the
   --  frequency of updates or what are the requirements on
   --  the frequency of updates to this parameter?)
   nhdpIibLinkSetLQuality  OBJECT-TYPE
      SYNTAX      Unsigned32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLQuality is a
          dimensionless number between 0
          (inclusive) and 1 (inclusive)
          describing the quality of a link;
          a greater value of L_quality
          indicating a higher quality link."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 5 }




Herberg, et al.         Expires September 9, 2010              [Page 39]

Internet-Draft                The NHDP MIB                    March 2010


   nhdpIibLinkSetLPending  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLPending is a
          boolean flag, describing if a
          link is considered pending (i.e.,
          a candidate, but not yet
          established, link)."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 6 }

   nhdpIibLinkSetLLost  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLLost is a
          boolean flag, describing if a
          link is considered lost due
          to link quality."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 7 }

   -- Note: need to locate a time type for this object
   nhdpIibLinkSetLTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLTime specifies
          when this Tuple expires and MUST
          be removed.
         "
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 8 }





  --
  --     IIB 2-Hop Set
  --         Entry (foreach IF on a 2-H neighbor):



Herberg, et al.         Expires September 9, 2010              [Page 40]

Internet-Draft                The NHDP MIB                    March 2010


  --                                 (1NeighIfAddrList,
  --                                  2NeighIfAddr,
  --                                  ExpireTime)

    nhdpIib2HopSetTable OBJECT-TYPE
       SYNTAX       SEQUENCE OF NhdpIib2HopSetEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
           "A 2-Hop Set of an interface records network
           addresses of symmetric 2-hop neighbors, and
           the symmetric links to symmetric 1-hop neighbors
           through which these symmetric 2-hop neighbors
           can be reached.  It consists of 2-Hop Tuples,
           each representing a single network address of
           a symmetric 2-hop neighbor, and a single MANET
           interface of a symmetric 1-hop neighbor.

           (N2_neighbor_iface_addr_list,
            N2_2hop_addr, N2_time)."
       REFERENCE
          "The NHDP draft."
    ::= { nhdpStateObjGrp 4 }

    nhdpIib2HopSetEntry  OBJECT-TYPE
       SYNTAX      NhdpIib2HopSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The entries include the 2 hop neighbor addrs,
           which act as the table index, and associated
           1 hop symmetric link addr set, designated through
           the nhdpDiscIfIndex, and an expiration time."
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpIib2HopSetIpAddress }
    ::= { nhdpIib2HopSetTable 1 }

    NhdpIib2HopSetEntry ::=
       SEQUENCE {
          nhdpIib2HopSetIpAddressType
            InetAddressType,
          nhdpIib2HopSetIpAddress
            InetAddress,
          nhdpIib2HopSet1HopIfIndex
            NeighborIfIndex,
          nhdpIib2HopSetN2Time
            Unsigned32



Herberg, et al.         Expires September 9, 2010              [Page 41]

Internet-Draft                The NHDP MIB                    March 2010


         }


   nhdpIib2HopSetIpAddressType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The type of the nhdpIib2HopSetIpAddress
          in the InetAddress MIB [RFC 4001]."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetEntry 1 }

   nhdpIib2HopSetIpAddress  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIib2HopSetIpAddr is an
          address of an interface of a symmetric
          2-hop neighbor which has a symmetric
          link (using any MANET interface) to
          the indicated symmetric 1-hop neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetEntry 2 }

   nhdpIib2HopSet1HopIfIndex  OBJECT-TYPE
      SYNTAX      NeighborIfIndex
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIib2HopSet1HopIfIndex is
          NeighborIfIndex of the one hop
          neighbor which communicated the ipAddress
          of the 2 hop neighbor in this row entry."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetEntry 3 }

   -- Note: need to get a time type for this object.
   nhdpIib2HopSetN2Time  OBJECT-TYPE
      SYNTAX      Unsigned32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIib2HopSetN2Time specifies



Herberg, et al.         Expires September 9, 2010              [Page 42]

Internet-Draft                The NHDP MIB                    March 2010


          when this column entry expires and
          MUST be removed."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetEntry 4 }




   --
   -- Neighbor Information Base (NIB)
   --
   -- Each router maintains a Neighbor Information Base
   -- that records information about addresses of
   -- current and recently symmetric 1-hop neighbors.
   --
   -- All addresses MUST have an associated prefix
   -- length.  Prefix lengths are indicated in HELLO
   -- messages as specified in [1]; if an address
   -- has no specified prefix length, then its prefix
   -- length is equal to the address length.  Two
   -- addresses are considered equal if and only
   -- if their associated prefix lengths are also equal.



   --     NIB Neighbor Set
   --         Entry (foreach 1-H Neighbor):
   --              (AllIfAddrListOfIhNeighbor,
   --               SymmetricIndicator)
   --     The NIB Neighbor Set Table is small because
   --     most of the corresponding information is found
   --     in the nhdpDiscoveredIfTable above.

   nhdpNibNeighborSetTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpNibNeighborSetEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
          "A router's Neighbor Set records all network
          addresses of each 1-hop neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpStateObjGrp 5 }

   nhdpNibNeighborSetEntry  OBJECT-TYPE
      SYNTAX      NhdpNibNeighborSetEntry
      MAX-ACCESS  not-accessible



Herberg, et al.         Expires September 9, 2010              [Page 43]

Internet-Draft                The NHDP MIB                    March 2010


      STATUS      current
      DESCRIPTION
          "A router's Neighbor Set consists
           of Neighbor Tuples, each representing
           a single 1-hop neighbor:

           (N_neighbor_addr_list,
            N_symmetric)"
      REFERENCE
         "This NHDP-MIB draft."
      INDEX { nhdpNibNeighborSetRouterId }
   ::= { nhdpNibNeighborSetTable 1 }

    NhdpNibNeighborSetEntry ::=
       SEQUENCE {
          nhdpNibNeighborSetRouterId
            NeighborRouterId,
          nhdpNibNeighborSetNSymmetric
            TruthValue
         }

   nhdpNibNeighborSetRouterId  OBJECT-TYPE
      SYNTAX      NeighborRouterId
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpNibNeighborSetRouterId is
          the NeighborRouterId of a one hop
          neighbor to this router.  It must also
          exist in the 'nhdpDiscIfSetTable'
          allowing the manager to determine
          the set of Ip addr's associated
          with the NeighborRouterId in this row."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpNibNeighborSetEntry 1 }

   nhdpNibNeighborSetNSymmetric  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpNibNeighborNSymmetric is
          a boolean flag, describing if this
          is a symmetric 1-hop neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpNibNeighborSetEntry 2 }



Herberg, et al.         Expires September 9, 2010              [Page 44]

Internet-Draft                The NHDP MIB                    March 2010


  --     Lost Neighbor Set
  --         Entry ( foreach IF foreach 1-H Neighbor): (IfAddr,
  --                                                    ExpireTime)

    nhdpNibLostNeighborSetTable OBJECT-TYPE
       SYNTAX       SEQUENCE OF NhdpNibLostNeighborSetEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
           "A router's Lost Neighbor Set records network
           addresses of routers which recently were
           symmetric 1-hop neighbors, but which are now
           advertised as lost."
       REFERENCE
          "The NHDP draft."
    ::= { nhdpStateObjGrp 6 }

    nhdpNibLostNeighborSetEntry  OBJECT-TYPE
       SYNTAX      NhdpNibLostNeighborSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "A router's Lost Neighbor Set consists of
          Lost Neighbor Tuples, each representing a
          single such network address:

          (NL_neighbor_addr, NL_time)"
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpNibLostNeighborSetRouterId }
    ::= { nhdpNibLostNeighborSetTable 1 }

    NhdpNibLostNeighborSetEntry ::=
       SEQUENCE {
          nhdpNibLostNeighborSetRouterId
            NeighborRouterId,
          nhdpNibLostNeighborSetNLTime
            Unsigned32
         }

   nhdpNibLostNeighborSetRouterId  OBJECT-TYPE
      SYNTAX      NeighborRouterId
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpNibLostNeighborSetRouterId is
          the NeighborRouterId of a one hop
          neighbor to this router which was



Herberg, et al.         Expires September 9, 2010              [Page 45]

Internet-Draft                The NHDP MIB                    March 2010


          recently lost.  It must also
          exist in the 'nhdpDiscIfSetTable'
          allowing the manager to determine
          the set of Ip addr's associated
          with the NeighborRouterId in this row."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpNibLostNeighborSetEntry 1 }


   -- Note: need to fime time type for this object
   nhdpNibLostNeighborSetNLTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpNibLostNeighborSetNLTime
          specifies when this Tuple expires
          and MUST be removed."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpNibLostNeighborSetEntry 2 }



--
-- nhdpPerformanceObjGrp
--

-- Contains objects which help to characterize the performance of
-- the NHDP process, typically counters.

nhdpPerformanceObjGrp OBJECT IDENTIFIER ::= { nhdpObjects 3 }

  --
  -- Objects per local interface
  --

  nhdpInterfacePerfTable  OBJECT-TYPE
      SYNTAX      SEQUENCE OF NhdpInterfacePerfEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "This table summarizes performance objects that are
          measured per local NHDP interface."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpPerformanceObjGrp 1 }



Herberg, et al.         Expires September 9, 2010              [Page 46]

Internet-Draft                The NHDP MIB                    March 2010


   nhdpInterfacePerfEntry OBJECT-TYPE
      SYNTAX      NhdpInterfacePerfEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "A single entry contains performance counters for
          a local NHDP interface."
      INDEX { nhdpIfIndex }
   ::= { nhdpInterfacePerfTable 1 }

   NhdpInterfacePerfEntry ::=
      SEQUENCE {
         nhdpIfPerfIndex
            InterfaceIndexOrZero,
         nhdpIfHelloMessageXmits
            Counter32,
         nhdpIfHelloMessageRecvd
            Counter32,
         nhdpIfHelloMessageXmitAccumulatedSize
            Counter32,
         nhdpIfHelloMessageRecvdAccumulatedSize
            Counter32,
         nhdpIfHelloMessageTriggeredXmits
            Counter32,
         nhdpIfHelloMessagePeriodicXmits
            Counter32,
         nhdpIfHelloMessageXmitAccumulatedSymmetricNeighborCount
            Counter32,
         nhdpIfHelloMessageXmitAccumulatedHeardNeighborCount
            Counter32,
         nhdpIfHelloMessageXmitAccumulatedLostNeighborCount
            Counter32
         }

   nhdpIfPerfIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The ID of an interface.  Used for cross
          indexing into other NHDP tables and other
          MIBs."
   ::= { nhdpInterfacePerfEntry 1 }

   nhdpIfHelloMessageXmits  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current



Herberg, et al.         Expires September 9, 2010              [Page 47]

Internet-Draft                The NHDP MIB                    March 2010


      DESCRIPTION
         "A counter is incremented each time a HELLO
         message has been transmitted on that interface."
   ::= { nhdpInterfacePerfEntry 2 }

   nhdpIfHelloMessageRecvd  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented each time a
         HELLO message has been received on that interface."
   ::= { nhdpInterfacePerfEntry 3 }

   nhdpIfHelloMessageXmitAccumulatedSize  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of octets in
         a HELLO message each time a
         HELLO message has been sent."
   ::= { nhdpInterfacePerfEntry 4 }

   nhdpIfHelloMessageRecvdAccumulatedSize  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of octets in
         a HELLO message each time a
         HELLO message has been received."
   ::= { nhdpInterfacePerfEntry 5 }

   nhdpIfHelloMessageTriggeredXmits  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented each time a triggered
         HELLO message has been sent."
   ::= { nhdpInterfacePerfEntry 6 }

   nhdpIfHelloMessagePeriodicXmits  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION



Herberg, et al.         Expires September 9, 2010              [Page 48]

Internet-Draft                The NHDP MIB                    March 2010


         "A counter is incremented each time a periodic
         HELLO message has been sent."
   ::= { nhdpInterfacePerfEntry 7 }

   nhdpIfHelloMessageXmitAccumulatedSymmetricNeighborCount  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of advertized
         symmetric neighbors in a HELLO each time a HELLO
         message has been sent."
   ::= { nhdpInterfacePerfEntry 8 }

   nhdpIfHelloMessageXmitAccumulatedHeardNeighborCount  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of advertized
         heard neighbors in a HELLO each time a HELLO
         message has been sent."
   ::= { nhdpInterfacePerfEntry 9 }

   nhdpIfHelloMessageXmitAccumulatedLostNeighborCount  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of advertized
         lost neighbors in a HELLO each time a HELLO
         message has been sent."
   ::= { nhdpInterfacePerfEntry 10 }



  --
  -- Objects per discovered neighbor interface
  --

  nhdpDiscIfSetPerfTable OBJECT-TYPE
       SYNTAX       SEQUENCE OF NhdpDiscIfSetPerfEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
          "A router's set of performance properties for
          each discovered interface of a neighbor."
       REFERENCE



Herberg, et al.         Expires September 9, 2010              [Page 49]

Internet-Draft                The NHDP MIB                    March 2010


          "The NHDP draft."
   ::= { nhdpPerformanceObjGrp 2 }


   nhdpDiscIfSetPerfEntry  OBJECT-TYPE
       SYNTAX      NhdpDiscIfSetPerfEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "There is an entry for each discovered
          interface of a neighbor."
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpDiscIfSetPerfIndex }
   ::= { nhdpDiscIfSetPerfTable 1 }

    NhdpDiscIfSetPerfEntry ::=
       SEQUENCE {
          nhdpDiscIfSetPerfIndex
            NeighborIfIndex,
          nhdpDiscIfRecvdPackets
            Counter32,
          nhdpDiscIfExpectedPackets
            Counter32
         }

   nhdpDiscIfSetPerfIndex  OBJECT-TYPE
      SYNTAX      NeighborIfIndex
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The NHDP interface ID (locally created)
          of a neigboring router.  Used for cross
          indexing into other NHDP tables and other
          MIBs."
      REFERENCE
         "This NHDP-MIB draft."
   ::= { nhdpDiscIfSetPerfEntry 1 }

   nhdpDiscIfRecvdPackets  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each
         time this device receives a packet from that interface
         of the neighbor."
      REFERENCE



Herberg, et al.         Expires September 9, 2010              [Page 50]

Internet-Draft                The NHDP MIB                    March 2010


         "The NHDP draft."
   ::= { nhdpDiscIfSetPerfEntry 2 }

   nhdpDiscIfExpectedPackets  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments by the number
          of missed packets from this neighbor based
          on the packet sequence number each time this
          device receives a packet from that interface
          of the neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetPerfEntry 3 }



   --
   -- Objects concerning the neighbor set
   --

   nhdpNibNeighborSetChanges  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each time the Neighbor Set changes.
         A change occurs whenever a new Neighbor Tuple has been
         added, a Neighbor Tuple has been removed or any entry of
         a Neighbor Tuple has been modified."
   ::= { nhdpPerformanceObjGrp 3 }



   --
   -- Objects per discovered neighbor
   --

   nhdpDiscNeighborSetPerfTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpDiscNeighborSetPerfEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
          "A router's set of discovered neighbors and
           their properties."
       REFERENCE



Herberg, et al.         Expires September 9, 2010              [Page 51]

Internet-Draft                The NHDP MIB                    March 2010


          "The NHDP draft."
   ::= { nhdpPerformanceObjGrp 4 }

   nhdpDiscNeighborSetPerfEntry  OBJECT-TYPE
       SYNTAX      NhdpDiscNeighborSetPerfEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The entries include the nhdpDiscRouterId of
           the discovered router, as well as performance
           objects related to changes of the Neighbor
           Set."
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpDiscNeighborSetRouterId }
   ::= { nhdpDiscNeighborSetPerfTable 1 }

    NhdpDiscNeighborSetPerfEntry ::=
       SEQUENCE {
          nhdpDiscNeighborSetRouterId
            NeighborRouterId,
          nhdpDiscNeighborNibNeighborSetChanges
            Counter32,
          nhdpDiscNeighborNibNeighborSetUpTime
            Unsigned32,
          nhdpDiscNeighborNibNeighborSetReachableLinkChanges
            Counter32
         }

   nhdpDiscNeighborSetRouterId  OBJECT-TYPE
      SYNTAX      NeighborRouterId
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The NHDP router ID (locally created)
          of a neigboring router.  Used for cross
          indexing into other NHDP tables and other
          MIBs."
      REFERENCE
         "This NHDP-MIB draft."
   ::= { nhdpDiscNeighborSetPerfEntry 1 }

   -- (Note: Can we point this to changes in a state grp
   --  table below?)
   nhdpDiscNeighborNibNeighborSetChanges  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current



Herberg, et al.         Expires September 9, 2010              [Page 52]

Internet-Draft                The NHDP MIB                    March 2010


      DESCRIPTION
         "This counter increments each time the neighbor becomes
         onlink or offlink.  A neighbor is said to become
         'onlink' if a new Neighbor Tuple is created that
         corresponds to the given neighbor.  It becomes 'offlink'
         if such a tuple has been deleted."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscNeighborSetPerfEntry 2 }

   -- (Note: Can we point this to the time since an entry in a
   --  table below has changed?)
   nhdpDiscNeighborNibNeighborSetUpTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This object returns the time in milliseconds since
         the neighbor becomes onlink or offlink.  A neighbor is
         said to become 'onlink' if a new Neighbor Tuple is created that
         corresponds to the given neighbor.  It becomes 'offlink' if
         such a tuple has been deleted.

         Positive values indicate that the neighbor is currently
         'onlink' and indicates the duration of the current 'onlink'
         period.  Negative values indicate that the neighbor is
         currently 'offlink' and the magnitude indicates the
         duration of the current 'offlink' period."
      REFERENCE
         "This NHDP-MIB draft."
   ::= { nhdpDiscNeighborSetPerfEntry 3 }

   nhdpDiscNeighborNibNeighborSetReachableLinkChanges  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each
         time the neighbor changes the interface over which it is
         reachable.  That means that the corresponding Link Tuple of the
         given link moves from the Link Set of one interface to another
         interface."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscNeighborSetPerfEntry 4 }






Herberg, et al.         Expires September 9, 2010              [Page 53]

Internet-Draft                The NHDP MIB                    March 2010


   --
   -- Objects per discovered 2-hop neighbor
   --

   nhdpIib2HopSetPerfTable OBJECT-TYPE
       SYNTAX       SEQUENCE OF NhdpIib2HopSetPerfEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
           "This table contains performance objects per
           discovered 2-hop neighbor."
       REFERENCE
          "The NHDP draft."
    ::= { nhdpPerformanceObjGrp 5 }

    nhdpIib2HopSetPerfEntry  OBJECT-TYPE
       SYNTAX      NhdpIib2HopSetPerfEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The entries contain performance objects per
           discovered 2-hop neighbor."
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpIib2HopSetIpAddress }
    ::= { nhdpIib2HopSetPerfTable 1 }

    NhdpIib2HopSetPerfEntry ::=
       SEQUENCE {
          nhdpIib2HopSetPerfIpAddress
            InetAddress,
          nhdpIib2HopSetPerfChanges
            Counter32,
          nhdpIib2HopSetPerfUpTime
            Unsigned32
         }

   nhdpIib2HopSetPerfIpAddress  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpIib2HopSetIpAddr is an
          address of an interface of a symmetric
          2-hop neighbor which has a symmetric
          link (using any MANET interface) to
          the indicated symmetric 1-hop neighbor."
      REFERENCE



Herberg, et al.         Expires September 9, 2010              [Page 54]

Internet-Draft                The NHDP MIB                    March 2010


         "The NHDP draft."
   ::= { nhdpIib2HopSetPerfEntry 1 }

   nhdpIib2HopSetPerfChanges  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each
         time this 2-hop neighbor changes its
         N2_neighbor_iface_addr_list in the
         nhdpIib2HopSetTable."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetPerfEntry 2 }

   nhdpIib2HopSetPerfUpTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This object returns the time in milliseconds since
         the 2-Hop Tuple
         corresponding to the given 2-hop neighbor IP address exists
         in the nhdpIib2HopSetTable."
      REFERENCE
         "This NHDP-MIB draft."
   ::= { nhdpIib2HopSetPerfEntry 3 }





--
-- nhdpNotifications
--

nhdpNotificationsGrp OBJECT IDENTIFIER ::= { nhdpObjects 4 }
nhdpNotificationsControl OBJECT IDENTIFIER ::= { nhdpObjects 5 }
nhdpNotificationsStates OBJECT IDENTIFIER ::= { nhdpObjects 6 }

   nhdpSetNotification OBJECT-TYPE
          SYNTAX       OCTET STRING (SIZE(4))
          MAX-ACCESS   read-write
          STATUS       current
          DESCRIPTION
             "A 4-octet string serving as a bit map for
             the notification events defined by the NHDP



Herberg, et al.         Expires September 9, 2010              [Page 55]

Internet-Draft                The NHDP MIB                    March 2010


             notifications. This NHDP notifications where
             a 1 in the bit field represents enabled. The
             right-most bit (leastsignificant) represents
             notification 0.

             This object is persistent and when written
             the entity SHOULD save the change to
             non-volatile storage."
           ::= { nhdpNotificationsControl 1 }


   nhdpMessageSrc OBJECT-TYPE
          SYNTAX       InetAddress
          MAX-ACCESS   read-only
          STATUS       current
          DESCRIPTION
             "The IP address of an inbound message that
             cannot be identified by a neighbor instance.  When
             the last value of a notification using this object is
             needed, but no notifications of that type have been sent,
             this value pertaining to this object should
             be returned as 0.0.0.0 or :: respectively."
          ::= { nhdpNotificationsControl 2 }

   -- Notifications

   -- Note: does this work when the neighbor goes down?
   -- (there is no nhdpNibNeighborSetRouterId any more...)

   nhdpNbrStateChange NOTIFICATION-TYPE
          OBJECTS { nhdpDiscIfSetRouterId, -- The originator
                                                -- of the notification
             nhdpNbrState  -- The new state
             }
          STATUS       current
          DESCRIPTION
             "An nhdpNbrStateChange notification signifies that
             there has been a change in the state of a
             NHDP neighbor."
          ::= { nhdpNotificationsGrp 1 }


    nhdpNbrState OBJECT-TYPE
       SYNTAX       INTEGER {
                       down (0),
                       asymmetric (1),
                       symmetric(2)
                       }



Herberg, et al.         Expires September 9, 2010              [Page 56]

Internet-Draft                The NHDP MIB                    March 2010


       MAX-ACCESS   read-only
       STATUS       current
       DESCRIPTION
          "NHDP neighbor states."
       DEFVAL { down }
       ::= { nhdpNotificationsStates 1 }



    nhdp2hopNbrStateChange NOTIFICATION-TYPE
          OBJECTS { nhdpIib2HopSetIpAddress, -- The originator
                                             -- of the notification
             nhdp2hopNbrState  -- The new state
             }
          STATUS       current
          DESCRIPTION
             "An nhdp2hopNbrStateChange notification signifies that
             there has been a change in the state of a 2-hop
             neighbor.  This notification should be
             generated when the 2-hop neighbor state goes
             down or up."
          ::= { nhdpNotificationsGrp 2 }

   nhdp2hopNbrState OBJECT-TYPE
       SYNTAX       INTEGER {
                       down (0),
                       up (1)
                       }
       MAX-ACCESS   read-only
       STATUS       current
       DESCRIPTION
          "NHDP 2hop neighbor states."
       DEFVAL { down }
       ::= { nhdpNotificationsStates 2 }


   nhdpIfRxBadMessage NOTIFICATION-TYPE
          OBJECTS { nhdpDiscIfSetRouterId, -- The originator of
                                           -- the notification
             nhdpDiscIfSetIndex,  -- The interface on which the
                                  -- message has been received
             nhdpMessageSrc  -- The source IP address
             }
          STATUS       current
          DESCRIPTION
             "An nhdpIfRxBadMessage notification signifies that a
             HELLO message has been received on an
             interface that cannot be parsed."



Herberg, et al.         Expires September 9, 2010              [Page 57]

Internet-Draft                The NHDP MIB                    March 2010


          ::= { nhdpNotificationsGrp 3 }


   nhdpIfStateChange NOTIFICATION-TYPE
          OBJECTS { nhdpIfIndex, -- The local interface
             nhdpIfState   -- The new state
             }
          STATUS       current
          DESCRIPTION
             "An nhdpIfStateChange notification signifies that there
             has been a change in the state of an NHDP
             interface.  This notification should be generated
             when the interface goes up or down, or when
             the list of addresses of that interface
             changes."
          ::= { nhdpNotificationsGrp 4 }

   nhdpIfState OBJECT-TYPE
       SYNTAX       INTEGER {
                       down (0),
                       up (1),
                       addresschange(2) -- If a new address has been
                                         -- added or an address has
                                         -- been removed
                       }
       MAX-ACCESS   read-only
       STATUS       current
       DESCRIPTION
          "NHDP interface states."
       DEFVAL { down }
       ::= { nhdpNotificationsStates 3 }








--
-- nhdpConformance information
--

-- Note: To be determined.

nhdpCompliances       OBJECT IDENTIFIER ::= { nhdpConformance 1 }
nhdpMIBGroups         OBJECT IDENTIFIER ::= { nhdpConformance 2 }




Herberg, et al.         Expires September 9, 2010              [Page 58]

Internet-Draft                The NHDP MIB                    March 2010


-- Compliance Statements
nhdpBasicCompliance MODULE-COMPLIANCE
  STATUS current
  DESCRIPTION
    "The basic implementation requirements for
     managed network entities that implement
     NHDP."
  MODULE -- this module

  MANDATORY-GROUPS { nhdpConfigurationGroup }


  ::= { nhdpCompliances 1 }

nhdpFullCompliance MODULE-COMPLIANCE
  STATUS current
  DESCRIPTION
    "The full implementation requirements for
     managed network entities that implement
     NHDP."
  MODULE -- this module

  MANDATORY-GROUPS { nhdpConfigurationGroup,
                     nhdpStateGroup,
                     nhdpNotificationGroup,
                     nhdpPerformanceGroup }

  ::= { nhdpCompliances 2 }


--
-- Units of Conformance
--

  nhdpConfigurationGroup OBJECT-GROUP
     OBJECTS {
              nhdpIfStatus,
              nhdpHelloInterval,
              nhdpHelloMinInterval,
              nhdpRefreshInterval,
              nhdpLHoldTime,
              nhdpHHoldTime,
              nhdpHystAcceptQuality,
              nhdpHystRejectQuality,
              nhdpInitialQuality,
              nhdpInitialPending,
              nhdpHpMaxJitter,
              nhdpHtMaxJitter,



Herberg, et al.         Expires September 9, 2010              [Page 59]

Internet-Draft                The NHDP MIB                    March 2010


              nhdpNHoldTime,
              nhdpIHoldTime,
              nhdpIfRowStatus
             }
      STATUS  current
      DESCRIPTION
         "Set of NHDP configuration objects implemented
          in this module."
   ::= { nhdpMIBGroups 2 }

  nhdpStateGroup OBJECT-GROUP
     OBJECTS {
              nhdpDiscIfSetRouterId,
              nhdpDiscIfSetIndex,
              nhdpDiscIfSetIpAddrType,
              nhdpDiscIfSetIpAddrPrefixLen,
              nhdpLibRemovedIfAddrSetIpAddrType,
              nhdpLibRemovedIfAddrSetIpAddrPrefixLen,
              nhdpLibRemovedIfAddrSetIfIndex,
              nhdpLibRemovedIfAddrSetIrTime,
              nhdpIibLinkSetIfIndex,
              nhdpIibLinkSetLHeardTime,
              nhdpIibLinkSetLSymTime,
              nhdpIibLinkSetLQuality,
              nhdpIibLinkSetLPending,
              nhdpIibLinkSetLLost,
              nhdpIibLinkSetLTime,
              nhdpIib2HopSetIpAddressType,
              nhdpIib2HopSet1HopIfIndex,
              nhdpIib2HopSetN2Time,
              nhdpNibNeighborSetNSymmetric,
              nhdpNibLostNeighborSetNLTime
             }
      STATUS  current
      DESCRIPTION
         "Set of NHDP state objects implemented
          in this module."
   ::= { nhdpMIBGroups 3 }

  nhdpPerformanceGroup OBJECT-GROUP
     OBJECTS {
              nhdpIfHelloMessageXmits,
              nhdpIfHelloMessageRecvd,
              nhdpIfHelloMessageXmitAccumulatedSize,
              nhdpIfHelloMessageRecvdAccumulatedSize,
              nhdpIfHelloMessageTriggeredXmits,
              nhdpIfHelloMessagePeriodicXmits,
              nhdpIfHelloMessageXmitAccumulatedSymmetricNeighborCount,



Herberg, et al.         Expires September 9, 2010              [Page 60]

Internet-Draft                The NHDP MIB                    March 2010


              nhdpIfHelloMessageXmitAccumulatedHeardNeighborCount,
              nhdpIfHelloMessageXmitAccumulatedLostNeighborCount,
              nhdpDiscIfRecvdPackets,
              nhdpDiscIfExpectedPackets,
              nhdpNibNeighborSetChanges,
              nhdpDiscNeighborNibNeighborSetChanges,
              nhdpDiscNeighborNibNeighborSetUpTime,
              nhdpDiscNeighborNibNeighborSetReachableLinkChanges,
              nhdpIib2HopSetPerfChanges,
              nhdpIib2HopSetPerfUpTime
            }
      STATUS  current
      DESCRIPTION
         "Set of NHDP performance objects implemented
          in this module."
   ::= { nhdpMIBGroups 4 }

  nhdpNotificationGroup NOTIFICATION-GROUP
     NOTIFICATIONS {
             nhdpNbrStateChange,
             nhdp2hopNbrStateChange,
             nhdpIfRxBadMessage,
             nhdpIfStateChange
             }
      STATUS  current
      DESCRIPTION
         "Set of NHDP notification objects implemented
          in this module."
   ::= { nhdpMIBGroups 5 }




END

8.  Security Considerations

   This MIB defines objects for the configuration, monitoring and
   notification of the Neighborhood Discovery Protocol (NHDP) [NHDP].
   NHDP allows routers to acquire topological information up to two hops
   away by virtue of exchanging HELLO messages.  The information
   acquired by NHDP is used by other protocols, such as OLSRv2 [OLSRv2]
   and SMF [SMF], and possibly other protocols.  The neighborhood
   information, exchanged between routers using NHDP, serves these
   routing protocols as a baseline for calculating paths to all
   destinations in the MANET, relay set selection for network-wide
   transmissions etc.




Herberg, et al.         Expires September 9, 2010              [Page 61]

Internet-Draft                The NHDP MIB                    March 2010


   There are a number of management objects defined in this MIB module
   with a MAX-ACCESS clause of read-write and/or read-create.  Such
   objects may be considered sensitive or vulnerable in some network
   environments.  The support for SET operations in a non-secure
   environment without proper protection can have a negative effect on
   network operations.  These are the tables and objects and their
   sensitivity/vulnerability:

   o  Specifically sensitive objects -

   o  nhdpIfStatus - this writable object turns on or off the NHDP
      process for the specified interface.  If disabled, higher level
      protocol functions, e.g., routing, would fail causing network-wide
      disruptions.

   o  nhdpHelloInterval, nhdpHelloMinInterval, and nhdpRefreshInterval -
      these writable objects control the rate at which HELLO messages
      are sent on a wireless interface.  If set at too high a rate, this
      could represent a form of DOS attack by overloading interface
      resources.

   o  nhdpHystAcceptQuality, nhdpHystRejectQuality, nhdpInitialQuality,
      nhdpInitialPending - these writable objects affect the perceived
      quality of the HNDP links and hence the overall stability of the
      network.  If improperly set, these settings could result in
      network-wide disruptions.

   o  The writable tables -

   o  nhdpInterfaceTable - this table contains writable objects that
      affect the overall performance and stability of the NHDP process.
      Failure of the NHDP process would result in network-wide failure.
      Particularly sensitive objects from this table are discussed in
      the previous list items.  This is the only table in the NHDP-MIB
      with writable objects.

   Some of the readable objects in this MIB module (i.e., objects with a
   MAX-ACCESS other than not-accessible) may be considered sensitive or
   vulnerable in some network environments.  It is thus important to
   control even GET and/or NOTIFY access to these objects and possibly
   to even encrypt the values of these objects when sending them over
   the network via SNMP.  These are the tables and objects and their
   sensitivity/vulnerability:

   o  nhdpDiscIfSetTable - The contains information on discovered
      neighbors, specifically their IP address in the
      nhdpDiscIfSetIpAddr object.  This information provides an
      adversary broad information on the members of the MANET, located



Herberg, et al.         Expires September 9, 2010              [Page 62]

Internet-Draft                The NHDP MIB                    March 2010


      within this single table.  This information can be use to expedite
      attacks on the other members of the MANET without having to go
      through a laborious discovery process on their own.  This object
      is the index into the table, and has a MAX-ACCESS of 'not-
      accessible'.  However this information can be exposed using SNMP
      operations.

   MANET technology is often deployed to support communications of
   emergency services or military tactical applications.  In these
   applications, it is imperative to maintain the proper operation of
   the communications network and to protect sensitive information
   related to its operation.  Therefore, when implementing these
   capabilities, the full use of SNMPv3 cryptographic machanisms for
   authentication and privacy is RECOMMENDED.

   SNMP versions prior to SNMPv3 did not include adequate security.
   Even if the network itself is secure (for example by using IPSec),
   there is no control as to who on the secure network is allowed to
   access and GET/SET (read/change/create/delete) the objects in this
   MIB module.

   It is RECOMMENDED that implementers consider the security features as
   provided by the SNMPv3 framework (see [RFC3410], section 8),
   including full support for the SNMPv3 cryptographic mechanisms (for
   authentication and privacy).

   Further, deployment of SNMP versions prior to SNMPv3 is NOT
   RECOMMENDED.  Instead, it is RECOMMENDED to deploy SNMPv3 and to
   enable cryptographic security.  It is then a customer/operator
   responsibility to ensure that the SNMP entity giving access to an
   instance of this MIB module is properly configured to give access to
   the objects only to those principals (users) that have legitimate
   rights to indeed GET or SET (change/create/delete) them.

9.  IANA Considerations

   This memo includes no request to IANA.

10.  Contributors

   This MIB document uses the template authored by D. Harrington which
   is based on contributions from the MIB Doctors, especially Juergen
   Schoenwaelder, Dave Perkins, C.M.Heard and Randy Presuhn.

11.  References






Herberg, et al.         Expires September 9, 2010              [Page 63]

Internet-Draft                The NHDP MIB                    March 2010


11.1.  Normative References

   [RFC2863]  McCloghrie, K. and F. Kastenholz, "The Interfaces Group
              MIB", RFC 2863, June 2000.

   [RFC3418]  Presuhn, R., "Management Information Base (MIB) for the
              Simple Network Management Protocol (SNMP)", STD 62,
              RFC 3418, December 2002.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2578]  McCloghrie, K., Ed., Perkins, D., Ed., and J.
              Schoenwaelder, Ed., "Structure of Management Information
              Version 2 (SMIv2)", STD 58, RFC 2578, April 1999.

   [RFC2579]  McCloghrie, K., Ed., Perkins, D., Ed., and J.
              Schoenwaelder, Ed., "Textual Conventions for SMIv2",
              STD 58, RFC 2579, April 1999.

   [RFC2580]  McCloghrie, K., Perkins, D., and J. Schoenwaelder,
              "Conformance Statements for SMIv2", STD 58, RFC 2580,
              April 1999.

   [NHDP]     Clausen, T., Dearlove, C., and J. Dean, "The MANET
              Neighborhood Discovery Protocol (NHDP)",
              draft-ietf-manet-nhdp-11 (work in progress), October 2009.

   [RFC4001]  Daniele, M., Haberman, B., Routhier, S., and J.
              Schoenwaelder, "Textual Conventions for Internet Network
              Addresses", RFC 4001, February 2005.

11.2.  Informative References

   [REPORT]   Cole, R., Macker, J., and A. Morton, "Definition of
              Managed Objects for Performance Reporting",
              draft-cole-manet-report-mib-02 (work in progress),
              March 2010.

   [RFC5148]  Clausen, T., Dearlove, C., and B. Adamson, "Jitter
              Considerations in Mobile Ad Hoc Networks (MANETs)",
              RFC 5148, February 2008.

   [OLSRv2]   Clausen, T., Dearlove, C., and P. Philippe, "The Optimized
              Link State Routing Protocol version 2", work in
              progress draft-ietf-manet-olsrv2-10.txt, September 2009.

   [SMF]      Macker, J., "Simplified Multicast Forwarding", work in



Herberg, et al.         Expires September 9, 2010              [Page 64]

Internet-Draft                The NHDP MIB                    March 2010


              progress draft-ietf-manet-smf-09.txt, July 2009.

   [RFC3410]  Case, J., Mundy, R., Partain, D., and B. Stewart,
              "Introduction and Applicability Statements for Internet-
              Standard Management Framework", RFC 3410, December 2002.

   [RFC3781]  Strauss, F. and J. Schoenwaelder, "Next Generation
              Structure of Management Information (SMIng) Mappings to
              the Simple Network Management Protocol (SNMP)", RFC 3781,
              May 2004.

Appendix A.  Change Log

   Here we list the changes made to the various drafts of this MIB.

   We list here the changes made on the draft-ietf-manet-nhdp-mib-02
   draft to generate the draft-ietf-manet-nhdp-mib-03 draft.

   1.  Cleaned up text in the Performance Group section defining the
       base versus the derived (from the REPORT-MIB) objects.

   2.  Added the local nhdpIfIndex to the nhdpIibLinkSetTable.  A duplex
       of interface indecies is required to define a wireless link.

   3.  Added text to the Security Considerations section.

   4.  Added notifications.

   We list here the changes made on the draft-ietf-manet-nhdp-mib-01
   draft to generate the draft-ietf-manet-nhdp-mib-02 draft.

   1.  Cleaned up several things (e.g. moved N_HOLD_TIME from interface
       parameter to router paramter)

   2.  Updated to NHDP draft version 11

   We list here the changes made on the draft-ietf-manet-nhdp-mib-00
   draft to generate the draft-ietf-manet-nhdp-mib-01 draft.

   1.  Made and extensive addition in the area of performance
       monitoring.  Added text in the front material, added a
       PerformanceGroup to the MIB and added the PerformanceGroup to the
       Conformance Sections.

   We list here the changes made on the draft-cole-manet-nhdp-mib-01
   draft to generate the draft-ietf-manet-nhdp-mib-00 draft.





Herberg, et al.         Expires September 9, 2010              [Page 65]

Internet-Draft                The NHDP MIB                    March 2010


   1.  Cleanup up numerous typos and add material to the Conformance
       section in order to pass the MIB checker, i.e., smilint.

   We list here the changes made on the draft-cole-manet-nhdp-mib-00
   draft to generate the draft-cole-manet-nhdp-mib-01 draft.

   1.  Defined the NeighborIfIndex and the NeighborRouterId textual
       conventions.  These identify a remote neighbor IfIndex and a
       remote neighbor router and are used as indexes into NHDP state
       tables.  These constructs were necessary in order to associate
       address lists with specific remote interfaces as required by the
       NHDP protocol specification.

   2.  Developed the nhdpInterfaceTable as part of the configuration
       group.

   3.  Developed the nhdpDiscIfSetTable as a means to associate address
       lists with remotely discovered neighbor interfaces.

   4.  Added tables defining the router's NHDP Local Information Base
       (LIB) as specified in the NHPD protocol specification.

   5.  Added tables defining the router's NHDP Interface information
       Base (IIB) as specified in the NHPD protocol specification.

   6.  Added tables defining the router's NHDP Neighbor Information Base
       (NIB) as specified in the NHPD protocol specification.

   7.  Aligned the NHDP-MIB and the OLSRv2-MIB configuration tables and
       indexing.

Appendix B.  Open Issues

   This section contains the set of open issues related to the
   development and design of the NHDP-MIB.  This section will not be
   present in the final version of the MIB and will be removed once all
   the open issues have been resolved.

   1.  How to handle dynamic parameters within NHDP?  Should we expose
       setting, min and max values?

   2.  Identify all objects requiring non-volatile storage in their
       DESCRIPTION clauses.

   3.  Incorporate parameter relationship conditions into their
       DESCRIPTION clauses.





Herberg, et al.         Expires September 9, 2010              [Page 66]

Internet-Draft                The NHDP MIB                    March 2010


   4.  Also, specify specific SNMP response to the snmp set request,
       i.e., 'generic error', 'bad value', etc.

   5.  Clean up all of the 'Note:' statements within the body of the
       MIB.

   6.  Work on the relationship to other MIBs, IF-MIB, REPORT-MIB,
       OLSRv2-MIB.

   7.  Cleanup all the [TODOs] from the MIB template.

Appendix C.


   ***************************************************************
   * Note to the RFC Editor (to be removed prior to publication) *
   *                                                             *
   * 1) The reference to RFCXXXX within the DESCRIPTION clauses  *
   * of the MIB module point to this draft and are to be         *
   * assigned by the RFC Editor.                                 *
   *                                                             *
   * 2) The reference to RFCXXX2 throughout this document point  *
   * to the current draft-ietf-manet-nhdp-mib-xx.txt.  This      *
   * need to be replaced with the XXX RFC number.                *
   *                                                             *
   ***************************************************************

Authors' Addresses

   Ulrich Herberg
   LIX, Ecole Polytechnique
   Palaiseau Cedex,   91128
   France

   EMail: ulrich@herberg.name
   URI:   http://www.herberg.name/


   Robert G. Cole
   Johns Hopkins University
   3400 North Charles Street, NEB Room 213
   Baltimore, Maryland  21218
   USA

   Phone: +1 443 910 4420
   EMail: rgcole01@comcast.net
   URI:   http://www.cs.jhu.edu/~rgcole/




Herberg, et al.         Expires September 9, 2010              [Page 67]

Internet-Draft                The NHDP MIB                    March 2010


   Ian D Chakeres
   CenGen
   9250 Bendix Road North
   Columbia, Maryland  560093
   USA

   EMail: ian.chakeres@gmail.com
   URI:   http://www.ianchak.com/











































Herberg, et al.         Expires September 9, 2010              [Page 68]

