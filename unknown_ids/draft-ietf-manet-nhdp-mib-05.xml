<?xml version="1.0" encoding="US-ASCII"?>
<!-- change the "txt" on the previous line to "xml" to make this valid XML -->
<!--
  XML2RFC offers an include feature described in the XML2RFC README
  file.  That syntax, however, contradicts the DTD requirements to
  have <reference> elements within the <references> element, so an 
  XML parser is likely to find your XML file invalid.  It may be
  possible that XML2RFC will change their DTD so that the XML file
  remains valid when their style of include is used.

  In the meantime therefore, we use an alternative valid-XML approach
  to includes, which unfortunately require that define your includes
  at the beginning of the file. Since the biggest benefit of includes
  is for references, this requires that your references be defined in
  ENTITY clauses here before being "included" and cited elsewhere in
  the file.
-->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" >
<?rfc toc="yes"?>
<?rfc symrefs="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc strict="no"?>
<?rfc rfcedstyle="yes"?>
<!--
  This template is for authors of IETF specifications containing MIB
  modules.  This template can be used as a starting point to produce
  specifications that comply with the Operations &amp; Management Area
  guidelines for MIB module documents.
-->
<!--
  Throughout this template, the marker "[TODO]" is used to indicate an
  element or text that requires replacement or removal.
-->
<!-- Intellectual Property section -->
<!--
  The Intellectual Property section will be generated automatically by
  XML2RFC, based on the ipr attribute in the rfc element.
-->
<!-- 
  [TODO] specify the name of the output document. This is optional;
the default is to use the base portion of the XML filename. 
[TODO]For Internet-drafts, indicate which intellectual property notice 
to use per the rules of RFC3978.
Specify this in the ipr attribute.  The value can be:
    full3978 -
    noModification3978 -
    noDerivatives3978 -
[TODO] Specify the category attribute per RFC2026 
options are info, std, bcp, or exp.
[TODO] if this document updates an RFC, specify the RFC in the 
"updates" attribute
-->
<rfc category="std" docName="draft-ietf-manet-nhdp-mib-05" ipr="trust200902">
  <front>

    <!--
[TODO] Enter the full document title and an abbreviated version
  to use in the page header.
-->

    <title abbrev="The NHDP MIB">Definition of Managed Objects for the
    Neighborhood Discovery Protocol</title>

    <!-- [TODO] copy the author block as many times as needed, one for each author.-->

    <!-- If the author is acting as editor, use the <role=editor> attribute-->

    <!-- see RFC2223 for guidelines regarding author names -->

	<author fullname="Ulrich Herberg" initials="U.H." role="" surname="Herberg">
      <organization>LIX, Ecole Polytechnique</organization>
      <address>
        <postal>
          <street></street>
          <city>Palaiseau Cedex</city>
          <region></region>
          <code>91128</code>
          <country>France</country>
        </postal>
        <email>ulrich@herberg.name</email>
        <uri>http://www.herberg.name/</uri>
      </address>
    </author>

    <author fullname="Robert G. Cole" initials="R.G." role="" surname="Cole">
      <organization>US Army CERDEC</organization>
      <address>
        <postal>
          <street>328 Hopkins Road, Bldg 245</street>
          <city>Aberdeen Proving Ground</city>
          <region>Maryland</region>
          <code>21005</code>
          <country>USA</country>
        </postal>
        <phone>+1 410 278 6779</phone>
        <email>robert.g.cole@us.army.mil</email>
        <uri>http://www.cs.jhu.edu/~rgcole/</uri>
      </address>
    </author>

    <author fullname="Ian D Chakeres" initials="I.D." role="" surname="Chakeres">
      <organization>CenGen</organization>
      <address>
        <postal>
          <street>9250 Bendix Road North</street>
          <city>Columbia</city>
          <region>Maryland</region>
          <code>560093</code>
          <country>USA</country>
        </postal>
        <email>ian.chakeres@gmail.com</email>
        <uri>http://www.ianchak.com/</uri>
      </address>
    </author>


    <date year="2010" />

    <area>MANET &amp; Routing Area</area>

    <workgroup>Internet Engineering Task Force</workgroup>

    <keyword>Network Management</keyword>
    <keyword>Management Information base</keyword>
    <keyword>MIB</keyword>
    <keyword>SMIv2</keyword>

    <keyword>Routing</keyword>
    <keyword>Neighbor Discovery</keyword>
    <keyword>MANET</keyword>


    <abstract>
      <t>This memo defines a portion of the Management Information Base (MIB)
      for use with network management protocols in the Internet community.
      In particular, it describes objects for configuring aspects of the
      Neighborhood Discovery Protocol (NHDP) process on a router.
      The NHDP MIB also reports state and performance information
      and notifications.  This additional
      state and performance information is useful to management
      stations troubleshooting neighbor discovery problems.</t>
    </abstract>

  </front>


  <middle>
    <section title="Introduction">
      <t>This memo defines a portion of the Management Information Base (MIB)
      for use with network management protocols in the Internet community.
      In particular, it describes objects for configuring aspects of the
      Neighborhood Discovery Protocol (NHDP)  <xref target="NHDP"/>
      process on a router.  The NHDP MIB also reports state and
      performance information and notifications.  This additional state 
      and performance information is useful to management stations 
      troubleshooting neighbor discovery problems.</t>
    </section>


    <section title="The Internet-Standard Management Framework">
      <t><!-- The title and text for this section has been copied from the 
         official boilerplate, and should not be modified unless the boilerplate 
         text at http;//ops.ietf.org/mib-boilerplate.html has changed. See RFC4818 
         section 3.1 for a discussion of the boilerplate section.-->
         For a detailed overview of the documents that describe the current 
         Internet-Standard Management Framework, please refer to 
         section 7 of RFC 3410 <xref target="RFC3410"/>.</t>

      <t>Managed objects are accessed via a virtual information store, termed
      the Management Information Base or MIB. MIB objects are generally
      accessed through the Simple Network Management Protocol (SNMP). Objects      
      in the MIB are defined using the mechanisms defined in the Structure of
      Management Information (SMI). This memo specifies a MIB module that is
      compliant to the SMIv2, which is described in STD 58, 
      RFC 2578 <xref target="RFC2578"></xref>, STD 58, 
      RFC 2579 <xref target="RFC2579"></xref> and STD 58, 
      RFC 2580 <xref target="RFC2580"></xref>.</t>
    </section>

    <section title="Conventions">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
         "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
         document are to be interpreted as described in 
         RFC 2119 <xref target="RFC2119"></xref>.</t>
    </section>


    <section title="Overview">
      <t>The NHDP protocol allows a router in a Mobile Ad-Hoc
      Network (MANET) to discover and track topological 
      information of routers up to two hops away by virtue of exchanging 
      HELLO messages. This information is useful for routers running
      various routing and multicast flooding protocols developed
      within the IETF MANET Working Group.</t>


      <section title="Terms">
        <t>The following definitions apply throughout this document:</t>
        <t><list style='symbols'>
          <t>Configuration Objects - switches, tables, objects
             which are initialized to default settings or set
             through the management interface defined by this MIB.</t>
          <t>State Objects - automatically generated values which
             define the current operating state of the NHDP
             protocol process in the router.</t>
          <t>Performance Objects - automatically generated values
             which help an administrator or automated tool to
             assess the performance of the NHDP protocol process
             on the router and the overall discovery performance
             within the NHDP domain.</t>
          <t>Notification Objects - triggers and associated notification
             messages allowing for asynchronous tracking of pre-defined
             events on the managed device.</t>
        </list></t>
      </section>    

    </section>



    <section title="Structure of the MIB Module">
      <t>This section presents the structure of the NHDP MIB module. 
         The MIB is arranged into the following structure:</t>
      <t><list style='symbols'>
        <t>nhdpNotifications - objects defining NHDP MIB notifications.</t>
        <t>nhdpObjects - management objects within this MIB.
           The objects are arranged into the following groups:
           <list style='symbols'>
              <t>Configuration Group - defining objects related to 
                 the configuration of the NHDP instance on the device.</t>
              <t>State Group - defining objects which reflect the current
                 state of the NHDP instance running on the device.</t>
              <t>Performance Group - defining objects which are 
                 useful to a management station when characterizing the
                 performance of NHDP on the device and in the MANET.</t>
           </list></t>
        <t>nhdpConformance - defining the minimal and maximal conformance
           requirements for implementations of this MIB.</t>
      </list></t>


      <section title="Notifications">
         <t>The Notifications subtree contains the list of notifications supported within the 
            NHDP-MIB and describes their intended purpose or utility. 
            The following notifications are specified:</t>
         <t><list style='symbols'>
            <t>nhdpNbrStateChange is a notification sent each time the status of a neighbor has changed. 
               Possible status values are 'down', 'asymmetric', and 'symmetric'.
            </t>
            <t>nhdp2hopNbrStateChange is a notification sent each time the status of 
               a two hop neighbor has changed. Possible status values are 'down' and 'up'.
            </t>
            <t>nhdpIfRxBadMessage is a notification sent each time an incoming HELLO message 
               has not been successfully parsed on an interface.
            </t>
            <t>nhdpIfStateChange is a notification sent each time the status of an interface 
               of the designated router has changed (i.e. an IP address has been added or 
               removed to the interface, or the interface has changed its status
               from 'up' to 'down' or vice versa).
            </t>
         </list></t>
           
      </section>



      <section title="The Configuration Group">
        <t>The NHDP device is configured with a set of controls.
           The authoritative list of configuration controls within the NHDP-MIB
           are found within the MIB module itself.  Generally, an attempt was
           made in developing the NHDP-MIB module to support all configuration
           objects defined within the NHDP protocol definition
           <xref target="NHDP"/>. 
           For all of the configuration parameters,  
           the same constraints and default values of these parameters 
           as defined in <xref target="NHDP"/> are followed.</t>
      </section>



      <section title="The State Group">
        <t>The State Group reports current state information, 
           including neighbor tables.  The NHDP-MIB State Group tables
           were designed to contain the complete set of state information
           defined within the information bases within the NHDP protocol
           <xref target="NHDP"/>.</t>

        <t>Two constructs, i.e., TEXTUAL CONVENTIONs, are defined in support of the 
           tables in the State Group.  These are the NeighborIfIndex
           and NeighborRouterId.  These are locally (to the NHDP device)
           defined, unique identifiers.  They are used to define indexes to the
           appropriate State Group tables and to correlate table entries
           to interface addresses, interfaces and routers within the NHDP
           domain.  The NeighborIfIndex is a unique identifier of discovered
           NHDP interfaces on all routers within the NHDP domain.
           The NeighborRouterId is a unique identifier of
           discovered NHDP routers within the NHDP domain.</t>
      </section>


      <section title="The Performance Group">
        <t>The Performance Group reports values relevant to system performance.
           This section lists objects for NHDP performance monitoring,
           some of which explicitly appear in the NHDP-MIB and others which
           are obtainable through a combination of base objects from this MIB 
           and reports available through the <xref target="REPORT">REPORT-MIB</xref>.
           Throughout this section those objects will be pointed out that are 
           intended as base objects which are explicitly defined within this 
           MIB and those objects which are derived through a combination of the
           NHDP-MIB base objects and capabilities afforded by the REPORT-MIB.</t>
        
        <t>Unstable neighbors or 2-hop neighbors and frequent changes 
           of sets can have a negative influence on the performance of NHDP. 
           The following objects allow management applications to acquire 
           information related to the stability and performance of NHDP:</t>
        
        <t>The following objects return statistics related to HELLO messages:
                 <list style='symbols'>
                    <t>Total number of sent HELLO messages on an interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessageXmits</t>
                          <t>Object type: Counter32</t>
                       </list></t>

                    <t>Total number of received HELLO messages on an interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessageRecvd</t>
                          <t>Object type: Counter32</t>
                       </list></t>
                       
                    <t>Total number of sent periodic HELLO messages on an interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessagePeriodicXmits</t>
                          <t>Object type: Counter32</t>
                       </list></t>

                    <t>Total number of sent triggered HELLO messages on an interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessageTriggeredXmits</t>
                          <t>Object type: Counter32</t>
                       </list></t>

                    <t>Acquire history of HELLO message scheduling instances for a
                       given time duration on an interface
                       <list style='hanging'>
                          <t>It is desirable to develop the history of the exact timestamps of 
                             each HELLO message that has been sent as well as the type of the 
                             message (triggered or periodical). 
                             The list of events starts at the given point of time t0 and ends 
                             at the given time t1.</t>
                          <t>This is a Derived Object to be pulled from the REPORT-MIB.
                             It is derived from, e.g., the nhdpIfHelloMessagePeriodicXmits
                             Base Object from the NHDP-MIB along with the capabilities
                             derived from the reportHistoryGroup from the REPORT-MIB.</t>
                       </list></t>

                    <t>Histogram of the intervals between HELLO messages on an interface
                       <list style='hanging'>
                          <t>It is desirable to track the values (in a 2-dimensional array) 
                             that represent a histogram 
                             of intervals between HELLO messages, separated by periodic and 
                             triggered types. The histogram would display the distribution of 
                             intervals between two consecutive HELLOs of the same type 
                             (triggered or periodical) using a given bin size. 
                             It includes all HELLOs that have been sent after the given 
                             time t0 and before the given time t1.</t>
                          <t>This is a Derived Object to be pulled from the REPORT-MIB.
                             It can be derived from, e.g., the nhdpIfHelloMessagePeriodicXmits
                             Base Object from the NHDP-MIB along with the capabilities
                             derived from the reportHistoryGroup from the REPORT-MIB.
                             The network management application could convert this information
                             into the desired histogram.</t>
                       </list></t>

                    <t>Changes of the frequency of the message scheduling on an interface
                       <list style='hanging'>
                          <t>This object will divide the given time interval from t0 to t1 into a 
                             given number of equal parts. It then creates a histogram for each 
                             part and calculates the distances (using the Bhattacharyya distance) between 
                             each two adjacent histograms in time. A higher value between two 
                             histograms means more difference between the histograms. 
                             For instance, this is representative of an
                             event that suddenly sends many triggered HELLO messages, 
                             whereas before there have been only very few such 
                             triggered messages.</t>
                          <t>This is a Derived Object to be pulled from the REPORT-MIB, as previously
                             discussed, albeit this is a bit more complex with respect to the
                             management application.</t>
                       </list></t>

                    <t>Average number of sent HELLO messages per second between 
                       the given time t0 and t1 on an interface
                       <list style='hanging'>
                          <t>This is a Derived Object to be pulled from the reportSampledGroup
                             from the REPORT-MIB.
                             It is derived from, e.g., the nhdpIfHelloMessageXmits
                             Base Object.</t>
                       </list></t>

                    <t>Average number of received HELLO messages per second 
                       on an interface between the given time t0 and t1
                       <list style='hanging'>
                          <t>This is a Derived Object to be pulled from the REPORT-MIB.
                             See the previous discussion.</t>
                       </list></t>

                    <t>Total accumulated size in octets of sent HELLO messages on an interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessageXmitAccumulatedSize</t>
                          <t>Object type: Counter32</t>
                       </list></t>

                    <t>Total accumulated size in octets of received HELLO messages on an interface
                       <list style='hanging'>
                          <t> This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessageRecvdAccumulatedSize</t>
                          <t>Object type: Counter32</t>
                       </list></t>

                    <t>Average size in octets of sent HELLO messages 
                       between the given time t0 and t1 on an interface.
                       <list style='hanging'>
                          <t>This is a Derived Object to be pulled from the reportSampledGroup
                             from the REPORT-MIB.
                             It is derived from, e.g., the nhdpIfHelloMessageRecvdAccumulatedSize
                             Base Object from this NHDP-MIB.</t>
                       </list></t>

                    <t>Average size in octets of received HELLO messages 
                       between the given time t0 and t1 on an interface
                       <list style='hanging'>
                          <t>This is a Derived Object to be pulled from the REPORT-MIB.
                             See previous discussion.</t>
                       </list></t>
                       
                    <t>Total accumulated number of advertised symmetric neighbors in 
                       HELLOs on that interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessageXmitAccumulatedSymmetricNeighborCount</t>
                          <t>Object type: Counter32</t>
                       </list></t>
                    
                    <t>Total accumulated number of advertised heard neighbors in HELLOs on that interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessageXmitAccumulatedHeardNeighborCount</t>
                          <t>Object type: Counter32</t>
                       </list></t>
                       
                    <t>Total accumulated number of advertised lost neighbors in HELLOs on that interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpIfHelloMessageXmitAccumulatedLostNeighborCount</t>
                          <t>Object type: Counter32</t>
                       </list></t>

                    <t>Number of expected packets from a given neighbor based on the packet 
                       sequence number on an interface
                       <list style='hanging'>
                          <t>This is a Base Object.</t>
                          <t>Object name: nhdpDiscIfExpectedPackets</t>
                          <t>Object type: Counter32</t>
                       </list></t>

                    <t>Success rate of received packets (number of received packets divided by 
                       number of expected packets based on the packet sequence number)
                       <list style='hanging'>
                          <t>This is a Derived Object to be pulled from this NHDP-MIB.
                             It is derived from, e.g., the nhdpDiscIfRecvdPackets and
                             the nhdpDiscIfExpectedPackets Base Objects defined in this MIB.
                             This metric is then computed by the network management application.</t>
                       </list></t>
                 </list></t>

        <t>The following objects inspect the frequency of all Neighbor Set changes:
	      <list style='symbols'>
                   <t>Number of Neighbor Set changes
                          <list style='hanging'>
                              <t>This object counts each Neighbor Set change. 
                                 A change occurs whenever a new Neighbor Tuple has been added, 
                                 a Neighbor Tuple has been removed or any entry of a Neighbor Tuple 
                                 has been modified.</t>
                              <t>This is a Base Object.</t>
                              <t>Object name: nhdpNibNeighborSetChanges</t>
                              <t>Object type: Counter32</t>
                          </list></t>

                   <t>Acquire history of Neighbor Set changes
                          <list style='hanging'>
                              <t>This object returns the history of the exact 
                                 timestamps of each time the Neighbor Set has been changed.</t>
                              <t>This is a Derived Object to be pulled from the 
                                 reportHistoryGroup of the REPORT-MIB.
                                 It is derived from the previously
                                 discussed Base Object.</t>
                          </list></t>

                   <t>Histogram of the intervals between Neighbor Set changes
                          <list style='hanging'>
                              <t>Returns the values (in a 2-dimensional array) 
                                 that represent a histogram of intervals between 
                                 Neighbor Set changes. 
                                 <!--The histogram includes all changes that have been 
                                 made after the given time t0 and before the given time t1.--></t>	
                              <t>This is a Derived Object to be pulled from the 
                                 reportHistoryGroup from the REPORT-MIB.
                                 It is derived from the previously discussed Base Object.
                                 The network management application would develop the histograms
                                 based upon lists obtained from the REPORT-MIB.</t>
                          </list></t>

                   <t>Changes of the frequency of the Neighbor Set changes
                          <list style='hanging'>
                              <t>This object will divide the given time interval 
                                 from t0 to t1 into a given number of equal parts. 
                                 It then creates a  histogram for each part and calculates
                                 the distances (using the Bhattacharyya distance) between 
                                 each two adjacent histograms in time. 
                                 A higher value between two histograms means more 
                                 difference between the histograms.</t>
                              <t>This is a Derived Object to be pulled from the 
                                 reportHistoryGroup from the REPORT-MIB.
                                 It is derived from the previously discussed Base Object.
                                 The network management application could then compute the
                                 desired metrics.</t>
                          </list></t>
              </list></t>
			
			
              <t>The next objects examine the uptime of a given neighbor:
                 <list style='symbols'>
                       <t>Number of changes of a Neighbor Tuple
                           <list style='hanging'>
                               <t>Returns the number of changes to the given Neighbor Tuple.</t>
                               <t>This is a Base Object.</t>
                               <t>Object name: nhdpDiscNeighborNibNeighborSetChanges</t>
                               <t>Object type: Counter32</t>
                           </list></t>
			
                       <t>Neighbor uptime
                           <list style='hanging'>
                               <t>Returns the number of hundredths of a second since the Neighbor Tuple 
                                  corresponding to the given neighbor was registered</t>
                               <t>This is a Base Object.</t>
                               <t>Object name: nhdpDiscNeighborNibNeighborSetUpTime</t>
                               <t>Object type: TimeTicks</t>
                           </list></t>
			
                        <t>Acquire history of change of onlink status of a given neighbor
                            <list style='hanging'>
                                <t>This object returns the history of the exact timestamps of 
                                   each time the neighbor becomes onlink or offlink. 
                                   A neighbor is said to become "onlink" if a new Neighbor Tuple 
                                   is created that corresponds to the given neighbor. 
                                   It becomes "offlink" if such a tuple has been deleted.</t>
                                <t>This is a Derived Object to be pulled from the 
                                   reportHistoryGroup of the REPORT-MIB.
                                   It is derived from, e.g., the nhdpDiscNeighborNibNeighborSetChanges
                                   Base Object defined in this MIB.</t>
                            </list></t>

                        <t>Histogram of the intervals between a change of the onlink status of 
                           a given neighbor
                            <list style='hanging'>
                                <t>Returns the values that represent a histogram of intervals 
                                   between a change of the onlink status of a given neighbor. 
                                   The histogram includes all changes that have been made after 
                                   the given time t0 and before the given time t1.</t>
                                <t>This is a Derived Object to be pulled from the 
                                   reportHistoryGroup of the REPORT-MIB.
                                   It is derived from, e.g. the nhdpDiscNeighborNibNeighborSetChanges
                                   Base Object defined
                                   in this MIB.  This object sits in the 
                                   nhdpDiscNeighborSetPerfTable which is indexed by
                                   the nhdpDiscNeighborSetRouterId.</t>
                            </list></t>
                 </list></t>
			
              <t>The following objects examine the stability of a neighbor. 
                 A neighbor is said to be unstable if it "flaps" frequently between several links. 
                 It is said to be stable if the set of Link Tuples that 
                 correspond to the given neighbor is stationary.
                 <!-- flapping between interfaces -->
                 <list style='symbols'>
                       <t>Count the changes of the interface over which a 
                          given neighbor can be reached
                                  <list style='hanging'>
                                      <t>This object counts 
                                         each time the neighbor changes the interface over which it 
                                         is reachable. 
                                         That means that the corresponding Link Tuple of the given 
                                         link moves from the Link Set of one interface to another 
                                         interface.</t>
                                      <t>This is a Base Object.</t>
                                      <t>Object name: nhdpDiscNeighborNibNeighborSetReachableLinkChanges</t>
                                      <t>Object type: Counter32</t>
                                  </list></t>

                       <t>Acquire history of changes of the interface over which a 
                          given neighbor can be reached
                                  <list style='hanging'>
                                      <t>This object returns the history of the exact timestamps of 
                                         each time the neighbor changes the interface over which it 
                                         is reachable. 
                                         That means that the corresponding Link Tuple of the given 
                                         link moves from the Link Set of one interface to another 
                                         interface.</t>
                                      <t>This is a Derived Object to be pulled from the 
                                         reportHistoryGroup of the REPORT-MIB.
                                         It is derived from, e.g., the 
                                         nhdpDiscNeighborNibNeighborSetReachableLinkChanges
                                         Base Object.  The network management could
                                         develop the desired histogram based upon the
                                         information retrieved from the REPORT-MIB.</t>
                                  </list></t>

                        <t>Histogram of the intervals between a change of the interface over 
                               which a given neighbor is reachable
                               <list style='hanging'>
                                   <t>Returns the values that represent a histogram of intervals 
                                      between a change of the interface over which a given neighbor is 
                                      reachable after the given time t0 and before the given 
                                      time  t1.</t>
                                   <t>This is a Derived Object to be pulled from the reportHistoryGroup 
                                      from the REPORT-MIB.  It is derived from the previously discussed 
                                      Base Object, nhdpDiscNeighborNibNeighborSetChanges counter. 
                                      The network management application would develop 
                                      the histograms based upon lists obtained from the REPORT-MIB.</t>
                               </list></t>
                 </list></t>
			
              <t>The following objects inspect the stability of a given 2-hop neighbor:
                 <!-- 2-hop neighbor flapping between different neighbors -->
                 <list style='symbols'>
                          <t>Count the changes of the N2_neighbor_iface_addr_list of 
                             a given 2-hop neighbor
                             <list style='hanging'>
                                 <t>This object returns the count of the
                                    times the 2-hop neighbor changes its N2_neighbor_iface_addr_list, 
                                    i.e. the neighbor over which it is reachable.</t>
                                 <t>This is a Base Object.</t>
                                 <t>Object name: nhdpIib2HopSetPerfChanges</t>
                                 <t>Object type: Counter32</t>
                             </list></t>

                          <t>Acquire history of changes of the N2_neighbor_iface_addr_list of 
                             a given 2-hop neighbor 
                             <list style='hanging'>
                                 <t>This object returns the history of the exact timestamps of 
                                    each time the 2-hop neighbor changes its N2_neighbor_iface_addr_list, 
                                    i.e. the neighbor over which it is reachable.</t>
                                 <t>This is a Derived Object to be pulled from the reportHistoryGroup 
                                    of the REPORT-MIB.  It is derived from the previously 
                                    discussed Base Object, nhdpIib2HopSetPerfChanges counter.</t>
                             </list></t>

                    <t>Histogram of the intervals between a change of a 2-hop 
                        neighbor's N2_neighbor_iface_addr_list
                        <list style='hanging'>
                                 <t>Returns the values that represent a histogram of intervals 
                                    between a change of the 2-hop neighbor's N2_neighbor_iface_addr_list 
                                    after the given time t0 and before the given time t1.</t>
                                 <t>This is a Derived Object to be pulled from the reportHistoryGroup 
                                    from the REPORT-MIB.  It is derived from the previously 
                                    discussed Base Object, nhdpIib2HopSetPerfChanges counter.  
                                    The network management application would develop the 
                                    histograms based upon lists
                                    obtained from the REPORT-MIB.</t>
                       </list></t>
                 </list></t>
			
              <t>The next objects examine the uptime of a given 2-hop neighbor:
                 <list style='symbols'>
                     <t>2-hop Neighbor uptime
                        <list style='hanging'>
                            <t>Returns the number of hundredths of a second since the 
                               2-Hop Tuple corresponding to the given 2-hop neighbor IP 
                               address was registered.</t>
                            <t>This is a Base Object.</t>
                            <t>Object name: nhdpIib2HopSetPerfUpTime</t>
                            <t>Object type: TimeTicks</t>
                        </list></t>

                     <t>Acquire history of change of onlink status of a given 2-hop neighbor
                        <list style='hanging'>
                            <t>This object returns the history of the exact timestamps of each 
                               time the 2-hop neighbor becomes onlink or offlink. 
                               A 2-hop neighbor is said to become "onlink" if a 
                               new 2-hop Tuple is created that corresponds to the given 2-hop neighbor. 
                               It becomes "offlink" if such a tuple has been deleted.</t>
                            <t>This is a Derived Object to be pulled from the reportHistoryGroup 
                               of the REPORT-MIB.  It is derived from the previously 
                               discussed Base Object, nhdpIib2HopSetPerfChanges counter.</t>
                        </list></t>

                     <t>Histogram of the intervals between a change of the onlink status 
                        of a given 2-hop neighbor
                        <list style='hanging'>
                            <t>Returns the values that represent a histogram of intervals between 
                               a change of the onlink status of a given 2-hop neighbor. 
                               The histogram includes all changes that have been made after the 
                               given time t0 and before the given time t1.</t>
                            <t>This is a Derived Object to be pulled from the reportHistoryGroup 
                               from the REPORT-MIB.  It is derived from the previously discussed 
                               Base Object, nhdpIib2HopSetPerfChanges counter.  
                               The network management application would develop 
                               the histograms based upon lists obtained from the REPORT-MIB.</t>
                        </list></t>
                 </list></t>        
      </section>



      <section title="Relationship to Other MIB Modules">
         <t>This section specifies the
            relationship of the MIB modules contained in this document to
            other standards, particularly to standards containing other MIB
            modules.  Definitions imported from other MIB modules and other MIB
            modules that SHOULD be implemented in conjunction with the MIB
            module contained within this document are identified in this section.</t>


          <section title="Relationship to the SNMPv2-MIB">
            <t>The 'system' group in the SNMPv2-MIB <xref target="RFC3418"></xref>
               is defined as being mandatory for all systems, and the objects apply
               to the entity as a whole. The 'system' group provides identification
               of the management entity and certain other system-wide data. The
               NHDP-MIB does not duplicate those objects.</t>
          </section>


          <section title="Relationship to the OLSRv2-MIB">
            <t>The OLSRv2 <xref target="OLSRv2"/> routing protocol relies upon the NHDP protocol for
               neighbor reachability information.  In order to troubleshoot, fault isolate,
               and manage the OLSRv2 protocol through the OLSRv2-MIB <xref target="OLSRv2"/>, it
               was necessary to align the State Group tables of these two MIBs.
               This is accomplished through the definition of two TEXTUAL-CONVENTIONS, i.e.
               the NeighborInterfaceId and the NeighborRouterId.  These object type
               are used to develop indexes into common NHDP-MIB and OLSRv2-MIB State Group
               tables.  These objects are locally significant but should be locally
               common to the NHDP-MIB and OLSRv2-MIBs implemented on a common networked
               device.  This will allow for improved cross referencing of information
              across the two MIBs.</t>
          </section>


          <section title="Relationship to the REPORT-MIB">
            <t>This document describes many useful Performance Management metrics
               for the management of NHDP network devices.  However, not all of these
               metrics are explicitly defined solely within the context of this NHDP-MIB.
               Some of these metrics are obtained through joint interaction between
               this MIB and the REPORT-MIB <xref target="REPORT"/>.  This NHDP-MIB 
               defines the minimum necessary objects (often of type COUNTER) which
               form the underlying basis for more sophisticated Performance
               Management reporting available in conjunction with the 
               REPORT-MIB.  Note however, that the implementation of the
               NHDP-MIB is independent of any implementations of the REPORT-MIB.
               See the discussion of the performance metrics for
               NHDP management in the Performance Group section of this document.</t>
          </section>


          <section title="MIB modules required for IMPORTS">
              <!-- <t>[TODO]: Citations are not permitted within a MIB module, but any
              module mentioned in an IMPORTS clause or document mentioned in a
              REFERENCE clause is a Normative reference, and must be cited someplace
              within the narrative sections. If there are imported items in the MIB
              module, such as Textual Conventions, that are not already cited, they
              can be cited in text here. Since relationships to other MIB modules
              should be described in the narrative text, this section is typically
             used to cite modules from which Textual Conventions are imported.</t>-->

             <t>The following NHDP-MIB module IMPORTS objects from 
                SNMPv2-SMI <xref target="RFC2578"/>, SNMPv2-TC <xref target="RFC2579"/>,
                SNMPv2-CONF <xref target="RFC2580"/>, IF-MIB <xref target="RFC2863"/>, 
                INET-ADDRESS-MIB <xref target="RFC4001"/>, and SMIng <xref target="RFC3781"/>.</t>
          </section>

    </section>

    <!-- Definitions section -->
    <!-- This section contains the MIB module(s) defined by the specification.
         These MIB modules MUST be written in SMIv2 [RFC2578] [RFC2579]
         [RFC2580].

         See Section 4 of RFC 4181 for guidelines on SMIv2 usage.

	 See Appendix C of RFC 4181 for suggested naming conventions

         A list of tools that can help automate the process of 
         checking mib definitions can be found at 
         http://www.ops.ietf.org/mib-review-tools.html
    -->

    <section title="Definitions">

      <figure>
          <preamble></preamble>
             <artwork>
NHDP-MIB DEFINITIONS ::= BEGIN

IMPORTS

    MODULE-IDENTITY, OBJECT-TYPE, NOTIFICATION-TYPE, 
    Counter32, Integer32, Unsigned32, mib-2, TimeTicks
                 FROM SNMPv2-SMI  --[RFC2578]

    TEXTUAL-CONVENTION, TruthValue, RowStatus 
                 FROM SNMPv2-TC  --[RFC2579]

    MODULE-COMPLIANCE, OBJECT-GROUP, NOTIFICATION-GROUP
                 FROM SNMPv2-CONF  --[STD58]

    InetAddressType, InetAddress,
    InetAddressPrefixLength             
                 FROM INET-ADDRESS-MIB  --[RFC4001] 

    InterfaceIndexOrZero
                 FROM IF-MIB  --[RFC2863] 
    ;

nhdpMIB MODULE-IDENTITY
       LAST-UPDATED "201011081000Z" -- November 08,2010
       ORGANIZATION "IETF MANET working group"
       CONTACT-INFO
       "WG E-Mail: manet@ietf.org

        WG Chairs: ian.chakeres@gmail.com
                   jmacker@nrl.navy.mil


        Editors:   Ulrich Herberg
                   Ecole Polytechnique
                   LIX
                   91128 Palaiseau Cedex
                   France
                   ulrich@herberg.name
                   http://www.herberg.name/

                   Robert G. Cole
                   US Army CERDEC
                   Space and Terrestrial Communications
                   328 Hopkins Road
                   Bldg 245, Room 16
                   Aberdeen Proving Ground, MD 21005
                   USA
                   +1 410 278-6779
                   robert.g.cole@us.army.mil
                   http://www.cs.jhu.edu/~rgcole/

                   Ian D Chakeres
                   CenGen
                   9250 Bendix Road North
                   Columbia, Maryland  21045
                   USA
                   ian.chakeres@gmail.com
                   http://www.ianchak.com/"

       DESCRIPTION
           "This NHDP MIB module is applicable to devices 
            implementing the Neighborhood Discovery Protocol
            defined in [RFC XXXX].

            Copyright (C) The IETF Trust (2009). This version
            of this MIB module is part of RFC XXXX; see the RFC
            itself for full legal notices."

       -- revision
       REVISION    "201011081000Z"   -- November 08, 2010
       DESCRIPTION 
         "The eight version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-05.txt.
          This is TBD."
       REVISION    "201006301000Z"   -- June 30, 2010
       DESCRIPTION 
         "The seventh version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-04.txt.
          Cleaned up and condensed the textual material
          in the earlier sections of this draft.  Check
          consistency with NHDP draft, i.e.,
          draft-ietf-manet-nhdp-12.txt."
       REVISION    "201003081000Z"   -- March 08, 2010
       DESCRIPTION 
         "The sixth version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-03.txt.
          Added the local nhdpIfIndex to the 
          nhdpIibLinkSetTable."
       REVISION    "200911091000Z"   -- November 09, 2009
       DESCRIPTION 
         "The fifth version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-02.txt.
          Cleaned up a few things and updated to newest
          revision of NHDP draft."
       REVISION    "200910211000Z"   -- October 21, 2009
       DESCRIPTION 
         "The fourth version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-01.txt.
          Added objects pertaining to the performance
          group."
       REVISION    "200905031500Z"   -- May 3, 2009
       DESCRIPTION 
         "The third version of this MIB module,
          published as draft-ietf-manet-nhdp-mib-00.txt.
          No major revisions to this draft.  Mainly rev'd
          as a new working group document.  But also cleaned
          syntax errors, typos and other issues discovered
          with 'smilint'."
       REVISION    "200902151500Z"   -- February 15, 2009
       DESCRIPTION 
         "The second version of this MIB module,
          published as draft-cole-manet-nhdp-mib-01.txt.  Major
          update adding objects for configuration and state."
       REVISION    "200804251500Z"   -- April 25, 2008
       DESCRIPTION 
         "The original version of this MIB module,
          published as draft-cole-manet-nhdp-mib-00.txt."
       -- RFC-Editor assigns XXXX
       ::= { mib-2 998 }   -- to be assigned by IANA

--
-- Top-Level Components of this MIB
--
nhdpNotifications OBJECT IDENTIFIER ::= { nhdpMIB 0 }
nhdpObjects       OBJECT IDENTIFIER ::= { nhdpMIB 1 }
nhdpConformance   OBJECT IDENTIFIER ::= { nhdpMIB 2 }


--
-- Textual Conventions
--

NeighborIfIndex ::= TEXTUAL-CONVENTION
    DISPLAY-HINT "d"
    STATUS       current
    DESCRIPTION
        "A locally arbitrary unique identifier associated with an
         NHDP neighbor interface.

         All objects of type NeighborIfIndex are assigned by the agent
         out of a common number space. In other words, NeighborIfIndex
         values assigned to entries in one table must not overlap with
         NeighborIfIndex values assigned to entries in another
         table.

         The NeighborIfIndex defines a discovered interface of a 1-hop
         or 2-hop neighbor of the local router.  The agent identifies 
         a unique neighbor interface through the receipt of an
         address list advertised through an NHDP HELLO message.  

         The value for each discovered neighbor interface must remain
         constant at least from one re-initialization of the entity's
         network management system to the next re-initialization,
         except that if an application is deleted and re-created.

         The specific value is meaningful only within a given SNMP
         entity. An NeighborIfIndex value must not be re-used until
         the next agent restart."
    SYNTAX       Unsigned32 (1..2147483647)


NeighborRouterId ::= TEXTUAL-CONVENTION
    DISPLAY-HINT "d"
    STATUS       current
    DESCRIPTION
        "A locally arbitrary unique identifier associated with an
         NHDP discovered peer router.

         All objects of type NeighborRouterId are assigned by the
         agent out of a common number space.

         The NeighborRouterId defines a discovered NHDP peer of 
         the local router.  The agent identifies a 
         unique neighbor through the receipt of address
         lists advertised through an NHDP HELLO messages.

         The value for each discovered neighbor ID must remain
         constant at least from one re-initialization of the entity's
         network management system to the next re-initialization,
         except that if an application is deleted and re-created.

         The specific value is meaningful only within a given SNMP
         entity. An NeighborRouterId value must not be re-used until
         the next agent restart."
    SYNTAX       Unsigned32 (1..2147483647)



--
-- nhdpObjects
--

--    Configuration Objects Group 
--    State Objects Group
--    Performance Objects Group



--
-- nhdpConfigurationObjGrp
--

-- Contains the NHDP objects which configure specific options
-- which determine the overall performance and operation of the
-- discovery protocol.

nhdpConfigurationObjGrp OBJECT IDENTIFIER ::= { nhdpObjects 1 }

   nhdpInterfaceTable  OBJECT-TYPE
      SYNTAX      SEQUENCE OF NhdpInterfaceEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The NHDP Interface Table describes the
          configuration of the interfaces of this NHDP device.
          The ifIndex is from the interfaces group 
          defined in the Interfaces Group MIB.

          The object 'nhdpIfStatus' provides the functionality
          expected by the NHDP in the Local Interface Base (LIB)
          Local Interface Set Table.  Hence, the Local Interface
          Set Table will not be defined below.

          The objects in this table are persistent and when 
          written the entity SHOULD save the change to 
          non-volatile storage."
      REFERENCE
         "RFC 2863 - The Interfaces Group MIB, McCloghrie,
          K., and F. Kastenholtz, June 2000."
   ::= { nhdpConfigurationObjGrp 1 }

   nhdpInterfaceEntry OBJECT-TYPE
      SYNTAX      NhdpInterfaceEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The NHDP interface entry describes one NHDP
          local interface configuration as indexed by 
          its ifIndex as defined in the Standard MIB II
          Interface Table (RFC2863)."
      INDEX { nhdpIfIndex }
   ::= { nhdpInterfaceTable 1 }

   NhdpInterfaceEntry ::=
      SEQUENCE {
         nhdpIfIndex
            InterfaceIndexOrZero,
         nhdpIfStatus
            TruthValue,
         nhdpHelloInterval
            Unsigned32,
         nhdpHelloMinInterval
            Unsigned32,
         nhdpRefreshInterval
            Unsigned32,
         nhdpLHoldTime
            Unsigned32,
         nhdpHHoldTime
            Unsigned32,
         nhdpHystAcceptQuality
            Integer32,
         nhdpHystRejectQuality
            Integer32,
         nhdpInitialQuality
            Integer32,
         nhdpInitialPending
            TruthValue,
         nhdpHpMaxJitter
            Unsigned32,
         nhdpHtMaxJitter
            Unsigned32,
         nhdpIfRowStatus
            RowStatus
         }

   nhdpIfIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The ifIndex for this interface."
      ::= { nhdpInterfaceEntry 1 }
      
   nhdpIfStatus  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhpdIfStatus indicates whether this interface is
          a MANET interface. A value of true(1) indicates 
          that the interface is a MANET interface.  A value of 
          false(2) indicates that the interface is not a MANET
          interface. This corresponds to the I_manet parameter
          in the Local Interface Set, which is omitted in this MIB
          due to the redundancy with the nhdpInterfaceTable."
      DEFVAL { 2 }
   ::= { nhdpInterfaceEntry 2 }


   --
   -- Interface Parameters - Message Intervals
   --
   nhdpHelloInterval  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhpdHelloInterval is the maximum time 
          between the transmission of two successive 
          HELLO messages on this MANET interface.

          The following constraints apply to this 
          parameter: 
             'nhpdHelloInterval ge 0'
             'nhpdHelloInterval ge nhdpHelloMinInterval'"
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 2000 }
   ::= { nhdpInterfaceEntry 3 }


   nhdpHelloMinInterval  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhpdHelloMinInterval is the minimum interval 
          between transmission of two successive HELLO 
          messages, on this MANET interface.

          The following constraints apply to this 
          parameter: 
             'nhdpHelloMinInterval gt 0'"
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 500 }
   ::= { nhdpInterfaceEntry 4 }


   nhdpRefreshInterval  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhpdRefreshInterval is the maximum interval 
          between advertisements, in a HELLO message on this 
          MANET interface, of each 1-hop neighbor network 
          address and its status.

          The following constraint applies to this 
          parameter:
             'nhdpRefreshInterval ge nhdpHelloInterval'" 
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 2000 }
   ::= { nhdpInterfaceEntry 5 }

   --
   -- Interface Parameters - Information Validity times
   --
   nhdpLHoldTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpLHoldTime is used to define the time 
          for which a recently used and replaced 
          originator address is used to recognize 
          the router's own messages.

          The following constraint applies to this 
          parameter: 
              'nhdpLHoldTime ge 0'"
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 6000 }
   ::= { nhdpInterfaceEntry 6 }

   nhdpHHoldTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHHoldTime is used to define the time 
          for which a recently used and replaced 
          originator address is used to recognize 
          the router's own messages.

          The following constraint applies to this 
          parameter:
              'nhdpHHoldTime ge 0'"
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 6000 }
   ::= { nhdpInterfaceEntry 7 }

   --
   -- Interface Parameters - Link Quality 
   -- (is optional and settings define operation)
   --
   nhdpHystAcceptQuality  OBJECT-TYPE
      SYNTAX      Integer32 (0..255)
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHystAcceptQuality is the 
          link quality threshold at or above 
          which a link becomes usable, 
          if it was not already so.

          The following constraint applies to this 
          parameter:
              '0 le nhdpHystRejectQuality
                 le nhdpHystAcceptQuality le 255'"
      REFERENCE
         "The NHDP draft. 
          Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 255 }
   ::= { nhdpInterfaceEntry 8 }

   nhdpHystRejectQuality  OBJECT-TYPE
      SYNTAX      Integer32 (0..255)
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHystRejectQuality is the 
          link quality threshold below which 
          a link becomes unusable, if it 
          was not already so.

          The following constraint applies to this 
          parameter:
              '0 le nhdpHystRejectQuality 
                 le nhdpHystAcceptQuality le 255'"
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 0 }
   ::= { nhdpInterfaceEntry 9 }

   nhdpInitialQuality  OBJECT-TYPE
      SYNTAX      Integer32 (0..255)
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpInitialQuality is the 
          initial quality of a newly 
          identified link.

          The following constraint applies to this 
          parameter:
              '0 le nhdpInitialQuality le 255'"
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 255 }
   ::= { nhdpInterfaceEntry 10 }

   nhdpInitialPending  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpInitialPending is defined as
          follows:
 
          If true, then a newly identified link
          is considered pending, and is not 
          usable until the link quality has
          reached or exceeded the
          nhdpHystAccept threshold."
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 2 }
   ::= { nhdpInterfaceEntry 11 }

   --
   -- Interface Parameters - Jitter
   --
   nhdpHpMaxJitter  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHpMaxJitter represents the 
          value of MAXJITTER used in [4] for
          periodically generated HELLO messages 
          on this MANET interface."
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 500 }
   ::= { nhdpInterfaceEntry 12 }


   nhdpHtMaxJitter  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHtMaxJitter represents the 
          value of MAXJITTER used in [4] for
          externally triggered HELLO messages 
          on this MANET interface."
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 500 }
   ::= { nhdpInterfaceEntry 13 }
   
   nhdpIfRowStatus  OBJECT-TYPE
      SYNTAX      RowStatus
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "This object permits management of the table 
         by facilitating actions such as row creation,
         construction, and destruction. The value of
         this object has no effect on whether other
         objects in this conceptual row can be
         modified."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpInterfaceEntry 14 }


   --
   -- Router Parameters - Information Validity Time
   --
   nhdpNHoldTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpHHoldTime is used as the period 
          during which former 1-hop neighbor 
          addresses are advertised as lost in 
          HELLO messages, allowing recipients of 
          these HELLO messages to accelerate removal
          of information from their 2-Hop Sets.  
          N_HOLD_TIME can be set to zero if 
          accelerated information removal is not 
          required.

          The following constraint applies to this 
          parameter:
              'nhdpHHoldTime ge 0'

          This object is persistent and when written
          the entity SHOULD save the change to 
          non-volatile storage."
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 6000 }
   ::= { nhdpConfigurationObjGrp 2 }


   nhdpIHoldTime  OBJECT-TYPE
      SYNTAX      Unsigned32
      UNITS       "milliseconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The nhdpIHoldTime is the period 
          for which a recently used local
          interface address is recorded.

          The following constraint applies to this 
          parameter:
              'nhdpIHoldTime ge 0'  

          This object is persistent and when written
          the entity SHOULD save the change to 
          non-volatile storage."
      REFERENCE
         "The NHDP draft. 
          See Section 5 on Protocol Parameters and 
          Constraints."
      DEFVAL { 6000 }
   ::= { nhdpConfigurationObjGrp 3 }




--
-- nhdpStateObjGrp
--

-- Contains information describing the current state of the NHDP
-- process.

nhdpStateObjGrp    OBJECT IDENTIFIER ::= { nhdpObjects 2 }

   -- Before building the NHDP Information Bases, we define
   -- two new constructs for indexing into the following
   -- tables and indexing into other tables in other MIBs.
   -- The NeighborIfIndex defines a unique (to the local router)
   -- index referencing a discovered interface on another
   -- router within the NHDP MANET. The NeighborRouterId defines a
   -- unique (to the local router) index referencing a discovered
   -- router within the NHDP MANET.



   -- This table is indexed by an IpAddr associated with
   -- NeighborIfIndex.  Multiple addresses can be associated
   -- with a given NeighborIfIndex.  Each NeighborIfIndex is
   -- associated with a NeighborRouterId.  Throughout this MIB,
   -- the NeighborIfIndex and the NeighborRouterId are used
   -- to define the set of IpAddrs related to the interface
   -- in discussion.


   nhdpUpTime OBJECT-TYPE
       SYNTAX       TimeTicks
       MAX-ACCESS   read-only
       STATUS       current
       DESCRIPTION
           "The number of hundredths of a second since the
            current NHDP process was initialized."
       REFERENCE
          "The NHDP draft."
    ::= { nhdpStateObjGrp 1 }

   nhdpDiscIfSetTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpDiscIfSetEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
           "A router's set of discovered interfaces on
            neighboring routers."
       REFERENCE
          "The NHDP draft."
    ::= { nhdpStateObjGrp 2 }

    nhdpDiscIfSetEntry  OBJECT-TYPE
       SYNTAX      NhdpDiscIfSetEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The entries include the nhdpDiscRouterId of
           the discovered router, the nhdpDiscIfIndex
           of the discovered interface and the
           current set of addresses associated
           with this neighbor interface.  The
           nhdpDiscIfIndex has to uniquely identify
           the remote interface address sets.  It
           need not be unique across the MANET.
           It must be unique within this router."
       REFERENCE
          "This document."
       INDEX { nhdpDiscIfSetIpAddrType,
               nhdpDiscIfSetIpAddr }
    ::= { nhdpDiscIfSetTable 1 }

    NhdpDiscIfSetEntry ::=
       SEQUENCE {
          nhdpDiscIfSetRouterId
            NeighborRouterId,
          nhdpDiscIfSetIndex
            NeighborIfIndex,
          nhdpDiscIfSetIpAddrType
            InetAddressType,
          nhdpDiscIfSetIpAddr
            InetAddress,
          nhdpDiscIfSetIpAddrPrefixLen
            InetAddressPrefixLength
         }

   nhdpDiscIfSetRouterId  OBJECT-TYPE
      SYNTAX      NeighborRouterId
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The NHDP router ID (locally created)
          of a neighboring router.  Used for cross
          indexing into other NHDP tables and other
          MIBs."
      REFERENCE
         "This NHDP-MIB draft."
   ::= { nhdpDiscIfSetEntry 1 }

   nhdpDiscIfSetIndex  OBJECT-TYPE
      SYNTAX      NeighborIfIndex
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The NHDP interface index (locally created)
          of a neighbor's interface.  Used for cross
          indexing into other NHDP tables and other
          MIBs."
      REFERENCE
         "This document."
   ::= { nhdpDiscIfSetEntry 2 }

   nhdpDiscIfSetIpAddrType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The type of the nhdpDiscIfSetIpAddr
          in the InetAddress MIB [RFC 4001]."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetEntry 3 }

   nhdpDiscIfSetIpAddr  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpDiscIfSetIpAddr is a
          recently used address of a neighbor
          of this router."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetEntry 4 }

   nhdpDiscIfSetIpAddrPrefixLen  OBJECT-TYPE
      SYNTAX      InetAddressPrefixLength
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "Indicates the number of leading one bits that form the
          mask to be logical-ANDed with the destination address
          before being compared to the value in the
          nhdpDiscIfSetAddr field.  If the resulting
          address block is contained in a block in this
          table, then a match should be returned."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetEntry 5 }




   -- An NHDP router's Local Information Base (LIB)

      -- Local IF Set Table
      -- Entry (foreach IF): (IfAddrList, 
      --                      PrefixMask, 
      --                      Manet_indication)
      --
      -- This table is redundant with information in
      -- the nhdpInterfaceTable above.  Hence it is not
      -- reproduced within this MIB module.




      -- Removed Interface Addr Set Table
      -- Entry (foreach Addr): (IfAddrRemoved, 
      --                        ExpirationTime)

   nhdpLibRemovedIfAddrSetTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpLibRemovedIfAddrSetEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "A router's Removed Interface Address Set records 
          network addresses which were recently used as local 
          interface network addresses.  If a router's interface 
          network addresses are immutable then the Removed
          Interface Address Set is always empty and MAY be omitted.
          It consists of Removed Interface Address Tuples, one 
          per network address."
      REFERENCE
          "The NHDP draft."
   ::= { nhdpStateObjGrp 3 }

   nhdpLibRemovedIfAddrSetEntry  OBJECT-TYPE
      SYNTAX      NhdpLibRemovedIfAddrSetEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
        "A router's Removed Interface Address Set consists
          of Removed Interface Address Tuples, one per network
          address:
          
          (IR_local_iface_addr, IR_time)

          The association between these addrs and
          the router's Interface is found in the
          Standard MIB II's IP addr table 
          (RFC1213)."
      REFERENCE
         "The NHDP draft."
      INDEX { nhdpLibRemovedIfAddrSetIpAddrType,
              nhdpLibRemovedIfAddrSetIpAddr }
   ::= { nhdpLibRemovedIfAddrSetTable 1 }

   NhdpLibRemovedIfAddrSetEntry ::=
      SEQUENCE {
          nhdpLibRemovedIfAddrSetIpAddrType
            InetAddressType,
          nhdpLibRemovedIfAddrSetIpAddr
            InetAddress,
          nhdpLibRemovedIfAddrSetIpAddrPrefixLen
            InetAddressPrefixLength,
          nhdpLibRemovedIfAddrSetIfIndex
            InterfaceIndexOrZero,
          nhdpLibRemovedIfAddrSetIrTime
            TimeTicks
         }

   nhdpLibRemovedIfAddrSetIpAddrType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The type of the nhdpLibRemovedIfAddrSetIpAddr
          in the InetAddress MIB [RFC 4001]."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpLibRemovedIfAddrSetEntry 1 }

   nhdpLibRemovedIfAddrSetIpAddr  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpLibRemovedIfAddrSetAddr is a
          recently used address of an interface of
          this router."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpLibRemovedIfAddrSetEntry 2 }

   nhdpLibRemovedIfAddrSetIpAddrPrefixLen  OBJECT-TYPE
      SYNTAX      InetAddressPrefixLength
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "Indicates the number of leading one bits that form the
          mask to be logical-ANDed with the address
          to determine the network address to which
          this interface is attached."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpLibRemovedIfAddrSetEntry 3 }

   nhdpLibRemovedIfAddrSetIfIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "Specifies the local IfIndex from which this
           Ip addr was recently removed."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpLibRemovedIfAddrSetEntry 4 }

   nhdpLibRemovedIfAddrSetIrTime  OBJECT-TYPE
      SYNTAX      TimeTicks
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "Specifies when this Tuple expires and MUST be removed
           from this table.  This represents the number of 
           hundredths of a second following the time that
           the current NHDP process was initialized."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpLibRemovedIfAddrSetEntry 5 }



   -- Interface Information Base (IIB)

   --
   -- NHDP Interface Information Base (IIB)
   --

   --     IIB Link Set
   --         Entry (foreach 1-H neighbor): (NeighborIfAddrList,
   --                                        HeardTime,
   --                                        SymTime,
   --                                        Quality,
   --                                        Pending,
   --                                        Lost,
   --                                        ExpireTime)
   nhdpIibLinkSetTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpIibLinkSetEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "A Link Set of an interface records links from 
          other routers which are, or recently 
          were, 1-hop neighbors."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpStateObjGrp 4 }

   nhdpIibLinkSetEntry  OBJECT-TYPE
      SYNTAX      NhdpIibLinkSetEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "A Link Set consists of Link Tuples, each 
           representing a single link indexed by the
           local and remote interface pair:

           (L_neighbor_iface_addr_list, L_HEARD_time,
            L_SYM_time, L_quality, L_pending, 
            L_lost, L_time)."
      REFERENCE
         "This NHDP-MIB draft."
      INDEX { nhdpIfIndex,
              nhdpIibLinkSet1HopIfIndex }
   ::= { nhdpIibLinkSetTable 1 }

   NhdpIibLinkSetEntry ::=
      SEQUENCE {
          nhdpIibLinkSet1HopIfIndex
            NeighborIfIndex,
          nhdpIibLinkSetLHeardTime
            TimeTicks,
          nhdpIibLinkSetLSymTime
            TimeTicks,
          nhdpIibLinkSetLQuality
            Integer32,
          nhdpIibLinkSetLPending
            TruthValue,
          nhdpIibLinkSetLLost
            TruthValue,
          nhdpIibLinkSetLTime
            TimeTicks
         }

   nhdpIibLinkSet1HopIfIndex  OBJECT-TYPE
      SYNTAX      NeighborIfIndex
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSet1HopIfIndex is
          the value of the NeighborIfIndex (from
          table nhdpDiscIfSetTable above). This 
          object is repeated here to support
          table walks to view the set of neighbors
          of this router."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 1 }

   nhdpIibLinkSetLHeardTime  OBJECT-TYPE
      SYNTAX      TimeTicks
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLHeardTime is 
          the time until which the MANET 
          interface of the 1-hop neighbor 
          would be considered heard if not 
          considering link quality.  This 
          is measured in hundredths of a second
          since the NHDP process was last
          initialized."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 2 }

   nhdpIibLinkSetLSymTime  OBJECT-TYPE
      SYNTAX      TimeTicks
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLSymTime is the 
          time until which the link to the 
          1-hop neighbor would be considered 
          symmetric if not considering link 
          quality.  This is measured in hundredths
          of a second since the NHDP process
          was last initialized."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 3 }

   nhdpIibLinkSetLQuality  OBJECT-TYPE
      SYNTAX      Integer32 (0..255)
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLQuality is a 
          dimensionless number between 0 
          (inclusive) and 255 (inclusive) 
          describing the quality of a link; 
          a greater value of L_quality 
          indicating a higher quality link."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 4 }

   nhdpIibLinkSetLPending  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLPending is a 
          Boolean flag, describing if a 
          link is considered pending (i.e.,
          a candidate, but not yet 
          established, link)."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 5 }

   nhdpIibLinkSetLLost  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLLost is a 
          Boolean flag, describing if a 
          link is considered lost due 
          to link quality."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 6 }

   nhdpIibLinkSetLTime  OBJECT-TYPE
      SYNTAX      TimeTicks
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIibLinkSetLTime specifies 
          when this Tuple expires and MUST 
          be removed.  This is measured in hundredths
          of a second since the NHDP process last
          initialized."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIibLinkSetEntry 7 }



  --
  --     IIB 2-Hop Set 
  --         Entry (foreach IF on a 2-H neighbor): 
  --                                 (1NeighIfAddrList,
  --                                  2NeighIfAddr,
  --                                  ExpireTime)
  --
   nhdpIib2HopSetTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpIib2HopSetEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "A 2-Hop Set of an interface records network 
          addresses of symmetric 2-hop neighbors, and 
          the symmetric links to symmetric 1-hop neighbors
          through which these symmetric 2-hop neighbors
          can be reached.  It consists of 2-Hop Tuples, 
          each representing a single network address of 
          a symmetric 2-hop neighbor, and a single MANET 
          interface of a symmetric 1-hop neighbor.

          (N2_neighbor_iface_addr_list, 
           N2_2hop_addr, N2_time)."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpStateObjGrp 5 }

   nhdpIib2HopSetEntry  OBJECT-TYPE
      SYNTAX      NhdpIib2HopSetEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The entries include the 2 hop neighbor addrs,
           which act as the table index, and associated
           1 hop symmetric link addr set, designated through
           the nhdpDiscIfIndex, and an expiration time."
      REFERENCE
         "This NHDP-MIB draft."
      INDEX { nhdpIib2HopSetIpAddressType,
              nhdpIib2HopSetIpAddress }
   ::= { nhdpIib2HopSetTable 1 }

   NhdpIib2HopSetEntry ::=
      SEQUENCE {
          nhdpIib2HopSetIpAddressType
            InetAddressType,
          nhdpIib2HopSetIpAddress
            InetAddress,
          nhdpIib2HopSet1HopIfIndex
            NeighborIfIndex,
          nhdpIib2HopSetN2Time
            TimeTicks
         }

   nhdpIib2HopSetIpAddressType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The type of the nhdpIib2HopSetIpAddress
          in the InetAddress MIB [RFC 4001]."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetEntry 1 }

   nhdpIib2HopSetIpAddress  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The nhdpIib2HopSetIpAddr is an
          address of an interface of a symmetric
          2-hop neighbor which has a symmetric 
          link (using any MANET interface) to 
          the indicated symmetric 1-hop neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetEntry 2 }

   nhdpIib2HopSet1HopIfIndex  OBJECT-TYPE
      SYNTAX      NeighborIfIndex
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIib2HopSet1HopIfIndex is 
          NeighborIfIndex of the one hop
          neighbor which communicated the ipAddress
          of the 2 hop neighbor in this row entry."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetEntry 3 }

   nhdpIib2HopSetN2Time  OBJECT-TYPE
      SYNTAX      TimeTicks
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpIib2HopSetN2Time specifies 
          when this column entry expires and 
          MUST be removed.  This is measured in
          hundredths of a second since the
          NHDP process last initialized."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetEntry 4 }



   --
   -- Neighbor Information Base (NIB)
   --
   -- Each router maintains a Neighbor Information Base 
   -- that records information about addresses of 
   -- current and recently symmetric 1-hop neighbors.
   --
   -- All addresses MUST have an associated prefix 
   -- length.  Prefix lengths are indicated in HELLO 
   -- messages as specified in [1]; if an address
   -- has no specified prefix length, then its prefix 
   -- length is equal to the address length.  Two 
   -- addresses are considered equal if and only
   -- if their associated prefix lengths are also equal.



   --     NIB Neighbor Set
   --         Entry (foreach 1-H Neighbor): 
   --              (AllIfAddrListOfIhNeighbor,
   --               SymmetricIndicator)
   --     The NIB Neighbor Set Table is small because
   --     most of the corresponding information is found
   --     in the nhdpDiscoveredIfTable above.
   --
   nhdpNibNeighborSetTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpNibNeighborSetEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
          "A router's Neighbor Set records all network 
           addresses of each 1-hop neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpStateObjGrp 6 }

   nhdpNibNeighborSetEntry  OBJECT-TYPE
      SYNTAX      NhdpNibNeighborSetEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
          "A router's Neighbor Set consists 
           of Neighbor Tuples, each representing 
           a single 1-hop neighbor:

           (N_neighbor_addr_list, 
            N_symmetric)"
      REFERENCE
         "This document."
      INDEX { nhdpDiscIfSetRouterId }
   ::= { nhdpNibNeighborSetTable 1 }

   NhdpNibNeighborSetEntry ::=
      SEQUENCE {
          nhdpNibNeighborSetNSymmetric
            TruthValue
        }

   nhdpNibNeighborSetNSymmetric  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpNibNeighborNSymmetric is 
          a Boolean flag, describing if this 
          is a symmetric 1-hop neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpNibNeighborSetEntry 1 }



  --     Lost Neighbor Set 
  --         Entry ( foreach IF foreach 1-H Neighbor): (IfAddr,
  --                                                    ExpireTime)
  --
   nhdpNibLostNeighborSetTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpNibLostNeighborSetEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
          "A router's Lost Neighbor Set records network 
           addresses of routers which recently were 
           symmetric 1-hop neighbors, but which are now
           advertised as lost."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpStateObjGrp 7 }

   nhdpNibLostNeighborSetEntry  OBJECT-TYPE
      SYNTAX      NhdpNibLostNeighborSetEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "A router's Lost Neighbor Set consists of 
          Lost Neighbor Tuples, each representing a 
          single such network address:

          (NL_neighbor_addr, NL_time)"
      REFERENCE
         "This NHDP-MIB draft."
      INDEX { nhdpDiscIfSetRouterId }
   ::= { nhdpNibLostNeighborSetTable 1 }

   NhdpNibLostNeighborSetEntry ::=
      SEQUENCE {
          nhdpNibLostNeighborSetNLTime
            TimeTicks
        }

   nhdpNibLostNeighborSetNLTime  OBJECT-TYPE
      SYNTAX      TimeTicks
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The nhdpNibLostNeighborSetNLTime
          specifies when this Tuple expires 
          and MUST be removed.  This is measured in
          hundredths of a second since the last
          time the NHDP processed was
          initialized."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpNibLostNeighborSetEntry 1 }



--
-- nhdpPerformanceObjGrp
--

-- Contains objects which help to characterize the performance of
-- the NHDP process, typically counters.
--
nhdpPerformanceObjGrp OBJECT IDENTIFIER ::= { nhdpObjects 3 }

  --
  -- Objects per local interface
  --  
  nhdpInterfacePerfTable  OBJECT-TYPE
      SYNTAX      SEQUENCE OF NhdpInterfacePerfEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "This table summarizes performance objects that are
          measured per local NHDP interface."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpPerformanceObjGrp 1 }

   nhdpInterfacePerfEntry OBJECT-TYPE
      SYNTAX      NhdpInterfacePerfEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "A single entry contains performance counters for
          a local NHDP interface."
      INDEX { nhdpIfIndex }
   ::= { nhdpInterfacePerfTable 1 }

   NhdpInterfacePerfEntry ::=
      SEQUENCE { 
         nhdpIfHelloMessageXmits
            Counter32,
         nhdpIfHelloMessageRecvd
            Counter32,
         nhdpIfHelloMessageXmitAccumulatedSize
            Counter32,
         nhdpIfHelloMessageRecvdAccumulatedSize
            Counter32,
         nhdpIfHelloMessageTriggeredXmits
            Counter32,
         nhdpIfHelloMessagePeriodicXmits
            Counter32,
         nhdpIfHelloMessageXmitAccumulatedSymmetricNeighborCount
            Counter32,
         nhdpIfHelloMessageXmitAccumulatedHeardNeighborCount
            Counter32,
         nhdpIfHelloMessageXmitAccumulatedLostNeighborCount
            Counter32
         }
  
   nhdpIfHelloMessageXmits  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented each time a HELLO
         message has been transmitted on that interface."
   ::= { nhdpInterfacePerfEntry 1 }

   nhdpIfHelloMessageRecvd  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented each time a
         HELLO message has been received on that interface."
   ::= { nhdpInterfacePerfEntry 2 }

   nhdpIfHelloMessageXmitAccumulatedSize  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of octets in
         a HELLO message each time a
         HELLO message has been sent."
   ::= { nhdpInterfacePerfEntry 3 }

   nhdpIfHelloMessageRecvdAccumulatedSize  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of octets in
         a HELLO message each time a
         HELLO message has been received."
   ::= { nhdpInterfacePerfEntry 4 }

   nhdpIfHelloMessageTriggeredXmits  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented each time a triggered
         HELLO message has been sent."
   ::= { nhdpInterfacePerfEntry 5 }

   nhdpIfHelloMessagePeriodicXmits  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented each time a periodic
         HELLO message has been sent."
   ::= { nhdpInterfacePerfEntry 6 }
    
   nhdpIfHelloMessageXmitAccumulatedSymmetricNeighborCount  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of advertised
         symmetric neighbors in a HELLO each time a HELLO 
         message has been sent."
   ::= { nhdpInterfacePerfEntry 7 }
   
   nhdpIfHelloMessageXmitAccumulatedHeardNeighborCount  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of advertised
         heard neighbors in a HELLO each time a HELLO 
         message has been sent."
   ::= { nhdpInterfacePerfEntry 8 }
   
   nhdpIfHelloMessageXmitAccumulatedLostNeighborCount  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter is incremented by the number of advertised
         lost neighbors in a HELLO each time a HELLO 
         message has been sent."
   ::= { nhdpInterfacePerfEntry 9 }
  
  
  
  --
  -- Objects per discovered neighbor interface
  --
  nhdpDiscIfSetPerfTable OBJECT-TYPE
       SYNTAX       SEQUENCE OF NhdpDiscIfSetPerfEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
          "A router's set of performance properties for 
          each discovered interface of a neighbor."
       REFERENCE
          "The NHDP draft."
   ::= { nhdpPerformanceObjGrp 2 }
   
   
   nhdpDiscIfSetPerfEntry  OBJECT-TYPE
       SYNTAX      NhdpDiscIfSetPerfEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "There is an entry for each discovered 
          interface of a neighbor."
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpDiscIfSetIndex }
   ::= { nhdpDiscIfSetPerfTable 1 }

    NhdpDiscIfSetPerfEntry ::=
       SEQUENCE {
          nhdpDiscIfRecvdPackets
            Counter32,
          nhdpDiscIfExpectedPackets
            Counter32
         }

   nhdpDiscIfRecvdPackets  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each
          time this device receives a packet from that interface
          of the neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetPerfEntry 1 }

   nhdpDiscIfExpectedPackets  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments by the number
          of missed packets from this neighbor based 
          on the packet sequence number each time this 
          device receives a packet from that interface
          of the neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscIfSetPerfEntry 2 }


   
   --
   -- Objects concerning the neighbor set
   --
   nhdpNibNeighborSetChanges  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each time the Neighbor Set changes.
          A change occurs whenever a new Neighbor Tuple has been 
          added, a Neighbor Tuple has been removed or any entry of 
          a Neighbor Tuple has been modified."
   ::= { nhdpPerformanceObjGrp 3 }

   

   --
   -- Objects per discovered neighbor
   --
   nhdpDiscNeighborSetPerfTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpDiscNeighborSetPerfEntry
       MAX-ACCESS   not-accessible
       STATUS       current
       DESCRIPTION
          "A router's set of discovered neighbors and
           their properties."
       REFERENCE
          "The NHDP draft."
   ::= { nhdpPerformanceObjGrp 4 }

   nhdpDiscNeighborSetPerfEntry  OBJECT-TYPE
       SYNTAX      NhdpDiscNeighborSetPerfEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
          "The entries include the nhdpDiscRouterId of
           the discovered router, as well as performance
           objects related to changes of the Neighbor
           Set."
       REFERENCE
          "This NHDP-MIB draft."
       INDEX { nhdpDiscIfSetRouterId }
   ::= { nhdpDiscNeighborSetPerfTable 1 }

    NhdpDiscNeighborSetPerfEntry ::=
       SEQUENCE {
          nhdpDiscNeighborNibNeighborSetChanges
            Counter32,
          nhdpDiscNeighborNibNeighborSetUpTime
            TimeTicks,
          nhdpDiscNeighborNibNeighborSetReachableLinkChanges
            Counter32
         }

   nhdpDiscNeighborNibNeighborSetChanges  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each time the neighbor becomes 
          onlink or offlink.  A neighbor is said to become 
          'onlink' if a new Neighbor Tuple is created that 
          corresponds to the given neighbor.  It becomes 'offlink' 
          if such a tuple has been deleted."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscNeighborSetPerfEntry 1 }

   nhdpDiscNeighborNibNeighborSetUpTime  OBJECT-TYPE
      SYNTAX      TimeTicks
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This object returns the time in hundredths of a second since
         the neighbor becomes 'onlink'.  A neighbor is
         said to become 'onlink' if a new Neighbor Tuple is created that
         corresponds to the given neighbor.  It becomes 'offlink' if
         such a tuple has been deleted."
      REFERENCE
         "This document."
   ::= { nhdpDiscNeighborSetPerfEntry 2 }
   
   nhdpDiscNeighborNibNeighborSetReachableLinkChanges  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each
         time the neighbor changes the interface over which it is
         reachable.  That means that the corresponding Link Tuple of the
         given link moves from the Link Set of one interface to another
         interface."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpDiscNeighborSetPerfEntry 3 }




   --
   -- Objects per discovered 2-hop neighbor
   --
   nhdpIib2HopSetPerfTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF NhdpIib2HopSetPerfEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "This table contains performance objects per
          discovered 2-hop neighbor."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpPerformanceObjGrp 5 }

   nhdpIib2HopSetPerfEntry  OBJECT-TYPE
      SYNTAX      NhdpIib2HopSetPerfEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
        "The entries contain performance objects per
          discovered 2-hop neighbor."
      REFERENCE
        "This NHDP-MIB draft."
      INDEX { nhdpDiscIfSetRouterId }
   ::= { nhdpIib2HopSetPerfTable 1 }

   NhdpIib2HopSetPerfEntry ::=
      SEQUENCE {
          nhdpIib2HopSetPerfChanges
            Counter32,
          nhdpIib2HopSetPerfUpTime
            TimeTicks
        }
         
   nhdpIib2HopSetPerfChanges  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This counter increments each
          time this 2-hop neighbor changes its
          N2_neighbor_iface_addr_list in the 
          nhdpIib2HopSetTable."
      REFERENCE
         "The NHDP draft."
   ::= { nhdpIib2HopSetPerfEntry 1 }

   nhdpIib2HopSetPerfUpTime  OBJECT-TYPE
      SYNTAX      TimeTicks
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "This object returns the time in hundredths of
          a second when the 2-Hop Tuple 
          corresponding to the given 2-hop 
          neighbor IP address was registered in the 
          nhdpIib2HopSetTable."
      REFERENCE
         "This NHDP-MIB draft."
   ::= { nhdpIib2HopSetPerfEntry 2 }



--
-- nhdpNotifications
--

nhdpNotificationsControl OBJECT IDENTIFIER ::= { nhdpNotifications 1 }
nhdpNotificationsObjects OBJECT IDENTIFIER ::= { nhdpNotifications 2 }
nhdpNotificationsStates OBJECT IDENTIFIER ::= { nhdpNotifications 3 }

   -- nhdpNotificationsControl
   nhdpSetNotification OBJECT-TYPE
      SYNTAX       OCTET STRING (SIZE(4))
      MAX-ACCESS   read-write
      STATUS       current
      DESCRIPTION
         "A 4-octet string serving as a bit map for
          the notification events defined by the NHDP 
          notifications. This NHDP notifications where 
          a 1 in the bit field represents enabled. The
          right-most bit (least significant) represents 
          notification 0.

          This object is persistent and when written
          the entity SHOULD save the change to 
          non-volatile storage."
   ::= { nhdpNotificationsControl 1 }

   nhdpMessageSrcType OBJECT-TYPE
      SYNTAX       InetAddressType
      MAX-ACCESS   read-only
      STATUS       current
      DESCRIPTION
         "The IP address type of the
          address of an inbound message that 
          cannot be identified by a neighbor instance."
   ::= { nhdpNotificationsControl 2 }

   nhdpMessageSrc OBJECT-TYPE
      SYNTAX       InetAddress
      MAX-ACCESS   read-only
      STATUS       current
      DESCRIPTION
         "The IP address of an inbound message that 
          cannot be identified by a neighbor instance.  When
          the last value of a notification using this object is
          needed, but no notifications of that type have been sent,
          this value pertaining to this object should
          be returned as 0.0.0.0 or :: respectively."
   ::= { nhdpNotificationsControl 3 }


   -- nhdpNotificationsObjects
   
   nhdpNbrStateChange NOTIFICATION-TYPE
      OBJECTS { nhdpDiscIfSetRouterId, -- The originator
                nhdpNbrState           -- The new state
              }
      STATUS       current
      DESCRIPTION
         "An nhdpNbrStateChange notification signifies that
          there has been a change in the state of a
          NHDP neighbor."
   ::= { nhdpNotificationsObjects 1 }

   nhdp2hopNbrStateChange NOTIFICATION-TYPE
      OBJECTS { nhdpDiscIfSetRouterId, -- The originator 
                nhdp2hopNbrState       -- The new state
              }
      STATUS       current
      DESCRIPTION
         "An nhdp2hopNbrStateChange notification signifies that
          there has been a change in the state of a 2-hop
          neighbor.  This notification should be
          generated when the 2-hop neighbor state goes
          down or up."
      ::= { nhdpNotificationsObjects 2 }

   nhdpIfRxBadMessage NOTIFICATION-TYPE
      OBJECTS { nhdpDiscIfSetRouterId, -- The originator of
                nhdpDiscIfSetIndex,    -- The interface
                nhdpMessageSrcType,    -- The source IP addrType
                nhdpMessageSrc         -- The source IP address
              }
      STATUS       current
      DESCRIPTION
         "An nhdpIfRxBadMessage notification signifies that a
          HELLO message has been received on an
          interface that cannot be parsed."
   ::= { nhdpNotificationsObjects 3 }


   nhdpIfStateChange NOTIFICATION-TYPE
      OBJECTS { nhdpIfIndex, -- The local interface
                nhdpIfState  -- The new state
              }
      STATUS       current
      DESCRIPTION
         "An nhdpIfStateChange notification signifies that there
          has been a change in the state of an NHDP
          interface.  This notification should be generated
          when the interface goes up or down, or when
          the list of addresses of that interface
          changes."
   ::= { nhdpNotificationsObjects 4 }

          


   -- nhdpNotificationStates
   nhdpNbrState OBJECT-TYPE
      SYNTAX       INTEGER {
                       down (0),
                       asymmetric (1),
                       symmetric(2)
                   }
      MAX-ACCESS   read-only
      STATUS       current
      DESCRIPTION
         "NHDP neighbor states."
      DEFVAL { down }
   ::= { nhdpNotificationsStates 1 }
          
   nhdp2hopNbrState OBJECT-TYPE
      SYNTAX       INTEGER {
                       down (0),
                       up (1)
                   }
      MAX-ACCESS   read-only
      STATUS       current
      DESCRIPTION
         "NHDP 2hop neighbor states."
      DEFVAL { down }
   ::= { nhdpNotificationsStates 2 }
          
   nhdpIfState OBJECT-TYPE
      SYNTAX       INTEGER {
                       down (0),
                       up (1),
                       addresschange(2) -- If a new address has been
                                         -- added or an address has
                                         -- been removed
                    }
      MAX-ACCESS   read-only
      STATUS       current
      DESCRIPTION
         "NHDP interface states."
      DEFVAL { down }
   ::= { nhdpNotificationsStates 3 }



--
-- nhdpConformance information
--

nhdpCompliances       OBJECT IDENTIFIER ::= { nhdpConformance 1 }
nhdpMIBGroups         OBJECT IDENTIFIER ::= { nhdpConformance 2 }


-- Compliance Statements
nhdpBasicCompliance MODULE-COMPLIANCE
   STATUS current
   DESCRIPTION
      "The basic implementation requirements for
       managed network entities that implement
       NHDP."
   MODULE -- this module
   MANDATORY-GROUPS { nhdpConfigurationGroup }
::= { nhdpCompliances 1 }


nhdpFullCompliance MODULE-COMPLIANCE
   STATUS current
   DESCRIPTION
      "The full implementation requirements for
       managed network entities that implement
       NHDP."
   MODULE -- this module
   MANDATORY-GROUPS { nhdpConfigurationGroup,
                      nhdpStateGroup,
                      nhdpPerformanceGroup,
                      nhdpNotificationObjectGroup,
                      nhdpNotificationGroup }
::= { nhdpCompliances 2 }


--
-- Units of Conformance
--
nhdpConfigurationGroup OBJECT-GROUP
   OBJECTS {
              nhdpIfIndex,
              nhdpIfStatus,
              nhdpHelloInterval,
              nhdpHelloMinInterval,
              nhdpRefreshInterval,
              nhdpLHoldTime,
              nhdpHHoldTime,
              nhdpHystAcceptQuality,
              nhdpHystRejectQuality,
              nhdpInitialQuality,
              nhdpInitialPending,
              nhdpHpMaxJitter,
              nhdpHtMaxJitter,
              nhdpNHoldTime,
              nhdpIHoldTime,
              nhdpIfRowStatus
           }
   STATUS  current
   DESCRIPTION
      "Set of NHDP configuration objects implemented
       in this module."
::= { nhdpMIBGroups 2 }

nhdpStateGroup OBJECT-GROUP
   OBJECTS {
              nhdpUpTime,
              nhdpDiscIfSetRouterId,
              nhdpDiscIfSetIndex,
              nhdpDiscIfSetIpAddrPrefixLen,
              nhdpLibRemovedIfAddrSetIpAddrPrefixLen,
              nhdpLibRemovedIfAddrSetIfIndex,
              nhdpLibRemovedIfAddrSetIrTime,
              nhdpIibLinkSetLHeardTime,
              nhdpIibLinkSetLSymTime,
              nhdpIibLinkSetLQuality,
              nhdpIibLinkSetLPending,
              nhdpIibLinkSetLLost,
              nhdpIibLinkSetLTime,
              nhdpIib2HopSet1HopIfIndex,
              nhdpIib2HopSetN2Time,
              nhdpNibNeighborSetNSymmetric,
              nhdpNibLostNeighborSetNLTime
           }
    STATUS  current
    DESCRIPTION
       "Set of NHDP state objects implemented
         in this module."
::= { nhdpMIBGroups 3 }

nhdpPerformanceGroup OBJECT-GROUP
   OBJECTS {
              nhdpIfHelloMessageXmits, 
              nhdpIfHelloMessageRecvd,
              nhdpIfHelloMessageXmitAccumulatedSize,
              nhdpIfHelloMessageRecvdAccumulatedSize,            
              nhdpIfHelloMessageTriggeredXmits,
              nhdpIfHelloMessagePeriodicXmits,
              nhdpIfHelloMessageXmitAccumulatedSymmetricNeighborCount,
              nhdpIfHelloMessageXmitAccumulatedHeardNeighborCount,
              nhdpIfHelloMessageXmitAccumulatedLostNeighborCount,
              nhdpDiscIfRecvdPackets,
              nhdpDiscIfExpectedPackets,
              nhdpNibNeighborSetChanges,
              nhdpDiscNeighborNibNeighborSetChanges,
              nhdpDiscNeighborNibNeighborSetUpTime,
              nhdpDiscNeighborNibNeighborSetReachableLinkChanges,
              nhdpIib2HopSetPerfChanges,
              nhdpIib2HopSetPerfUpTime
          }
    STATUS  current
    DESCRIPTION
       "Set of NHDP performance objects implemented
         in this module."
::= { nhdpMIBGroups 4 }

nhdpNotificationObjectGroup OBJECT-GROUP
   OBJECTS {
             nhdpSetNotification,
             nhdpMessageSrcType,
             nhdpMessageSrc,
             nhdpIfState,
             nhdpNbrState,
             nhdp2hopNbrState
           }
   STATUS  current
   DESCRIPTION
      "Set of NHDP notification objects implemented
       in this module."
::= { nhdpMIBGroups 5 }

nhdpNotificationGroup NOTIFICATION-GROUP
   NOTIFICATIONS {
             nhdpNbrStateChange,
             nhdp2hopNbrStateChange,
             nhdpIfRxBadMessage,
             nhdpIfStateChange
           }
   STATUS  current
   DESCRIPTION
      "Set of NHDP notifications implemented
       in this module."
::= { nhdpMIBGroups 6 }

END
	     </artwork>
          <postamble></postamble>
      </figure>

    </section>

    <section title="Security Considerations">
      <t>This MIB defines objects for the configuration, monitoring and
         notification of the Neighborhood Discovery Protocol (NHDP) <xref target="NHDP"/>.
         NHDP allows routers to acquire topological information up to two hops away by 
         virtue of exchanging HELLO messages. The information acquired by NHDP is used 
         by other protocols, such as OLSRv2 <xref target="OLSRv2"/> and SMF <xref target="SMF"/>, 
         and possibly other protocols. The neighborhood information, exchanged between 
         routers using NHDP, serves these routing protocols as a baseline for 
         calculating paths to all destinations in the MANET, relay set selection for 
         network-wide transmissions etc.</t>

      <t>There are a number of management objects defined in this MIB module
         with a MAX-ACCESS clause of read-write and/or read-create. Such objects
         may be considered sensitive or vulnerable in some network environments.
         The support for SET operations in a non-secure environment without
         proper protection can have a negative effect on network operations.
         These are the tables and objects and their
         sensitivity/vulnerability:</t>

      <t><list style="symbols">
          <t>Specifically sensitive objects -</t>
          <t>nhdpIfStatus - this writable object turns on or off the NHDP
             process for the specified interface.  If disabled, higher level
             protocol functions, e.g., routing, would fail causing
             network-wide disruptions.</t>

          <t>nhdpHelloInterval, nhdpHelloMinInterval, and nhdpRefreshInterval - these
             writable objects control the rate at which HELLO messages are sent
             on a wireless interface.  If set at too high a rate, this could
             represent a form of DOS attack by overloading interface
             resources.</t>

          <t>nhdpHystAcceptQuality, nhdpHystRejectQuality, nhdpInitialQuality,
             nhdpInitialPending - these
             writable objects affect the perceived quality of the NHDP links and
             hence the overall stability of the network.  If improperly set,
             these settings could result in network-wide disruptions.</t>

          <t>nhdpInterfaceTable - this table contains writable objects that affect
             the overall performance and stability of the NHDP process.  Failure of the NHDP
             process would result in network-wide failure.  Particularly sensitive
             objects from this table are discussed in the previous list items.
             This is the only table in the NHDP-MIB with writable objects.</t>
        </list></t>


      <t>Some of the readable objects in this MIB module (i.e., objects with a
         MAX-ACCESS other than not-accessible) may be considered sensitive or
         vulnerable in some network environments. It is thus important to control
         even GET and/or NOTIFY access to these objects and possibly to even
         encrypt the values of these objects when sending them over the network
         via SNMP. These are the tables and objects and their
         sensitivity/vulnerability: 
         <list style="symbols">
          <t>nhdpDiscIfSetTable - The contains information on discovered neighbors,
             specifically their IP address in the nhdpDiscIfSetIpAddr object.
             This information provides an adversary broad information on the
             members of the MANET, located within this single table.  This information
             can be use to expedite attacks on the other members of the MANET
             without having to go through a laborious discovery process on their own.
             This object is the index into the table, and has a MAX-ACCESS
             of 'not-accessible'.  However this information can be exposed
             using SNMP operations.</t>
        </list></t>

      <t>MANET technology is often deployed to support communications
         of emergency services or military tactical applications.  In these
         applications, it is imperative to maintain the proper operation of the
         communications network and to protect sensitive information
         related to its operation.  Therefore, when implementing
         these capabilities, the full use of SNMPv3 cryptographic mechanisms
         for authentication and privacy is RECOMMENDED.</t>

      <t>SNMP versions prior to SNMPv3 did not include adequate security. Even
         if the network itself is secure (for example by using IPSec), 
         there is no control as to who on the secure network is allowed to access
         and GET/SET (read/change/create/delete) the objects in this MIB
         module.</t>

      <t>It is RECOMMENDED that implementers consider the security features as
         provided by the SNMPv3 framework (see <xref target="RFC3410"></xref>,
         section 8), including full support for the SNMPv3 cryptographic
         mechanisms (for authentication and privacy).</t>

      <t>Further, deployment of SNMP versions prior to SNMPv3 is NOT
         RECOMMENDED. Instead, it is RECOMMENDED to deploy SNMPv3 and to enable
         cryptographic security. It is then a customer/operator responsibility to
         ensure that the SNMP entity giving access to an instance of this MIB
         module is properly configured to give access to the objects only to
         those principals (users) that have legitimate rights to indeed GET or
         SET (change/create/delete) them.</t>
    </section>


    <section title="IANA Considerations">
      <t>Editor's Note (to be removed prior to publication): the IANA is
      requested to assign a value for "XXXX" under the 'mib-2' subtree and to
      record the assignment in the SMI Numbers registry. When the assignment
      has been made, the RFC Editor is asked to replace "XXXX" (here and in the
      MIB module) with the assigned value and to remove this note.</t>

      <t>Note well: prior to official assignment by the IANA, a draft document
      MUST use placeholders (such as "XXXX" above) rather than actual numbers.
      See RFC4181 Section 4.5 for an example of how this is done in a draft
      MIB module.</t>
    </section>

    <!-- The Author's Addresses section will be generated 
         automatically by XML2RFC from the front information -->

    <section title="Contributors">
      <t>This MIB document uses the 
      template authored by D. Harrington which is
      based on contributions from the MIB Doctors,
      especially Juergen Schoenwaelder, Dave Perkins, C.M.Heard and Randy
      Presuhn.</t>

    </section>

<!--
    <section title="Acknowledgements">
      <t>[TODO]This acknowledgement can be removed from your MIB module
      document.</t>
    </section>
    -->
  </section>
  </middle>

  <back>
    <!-- References Section -->

    <!-- Section 4.7f of [RFC2223bis] specifies the requirements for the
   references sections.  In particular, there MUST be separate lists of
   normative and informative references, each in a separate section.
   The style SHOULD follow that of recently published RFCs.

   The standard MIB boilerplate available at
   http://www.ops.ietf.org/mib-boilerplate.html includes lists of
   normative and informative references that MUST appear in all IETF
   specifications that contain MIB modules.  If items from other MIB
   modules appear in an IMPORTS statement in the Definitions section,
   then the specifications containing those MIB modules MUST be included
   in the list of normative references.  When items are imported from an
   IANA-maintained MIB module the corresponding normative reference
   SHALL point to the on-line version of that MIB module.  It is the
   policy of the RFC Editor that all references must be cited in the
   text;  such citations MUST appear in the overview section where
   documents containing imported definitions (other those already
   mentioned in the MIB boilerplate) are required to be mentioned (cf.
   Section 3.2).

In general, each normative reference SHOULD point to the most recent
version of the specification in question.
-->

    <references title="Normative References">
      <!-- <t>[TODO] rfc2629, 2863, 3418, and 4181 are normative references that
      are required only to support this template, and which can be removed
      from your final document, if not used for other purposes.</t>-->

<!--
      &rfc2629;
      &rfc4181;
-->

    <reference anchor='RFC2863'>
        <front>
          <title>The Interfaces Group MIB</title>
          <author initials='K.' surname='McCloghrie' fullname='K. McCloghrie'>
            <organization /></author>
          <author initials='F.' surname='Kastenholz' fullname='F. Kastenholz'>
            <organization /></author>
          <date year='2000' month='June' />
        </front>
       <seriesInfo name='RFC' value='2863' />
       <format type='TXT' octets='155014' target='ftp://ftp.isi.edu/in-notes/rfc2863.txt' />
    </reference>



    <reference anchor='RFC3418'>
       <front>
         <title>Management Information Base (MIB) for the Simple Network Management Protocol (SNMP)</title>
         <author initials='R.' surname='Presuhn' fullname='R. Presuhn'>
           <organization /></author>
         <date year='2002' month='December' />
       </front>
       <seriesInfo name='STD' value='62' />
       <seriesInfo name='RFC' value='3418' />
       <format type='TXT' octets='49096' target='ftp://ftp.isi.edu/in-notes/rfc3418.txt' />
    </reference>


      <!--  <t>[TODO] rfc2119, 2578, 2579, and 2580 are required to support MIB
      module boilerplate text.</t> -->

    <reference anchor='RFC2119'>
        <front>
          <title abbrev='RFC Key Words'>Key words for use in RFCs to Indicate Requirement Levels</title>
          <author initials='S.' surname='Bradner' fullname='Scott Bradner'>
            <organization>Harvard University</organization></author>
          <date year='1997' month='March' />
        </front>
        <seriesInfo name='BCP' value='14' />
        <seriesInfo name='RFC' value='2119' />
        <format type='TXT' octets='4723' target='ftp://ftp.isi.edu/in-notes/rfc2119.txt' />
        <format type='HTML' octets='17491' target='http://xml.resource.org/public/rfc/html/rfc2119.html' />
        <format type='XML' octets='5777' target='http://xml.resource.org/public/rfc/xml/rfc2119.xml' />
    </reference>



    <reference anchor='RFC2578'>
        <front>
          <title abbrev='SMIv2'>Structure of Management Information Version 2 (SMIv2)</title>
          <author initials='K.' surname='McCloghrie' fullname='Keith McCloghrie' role='editor'>
            <organization></organization></author>
          <author initials='D.' surname='Perkins' fullname='David Perkins' role='editor'>
            <organization></organization></author>
          <author initials='J.' surname='Schoenwaelder' fullname='Juergen Schoenwaelder' role='editor'>
            <organization></organization></author>
          <date year='1999' month='April' />
        </front>
        <seriesInfo name='STD' value='58' />
        <seriesInfo name='RFC' value='2578' />
        <format type='TXT' octets='89712' target='ftp://ftp.isi.edu/in-notes/rfc2578.txt' />
    </reference>



    <reference anchor='RFC2579'>
        <front>
          <title>Textual Conventions for SMIv2</title>
          <author initials='K.' surname='McCloghrie' fullname='Keith McCloghrie' role='editor'>
            <organization>Cisco Systems, Inc.</organization></author>
          <author initials='D.' surname='Perkins' fullname='David Perkins' role='editor'>
            <organization>SNMPinfo</organization></author>
          <author initials='J.' surname='Schoenwaelder' fullname='Juergen Schoenwaelder' role='editor'>
            <organization>TU Braunschweig</organization></author>
          <date year='1999' month='April' />
        </front>
        <seriesInfo name='STD' value='58' />
        <seriesInfo name='RFC' value='2579' />
        <format type='TXT' octets='59039' target='ftp://ftp.isi.edu/in-notes/rfc2579.txt' />
    </reference>



    <reference anchor='RFC2580'>
        <front>
          <title>Conformance Statements for SMIv2</title>
          <author initials='K.' surname='McCloghrie' fullname='Keith McCloghrie'>
            <organization>Cisco Systems, Inc.</organization></author>
          <author initials='D.' surname='Perkins' fullname='David Perkins'>
            <organization>SNMPinfo</organization></author>
          <author initials='J.' surname='Schoenwaelder' fullname='Juergen Schoenwaelder'>
            <organization>TU Braunschweig</organization></author>
          <date year='1999' month='April' /></front>
         <seriesInfo name='STD' value='58' />
         <seriesInfo name='RFC' value='2580' />
         <format type='TXT' octets='54253' target='ftp://ftp.isi.edu/in-notes/rfc2580.txt' />
    </reference>

      <!--  <t>[TODO]: Add your own normative references.</t>-->
    <reference anchor="NHDP">
        <front>
          <title>The MANET Neighborhood Discovery Protocol (NHDP)</title>
          <author initials="T." surname="Clausen">
            <organization></organization>
          </author>
          <author initials="C." surname="Dearlove">
            <organization></organization>
          </author>
          <author initials="J." surname="Dean">
            <organization></organization>
          </author>
          <date month="October" day="26" year="2009" />
        </front>
        <seriesInfo name='Internet-Draft' value='draft-ietf-manet-nhdp-11' />
        <format type='TXT' target='http://www.ietf.org/internet-drafts/draft-ietf-manet-nhdp-11.txt' />
    </reference>

    
    <reference anchor='RFC4001'>
        <front>
          <title>Textual Conventions for Internet Network Addresses</title>
          <author initials='M.' surname='Daniele' fullname='M. Daniele'>
             <organization /></author>
          <author initials='B.' surname='Haberman' fullname='B. Haberman'>                    
             <organization /></author>
          <author initials='S.' surname='Routhier' fullname='S. Routhier'>
             <organization /></author>
          <author initials='J.' surname='Schoenwaelder' fullname='J. Schoenwaelder'>
             <organization /></author>
          <date year='2005' month='February' />
        </front>
        <seriesInfo name='RFC' value='4001' />
        <format type='TXT' octets='26379' target='ftp://ftp.isi.edu/in-notes/rfc4001.txt' />
    </reference>
      
    </references>

    <references title="Informative References">
      <!-- <t>[TODO] RFC3410 is required to support the boilerplate text.</t>-->
      
      <reference anchor="REPORT">
        <front>
          <title>Definition of Managed Objects for Performance Reporting</title>
          <author initials="R.G." surname="Cole">
            <organization></organization>
          </author>
          <author initials="J." surname="Macker">
            <organization></organization>
          </author>
          <author initials="A." surname="Morton">
            <organization></organization>
          </author>
          <date month="March" year="2010" />
        </front>
        <seriesInfo name='Internet-Draft' value='draft-cole-manet-report-mib-02' />
        <format type='TXT' target='http://www.ietf.org/internet-drafts/draft-cole-manet-report-mib-02.txt' />
      </reference>
    
      
     <reference anchor='RFC5148'>
        <front>
          <title>Jitter Considerations in Mobile Ad Hoc Networks (MANETs)</title>
          <author initials='T.' surname='Clausen' fullname='T. Clausen'>
             <organization /></author>
          <author initials='C.' surname='Dearlove' fullname='C. Dearlove'>                    
             <organization /></author>
          <author initials='B.' surname='Adamson' fullname='B. Adamson'>
             <organization /></author>
          <date year='2008' month='February' />
        </front>
        <seriesInfo name='RFC' value='5148' />
        <format type='TXT' octets='26379' target='ftp://ftp.isi.edu/in-notes/rfc5148.txt' />
     </reference>
     
      
      
      <reference anchor="OLSRv2">
	<front>
	    <title>The Optimized Link State Routing Protocol version 2</title>
	    <author initials="T.H." surname="Clausen" fullname="Thomas Heide Clausen">
	        <organization abbrev="X">Ecole Polytechnique, France</organization>
	    </author>
	    <author initials="C.M." surname="Dearlove" fullname="Christopher Dearlove">
		<organization>BAE Systems Advanced Technology Centre, UK</organization>
	    </author>
	    <author initials="P." surname="Philippe" fullname="Philippe Jacquet">
		<organization abbrev="NRL">INRIA</organization>
	    </author>
	    <date month="September" year="2009"/>
	</front>
	<seriesInfo name="work in progress" value="draft-ietf-manet-olsrv2-10.txt"/>
      </reference>
			
      <reference anchor="SMF">
	<front>
	<title>Simplified Multicast Forwarding</title>
	<author initials="J." surname="Macker" fullname="Joseph Macker">
	    <organization abbrev="X">NRL</organization>
	</author>
	<date month="July" year="2009"/>
	</front>
        <seriesInfo name="work in progress" value="draft-ietf-manet-smf-09.txt"/>
      </reference>

      <reference anchor='RFC3410'>
        <front>
          <title>Introduction and Applicability Statements for Internet-Standard Management Framework</title>
          <author initials='J.' surname='Case' fullname='J. Case'>
            <organization /></author>
          <author initials='R.' surname='Mundy' fullname='R. Mundy'>
            <organization /></author>
          <author initials='D.' surname='Partain' fullname='D. Partain'>
            <organization /></author>
          <author initials='B.' surname='Stewart' fullname='B. Stewart'>
            <organization /></author>
          <date year='2002' month='December' />
        </front>
        <seriesInfo name='RFC' value='3410' />
        <format type='TXT' octets='61461' target='ftp://ftp.isi.edu/in-notes/rfc3410.txt' />
      </reference>
      
      
      <reference anchor='RFC3781'>
        <front>
          <title>Next Generation Structure of Management Information (SMIng) Mappings 
                 to the Simple Network Management Protocol (SNMP)</title>
          <author initials='F.' surname='Strauss' fullname='F. Strauss'>
            <organization /></author>
          <author initials='J.' surname='Schoenwaelder' fullname='J. Schoenwaelder'>
            <organization /></author>
          <date year='2004' month='May' />
        </front>
        <seriesInfo name='RFC' value='3781' />
        <format type='TXT' octets='61461' target='ftp://ftp.isi.edu/in-notes/rfc3781.txt' />
      </reference>

      <!-- <t>[TODO] Add your own informative references</t>-->


    </references>

    <!--
<section anchor="appendix" title="Appendix A">
	<t>You can add appendices just as regular sections, the only
difference is that they go under "back" element, and get letters 
instead of numbers</t>
</section>
-->

    <section title="Change Log ">
      <t>Here we list the changes made to the various drafts of this MIB.</t>
      
      <t>We list here the changes made on the draft-ietf-manet-nhdp-mib-04 draft to generate
         the draft-ietf-manet-nhdp-mib-05 draft.</t>
      <t><list style="numbers">
          <t>Cleaned up the time objects within the MIB using the TimeTicks Textual
             Convention.</t>
          <t>Changed the definition of the 'nhdpDiscNeighborNibNeighborSetUpTime'
             object to track only the entry uptime, since the time since 'down'
             referred to a removed tuple.</t>
      </list></t>

      <t>We list here the changes made on the draft-ietf-manet-nhdp-mib-03 draft to generate
         the draft-ietf-manet-nhdp-mib-04 draft.</t>
      <t><list style="numbers">
          <t>Cleaned up and condensed text in the front material to this draft.  Specifically,
             shortened the Configuration and State Group sections, deferring to the MIB
             as definitive.  Left the Performance Group discussion primarily intact due to its
             discussion of base and derived performance objects and statistics and
             their value to management and operations of NHDP.</t>
          <t>Added information identifying objects requiring non-volatile
             storage within the DESCRIPTION clause of the objects within the NHDP-MIB.</t>
          <t></t>
      </list></t>

      <t>We list here the changes made on the draft-ietf-manet-nhdp-mib-02 draft to generate
         the draft-ietf-manet-nhdp-mib-03 draft.</t>
      <t><list style="numbers">
          <t>Cleaned up text in the Performance Group section defining the base versus 
             the derived (from the REPORT-MIB) objects.</t>
          <t>Added the local nhdpIfIndex to the nhdpIibLinkSetTable.  
             A duplex of interface indexes is required to define a wireless link.</t>
          <t>Added text to the Security Considerations section.</t>
          <t>Added notifications.</t>
      </list></t>

      <t>We list here the changes made on the draft-ietf-manet-nhdp-mib-01 draft to generate
         the draft-ietf-manet-nhdp-mib-02 draft.</t>
      <t><list style="numbers">
          <t>Cleaned up several things (e.g. moved N_HOLD_TIME from interface 
             parameter to router parameter)</t>
          <t>Updated to NHDP draft version 11</t>
      </list></t>
      

      <t>We list here the changes made on the draft-ietf-manet-nhdp-mib-00 draft to generate
         the draft-ietf-manet-nhdp-mib-01 draft.</t>
      <t><list style="numbers">
          <t>Made and extensive addition in the area of performance monitoring.  Added text
             in the front material, added a PerformanceGroup to the MIB and added the PerformanceGroup
             to the Conformance Sections.</t>
      </list></t>

      <t>We list here the changes made on the draft-cole-manet-nhdp-mib-01 draft to generate
         the draft-ietf-manet-nhdp-mib-00 draft.</t>
      <t><list style="numbers">
          <t>Cleanup up numerous typos and add material to the Conformance section in order
             to pass the MIB checker, i.e., smilint.</t>
      </list></t>

      <t>We list here the changes made on the draft-cole-manet-nhdp-mib-00 draft to generate
         the draft-cole-manet-nhdp-mib-01 draft.</t>
      <t><list style="numbers">
          <t>Defined the NeighborIfIndex and the NeighborRouterId textual conventions.  These
             identify a remote neighbor IfIndex and a remote neighbor router and are
             used as indexes into NHDP state tables. These constructs were necessary in order
             to associate address lists with specific remote interfaces as required by the
             NHDP protocol specification.</t>
          <t>Developed the nhdpInterfaceTable as part of the configuration group.</t>
          <t>Developed the nhdpDiscIfSetTable as a means to associate address lists with
             remotely discovered neighbor interfaces.</t>
          <t>Added tables defining the router's NHDP Local Information Base (LIB)
             as specified in the NHDP protocol specification.</t>  
          <t>Added tables defining the router's NHDP Interface information Base (IIB)
             as specified in the NHDP protocol specification.</t>  
          <t>Added tables defining the router's NHDP Neighbor Information Base (NIB)
             as specified in the NHDP protocol specification.</t>  
          <t>Aligned the NHDP-MIB and the OLSRv2-MIB configuration tables and indexing.</t>  
      </list></t>
    </section>


<!--    <section title="Open Issues">
      <t>This section contains the set of open issues related to the
         development and design of the NHDP-MIB.
         This section will not be present in the final version of the MIB
         and will be removed once all the open issues have been resolved.</t>

      <t><list style="numbers">
          <t></t>
        </list></t>
    </section>
-->

    <section title="">
       <figure>
          <preamble></preamble>

          <artwork>
***************************************************************
* Note to the RFC Editor (to be removed prior to publication) *
*                                                             *
* 1) The reference to RFCXXXX within the DESCRIPTION clauses  *
* of the MIB module point to this draft and are to be         *
* assigned by the RFC Editor.                                 *
*                                                             *
***************************************************************
          </artwork>
          <postamble></postamble>
       </figure>
    </section>

  </back>
</rfc>
