


Network Working Group                                          D. McGrew
Internet Draft                                       Cisco Systems, Inc.
Intended Status: Informational                          October 27, 2008
Expires: April 30, 2009                                                 


    AES-GCM and AES-CCM Authenticated Encryption in Secure RTP (SRTP)   
                     draft-mcgrew-srtp-aes-gcm-00.txt


Status of this Memo

   By submitting this Internet-Draft, each author represents that
   any applicable patent or other IPR claims of which he or she is
   aware have been or will be disclosed, and any of which he or she
   becomes aware will be disclosed, in accordance with Section 6 of
   BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 30, 2009.

Copyright Notice

   Copyright (C) The IETF Trust (2008).

   
    












McGrew                      Informational                       [Page 1]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


Abstract

   This document defines how AES GCM, AES CCM, and other Authenticated
   Encryption with Associated Data (AEAD) algorithms, can be used to
   provide confidentiality and data authentication mechanisms in the
   SRTP protocol. 
 

Table of Contents

   1. Introduction.....................................................2
   1.1. Conventions Used In This Document..............................3
   1.2. AEAD processing for SRTP.......................................3
   1.2.1. Terminology..................................................4
   1.2.2. Initialization Vectors for SRTP..............................4
   1.2.3. Initialization Vectors for SRTCP.............................5
   1.2.4. AEAD Authentication versus SRTP Authentication...............5
   2. AEAD parameters for SRTP and SRTCP...............................8
   2.1. Generic AEAD Parameter Constraints.............................8
   2.2. AES-GCM for SRTP/SRTCP.........................................9
   2.3. AES-CCM for SRTP/SRTCP.........................................9
   3. Security Considerations.........................................10
   4. IANA Considerations.............................................11
   5. Acknowledgements................................................12
   6. References......................................................12
   6.1. Normative References..........................................12
   6.2. Informative References........................................12


1. Introduction

   The Secure Real-time Transport Protocol (SRTP) is a profile of the
   Real-time Transport Protocol (RTP), which can provide
   confidentiality, message authentication, and replay protection to the
   RTP traffic and to the control traffic for RTP, the Real-time
   Transport Control Protocol (RTCP). 
 
   SRTP/SRTCP assumes that both the sender and recipient have a shared
   secret master key and a shared secret master salt.  As described in
   sections 4.3.1 and 4.3.3 of [RFC3711], a Key Derivation Function is
   applied to these secret values to obtain separate encryption keys,
   authentication keys and salting keys for STRP and for SRTCP.  (Note:
   As will be explained below, AEAD SRTP/SRTCP does not make use of
   these authentication keys.)
 
   Authenticated encryption [BN00] is a form of encryption that, in
   addition to providing confidentiality for the plaintext that is
   encrypted, provides a way to check its integrity and authenticity. 
   Authenticated Encryption with Associated Data, or AEAD [R02], adds
   the ability to check the integrity and authenticity of some
   Associated Data (AD), also called "additional authenticated data",
   that is not encrypted.  This specification makes use of the interface


McGrew                      Informational                       [Page 2]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


   to a generic AEAD algorithm as defined in [RFC5116]. 
 
   The Advanced Encryption Standard (AES) is a block cipher that
   provides a high level of security, and can accept different key
   sizes.  Two families of AEAD algorithm families, AES Galois/Counter
   Mode (AES GCM) and AES Cipher Block Chaining/Counter Mode (AES/CCM),
   are based upon AES.  This specification makes use of the AES versions
   that use 128-bit and 256-bit keys, which we call AES-128 and AES-256,
   respectively. 
 
   The Galois/Counter Mode (GCM) of operation and the Counter with CBC
   MAC (CCM) mode are AEAD modes of operation for block ciphers.  Both
   use counter mode to encrypt the data, an operation that can be
   efficiently pipelined, making them especially appealing for
   high-speed implementations, or for implementations in an efficient
   and compact circuit.  Further GCM authentication uses operations
   which are particularly well suited to efficient implementation in
   hardware.  This specification uses GCM and CCM with both AES-128 and
   AES-256. 
 
   In summary, this document defines how to use AEAD algorithms,
   particularly AES GCM and AES CCM, to provide confidentiality and
   message authentication within SRTP and SRTCP packets. 
 

1.1. Conventions Used In This Document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119]. 
 

1.2. AEAD processing for SRTP

   We first define how to use a generic AEAD algorithm in SRTP, then we
   describe the specific use of the AES-128-GCM and AES-256-GCM
   algorithms. 
 
   The use of an AEAD algorithm is defined by expressing the AEAD
   encryption algorithm inputs in terms of SRTP fields and data
   structures.  The AEAD encryption inputs are as follows:
 
      Key.  This input is the SRTP encryption key (SRTP_encr_key)
      produced from the shared secret master key using the key
      derivation process.  (Note that the SRTP_auth_key is not used). 
 
      Associated Data.  This is data that is to be authenticated but not
      encrypted.  In SRTP, the associated data consists of the entire
      RTP header, including the list of CSRC identifiers (if present)
      and the RTP header extension (if present), as shown in Figure 2. 
 
      Plaintext.  This is data that is to be both authenticated and


McGrew                      Informational                       [Page 3]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


      encrypted.  In SRTP this consists of the RTP payload, and the RTP
      padding and RTP pad count fields (if the latter two fields are
      present), as shown in Figure 2.  The padding service provided by
      RTP is not needed by the AEAD encryption algorithm, so the RTP
      padding and RTP pad count fields SHOULD be omitted. 
 
      Initialization Vector (IV).  Each STRP/SRTCP packet has its own
      12-octet initialization vector.  Construction of this IV is
      covered in more detail below. 
 
   The AEAD encryption algorithm accepts these four inputs and returns a
   Ciphertext field. 
 

1.2.1. Terminology

   The following terms have very specific meanings in the context of
   this RFC:
 
      Security Association.  For the purposes of this document a
      security association is the outcome of any process which results
      in mutual authentication between client and server and their
      possession of a shared secret master key and a shared secret
      master salt.  Details of how the security association is
      established are outside the scope of this document. 
 
      Instantiation.  Once keys have been established, an instance of
      the AEAD algorithm is created using the appropriate key.  In
      SRTP/SRTCP there will be four instantiations of the AEAD
      algorithm; one for SRTP traffic from the client to the server, one
      for SRTP traffic from the server to the client, one for SRTCP
      traffic from the client to the server, and one for SRTCP traffic
      from the server to the client.  Each of these instantiations has
      its own encryption key derived from its shared secret master key
      and encryption salt derived from its shared secret master salt. 
 
      Invocation.  SRTP/SRTCP data streams are broken into packets. 
      Each packet is processed by a single invocation of the appropriate
      instantiation of the AEAD algorithm. 
 
   Each AEAD instantiation has its own invocation counter which is
   incremented each time that particular instantiation is invoked.  As
   we shall see below, the invocation counter is used to insure each
   invocation gets a unique initialization vector. 
 

1.2.2. Initialization Vectors for SRTP

   The initialization vector for an SRTP packet is formed from the
   4-octet Synchronization Source identifier (SSRC), 4-octet Rollover
   Counter (ROC), the 2-octet RTP Sequence Number (SEQ), and a 12-octet
   SRTP session encryption salt produced by the SRTP Key Derivation


McGrew                      Informational                       [Page 4]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


   Function (KDF) as described in [RFC 3711].  (The concatenation of the
   ROC and SEQ serves as a 6-octet invocation counter.) First, a 2-octet
   string consisting of zeroes is prepended to the 4-octet SSRC, then
   the 4-octet ROC appended and 2-octet SEQ is appended to that octet
   string.  The resulting 12-octet string is bitwise exclusive-ored into
   salt; the output of that process is the IV.  The process is
   illustrated in Figure 1.  The IV is always exactly 12 octets in
   length. 
 

1.2.3. Initialization Vectors for SRTCP

   The initialization vector for an SRTCP packet is formed from the
   4-octet Synchronization Source identifier (SSRC), 31-bit SRTCP Index
   (packed zero-filled, right justified into a 4-octet field), and a
   12-octet SRTP session encryption salt produced by the SRTP Key
   Derivation Function (KDF) as described in [RFC 3711].  (The 31-bit
   SRTCP index serves as the invocation counter.) First a 12-octet
   string is formed by starting with a 2-octet string consisting of
   zeroes, and post-pending the 4-octet SSRC, the 4-octet ROC, and
   2-octet SEQ.  The resulting 12-octet string is bitwise exclusive-ored
   into salt; the output of that process is the IV.  The process is
   illustrated in Figure 3.  The IV is always exactly 12 octets in
   length. 
 

1.2.4. AEAD Authentication versus SRTP Authentication

   The reader is reminded that in addition to providing confidentiality
   for the plaintext that is encrypted, an AEAD algorithm also provides
   a way to check the data integrity and authenticity of the plaintext
   and associated data.  The AEAD integrity check is incorporated into
   the ciphertext field by RFC 5116, thus AEAD does not make use of the
   optional SRTP Authentication Tag field.  (Note that this means that
   the cipher text will be longer than the plain text by precisely the
   length of the AEAD authentication tag.)
 
   The AEAD message authentication mechanism MUST be the primary message
   authentication mechanism for AEAD SRTP.  Additional SRTP
   authentication mechanisms SHOULD NOT be used with any AEAD algorithm
   and the optional SRTP Authentication Tag SHOULD NOT be present. 
 
      Rationale.  Some applications use the Authentication Tag as a
      means of conveying additional information, notably [RFC4771]. 
      This document retains the Authentication Tag field primarily to
      preserve compatibility with these applications. 
 







McGrew                      Informational                       [Page 5]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


               0  0  0  0  0  0  0  0  0  0  1  1
               0  1  2  3  4  5  6  7  8  9  0  1
             +--+--+--+--+--+--+--+--+--+--+--+--+
             |00|00|    SSRC   |    ROC    | SEQ |---+
             +--+--+--+--+--+--+--+--+--+--+--+--+   |
                                                     |
             +--+--+--+--+--+--+--+--+--+--+--+--+   |
             |         Encryption Salt           |->(+)
             +--+--+--+--+--+--+--+--+--+--+--+--+   |
                                                     |
             +--+--+--+--+--+--+--+--+--+--+--+--+   |
             |       Initialization Vector       |<--+
             +--+--+--+--+--+--+--+--+--+--+--+--+

           Figure 1: SRTP Initialization Vector formation.



        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    A  |V=2|P|X|  CC   |M| Packet Type |       sequence number         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    A  |                           timestamp                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    A  |           synchronization source (SSRC) identifier            |
       +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
    A  |      contributing source (CSRC) identifiers (optional)        |
    A  |                               ....                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    A  |                   RTP extension (OPTIONAL)                    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    P  |                          payload  ...                         |
    P  |                               +-------------------------------+
    P  |                               | RTP padding   | RTP pad count |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    X  :              authentication tag (NOT RECOMMENDED)             :
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                P = Plaintext (to be encrypted and authenticated)
                A = Associated Data (to be authenticated only)
                X = neither encrypted nor authenticated

    Figure 2: Constructing AEAD inputs from an RTP packet.










McGrew                      Informational                       [Page 6]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


               0  0  0  0  0  0  0  0  0  0  1  1
               0  1  2  3  4  5  6  7  8  9  0  1
             +--+--+--+--+--+--+--+--+--+--+--+--+
             |00|00|    SSRC   |00|00|SRTCP Index|---+
             +--+--+--+--+--+--+--+--+--+--+--+--+   |
                                                     |
             +--+--+--+--+--+--+--+--+--+--+--+--+   |
             |         Encryption Salt           |->(+)
             +--+--+--+--+--+--+--+--+--+--+--+--+   |
                                                     |
             +--+--+--+--+--+--+--+--+--+--+--+--+   |
             |       Initialization Vector       |<--+
             +--+--+--+--+--+--+--+--+--+--+--+--+

           Figure 3: SRTCP Initialization Vector formation.


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    A  |V=2|P|X|  RC   |M| Packet Type |            length             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    A  |           synchronization source (SSRC) of Sender             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    P  |                         sender info                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    P  |                        report block 1                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    P  |                        report block 2                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    P  |                              ...                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    P  |V=2|P|X|  SC   |M| Packet Type |              length           |
       +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
    P  |                          SSRC/CSRC_1                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    P  |                           SDES items                          |
       +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
    P  |                              ...                              |
       +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
    A  |E|                         SRTCP index                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    X  |                   SRTCP MKI (optional)index                   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    X  :              authentication tag (NOT RECOMMENDED)             :
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                P = Plaintext (to be encrypted and authenticated)
                A = Associated Data (to be authenticated only)
                X = neither encrypted nor authenticated

    Figure 4: Constructing AEAD inputs from an RTCP packet.


McGrew                      Informational                       [Page 7]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008




2. AEAD parameters for SRTP and SRTCP

   In general, any AEAD algorithm can accept inputs with varying
   lengths, but each algorithm can accept only a limited range of
   lengths for a specific parameter.  In this section, we describe the
   constraints on the parameter lengths that any AEAD algorithm must
   support to be used in AEAD-SRTP.  Additionally we specify a complete
   parameter set for a specific AEAD algorithm, namely AES-GCM
 

2.1. Generic AEAD Parameter Constraints

   All AEAD algorithms used with SRTP/SRTCP MUST satisfy the three
   constraints listed below:
 
      PARAMETER  Meaning                 Value
      
      A_MAX      maximum additional       MUST be at least 12 octets
                 authenticated data
                 length
      N_MIN      minimum nonce (IV)       MUST be 12 octets
                 length
      N_MAX      maximum nonce (IV)       MUST be 12 octets
                 length
      C_MAX      maximum ciphertext       MUST be at most 2^16-40 octets
                 length per invocation    SHOULD be at least 2232
      
      
   The upper bound on C_MAX is obtained by subtracting away a 20-octet
   IP header, an 8-octet UDP header, and a 12-octet RTP header out of
   the largest possible IP packet, the total length of which is 2^16
   octets. 
 
   Similarly the lower bound on C_MAX is based on the maximum
   transmission unit (MTU) of 2272 octets in IEEE 802.11.  Because many
   RTP applications use very short payloads (for example, the G.729
   codec used in VoIP can be as short as 20 octets), implementations
   that only support a maximum ciphertext lengths smaller than 2232
   octets are permitted under this RFC.  However, in the interest of
   maximizing interoperability between various AEAD implementations, the
   use of C_MAX values less than 2232 is discouraged. 
 
   For sake of clarity we specify two additional parameters:
 
      Authentication Tag Length         MUST be either 8, 12, or 16
                                             octets
      Maximum number of invocations     MUST be at most 2^48 for SRTP
         for a given instantiation      MUST be at most 2^31 for SRTCP
      
   The reader is reminded that the plaintext is shorter than the


McGrew                      Informational                       [Page 8]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


   ciphertext by exactly the length of the AEAD authentication tag. 
 

2.2. AES-GCM for SRTP/SRTCP

   AES GCM is a family of AEAD algorithm built around the AES block
   cipher algorithm.  AES GCM uses AES counter mode for encryption and
   Galois Message Authentication Code (GMAC) for authentication.  A
   detailed description of the AES GCM family can be found in
   [RFC5116].  The following members of the AES GCM family may be used
   with SRTP/SRTCP:
 
             Table: AES GCM algorithms for SRTP/SRTCP
      Name                 Key Size      Auth. Tag Size     Reference
      ================================================================
      AEAD_AES_128_GCM     16 octets     16 octets          [RFC5116]
      AEAD_AES_256_GCM     32 octets     16 octets          [RFC5116]
      AEAD_AES_128_GCM_8   16 octets     8 octets           [RFC5282]
      AEAD_AES_256_GCM_8   32 octets     8 octets           [RFC5282]
      AEAD_AES_128_GCM_12  16 octets     12 octets          [RFC5282]
      AEAD_AES_256_GCM_12  32 octets     12 octets          [RFC5282]
      
      
   Any implementation of AES GCM SRTP MUST support both
   AEAD-AES-128-GCM-8 and AEAD-AES-256-GCM-8. 
 
   In addition to the invocation counter used in the formation of IVs,
   each instantiation of AES GCM has a block counter which is
   incremented each time AES is called to produce a 16-octet output
   block.  The block counter is reset to "1" each time AES GCM is
   invoked. 
 
                                               1   1   1   1   1   1
       0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5
     ----+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |        |      salt     |       |   salt xor    |     block     |
    |  salt  |      xor      | salt  |  invocation   |    counter    |
    |        |      ssrc     |       |    counter    |               |
     ----+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
   
      Figure 5: AES Inputs for Counter Mode Encryption in GCM

2.3. AES-CCM for SRTP/SRTCP

   AES CCM is another family of AEAD algorithm built around the AES
   block cipher algorithm.  AES GCM uses AES counter mode for encryption
   and AES Cipher Block Chaining Message Authentication Code (CBC MAC)
   for authentication.  A detailed description of the AES CCM family can
   be found in [RFC5116].  The following members of the AES CCM family
   may be used with SRTP/SRTCP:
 
          Table: AES CCM algorithms for SRTP/SRTCP


McGrew                      Informational                       [Page 9]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


   Name                 Key Size      Auth. Tag Size     Reference
   ================================================================
   AEAD_AES_128_CCM     16 octets     16 octets          [RFC5116]
   AEAD_AES_256_CCM     32 octets     16 octets          [RFC5116]
   
   Any implementation of AES CCM SRTP/SRTCP MUST support both
   AEAD-AES-128-CCM and AEAD-AES-256-CCM. 
 
      In addition to the invocation counter used in the formation of
      IVs, each instantiation of AES CCM has a block counter which is
      incremented each time AES is called to produce a 16-octet output
      block.  The block counter is reset to "0" each time AES CCM is
      invoked. 
 
   AES CCM uses a flag octet that conveys information about the length
   of the authentication tag, length of the block counter, and presence
   of additional authenticated data.  For AES CCM in SRTP/SRTCP, the
   flag octet has the hex value 5A if an 8-octet authentication tag is
   used, 6A if a 12-octet authentication tag is used, and 7A if a
   16-octet authentication tag is used.  The flag octet is one of the
   inputs to AES during the counter mode encryption of the plaintext
   (see Figure 6)
 
                                                1   1   1   1   1   1
       0   1   2   3   4   5   6   7   8   9   0   1   2   3   4   5
     ----+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |    |       |      salt     |       |   salt xor    |   block   |
    |Flag| salt  |      xor      | salt  |  invocation   |  counter  |
    |    |       |      ssrc     |       |    counter    |           |
     ----+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
   
     Figure 6: AES Inputs for Counter Mode Encryption in CCM

3. Security Considerations

   We require that the AEAD authentication tag must be at least 8
   octets, significantly reducing the probability of an adversary
   successfully introducing fraudulent data.  The goal of an
   authentication tag is to minimize the probability of a successful
   forgery occurring anywhere in the network we are attempting to
   defend.  There are three relevant factors: how low we wish the
   probability of successful forgery to be (prob_success), how many
   attempts the adversary can make (N_tries) and the size of the
   authentication tag in bits (N_tag_bits).  Then
 
           prob_success < expected number of successes
                        = N_tries * 2^-N_tag_bits.
   
   The table below summarizes the relationship between the
   authentication tag size, the probability of success, and the maximum
   numbers of forgery attempts that can be permitted on our network. 
 


McGrew                      Informational                      [Page 10]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


      
      |==================+========================================|
      |  Authentication  |  Probability any Successful Forgeries  |
      |    Tag Size      |-------------+-------------+------------|
      |    (octets)      |    2^-10    |   2^-20     |   2^-30    |
      |==================+=============+=============+============|
      |        4         |  2^22 tries |  2^12 tries |  2^2 tries |
      |==================+=============+=============+============|
      |        8         |  2^54 tries |  2^44 tries | 2^34 tries |
      |==================+=============+=============+============|
      |       12         |  2^86 tries |  2^76 tries | 2^66 tries |
      |==================+=============+=============+============|
      |       16         | 2^118 tries | 2^108 tries | 2^98 tries |
      |==================+=============+=============+============|
      
       Table 1: Maximum allowable number of forgery attempts for
                a given tag size and probability of success.
      

4. IANA Considerations

   RFC 4568 defines SRTP "crypto suites"; a crypto suite corresponds to
   a particular AEAD algorithm in SRTP.  In order to allow SDP to signal
   the use of the algorithms defined in this document, IANA will
   register the following crypto suites into the subregistry for SRTP
   crypto suites under the SRTP transport of the SDP Security
   Descriptions:
 
      srtp-crypto-suite-ext = "AEAD_AES_128_GCM"    /
                              "AEAD_AES_256_GCM"    /
                              "AEAD_AES_128_GCM_8"  /
                              "AEAD_AES_256_GCM_8"  /
                              "AEAD_AES_128_GCM_12" /
                              "AEAD_AES_256_GCM_12" /
                              "AEAD_AES_128_CCM"    /
                              "AEAD_AES_256_CCM"    /
                              srtp-crypto-suite-ext
   
   draft-ietf-avt-dtls-srtp-05 defines a DTLS-SRTP "SRTP Protection
   Profile"; it also corresponds to the use of an AEAD algorithm in
   SRTP.  In order to allow the use of the algorithms defined in this
   document in DTLS-SRTP, IANA will also register the following SRTP
   Protection Profiles:
 
        SRTP_AEAD_AES_128_GCM
        SRTP_AEAD_AES_256_GCM
        SRTP_AEAD_AES_128_GCM_8
        SRTP_AEAD_AES_256_GCM_8
        SRTP_AEAD_AES_128_GCM_12
        SRTP_AEAD_AES_256_GCM_12
        SRTP_AEAD_AES_128_CCM
        SRTP_AEAD_AES_256_CCM


McGrew                      Informational                      [Page 11]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


   
   

5. Acknowledgements

   The author would like to thank Kevin Igoe and many other reviewers
   provided valuable comments on earlier drafts of this document. 
 

6. References


6.1. Normative References

   [CCM]      Dworkin, M., "NIST Special Publication 800-38C: The CCM
              Mode for Authentication and Confidentiality", U.S.
              National Institute of Standards and Technology http://
              csrc.nist.gov/publications/nistpubs/800-38C/SP800-38C.pdf.

   [GCM]      Dworkin, M., "NIST Special Publication 800-38D:
              Recommendation for Block Cipher Modes of Operation:
              Galois/Counter Mode (GCM) and GMAC.", U.S. National
              Institute of Standards and Technology http://
              csrc.nist.gov/publications/nistpubs/800-38D/SP800-38D.pdf.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC5116]  McGrew, D., "An Interface and Algorithms for
              Authenticated Encryption with Associated Data", RFC 5116,
	      January 2008.


6.2. Informative References

   [BN00]     Bellare, M. and C. Namprempre, "Authenticated encryption:
              Relations among notions and analysis of the generic
              composition paradigm", Proceedings of ASIACRYPT 2000,
              Springer-Verlag, LNCS 1976, pp. 531-545 http://
              www-cse.ucsd.edu/users/mihir/papers/oem.html.

   [BOYD]     Boyd, C. and A. Mathuria, "Protocols for Authentication
              and Key Establishment", Springer, 2003 .

   [CMAC]     "NIST Special Publication 800-38B",  http://csrc.nist.gov/
              CryptoToolkit/modes/800-38_Series_Publications/
              SP800-38B.pdf.

   [EEM04]    Bellare, M., Namprempre, C., and T. Kohno, "Breaking and
              provably repairing the SSH authenticated encryption
              scheme: A case study of the Encode-then-Encrypt-and-MAC
              paradigm", ACM Transactions on Information and System Secu


McGrew                      Informational                      [Page 12]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


              rity, http://www-cse.ucsd.edu/users/tkohno/papers/
              TISSEC04/.

   [GR05]     Garfinkel, T. and M. Rosenblum, "When Virtual is Harder
              than Real: Security Challenges in Virtual Machine Based
              Computing Environments", Proceedings of the 10th Workshop
              on Hot Topics in Operating Systems http://
              www.stanford.edu/~talg/papers/HOTOS05/
              virtual-harder-hotos05.pdf.

   [J02]      Jonsson, J., "On the Security of CTR + CBC-MAC",
              Proceedings of the 9th Annual Workshop on Selected Areas
              on Cryptography, http://csrc.nist.gov/CryptoToolkit/modes/
              proposedmodes/ccm/ccm-ad1.pdf, 2002.

   [MODES]    Dworkin, M., "NIST Special Publication 800-38:
              Recommendation for Block Cipher Modes of Operation", U.S.
              National Institute of Standards and Technology http://
              csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf.

   [MV04]     McGrew, D. and J. Viega, "The Security and Performance of
              the Galois/Counter Mode (GCM)", Proceedings of INDOCRYPT
              '04, http://eprint.iacr.org/2004/193, December 2004.

   [R02]      Rogaway, P., "Authenticated encryption with Associated-
              Data", ACM Conference on Computer and Communication
              Security (CCS'02), pp. 98-107, ACM Press,
              2002. http://www.cs.ucdavis.edu/~rogaway/papers/ad.html.

   [RFC2104]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-
              Hashing for Message Authentication", RFC 2104,
              February 1997.

   [RFC2434]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", BCP 26, RFC 2434,
              October 1998.

   [RFC4086]  Eastlake, D., Schiller, J., and S. Crocker, "Randomness
              Requirements for Security", BCP 106, RFC 4086, June 2005.

   [RFC4106]  Viega, J. and D. McGrew, "The Use of Galois/Counter Mode
              (GCM) in IPsec Encapsulating Security Payload (ESP)",
              RFC 4106, June 2005.

   [RFC4107]  Bellovin, S. and R. Housley, "Guidelines for Cryptographic
              Key Management", BCP 107, RFC 4107, June 2005.

   [RFC4303]  Kent, S., "IP Encapsulating Security Payload (ESP)",
              RFC 4303, December 2005.

   [RFC4309]  Housley, R., "Using Advanced Encryption Standard (AES) CCM
              Mode with IPsec Encapsulating Security Payload (ESP)",


McGrew                      Informational                      [Page 13]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


              RFC 4309, December 2005.

   [RFC4771]  Lehtovirta, V., Naslund, M., and K. Norrman, "Integrity
              Transform Carrying Roll-Over Counter for the Secure Real-
              time Transport Protocol (SRTP)", RFC 4771, January 2007.

















































McGrew                      Informational                      [Page 14]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


   Author's Address
   
      David A. McGrew
      Cisco Systems, Inc.
      510 McCarthy Blvd.
      Milpitas, CA  95035
      US
   
      Phone: (408) 525 8651
      Email: mcgrew@cisco.com
      URI:   http://www.mindspring.com/~dmcgrew/dam.htm
   
   


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement


McGrew                      Informational                      [Page 15]

Internet Draft         AES-GCM and AES-CCM for SRTP         Oct 27, 2008


   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).















































McGrew                      Informational                      [Page 16]
