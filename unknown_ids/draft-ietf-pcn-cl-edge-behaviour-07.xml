<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced. 
     An alternate method (rfc include) is described in the
     references. -->

<!ENTITY RFC2119 SYSTEM
"http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2474 SYSTEM
"http://xml.resource.org/public/rfc/bibxml/reference.RFC.2474.xml">
<!ENTITY RFC2475 SYSTEM
"http://xml.resource.org/public/rfc/bibxml/reference.RFC.2475.xml">
<!ENTITY RFC3086 SYSTEM
"http://xml.resource.org/public/rfc/bibxml/reference.RFC.3086.xml">
<!ENTITY RFC5559 SYSTEM
"http://xml.resource.org/public/rfc/bibxml/reference.RFC.5559.xml">
<!ENTITY RFC5670 SYSTEM
"http://xml.resource.org/public/rfc/bibxml/reference.RFC.5670.xml">
<!ENTITY RFC5696 SYSTEM
"http://xml.resource.org/public/rfc/bibxml/reference.RFC.5696.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions
     (PIs), please see http://xml.resource.org/authoring/README.html.
      -->
<!-- Below are generally applicable Processing Instructions (PIs)
     that most I-Ds might want to use. -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space 
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="info" docName="draft-ietf-pcn-cl-edge-behaviour-07"
ipr="trust200902">

<!-- ***** FRONT MATTER ***** -->

<front>
  <!-- The abbreviated title is used in the page header - it is
       only necessary if the full title is longer than 39 characters
-->

  <title abbrev="PCN CL Boundary Node Behaviour">PCN Boundary Node
    Behaviour for the Controlled Load (CL) Mode of Operation</title>

  <author fullname="Anna Charny" initials="A." surname="Charny">
    <organization>Cisco Systems</organization>
    <address>
      <postal>
        <street>300 Apollo Drive</street>
        <city>Chelmsford</city>
        <region>MA</region>
        <code>01824</code>
        <country>USA</country>
      </postal>
      <email>acharny@cisco.com</email>
    </address>
  </author>

  <author fullname="Fortune Huang" initials="F.Q." surname="Huang">
    <organization>Huawei Technologies</organization>
    <address>
      <postal>
        <street>Section F, Huawei Industrial Base, </street>
        <city>Bantian Longgang</city>
        <region>Shenzhen</region>
        <code>518129</code>
        <country>P.R. China</country>
      </postal>
      <phone>+86 15013838060</phone>
      <email>fqhuang@huawei.com</email>
    </address>
  </author>

  <author fullname="Georgios Karagiannis" initials="G."
    surname="Karagiannis">
    <organization>U. Twente</organization>
    <address>
      <postal>
        <street> </street>
        <city></city>
        <region></region>
        <code></code>
        <country></country>
      </postal>
      <phone></phone>
      <email>karagian@cs.utwente.nl</email>
    </address>
  </author>

  <author fullname="Michael Menth" initials="M." surname="Menth">
    <organization>University of Wuerzburg</organization>
    <address>
      <postal>
        <street>Am Hubland</street>
        <city>Wuerzburg</city>
        <code>D-97074</code>
        <country>Germany</country>
      </postal>
      <phone>+49-931-888-6644</phone>
      <email>menth@informatik.uni-wuerzburg.de</email>
    </address>
  </author>

  <author fullname="Tom Taylor" initials="T." role="editor"
    surname="Taylor">
    <organization>Huawei Technologies</organization>
    <address>
      <postal>
        <street>1852 Lorraine Ave</street>
        <city>Ottawa</city>
        <region>Ontario</region>
        <country>Canada</country>
        <code>K1H 6Z8</code>
      </postal>
      <phone>+1 613 680 2675</phone>
      <email>tom111.taylor@bell.net</email>
    </address>
  </author>

  <date year="2010"/>

  <!-- Meta-data Declarations -->

  <area>Transport</area>
  <workgroup>Internet Engineering Task Force</workgroup>
  <keyword>PCN</keyword>
  <keyword>controlled load</keyword>
  <keyword>CL</keyword>
  <keyword>boundary node behaviour</keyword>

  <abstract>
    <t>Pre-congestion notification (PCN) is a means for protecting
    the quality of service for inelastic traffic admitted to a
    Diffserv domain. The overall PCN architecture is described in RFC
    5559. This memo is one of a series describing possible boundary
    node behaviours for a PCN-domain. The behaviour described here is
    that for a form of measurement-based load control using three PCN
    marking states, not-marked, threshold-marked, and 
    excess-traffic-marked. This behaviour is known informally as the
    Controlled Load (CL) PCN-boundary-node behaviour. </t>
  </abstract>
</front>

<middle>
<section anchor="intro" title="Introduction">

    <t>   The objective of Pre-Congestion Notification (PCN) is to protect
    the quality of service of inelastic flows within a Diffserv domain, in a
    simple, scalable, and robust fashion.  Two mechanisms are used: admission
    control, to decide whether to admit or block a new flow request, and (in
    abnormal circumstances) flow termination to decide whether to terminate 
    some of the existing flows. To achieve this, the overall rate of PCN-traffic
    is metered on every link in the PCN-domain, and PCN-packets are 
    appropriately marked when certain configured rates are exceeded.  These
    configured rates are below the rate of the link thus providing notification
    to PCN-boundary-nodes about incipient overloads before any congestion occurs
    (hence the "pre" part of pre-congestion notification).  The level of marking
    allows decisions to be made on whether to admit or terminate PCN-flows. For
    more details see <xref target="RFC5559"/>. </t>

    <t>PCN-boundary-node behaviours specify a detailed set of algorithms and
    procedures used to implement the PCN mechanisms. Since the algorithms
    depend on specific metering and marking behaviour at the interior nodes,
    it is also necessary to specify the assumptions made about
    PCN-interior-node behaviour. Finally, because PCN uses DSCP values to carry
    its markings, a specification of PCN-boundary-node behaviour must include
    the per domain behaviour (PDB) template specified in
    <xref target="RFC3086"/>, filled out with the appropriate content. The
    present document accomplishes these tasks for the controlled load (CL)
    mode of operation. </t>

    <section anchor="terms" title="Terminology">

      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
      document are to be interpreted as described in RFC2119 [RFC2119].</t>

      <t>In addition to the terms defined in <xref target="RFC5559"/>,
      this document uses the following terms:
      <list style="hanging" hangIndent="3">

        <t hangText="Decision Point">
				<vspace blankLines="0" /> 
				The node that makes the decision about which flows to admit and to
				terminate. In a given network deployment, this may be the 
				PCN-ingress-node or a centralized control node.  Regardless of the 
				location of the Decision Point, the ingress node is the point where 
				the decisions are enforced.</t>

        <t hangText="NM-rate">
				<vspace blankLines="0" />
				The rate of not-marked PCN-traffic received at a PCN-egress-node
				for a given ingress-egress-aggregate in octets per second. For
				further details see <xref target="egrColl"/>.</t>

        <t hangText="ThM-rate">
        <vspace blankLines="0" /> 
        The rate of threshold-marked PCN-traffic received at a 
        PCN-egress-node for a given ingress-egress-aggregate in octets per
        second. For further details see <xref target="egrColl"/>.</t>

        <t hangText="ETM-rate">
        <vspace blankLines="0" /> 
        The rate of excess-traffic-marked PCN-traffic received at a 
        PCN-egress-node for a given ingress-egress-aggregate in octets per
        second. For further details see <xref target="egrColl"/>.</t>

        <t hangText="PCN-sent-rate">
        <vspace blankLines="0" />
        The rate of PCN-traffic received at a PCN-ingress-node and destined
        for a given ingress-egress-aggregate in octets per second. For further
        details see <xref target="ingrBehav"/>.</t>

        <t hangText="Congestion level estimate (CLE)">
        <vspace blankLines="0"/>
        A value derived from the measurement of PCN packets
        received at a PCN-egress-node for a given ingress-egress-aggregate,
        representing the ratio of marked to total PCN-traffic (measured in
        octets) over a short period. The CLE is used to derive the 
        PCN-admission-state (<xref target="decisAdmit"/>) and also by the
        report suppression procedure (<xref target="repSuppress"/>) if 
        report suppression is activated.</t>

        <t hangText="PCN-admission-state"> 
        <vspace blankLines="0" /> 
        The state ("admit" or "block") derived by the Decision Point for a given
        ingress-egress-aggregate based on PCN packet marking statistics. The 
        Decision Point decides to admit or block new flows offered to the 
        aggregate based on the current value of the PCN-admission-state. For 
        further details see <xref target="decisAdmit"/>.</t>

        <t hangText="Sustainable aggregate rate (SAR)"> 
        <vspace blankLines="0" /> 
        The estimated maximum rate of PCN-traffic that can be admitted to a given
        ingress-egress-aggregate at a given moment without risking degradation of
        quality of service for the admitted flows. The intention is that if the 
        PCN-sent-rate of every ingress-egress-aggregate passing through a given
        link is limited to its sustainable aggregate rate, the total rate of 
        PCN-traffic flowing through the link will be limited to the
        PCN-supportable-rate for that link. An estimate of the sustainable aggregate
        rate for a given ingress-egress-aggregate is derived as part of the flow
        termination procedure, and is used to determine how much PCN-traffic must
        be terminated. For further details see <xref target="decisTerm"/>.</t>
        
        <t hangText="CLE-reporting-threshold"> 
        <vspace blankLines="0" /> 
        A configurable value against which the CLE is compared as part of the
        report suppression procedure. For further details, see 
        <xref target="repSuppress"/>.</t>

        <t hangText="CLE-limit"> 
        <vspace blankLines="0" /> 
        A configurable value against which the CLE is compared in order to 
        derive the PCN-admission-state for a given ingress-egress-aggregate.
        For further details, see <xref target="decisAdmit"/>.</t>

        <t hangText="T-meas"> 
        <vspace blankLines="0" /> 
        An interval, the value of which is configurable, defining the measurement
        period at the PCN-egress-node during which statistics relating to 
        PCN-traffic marking are collected. At the end of the interval the values 
        NM-rate, ThM-rate, and ETM-rate as defined above are calculated and a
        report is sent to the Decision Point, subject to the operation of the 
        report suppression feature. For further details see 
        <xref target="egressBehav"/>.</t>

        <t hangText="T-maxsuppress"> 
        <vspace blankLines="0" /> 
        An interval, the value of which is configurable, after which the 
        PCN-egress-node must send a report to the Decision Point for a given 
        ingress-egress-aggregate regardless of the most recent values of the 
        CLE. This is used as a keep-alive mechanism for signalling between the
        PCN-egress-node and the Decision Point when report suppression is
        activated. For further details, see <xref target="repSuppress"/>.</t>

        <t hangText="T-fail"> 
        <vspace blankLines="0" /> 
        An interval, the value of which is configurable, after which the Decision
        Point concludes that communication from a given PCN-egress-node has failed
        if it has received no reports from the PCN-egress-node during that 
        interval. For further details see <xref target="decisSig"/>.</t>
      </list>
      </t>

    </section><!-- terms -->

</section><!-- intro -->

<section anchor="coreAssum" title="Assumed Core Network Behaviour for CL">

	<t> This section describes the assumed behaviour for nodes of the PCN-domain
	when acting in their role as PCN-interior-nodes. The CL mode of operation
	assumes that:
	<list style="symbols">

		<t> PCN-interior-nodes perform threshold-marking and excess-traffic-marking
		of packets according to the rules specified in <xref target="RFC5670"/>, and
		any additional rules specified in the applicable encoding extension document;
		</t>

		<t> encoding of PCN status within individual packets is based on 
		<xref target="RFC5696"/>, extended to provide a third PCN encoding state.
		A possible extension is documented in <xref target="ID.PCN3in1"/>; </t>

		<t> the PCN-domain satisfies the conditions specified in the applicable
		encoding extension document; </t>

		<t> on each link the reference rate for the threshold-meter is configured
		to be equal to the PCN-admissible-rate for the link; </t> 

		<t> on each link the reference rate for the excess traffic meter is
		configured to be equal to the PCN-supportable-rate for the link; </t>
	</list>
	</t>

	<t> According to <xref target="RFC5696"/>, the encoding extension documents 
	should specify the allowable transitions between marking states. However, to
	be absolutely clear, these allowable transitions are specified here. At any
	interior node, the only permitted transitions are these: 
	<list style="symbols"> 

		<t>a PCN-packet that is not-marked (NM) MAY be threshold-marked (ThM)
		or excess-traffic-marked (ETM);</t>

		<t>a PCN-packet that is threshold-marked (ThM) MAY be 
		excess-traffic-marked (ETM).</t>

	</list>

	An interior node MUST NOT perform any of the following:
	<list style="symbols">
		<t>re-mark a packet from PCN to non-PCN, or from non-PCN to PCN;</t> 
		<t>re-mark a PCN-packet from threshold-marked (ThM) to not-marked (NM);</t>
		<t>re-mark a PCN-packet from excess-traffic-marked (ETM) to not-marked (NM) 
		or threshold-marked (ThM).</t>
	</list>
	</t>

</section><!-- coreAssum -->

<section anchor="behaviours" title="Node Behaviours">

	<section anchor="overBehav" title="Overview">

		<t>This section describes the behaviour of the PCN-ingress-node, 
		PCN-egress-node, and the Decision Point (which may be collocated with the 
		PCN-ingress-node). </t>

		<t>The PCN-egress-node collects the rates of not-marked, threshold-marked, 
		and excess-traffic-marked PCN-traffic for each ingress-egress-aggregate and
		reports them to the Decision Point. It may also identify PCN-flows that have
		experienced excess-traffic-marking. For a detailed description, see 
		<xref target="egressBehav"/>.</t>

		<t>The PCN-ingress-node enforces flow admission and termination decisions. 
		It also reports the rate of PCN-traffic sent to a given ingress-egress-aggregate
		when requested by the Decision Point. For details, see 
		<xref target="ingrBehav"/>.</t>

		<t>Finally, the Decision Point makes flow admission decisions and selects 
		flows to terminate based on the information provided by the PCN-ingress-node 
		and PCN-egress-node for a given ingress-egress-aggregate. For details, see 
		<xref target="decisBehav"/>.</t>

	</section><!-- overBehav -->

	<section anchor="egressBehav" title="Behaviour of the PCN-Egress-Node">

		<section anchor="egrColl" title="Data Collection">

			<t>The PCN-egress-node MUST meter received PCN-traffic in order to derive
			periodically the following rates for each ingress-egress-aggregate passing
			through it: 
			<list style="symbols">
				<t>NM-rate: octets per second of PCN-traffic in PCN-packets that are 
				not-marked;</t> 
				<t>ThM-rate: octets per second of PCN-traffic in PCN-packets that are
				threshold-marked;</t> 
				<t>ETM-rate: octets per second of PCN-traffic in PCN-packets that are 
				excess-traffic-marked.</t>
			</list> 
			It is RECOMMENDED that the measurement interval, T-meas, between successive
			calculations of these quantities be in the range of 100 to 500 ms to provide
			a reasonable tradeoff between signalling demands on the network and the time
			taken to react to impending congestion. </t>

			<t>The PCN-traffic SHOULD be metered continuously and the intervals 
			themselves SHOULD be of equal length, to minimize the statistical variance
			introduced by the measurement process itself. The starting and ending times
			of the measurement intervals for different ingress-egress-aggregates MAY be
			the same or MAY be different.</t>

			<t>As a configurable option, the PCN-egress-node MAY record flow identifiers
			of the PCN-flows for which excess-traffic-marked packets have been observed.
			These can be used by the Decision Point when it selects flows for termination.
			<list style="empty">
				<t>In networks using multipath routing it is possible that congestion is
				not occurring on all paths carrying a given ingress-egress-aggregate.
				Assuming that specific PCN-flows are routed via specific paths, identifying
				the PCN-flows that are experiencing excess-traffic-marking helps to avoid
				termination of PCN-flows not contributing to congestion.</t>
			</list>
			</t>

		</section><!-- egrColl -->

		<section anchor="egrSig" title="Reporting the PCN Data">

			<t>If the report suppression option described in the next sub-section is not
			activated, the PCN-egress-node MUST report the latest values of NM-rate, 
			ThM-rate, and ETM-rate to the Decision Point each time that it calculates 
			them.</t>

			<t>If so configured (e.g., because multipath routing is being used, as
			explained in the previous section), the PCN-egress-node MUST also report the
			set of flow identifiers of PCN-flows for which excess-traffic-marking was
			observed in the most recent measurement interval. If this set is large, the
			PCN-egress-node MAY report only the most recently excess-traffic-marked 
			PCN-flows rather than the complete set. </t>

		</section><!-- egrSig -->

		<section anchor="repSuppress" title="Optional Report Suppression">

			<t>Report suppression MUST be provided as a configurable option, along with 
			two configurable parameters, the CLE-reporting-threshold and the maximum 
			report suppression interval T-maxsuppress. The default value of the 
			CLE-reporting-threshold is zero. T-maxsuppress is discussed further at the 
			end of this sub-section, but functions as a keep-alive mechanism for 
			signalling between the PCN-egress-node and the Decision Point.</t>

			<t>If the report suppression option is enabled, the PCN-egress-node MUST 
			apply the following procedure to decide whether to send a report to the
			Decision Point, rather than sending a report automatically at the end of
			each measurement interval. 
			<list style="numbers">
				<t>As well as the quantities NM-rate, ThM-rate, and ETM-rate, the 
				PCN-egress-node MUST calculate the congestion level estimate (CLE) for 
				each measurement interval. The CLE is equal to the ratio: 
				<list style="empty"> 
					<t>(ThM-rate + ETM-rate) / (NM-rate + ThM-rate + ETM-rate)</t> 
				</list> 
				if any PCN-traffic was observed, or zero otherwise.
				</t>

				<t>If the calculated CLE for the latest measurement interval or for the
				immediately previous interval is greater than the CLE-reporting-threshold,
				then the PCN-egress-node MUST send a report to the Decision Point. The
				contents of the report are described below.</t>

				<t>If an interval T-maxsuppress has elapsed since the last report was sent
				to the Decision Point, then the PCN-egress-node MUST send a report to the 
				Decision Point regardless of the CLE value. </t>

				<t>If neither of the preceding conditions holds, the PCN-egress-node MUST
				NOT send a report for the latest measurement interval.</t> 
			</list>
			</t>

			<t>Each report sent to the Decision Point when report suppression has been
			activated MUST contain the values of NM-rate, ThM-rate, ETM-rate, and CLE 
			that were calculated for the most recent measurement interval. If so
			configured, the PCN-egress-node MUST also report the set of flow identifiers
			of PCN-flows for which excess-traffic-marking was observed in the most recent
			measurement interval.</t>

			<t>The above procedure ensures that at least one report is sent per interval
			(T-maxsuppress + T-meas). This provides some protection against loss of 
			egress reports and also demonstrates to the Decision Point that both the 
			PCN-egress-node and the communication path between the two nodes are in
			operation. However, depending on the transport used for reporting, the
			operator may choose to set T-maxsuppress to an effectively infinite value.
			For example, the transport may include its own keep-alive signalling at a
			frequency such that PCN keep-alive signalling is redundant. </t>

		</section><!-- repSuppress -->

	</section><!-- egressBehav -->

	<section anchor="decisBehav" title="Behaviour at the Decision Point">

		<t>Operators may choose to use PCN procedures just for flow admission, or just
		for flow termination, or for both. The Decision Point MUST implement both
		mechanisms, but configurable options MUST be provided to activate or deactivate
		PCN-based flow admission and flow termination independently of each other at a
		given Decision Point.</t>

		<t>If PCN-based flow termination is enabled but PCN-based flow admission is not,
		flow termination operates as specified in this document. Logically, some other
		system of flow admission control must be in operation, but the description of
		such a system is out of scope of this document and depends on local 
		arrangements.</t>

		<section anchor="decisAdmit" title="Flow Admission">

			<t>The Decision Point determines the PCN-admission-state for a given 
			ingress-egress-aggregate each time it receives a report from the egress node.
			It makes this determination on the basis of the congestion level estimate
			(CLE). If the CLE is provided in the egress node report, the Decision Point
			SHOULD use the reported value. If the CLE was not provided in the report, the
			Decision Point MUST calculate it based on the other values provided in the
			report, using the formula 
			<list style="empty"> 
   			<t>CLE = (ThM-rate + ETM-rate) / (NM-rate + ThM-rate + ETM-rate)</t> 
			</list> 
			if any PCN-traffic was observed, or CLE = 0 if all the rates are zero.</t>

			<t>The Decision Point MUST compare the reported or calculated CLE to a
			configurable value, the CLE-limit. If the CLE is less than the CLE-limit,
			the PCN-admission-state for that aggregate MUST be set to "admit"; otherwise
			it MUST be set to "block". 
			<list style="empty">
				<t>The outcome of the comparison is not very sensitive to the value of the
				CLE-limit in practice, because when threshold-marking occurs it tends to
				persist long enough that threshold-marked traffic becomes a large 
				proportion of the received traffic in a given interval.</t>
			</list>
			</t>

			<t>If the PCN-admission-state for a given ingress-egress-aggregate is "admit",
			the Decision Point SHOULD allow new flows to be admitted to that aggregate. 
			If the PCN-admission-state for a given ingress-egress-aggregate is "block", 
			the Decision Point SHOULD NOT allow new flows to be admitted to that 
			aggregate. These actions MAY be modified by policy in specific cases, but 
			such policy intervention risks defeating the purpose of using PCN. </t>

		</section><!-- decisAdmit -->

		<section anchor="decisTerm" title="Flow Termination">

			<t>When the report from the PCN-egress-node includes a non-zero value of the
			ETM-rate for some ingress-egress-aggregate, the Decision Point MUST request 
			the PCN-ingress-node to provide an estimate of the rate (PCN-sent-rate) at
			which the PCN-ingress-node is receiving PCN-traffic that is destined for the
			given ingress-egress-aggregate. 
			<list style="empty">
				<t>If the Decision Point is collocated with the PCN-ingress-node, the 
				request and response are internal operations.</t>
			</list> 
			The Decision Point MUST then wait for both the requested rate from the
			PCN-ingress-node and the next report from the PCN-egress-node for the 
			ingress-egress-aggregate concerned. If the next egress node report also
			includes a non-zero value for the ETM-rate, the Decision Point MUST determine
			an amount of flow to terminate using the following steps: 
			<list style="numbers">
				<t>The sustainable aggregate rate (SAR) for the given 
				ingress-egress-aggregate is estimated by the sum:
				<list style="empty">
					<t>SAR = NM-rate + ThM-rate</t>
				</list>
				for the latest reported interval.</t>

				<t>The amount of traffic that should be terminated is the difference:
				<list style="empty">
					<t>PCN-sent-rate - SAR,</t>
				</list>
				where PCN-sent-rate is the value provided by the PCN-ingress-node.
				</t>

			</list>
			</t>

			<t>If the difference calculated in the second step is positive, the Decision
			Point SHOULD select PCN-flows to terminate, until it determines that the 
			PCN-traffic admission rate will no longer be greater than the estimated
			sustainable aggregate rate. If the Decision Point knows the bandwidth 
			required by individual PCN-flows (e.g., from resource signalling used to 
			establish the flows), it MAY choose to complete its selection of PCN-flows to
			terminate in a single round of decisions.</t>
 
			<t>Alternatively, the Decision Point MAY spread flow termination over 
			multiple rounds to avoid over-termination.  If this is done, it is 
			RECOMMENDED that enough time elapse between successive rounds of termination 
			to allow the effects of previous rounds to be reflected in the measurements
			upon which the termination decisions are based (see <xref target="IEEE-Satoh"/>
			and sections 4.2 and 4.3 of <xref target="Menth08-sub-9"/>).</t>

			<t>If the egress node has supplied a list of PCN-flow identifiers 
			(<xref target="egressBehav"/>), the Decision Point SHOULD first consider
			terminating PCN-flows in that list. In general, the selection of flows for
			termination MAY be guided by policy.</t>

		</section><!-- decisTerm -->

		<section anchor="decisSig" title="Decision Point Action For Missing 
		PCN-Boundary-Node Reports">

			<t>If the Decision Point fails to receive any report from a given 
			PCN-egress-node for a configurable interval T-fail, it SHOULD raise an alarm
			to management. A Decision Point collocated with a PCN-ingress-node SHOULD 
			cease to admit PCN-flows to the ingress-egress-aggregate passing from the 
			PCN-ingress-node to the given PCN-egress-node, until it again receives a 
			report from that node. A centralized Decision Point MAY cease to admit 
			PCN-flows to all ingress-egress-aggregates destined to the PCN-egress-node
			concerned, until it again receives a report from that node.</t>

			<t>If a centralized Decision Point fails to receive a reply within a 
			reasonable period of time to a request for a PCN-sent-rate value sent to 
			a given PCN-ingress-node, it SHOULD raise an alarm to management.</t>

		</section><!-- decisSig -->

	</section><!-- decisBehav -->

	<section anchor="ingrBehav" title="Behaviour of the Ingress Node">

		<t>The PCN-ingress-node MUST provide the estimated rate of PCN-traffic received
		at  that node and destined for a given ingress-egress-aggregate in octets per
		second (the PCN-sent-rate) when the Decision Point requests it.  The way this
		rate estimate is derived is a matter of implementation. 
		<list style="empty">
			<t>For example, the rate that the PCN-ingress-node supplies MAY be based on
			a quick sample taken at the time the information is required. It is 
			RECOMMENDED that such a sample be based on observation of at least 30 
			PCN-packets to achieve reasonable statistical reliability. </t>
		</list>
		</t>

	</section><!-- ingrBehav -->

	<section anchor="timers" title="Summary of Timers">

		<t><xref target="tab_Timers"/> summarizes the timers implied by the preceding
		procedures. The three limits T-meas, T-maxsuppress, and T-fail apply to the
		three timers t-meas, t-maxsuppress, and t-fail respectively. t-meas and 
		t-maxsuppress are reset upon expiry. t-fail is reset by management action or
		by receipt of a report from the PCN-egress-node concerned.</t>

		<texttable anchor="tab_Timers" title="Timers Used For the CL Boundary Node
		Behaviour"> 
			<ttcol>Timer</ttcol> 
			<ttcol>Location</ttcol> 
			<ttcol>Incidence</ttcol> 
			<ttcol>Limit</ttcol> 
			<ttcol>Action on Expiry</ttcol>

			<c>t-meas</c> 
			<c>Egress node</c> 
			<c>One per node</c> 
			<c>T-meas</c> 
			<c>Calculate and possibly report NM-rate, ThM-rate, ETM-rate and 
			conditionally CLE for each IEA.</c>

			<c>-</c> 
			<c>-</c>
			<c>-</c> 
			<c>-</c> 
			<c>-</c>

			<c>t-maxsuppress</c> 
			<c>Egress node</c> 
			<c>One per IEA if report suppression is enabled.</c>
			<c>T-maxsuppress</c> 
			<c>Send a report for that IEA at the next expiry of T-meas.</c>

			<c>-</c> 
			<c>-</c> 
			<c>-</c> 
			<c>-</c> 
			<c>-</c>

			<c>t-fail</c> 
			<c>Decision point</c> 
			<c>One per egress node</c> 
			<c>T-fail</c> 
			<c>Assume failure and cease to admit flows passing through that egress 
			node.</c>

			<postamble>IEA = ingress-egress-aggregate</postamble>
		</texttable>


		<t>The value of T-meas SHOULD be configurable, and is RECOMMENDED to be of
		the order of 100 to 500 ms.</t>

		<t>t-maxsuppress is active only when report suppression is enabled. The value
		of T-maxsuppress SHOULD be configurable. The appropriate value depends on the
		transport used to carry the egress node reports. For unreliable transport, 
		T-maxsuppress is RECOMMENDED to be of the order of one second.</t>

		<t>The value of T-fail MUST be configurable. When unreliable transport is 
		used, the value of T-fail is RECOMMENDED to be of the order of 
		3 * T-maxsuppress if report suppression is enabled, and of the order of 
		3 * T-meas if report suppression is not enabled. When reliable transport is
		used, the operator may choose to provide similar values for T-fail or may
		choose to disable report timing by setting an effectively infinite value for
		T-fail.</t>

	</section><!-- timers -->

</section><!-- behaviours -->

<section anchor="aggregates" title="Identifying Ingress and Egress
	Nodes for PCN Traffic">

	<t>The operation of PCN depends on the ability of the PCN-ingress-node to identify 
	the ingress-egress-aggregate to which each new PCN-flow belongs and the ability of
	the egress node to identify the ingress-egress-aggregate to which each received
	PCN-packet belongs. If the Decision Point is collocated with the PCN-ingress-node,
	the PCN-egress-node also needs to associate each ingress-egress-aggregate with the
	address of the PCN-ingress-node to which it must send its reports.</t>

	<t>The means by which this is done depends on the packet routing technology in 
	use in the network. The procedure to provide the required information is out of the
	scope of this document.</t>

</section><!-- aggregates -->

<section anchor="PDBSpec" title="Specification of Diffserv Per-Domain Behaviour">

	<t>This section provides the specification required by <xref target="RFC3086"/>
	for a per-domain behaviour.</t>

	<section anchor="PDBApplic" title="Applicability">

		<t>This section draws heavily upon points made in the PCN architecture document,
		<xref target="RFC5559"/>.  </t>

		<t>The PCN CL boundary node behaviour specified in this document is applicable
		to inelastic traffic (particularly video and voice) where quality of service for
		admitted flows is protected primarily by admission control at the ingress to the
		domain. In exceptional circumstances (e.g. due to network failures) 
		already-admitted flows may be terminated to protect the quality of service of 
		the remaining flows. The CL boundary node behaviour is less likely to terminate
		too many flows under such circumstances than the SM boundary node behaviour
		(<xref target="I-D.SM-edge-behaviour"/>).</t>

	</section><!-- PDBApplic -->

	<section anchor="PDBTechSpec" title="Technical Specification">

		<t>The technical specification of the PCN CL per domain behaviour is provided
		by the contents of <xref target="RFC5559"/>, <xref target="RFC5696"/>, 
		<xref target="RFC5670"/>, the specification of the encoding extension 
		(e.g., <xref target="ID.PCN3in1"/>), and the present document. </t>

	</section><!-- PDBTechSpec -->

	<section anchor="PDBAttrib" title="Attributes">

		<t>The purpose of this per-domain behaviour is to achieve low loss and jitter
		for the target class of traffic. The design requirement for PCN was that 
		recovery from overloads through the use of flow termination should happen 
		within 1-3 seconds. PCN probably performs better than that.</t>

	</section><!-- PDBAttrib -->

	<section anchor="PDBParms" title="Parameters">

		<t>In the list that follows, note that most PCN-ingress-nodes are also 
		PCN-egress-nodes, and vice versa. Furthermore, the PCN-ingress-nodes may be
		collocated with Decision Points.</t>

		<t>Parameters at the PCN-ingress-node: <vspace blankLines="0"/> 
		-----------------------------------
		<list style="symbols">
			<t>Filters for distinguishing PCN from non-PCN inbound traffic.</t> 
			
			<t>The markings to be applied to PCN-traffic.</t> 
			
			<t>Reference rates on each inward link for the PCN-threshold-rate and 
			PCN-excess-rate; see <xref target="coreAssum"/>.</t>
			
			<t>The information needed to distinguish PCN-traffic belonging to a given
			ingress-egress-aggregate.</t>
		</list>
		</t>

		<t>Parameters at the PCN-egress-node: <vspace blankLines="0"/> 
		----------------------------------
		<list style="symbols">
			<t>The measurement interval T-meas. </t> 
			
			<t>Whether report suppression is enabled and, if so, the values of the 
			CLE-reporting-threshold and T-maxsuppress.</t> 
			
			<t>Whether individual flow identifiers must be reported for 
			excess-traffic-marked PCN-traffic.</t>
			
			<t>The information needed to distinguish PCN-traffic belonging to a given
			ingress-egress-aggregate.</t> 
			
			<t>The marking rules for re-marking PCN-traffic leaving the PCN domain.</t>
		</list>
		</t>

		<t>Parameters at each interior node: <vspace blankLines="0"/> 
		---------------------------------
		<list style="symbols">
			<t>Reference rates on each link for the PCN-threshold-rate and 
			PCN-excess-rate; see <xref target="coreAssum"/>.</t>
			
			<t>The markings to be applied to PCN-traffic, including the identification
			of PCN-packets and the encodings to indicate threshold-marking and 
			excess-traffic-marking..</t>
		</list>
		</t>

		<t>Parameters at the Decision Point: <vspace blankLines="0"/> 
		---------------------------------
		<list style="symbols">
			<t>Activation/deactivation of PCN-based flow admission.</t>
			
			<t>Activation/deactivation of PCN-based flow termination.</t>
			
			<t>The value of CLE-limit.</t>
			
			<t>The maximum interval T-fail between reports from a given PCN-egress-node,
			for detecting failure of communications with that node.</t>
			
			<t>The information needed to map between each ingress-egress-aggregate and the
			corresponding PCN-ingress-node and PCN-egress-node. </t>
		</list>
		</t>

	</section><!-- PDBParms -->

	<section anchor="PDBAssum" title="Assumptions">

		<t>Assumed that a specific portion of link capacity has been reserved for
		PCN-traffic. </t>

	</section><!-- PDBAssum -->

	<section anchor="PDBExamp" title="Example Uses">

		<t>The PCN CL behaviour may be used to carry real-time traffic, particularly
		voice and video.</t>

	</section><!-- PDBExamp -->

	<section anchor="PDBEnv" title="Environmental Concerns">

		<t>The PCN CL per-domain behaviour may interfere with the use of end-to-end 
		ECN due to reuse of ECN bits for PCN marking. See the applicable PCN marking
		specifications for details.</t>

	</section><!-- PDBEnv -->

	<section anchor="PDBSec" title="Security Considerations">

		<t>Please see the security considerations in <xref target="secur"/> as well
		as those in <xref target="RFC2474"/> and <xref target="RFC2475"/>.</t>

	</section><!-- PDBSec -->

</section><!-- PDBSpec -->


<section anchor="secur" title="Security Considerations">

	<t><xref target="RFC5559"/> provides a general description of the security
	considerations for PCN. This memo introduces no new considerations.</t>

</section><!-- secur -->


<section anchor="iana" title="IANA Considerations">

	<t>This memo includes no request to IANA.</t>

</section><!-- iana -->

<section anchor="Acknowledgements" title="Acknowledgements">

	<t>The content of this memo bears a family resemblance to 
	<xref target="ID.briscoe-CL"/>. The authors of that document were Bob Briscoe, 
	Philip Eardley, and Dave Songhurst of BT, Anna Charny and Francois Le Faucheur
	of Cisco, Jozef Babiarz, Kwok Ho Chan, and Stephen Dudley of Nortel, Giorgios
	Karagiannis of U. Twente and Ericsson, and Attila Bader and Lars Westberg of
	Ericsson.</t>

	<t>Ruediger Geib, Philip Eardley, and Bob Briscoe have helped to shape the 
	present document with their comments. Toby Moncaster gave a careful review to
	get it into shape for Working Group Last Call.</t>
	
	<t>Amongst the authors, Michael Menth deserves special mention for his constant
	and careful attention to both the technical content of this document and the 
	manner in which it was expressed.</t>
	
</section><!-- Acknowledgements -->

</middle>

<!--  *****BACK MATTER ***** -->

<back>

<references title="Normative References">
	&RFC2119; 
	&RFC2474; 
	&RFC2475; 
	&RFC5559; 
	&RFC5670; 
	&RFC5696;
</references>

<references title="Informative References">
	&RFC3086;

	<reference anchor="ID.briscoe-CL">
		<front>
			<title>An edge-to-edge Deployment Model for Pre-Congestion Notification:
			Admission Control over a DiffServ Region (expired Internet Draft)</title>
			<author initials="B." surname="Briscoe">
				<organization>BT &amp; UCL</organization>
			</author>
			<date year="2006" />
		</front>
	</reference>

	<reference anchor="ID.PCN3in1">
		<front>
			<title>PCN 3-State Encoding Extension in a single DSCP (Work in progress)
			</title>
			<author initials="B." surname="Briscoe"> 
				<organization>BT &amp; UCL</organization> 
			</author> 
			<date year="2010" month="July" /> 
		</front> 
	</reference>

	<reference anchor="Menth08-sub-9" 
		target="http://www3.informatik.uni-wuerzburg.de/
							~menth/Publications/papers/Menth08-Sub-9.pdf"> 
		<front>
			<title>PCN-Based Measured Rate Termination</title> 
			<author initials="M." surname="Menth"> 
				<organization>U. Wuerzburg</organization> 
			</author> 
			<author initials="F." surname="Lehrieder"> 
				<organization>U. Wuerzburg</organization> 
			</author> 
			<date year="2009" month="July"/>
		</front>
		<format type="PDF" target="http://www3.informatik.uni-wuerzburg.de/
			~menth/Publications/papers/Menth08-Sub-9.pdf" />
	</reference>

	<reference anchor="I-D.SM-edge-behaviour">
  	<front>
			<title>PCN Boundary Node Behaviour for the Single Marking (SM) 
    		Mode of Operation (Work in progress)</title>
			<author initials="A." surname="Charny">
				<organization>Cisco</organization>
			</author>
			<author initials="J." surname="Zhang">
				<organization>Cisco</organization>
    	</author>
    	<author initials="G." surname="Karagiannis">
      	<organization>U. Twente</organization>
    	</author>
    	<author initials="M." surname="Menth">
      	<organization>U. Wuerzburg</organization>
    	</author>
    	<author initials="T." surname="Taylor">
				<organization>Huawei Technologies</organization>
    	</author>
    	<date year="2010" month="June"/>
  	</front>
	</reference>

	<reference anchor="IEEE-Satoh">
  	<front>
    	<title>"Cause and Countermeasure of Overtermination for PCN-Based Flow
    		Termination", Proceedings of IEEE Symposium on Computers and 
    		Communications (ISCC '10), pp. 155-161, Riccione, Italy</title>
			<author initials="D." surname="Satoh">
      	<organization>NTT-AT</organization>
    	</author>
			<author initials="H." surname="Ueno">
      	<organization>NTT-AT</organization>
			</author>
    	<date month="June" year="2010" />
		</front>
	</reference>

</references>

</back>
</rfc>
