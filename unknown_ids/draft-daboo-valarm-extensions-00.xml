<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE rfc SYSTEM 'rfc2629.dtd' [<!ENTITY rfc2119 PUBLIC '' 'bibxml/reference.RFC.2119.xml'><!ENTITY rfc3261 PUBLIC '' 'bibxml/reference.RFC.3261.xml'><!ENTITY rfc3860 PUBLIC '' 'bibxml/reference.RFC.3860.xml'><!ENTITY rfc3966 PUBLIC '' 'bibxml/reference.RFC.3966.xml'><!ENTITY rfc4791 PUBLIC '' 'bibxml/reference.RFC.4791.xml'><!ENTITY id2445bis PUBLIC '' 'bibxml3/reference.I-D.ietf-calsify-rfc2445bis.xml'>]> <?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?><?rfc toc="yes"?><?rfc comments="yes"?><?rfc inline="yes"?><?rfc symrefs="yes"?><?rfc sortrefs="yes"?><?rfc compact="yes"?><?rfc subcompact="no"?><?rfc tocdepth="2"?><?rfc strict="yes"?><rfc category="std" ipr='trust200902' docName='draft-daboo-valarm-extensions-00'>    <front>        <title abbrev="VALARM Extensions">VALARM Extensions for iCalendar</title>        <author initials="C." surname="Daboo" fullname="Cyrus Daboo">            <organization abbrev="Apple">                Apple Inc.            </organization>            <address>                <postal>                    <street>                        1 Infinite Loop                    </street>                    <city>                        Cupertino                    </city>                    <region>                        CA                    </region>                    <code> 95014 </code>                    <country>                        USA                    </country>                </postal>                <email>                    cyrus@daboo.name                </email>                <uri>                    http://www.apple.com/                </uri>            </address>        </author><!--   <author initials="B." surname="Desruisseaux"          fullname="Bernard Desruisseaux">    <organization abbrev="Oracle">Oracle Corporation</organization>    <address>      <postal>        <street>600 blvd. de Maisonneuve West</street>        <street>Suite 1900</street>        <city>Montreal</city>        <region>QC</region>        <code>H3A 3J2</code>        <country>CA</country>      </postal>      <email>bernard.desruisseaux@oracle.com</email>      <uri>http://www.oracle.com/</uri>    </address>  </author> -->        <date />        <area>Applications</area>        <keyword>alarms</keyword>        <keyword>calendaring</keyword>        <keyword>iCalendar</keyword>        <keyword>CalDAV</keyword>        <abstract>            <t>                This document defines a set of extensions to the iCalendar VALARM component to enhance use of alarms and improve interoperability between clients and servers.            </t>        </abstract>    </front>    <middle>        <section title='Introduction'>            <t>                The <xref target="I-D.ietf-calsify-rfc2445bis">iCalendar</xref> specification defines a set of components used to describe calendar data. One of those is the "VALARM" component which appears as a sub-component of "VEVENT" and "VTODO" components. The "VALARM" component is used to specify a reminder for an event or to-do. Different alarm actions are possible as are different ways to specify how the alarm is triggered.            </t>            <t>                As iCalendar has become more widely used and as client-server protocols such as <xref target="RFC4791">CalDAV</xref> have become more popular, several issues with "VALARM" components have arisen. Most of these relate to the need to extend the existing "VALARM" component with new properties and behaviors to allow clients and servers to accomplish specific tasks in an interoperable manner. For example, clients typically need a way to specify that an alarm has been dismissed by a calendar user, or has been "snoozed" by a set amount of time. To date, this has been done through the use of custom "X-" properties specific to each client implementation, leading to poor interoperability.            </t>            <t>                This specification defines a set of extensions to "VALARM" components to cover common requirements for alarms not currently addressed in iCalendar. Each extension is defined in a separate section below. For the most part, each extension can be supported independently of the others, though in some cases one extension will require another.            </t>        </section>        <section title='Conventions Used in This Document'>            <t>                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <xref target='RFC2119' />.            </t>            <t>                When XML element types in the namespaces "DAV:" and "urn:ietf:params:xml:ns:caldav" are referenced in this document outside of the context of an XML fragment, the string "DAV:" and "CALDAV:" will be prefixed to the element type names respectively.            </t>        </section>        <section title="Extensible syntax for VALARM" anchor="syntax">            <t>                Section 3.6.6 of <xref target="I-D.ietf-calsify-rfc2445bis"/> defines the syntax for "VALARM" components and properties within them. However, as written, it is hard to extend this by adding, e.g., a new property common to all types of alarm. Since many of the extensions defined in this document need to extend the base syntax, an alternative form for the base syntax is defined here, with the goal of simplifying specification of the extensions.            </t>            <t>                A "VALARM" calendar component is re-defined by the following notation:          <figure><artwork name="abnf"><![CDATA[     alarmcext  = "BEGIN" ":" "VALARM" CRLF                  alarmprop                  "END" ":" "VALARM" CRLF     alarmprop  = *(                ; the following are REQUIRED,                ; but MUST NOT occur more than once                action / trigger /                ; one set of action properties MUST be                ; present and MUST match the action specified                ; in the ACTION property                actionprops /                ; the following is OPTIONAL,                ; and MAY occur more than once                x-prop / iana-prop                )                     actionprops = audiopropext / disppropext / emailpropext     audiopropext  = *(                ; 'duration' and 'repeat' are both OPTIONAL,                ; and MUST NOT occur more than once each,                ; but if one occurs, so MUST the other                duration / repeat /                ; the following is OPTIONAL,                ; but MUST NOT occur more than once                attach                )     disppropext = *(                ; the following are REQUIRED,                ; but MUST NOT occur more than once                description /                ; 'duration' and 'repeat' are both OPTIONAL,                ; and MUST NOT occur more than once each,                ; but if one occurs, so MUST the other                duration / repeat                )     emailpropext = *(                ; the following are all REQUIRED,                ; but MUST NOT occur more than once                description / summary /                ; the following is REQUIRED,                ; and MAY occur more than once                attendee /                ; 'duration' and 'repeat' are both OPTIONAL,                ; and MUST NOT occur more than once each,                ; but if one occurs, so MUST the other                duration / repeat                )]]></artwork>          </figure>        </t>        </section>        <section title="VALARM Unique Identifier">            <t>                Several of the other extensions in this specification require identifying a specific instance of a "VALARM" component in an iCalendar stream. To aid that, this extension adds a "UID" property to "VALARM" components to allow a unique identifier to specified. The value of this unique identifier can then be used to refer uniquely to the "VALARM" component.            </t>            <t>                The "UID" property defined here follows the definition in Section 3.8.4.7 of <xref target="I-D.ietf-calsify-rfc2445bis"/>. In particular it MUST be a globally unique identifier.             </t>            <t>                The "VALARM" component defined in <xref target="syntax"/> is extended here as:                <figure>                <artwork name="abnf">        alarmprop  /= *(                   ; the following is OPTIONAL,                   ; but MUST NOT occur more than once                   uid                   )                </artwork>                </figure>            </t>        </section>        <section title="VALARM URI Action">            <t>                Currently "VALARM" components have actions for audio, display and email. New types of action are of interest, e.g., SMS, instant messaging, etc. Rather then specify separate actions for these, an alternative is to define a "URI" action that allows any URI scheme to be used as an action, where it makes sense. Thus URI schemes for IM <xref target="RFC3860"/>, SIP <xref target="RFC3261"/>, TEL <xref target="RFC3966"/> etc could be used.            </t>            <t>                This extension defines a new "URI" property value for use with the "ACTION" property in "VALARM" components. A new set of action properties is defined for "VALARM" components based on this new action as defined by the syntax below.                <figure>                <artwork name="abnf">        actionvalue /= "URI"                    ; Adds a new action for a "VALARM"        actionprop  /= uriprop                    ; Re-defines the "VALARM" component to include                    ; "uriprop" as a new set of action properties         uriprop     = *(                    ; the following are REQUIRED,                    ; but MUST NOT occur more than once                    description / uri /                    ; 'duration' and 'repeat' are both OPTIONAL,                    ; and MUST NOT occur more than once each,                    ; but if one occurs, so MUST the other                    duration / repeat                    )                </artwork>                </figure>            </t>        </section>        <section title="VALARM Agent Property">            <t>                With the advent of a standard client/server protocol for calendaring and scheduling data (<xref target="RFC4791"/>) there is a need to specify which client or server should handle the presentation of an alarm when it is triggered. For example, calendar users want to be able to receive alarms at all times, even when their desktop client might be unavailable. Since the server is "always on", a service running on the server could monitor alarm status and when appropriate trigger those alarms. In addition it may be important for only the server or the client to be set to handle an alarm - and in some cases only specific servers or clients.            </t>            <t>                To address this need, this specification defines an "ALARM-AGENT" iCalendar property that can be added to any "VALARM" component. This property specifies whether a client or server or both should be responsible for processing the alarm when it triggers. In addition, a "URI" property parameter can be added to uniquely identify the client or server that should process the alarm. This is defined by the syntax below.                <figure>                <artwork name="abnf">        alarmprop  /= *(                   ; the following is OPTIONAL,                   ; and MAY occur more than once                   alarm-agent                   )                </artwork>                </figure>            </t>            <section title="Alarm Agent Property" anchor="ALARM-AGENT">                <t>                    <list style="hanging">                        <t hangText="Property Name:">                            ALARM-AGENT                        </t>                        <t hangText="Purpose:">                            This property specifies whether a client, server, both or none gets to process an alarm when it is triggered.                         </t>                        <t hangText="Value Type:">                            TEXT                         </t>                        <t hangText="Property Parameters:">                            IANA, non-standard, and URI property parameters can be specified on this property.                         </t>                        <t hangText="Conformance:">                            This property can be specified within "VALARM" calendar components.                         </t>                        <t hangText="Description:">                            This property is used to specify who is responsible for processing an alarm when it is triggered. When the value "SERVER" is specified, only a server that has a copy of the event is responsible. When the value "CLIENT" is specified, only a client that has a copy of the event is responsible. When the value "BOTH" is specified, either a client or server is responsible. When the value "NONE" is specified, neither a client nor server is responsible (i.e. the alarm action is never carried out when it triggers). If the "URI" property parameter is specified for "SERVER" or "CLIENT" values, then only the client or server identified by the "URI" value is responsible. Clients or servers that are not responsible for the alarm SHOULD NOT process the alarm action when it is triggered.                        </t>                        <t hangText="Format Definition:">                            This property is defined by the following notation:                             <figure>                                <artwork name="abnf">     alarm-agent     = "ALARM-AGENT" alarmagentparam ":"                     alarmagentvalue CRLF          alarmagentparam = *(                     ; the following is OPTIONAL,                     ; but MUST NOT occur more than once                     (";" uriparam) /                     ; the following is OPTIONAL,                     ; and MAY occur more than once                     (";" other-param)                     )     alarmagentvalue = "SERVER" / "CLIENT" / "BOTH" / "NONE"                     / iana-token / x-name                                </artwork>                            </figure>                        </t>                        <t hangText="Example:">                            The following is an example of this property:                             <figure>                                <artwork>     ALARM-AGENT:SERVER                                </artwork>                            </figure>                        </t>                    </list>                </t>            </section>            <section title="URI Property Parameter" anchor="URI-PARAM">                <t>                    <list style="hanging">                        <t hangText="Property Name:">                            URI                        </t>                        <t hangText="Purpose:">                            This property parameter specifies a URI that is related to the property it is applied to.                         </t>                        <t hangText="Format Definition:">                            This property is defined by the following notation:                             <figure>                                <artwork name="abnf">     uriparam   = "URI" "=" DQUOTE uri DQUOTE                                </artwork>                            </figure>                        </t>                        <t hangText="Description:">                            This property parameter is used to specify a URI that is associated with the property it is applied to. Each property that allows this parameter to be specified MUST indicate what the value of the URI represents.                        </t>                        <t hangText="Example:">                            The following is an example of this property:                             <figure>                                <artwork>     ALARM-AGENT;URI="http://calendar.example.com":SERVER                                </artwork>                            </figure>                        </t>                    </list>                </t>            </section>        </section>        <section title="VALARM Status Property">            <t>            	There is currently no way for a "VALARM" component to indicate the status of the alarm (e.g., whether it has been triggered or not). With the advent of a standard client/server protocol for calendaring and scheduling data (<xref target="RFC4791"/>) it is quite possible for an event with an alarm to exist on multiple clients in addition to the server. If each of those is responsible for performing the action when an alarm triggers then multiple "alerts" are generated by different devices. In a such a situation a calendar user would like to be able to "dismiss" the alarm on one device and have it dismissed on the others too.            </t>            <t>            	In addition, calendar user agents often provide a way for calendar users to "snooze" an alarm (temporarily dismiss it but have it re-scheduled to trigger again a short while later). However, there is no way for a "VALARM" component to indicate that it has been snoozed and for how long.            </t>            <t>            	Finally, with recurring events that have alarms, it is important to know when the last alarm in the recurring set was triggered, so that the client can determine whether any and how many past alarms have been missed.            </t>            <t>            	To address these needs, this specification adds the following:            	<list style="symbols">            		<t>a "STATUS" property to "VALARM" components with values to indicate wether an alarm is active, inactive, completed (dismissed) or snoozed.</t>            		<t>a "LAST-TRIGGERED" property to "VALARM" components to indicate when the alarm was last triggered.</t>            		<t>a "SNOOZE-UNTIL" property to "VALARM" components to indicate when to trigger an alarm after it has been "snoozed".</t>            	</list>                This is defined by the syntax below.                <figure>                <artwork name="abnf">        alarmprop       /= *(                        ; the following are OPTIONAL,                        ; but MUST NOT occur more than once                        status / last-triggered / snooze-until                        )                           statvalue       /= statvalue-alarm        statvalue-alarm = "ACTIVE"    ; Indicates alarm is active and                                      ; waiting to be triggered.                        / "CANCELLED" ; Indicates alarm is inactive                                      ; and won't be triggered.                        / "COMPLETED" ; Indicates alarm has triggered                                      ; and been dismissed.                        / "SNOOZED"   ; Indicates alarm has triggered                                      ; and been snoozed.        ; Status values for a "VALARM"                        </artwork>                </figure>            </t>            <section title="Last Triggered Property" anchor="LAST-TRIGGERED">                <t>                    <list style="hanging">                        <t hangText="Property Name:">                            LAST-TRIGGERED                        </t>                        <t hangText="Purpose:">                            This property specifies the UTC date and time at which the corresponding alarm was last triggered.                         </t>                        <t hangText="Value Type:">                            DATE-TIME                          </t>                        <t hangText="Property Parameters:">                            IANA and non-standard property parameters can be specified on this property.                         </t>                        <t hangText="Conformance:">                            This property can be specified within "VALARM" calendar components.                         </t>                        <t hangText="Description:">                            This property is used to specify when an alarm was last triggered. This allows clients to track repeating alarms or alarms on recurring events or to-dos to ensure that the right number of missed alarms can be tracked.                        </t>                        <t hangText="Format Definition:">                            This property is defined by the following notation:                             <figure>                                <artwork name="abnf">    last-triggered = "LAST-TRIGGERED" lasttrigparam ":" datetime CRLF         lasttrigparam  = *(                     ; the following is OPTIONAL,                     ; and MAY occur more than once                      (";" other-param)                     )                                </artwork>                            </figure>                        </t>                        <t hangText="Example:">                            The following is an example of this property:                             <figure>                                <artwork>     LAST-TRIGGERED:20090604T084500Z                                </artwork>                            </figure>                        </t>                    </list>                </t>            </section>            <section title="Snooze Until Property" anchor="SNOOZE-UNTIL">                <t>                    <list style="hanging">                        <t hangText="Property Name:">                            SNOOZE-UNTIL                        </t>                        <t hangText="Purpose:">                            This property specifies the UTC date and time at which the corresponding alarm is to be re-triggered after being "snoozed".                        </t>                        <t hangText="Value Type:">                            DATE-TIME                          </t>                        <t hangText="Property Parameters:">                            IANA and non-standard property parameters can be specified on this property.                         </t>                        <t hangText="Conformance:">                            This property can be specified within "VALARM" calendar components.                         </t>                        <t hangText="Description:">                            This property is used to specify when an alarm is expected to be re-triggered following a "snooze" operation by a calendar user.                        </t>                        <t hangText="Format Definition:">                            This property is defined by the following notation:                             <figure>                                <artwork name="abnf">     snooze-until      = "SNOOZE-UNTIL" snoozeuntilparam ":"                         datetime CRLF          snoozeuntilparam  = *(                     ; the following is OPTIONAL,                     ; and MAY occur more than once                      (";" other-param)                     )                                </artwork>                            </figure>                        </t>                        <t hangText="Example:">                            The following is an example of this property:                             <figure>                                <artwork>     SNOOZE-UNTIL:20090604T085000Z                                </artwork>                            </figure>                        </t>                    </list>                </t>            </section>        </section>        <section title="VALARM Included by Reference">            <t>                In some situations a calendar user might wish to define an alarm to be used on multiple events or to-dos. This would allow a change to one alarm to effect the alarms for multiple events or to-dos without having to modify each "VALARM" component in each event or to-do. One use for this is for setting up a "default" alarm for a calendar user - one that gets applied to all new events or to-dos added to the user's calendar.            </t>            <t>            	TODO: need more text on how properties are "inherited" and "overridden".            </t>            <t>                This extension defines a "UID-REFERENCE" property for use with "VALARM" components. The value of this property is the unique identifier ("UID" property value) of another "VALARM" component. The "UID-REFERENCE" property is used in place of normal "VALARM" action properties as defined by the syntax below.                <figure>                <artwork name="abnf">        alarmprop  /= *(                   ; the following is OPTIONAL,                   ; but MUST NOT occur more than once                   uid-ref                   )                </artwork>                </figure>            </t>            <section title="Unique Identifier Reference Property" anchor="UID-REFERENCE">                <t>                    <list style="hanging">                        <t hangText="Property Name:">                            UID-REFERENCE                         </t>                        <t hangText="Purpose:">                            This property specifies a reference to another component.                         </t>                        <t hangText="Value Type:">                            TEXT                         </t>                        <t hangText="Property Parameters:">                            Non-standard property parameters can be specified on this property.                         </t>                        <t hangText="Conformance:">                            This property can be specified within "VALARM" calendar components.                         </t>                        <t hangText="Format Definition:">                            This property is defined by the following notation:                             <figure>                                <artwork name="abnf">     uid-ref       = "UID-REFERENCE" uidrefparam ":" text CRLF     uidrefparam   = *(";" other-param)                                </artwork>                            </figure>                        </t>                        <t hangText="Description:">                            This property is used to specify a reference to an iCalendar "VALARM" component. Its value is equal to the value of the "UID" property in the component being referenced. When present in a "VALARM" component, all the properties from the referenced "VALARM" are applied to the referring component, except for those that have counter-parts in the referring component. For example, a "SUMMARY" property defined in a referenced component can be overridden by a "SUMMARY" in the referring component. Also, per-instance copies of some properties are required, such as "LAST-TRIGGERED" and "SNOOZE-UNTIL".                        </t>                        <t hangText="Example:">                            The following is an example of this property:                             <figure>                                <artwork>     UID-REFERENCE:19960401T080045Z-4000F192713-0052@example.com                                </artwork>                            </figure>                        </t>                    </list>                </t>            </section>        </section>        <section title="Default Alarms in CalDAV">            <t>            	TODO: specify how default alarms for different types of component and for timed/all-day can be set in WebDAV properties and then referenced in calendar data, and automatically applied by the server to new events and new invites.            </t>        </section>        <section title='Security Considerations'>            <t>TODO:talk about importance of stripping VALARMs from incoming iTIP. Talk about VALARMs being used to "spam" - particularly nasty if the server handles it.            </t>        </section>        <section title='IANA Considerations'>        	<t>TODO: tables registering new properties, parameters and values.</t>        	<!--            <section title='Property Registrations'>                <t>                    This documents defines the following new iCalendar properties to be added to the registry defined in Section 8.2.3 of <xref target="I-D.ietf-calsify-rfc2445bis" />:                </t>                <texttable>                    <ttcol>                        Property                    </ttcol>                    <ttcol>                        Status                    </ttcol>                    <ttcol>                        Reference                    </ttcol>                    <c>                        -                    </c>                    <c>                        -                    </c>                    <c>                        RFCXXXX                    </c>                </texttable>            </section>            <section title='Paramater Registrations'>                <t>                    This documents defines the following new iCalendar properties to be added to the registry defined in Section 8.2.3 of <xref target="I-D.ietf-calsify-rfc2445bis" />:                </t>                <texttable>                    <ttcol>                        Property                    </ttcol>                    <ttcol>                        Status                    </ttcol>                    <ttcol>                        Reference                    </ttcol>                    <c>                        -                    </c>                    <c>                        -                    </c>                    <c>                        RFCXXXX                    </c>                </texttable>            </section>        -->        </section>        <section title='Acknowledgments'>            <t>                This specification came about via discussions at the Calendaring and Scheduling Consortium.            </t>        </section>    </middle>    <back>        <references title='Normative References'>            &rfc2119; &rfc4791; &id2445bis;        </references>        <references title='Informative References'>            &rfc3261; &rfc3860; &rfc3966;        </references><!--         <section title="Change History (To be removed by RFC Editor before publication)">            <t>                Changes frinom -01:                <list style='numbers'>                    <t>                    </t>                </list>            </t>        </section> -->    </back></rfc>