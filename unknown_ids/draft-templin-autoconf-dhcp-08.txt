


Network Working Group                                         F. Templin
Internet-Draft                                                S. Russert
Intended status: Informational                                     S. Yi
Expires: December 31, 2007                          Boeing Phantom Works
                                                           June 29, 2007


                        MANET Autoconfiguration
                   draft-templin-autoconf-dhcp-08.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on December 31, 2007.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   Mobile Ad-hoc Networks (MANETs) connect routers on links with
   asymmetric reachability characteristics, and may also connect to
   other networks including the Internet.  Routers in MANETs must have a
   way to automatically provision global- and/or local-scope IP
   addresses/prefixes.  This document specifies mechanisms for MANET
   autoconfiguration.  Both IPv4 and IPv6 are discussed.




Templin, et al.         Expires December 31, 2007               [Page 1]

Internet-Draft           MANET Autoconfiguration               June 2007


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  MANET Autoconfiguration  . . . . . . . . . . . . . . . . . . .  6
     3.1.  MANET Router (MNR) Operation . . . . . . . . . . . . . . .  6
       3.1.1.  MANET Local Address (MLA) Configuration  . . . . . . .  7
       3.1.2.  MNBR List Discovery  . . . . . . . . . . . . . . . . .  7
       3.1.3.  Virtual Ethernet Interface Configuration . . . . . . .  8
       3.1.4.  MNBR Reachability Confirmation . . . . . . . . . . . .  9
       3.1.5.  Global-scope Address Autoconfiguration . . . . . . . .  9
       3.1.6.  Local-scope Address Autoconfiguration  . . . . . . . . 10
       3.1.7.  Self-Generated IPv6 Interface Identifiers  . . . . . . 11
       3.1.8.  Packet Forwarding and Default MNBR Selection . . . . . 11
     3.2.  MANET Border Router (MNBR) Operation . . . . . . . . . . . 12
     3.3.  DHCP Server Extensions . . . . . . . . . . . . . . . . . . 12
     3.4.  MLA Encapsulation  . . . . . . . . . . . . . . . . . . . . 12
     3.5.  MANET Flooding . . . . . . . . . . . . . . . . . . . . . . 13
     3.6.  Changes to the Neighbor Discovery Model  . . . . . . . . . 13
   4.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 13
   5.  Security Considerations  . . . . . . . . . . . . . . . . . . . 13
   6.  Related Work . . . . . . . . . . . . . . . . . . . . . . . . . 14
   7.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 14
   8.  Contributors . . . . . . . . . . . . . . . . . . . . . . . . . 14
   9.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 14
     9.1.  Normative References . . . . . . . . . . . . . . . . . . . 14
     9.2.  Informative References . . . . . . . . . . . . . . . . . . 15
   Appendix A.  IPv6 Neighbor Discovery (ND) and Duplicate
                Address Detection (DAD) . . . . . . . . . . . . . . . 16
   Appendix B.  IPv6 StateLess Address AutoConfiguration (SLAAC)  . . 17
   Appendix C.  Change Log  . . . . . . . . . . . . . . . . . . . . . 17
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 19
   Intellectual Property and Copyright Statements . . . . . . . . . . 20


















Templin, et al.         Expires December 31, 2007               [Page 2]

Internet-Draft           MANET Autoconfiguration               June 2007


1.  Introduction

   Mobile Ad-hoc Networks (MANETs) connect MANET Routers (MNRs) on links
   with asymmetric reachability characteristics (see: [RFC2461], Section
   2.2).  MNRs participate in a routing protocol over MANET interfaces
   to discover routes across the MANET using multiple forwarding hops if
   necessary.  MANETs may also connect to other networks including the
   Internet via MANET Border Routers (MNBRs), and MNRs may be multiple
   hops away from their nearest MNBR in some scenarios.  A MANET may be
   as large as an Autonomous System (AS) or as small as a single MNR
   (and its attached networks).  A MANET may contain other MANETs, and
   may also be a subnetwork of a larger MANET.  MNRs must have a means
   to automatically provision global- and/or local-scope IP addresses/
   prefixes plus other configuration information.

   Conceptually, a MNR embodies a router entity that connects its
   attached networks to MANETs and/or other networks including the
   Internet (see: Figure 1).  The router entity also connects to an
   imaginary shared link via a "virtual ethernet" interface configured
   over its MANET interfaces (see: Figure 2 and Figure 3).  An "opaque"
   view of this virtual ethernet sees the MANET as a fully-connected
   shared link that connects all MNRs, while a "transparent" view sees
   the MANET as a multilink site.  For each distinct MANET to which they
   connect, MNRs discover a list of MNBRs that determines the MANET's
   identity.  An MNR (and its attached networks) is a "site" unto
   itself, and a MANET is therefore a "site-of-sites".

   MANETs that comprise homogeneous link types can configure the routing
   protocol to operate as a sub-IP layer mechanism such that IP sees the
   MANET as an ordinary shared link the same as for a (bridged) campus
   LAN.  In that case, a single IP hop is sufficient to traverse the
   MANET.

   MANETs that comprise heterogeneous link types must instead (or, in
   addition) provide a routing service that operates as an IP layer
   mechanism to accommodate media types with dissimilar Layer-2 address
   formats and maximum transmission units (MTUs).  In that case,
   multiple IP hops may be necessary to traverse the MANET.

   This document specifies mechanisms and operational practices for
   MANET autoconfiguration.  Operation using standard DHCP
   [RFC2131][RFC3315][RFC3633] and neighbor discovery
   [RFC1256][RFC2461][RFC2462] mechanisms is assumed unless otherwise
   specified.  Both IPv4 [RFC0791] and IPv6 [RFC2460] are discussed.







Templin, et al.         Expires December 31, 2007               [Page 3]

Internet-Draft           MANET Autoconfiguration               June 2007


2.  Terminology

   The terminology in [I-D.ietf-autoconf-manetarch] and the normative
   references apply; the following terms are defined within the scope of
   this document:

   subnetwork
      the same as defined in [RFC3819].

   egress/ingress interface
      the same as defined in ([RFC3753], Section 3).

   MANET Interface
      a MANET Router's attachment to an asymmetric reachability link
      (see: [RFC2461], Section 2.2).  A MANET interface is a "lateral"
      interface, i.e., it is inherently neither an ingress nor egress
      interface although it can sometimes exhibit characteristics of
      both.

   Mobile Ad-hoc Network (MANET)
      a connected network region of MANET routers that maintain a
      routing structure among themselves over MANET interfaces.  A MANET
      may be as large as an Autonomous System (AS) or as small as a
      single MANET router, and may also be a subnetwork of a larger
      MANET.  A MANET router (and its attached networks) is a "site"
      unto itself, and a MANET is therefore a "site-of-sites".  (Note
      that this document considers the terms "MANET" and "site" as
      functional equivalents.)

      Further information on the characteristics of MANETs can be found
      in [RFC2501].

   MANET Router (MNR)
      a node that participates in a routing protocol on its MANET
      interface(s) and forwards packets on behalf of both other MNRs and
      "downstream" networks attached on its ingress interfaces.  A MNR
      can also connect to "upstream" networks either directly on its
      egress interfaces or indirectly via MNBRs.  For the purpose of
      this specification, an MNR comprises a router entity, one or more
      host entities, and its attached ingress/egress/MANET interfaces
      (see: Figure 1).

   MANET Border Router (MNBR)
      an MNR that connects a MANET to "upstream" networks (including the
      Internet) over egress interfaces.






Templin, et al.         Expires December 31, 2007               [Page 4]

Internet-Draft           MANET Autoconfiguration               June 2007


   MANET Local Address (MLA)
      an IP unicast address configured by an MNR that is unique within
      the MANET; it is used as an identifier for operating the routing
      protocol and may also be assigned to a MANET interface as a
      locator for packet forwarding within the scope of the MANET.

   virtual ethernet
      an imaginary shared link that connects all MNRs in a MANET.  MNRs
      attach to the virtual ethernet via an interface that is configured
      over underlying MANET interface(s) and presents both opaque and
      transparent "portals" (see: Figure 2 and Figure 3).

      The opaque portal encapsulates each IP packet in an outer IP
      header then sends it on an underlying MANET interface such that
      the TTL/HOP Limit in the inner IP header is not decremented as the
      packet traverses the MANET, i.e., the opaque portal views the
      MANET as a unified shared link.

      The transparent portal sends each IP packet on an underlying MANET
      interface without further encapsulation such that the TTL/Hop
      Limit may be decremented as the packet traverses the MANET, i.e.,
      the transparent portal views the MANET as a multilink site.

   Extended Neighbor Discovery (END) message
      an IP Neighbor Discovery (ND) message [RFC1256] [RFC2461]
      transmitted on the transparent portal of the MNR's virtual
      ethernet interface with an MLA of the underlying MANET interface
      as a source address and with destination address set to an MLA or
      a site-scoped multicast address.  The TTL/Hop Limit in END
      messages may be decremented as the message traverses the MANET.

   The following figure depicts the architectural model for a MANET
   router:


















Templin, et al.         Expires December 31, 2007               [Page 5]

Internet-Draft           MANET Autoconfiguration               June 2007


                           Egress Interfaces (to Internet)
                                   ^   ^        ^
                                   |   |        |
          +------------------------+---+--------+----------+
          | Internal hosts         |   |        |          |    M
          |  an routers            |   |  ....  |          |    A
          |       ,-.    |     +---+---+--------+---+      |    N
          |      (H1 )---+     |                    |      |    E
          |   |   `-'    |     |                    +------+--< T
          | . |  +---+   |     |                    |      |
          | . +--|R1 |---+-----+                    |      |    I
          | . |  +---+   |     |       Router       +------+--< n
          |   |   ,-.    |     |                    |  .   |    t
          |      (H2 )---+     |       Entity       |  .   |    e
          |       `-'    |  .  |                    |  .   |    r
          |                 .  |                    |  .   |    f
          |       ,-.       .  |                    +------+--< a
          |      (Hn )---------+                    |      |    c
          |       `-'          +---+---+--------+---+      |    e
          | Ingress Interfaces     |   |  ....  |          |    s
          | (to internal networks) |   |        |          |
          +------------------------+---+--------+----------+
                                   |   |        |
                                   v   v        v
                   Ingress Interfaces (to external networks)

                          Figure 1: MANET Router


3.  MANET Autoconfiguration

3.1.  MANET Router (MNR) Operation

   The following sections specify autoconfiguration mechanisms and/or
   operational practices used by MNRs to support egress interfaces that
   connect "upstream" (i.e., toward fixed Internet infrastructure),
   ingress interfaces that connect "downstream" to internal and external
   networks (i.e., away from fixed Internet infrastructure), and MANET
   interfaces that connect the MNR "laterally" to other MNRs.  Egress
   interfaces have addresses assigned or validated by other devices,
   ingress interface addresses are controlled by the MNR, and MANET
   interface addresses are coordinated with other MNRs.  MNRs engage in
   the routing protocol on MANET interfaces, configure virtual ethernet
   interfaces, and obtain global- and/or local-scope addresses/prefixes
   using these mechanisms and practices.






Templin, et al.         Expires December 31, 2007               [Page 6]

Internet-Draft           MANET Autoconfiguration               June 2007


3.1.1.  MANET Local Address (MLA) Configuration

   Upon joining a MANET, each MNR first configures an MLA used for
   operating the routing protocol and/or for local communications within
   the MANET.

   IPv6 MLAs can be administratively assigned, dynamically configured
   using DHCP[RFC3315], autoconfigured using IPv6 StateLess Address
   AutoConfiguration (SLAAC) [RFC2462], or self-generated using IPv6
   Unique Local Addresses (ULAs) [RFC4193][I-D.ietf-ipv6-ula-central].
   The MLAs include interface identifiers that are either managed for
   uniqueness (see: [RFC4291], Appendix A) or self-generated using a
   suitable pseudo-random interface identifier generation mechanism
   (e.g., Cryptographically Generated Addresses (CGAs) [RFC3972], IPv6
   privacy addresses [I-D.ietf-ipv6-privacy-addrs-v2], etc.).

   IPv4 MLAs can be administratively assigned, dynamically configured
   using DHCP [RFC2131] or self-generated using an unspecified IPv4
   unique local address configuration mechanism.  (Such a mechanism
   could be considered as a site-scoped equivalent to IPv4 link-local
   addresses [RFC3927].)

   When there is no administratively assigned MLA, the choice of
   attempting to dynamically configure an MLA using DHCP or self-
   generate one using some other mechanism is up to the MNR.  DHCP-
   generated MLAs have the benefit of a "managed" avoidance of address
   collisions, while self-generated MLAs must be monitored for
   collisions with other nodes that might assign a duplicate.  Note also
   that DHCP service for MLA configuration may not be available in all
   MANETs.

   DHCP configuration of MLAs for both IPv4 and IPv6 requires relay
   support from other MNRs that have already been autoconfigured within
   the MANET.  In particular, since a MNR presumably has no usable site-
   scoped addresses before configuring an MLA, it must send its DHCP
   requests to a link-scoped broadcast/multicast address and await a
   (relayed) address delegation reply from a server.  This means that
   all MNRs should be prepared to act as DHCP relays on behalf of
   neighboring MNRs that have recently joining the MANET, and relay any
   link-scoped DHCP requests to either a site-scoped "All-DHCP-Servers"
   address or to one or more unicast addresses.

3.1.2.  MNBR List Discovery

   After configuring MLAs, the MNR next engages in the routing
   protocol(s) over its MANET interfaces and discovers the list of MNBRs
   on the MANET.  The list of MNBRs is discovered the same as for the
   ISATAP Potential Router List (PRL) initialization procedure



Templin, et al.         Expires December 31, 2007               [Page 7]

Internet-Draft           MANET Autoconfiguration               June 2007


   ([RFC4214], Section 8.3.2); it also serves as an identifier for the
   MANET.  (If the list of MNBRs is NULL, an alternate token such as the
   Layer-2 address of an ordinary MNR can serve as an identifier for the
   MANET.)

3.1.3.  Virtual Ethernet Interface Configuration

   The MNR configures a virtual ethernet interface that connects all
   MNRs in the MANET over the underlying MANET interfaces.

   The opaque portal of the virtual ethernet interface configures a
   link-local address that is assured to be unique among the virtual
   interfaces of all MNRs in the MANET (e.g., an ISATAP link-local
   address configured per ([RFC4214], Section 6.2) and derived from a
   MANET interface's IPv4 MLA).  IP packets sent via the opaque portal
   are encapsulated in an outer IP header then submitted to ip_output()
   for transmission on an underlying MANET interface.

   The transparent portal of the virtual ethernet interface configures
   no addresses itself, but rather provides IP with direct access to the
   underlying MANET interfaces and their associated addresses.  IP
   packets sent via the transparent portal are transmitted
   unencapsulated on an underlying MANET interface, but may include an
   IPv4 source routing header (likewise IPv6 routing header) or a
   subnetwork-specific encapsulation.

   Figure 2 depicts the protocol stack model for the virtual ethernet
   output routine, and Figure 3 depicts the corresponding model for the
   virtual ethernet input routine:

       +--------------------------------------------------+   |
       |                   ip_output()                    |   |
       +--------------------------------------------------+   |
       |             virtual_ethernet_output()            |   |
       |                                                  |
       | _ transparent portal _   ___ opaque portal _____ |   p
       |/                      \ /                       \|   a
       | - MANET intf already   | - select MANET intf     |   c
       |   selected by ULP      | - encapsulate in IP     |   k
       | - insert routing hdr   | - send to MANET intf    |   e
       |   (if necessary)       |   via ip_output()       |   t
       | - send directly to     +-------------------------+   s
       |   MANET intf           |       ip_output()       |
       +--------------+---------+----+-...-+--------------+   |
       | MANET Intf 0 | MANET Intf 1 | ... | MANET Intf n |   |
       |    (MLA 0)   |    (MLA 1)   | ... |    (MLA n)   |   |
       +--------------+--------------+-...-+--------------+   v




Templin, et al.         Expires December 31, 2007               [Page 8]

Internet-Draft           MANET Autoconfiguration               June 2007


                    Figure 2: virtual_ethernet_output()


       +--------------------------------------------------+   ^
       |                    ip_input()                    |   |
       +--------------------------------------------------+   |
       |             virtual_ethernet_input()             |
       |                                                  |   p
       | _ transparent portal _   ___ opaque portal  ____ |   a
       |/                      \ /                       \|   c
       | - submit to ip_input() | - decapsulate packet    |   k
       |                        | - submit to ip_input()  |   e
       |                        +-------------------------+   t
       |                        |        ip_input()       |   s
       +--------------+---------+----+-...-+--------------+
       | MANET Intf 0 | MANET Intf 1 | ... | MANET Intf n |   |
       |    (MLA 0)   |    (MLA 1)   | ... |    (MLA n)   |   |
       +--------------+--------------+-...-+--------------+   |

                    Figure 3: virtual_ethernet_input()

3.1.4.  MNBR Reachability Confirmation

   After the MNR configures a virtual ethernet interface, it can confirm
   reachability of MNBRs and (in the case of IPv6) discover prefixes
   associated with the MANET's virtual ethernet.  (It can also discover
   IPv6 prefixes through a MANET-specific out-of-band service discovery
   protocol.)  The MNR can confirm reachability by sending/receiving END
   messages over the transparent portal, by sending/receiving ordinary
   ND messages over the opaque portal, via reachability information
   conveyed in the routing protocol itself, or through some other means
   associated with the particular MANET subnetwork technology.

   The MNR can then configure global- or local-scope addresses as
   specified in the following sections:

3.1.5.  Global-scope Address Autoconfiguration

   After the MNR discovers MNBRs, it can configure global-scope
   addresses/prefixes that are topologically correct for the MANET
   according to either DHCP or IPv6 Stateless Address AutoConfiguration
   (SLAAC) (but see Appendix B for further considerations on SLAAC).
   When DHCP is used, a DHCP client associated with (one of) the MNR's
   host entity(s) forwards a DHCP DISCOVER (DHCPv4) or Solicit (DHCPv6)
   request to a DHCP relay associated with its router entity to request
   IP address and/or prefix delegations.  (In other words, the MNR acts
   as both DHCP client and relay.)  The relay function then forwards the
   request to one or more MNBRs, to other known DHCP servers, or to a



Templin, et al.         Expires December 31, 2007               [Page 9]

Internet-Draft           MANET Autoconfiguration               June 2007


   site-scoped "All-DHCP-Servers" multicast address.

   For DHCPv6, the MNR's relay function writes an address from the
   appropriate virtual ethernet interface portal in the "peer-address"
   field and also writes an address from the prefix associated with the
   virtual ethernet in the "link-address" field (if a prefix is
   available).  The MNR can also use DHCP prefix delegation [RFC3633] to
   obtain global-scope prefixes for assignment and/or further sub-
   delegation on networks connected on its ingress interfaces.

   For DHCPv4, the MNR's relay function writes an address from the
   appropriate virtual ethernet interface portal in the 'giaddr' field
   and also includes the address in a DHCPv4 MLA option (see:
   Section 3.4).  If necessary to identify the MNR's ingress interface,
   the relay also includes a link selection sub-option [RFC3527] with an
   address from the prefix associated with the MANET's virtual ethernet
   (if a prefix is available).  The MNR can also use a prefix delegation
   mechanism [I-D.ietf-dhc-subnet-alloc] to obtain prefixes for further
   assignment and/or further sub-delegation on networks connected on its
   ingress interfaces.

   The DHCP request will elicit a DHCP reply from a server with IP
   address/prefix delegations.  When addresses are delegated, the MNR
   assigns the resulting addresses to an ingress interface, i.e., it
   does *not* assign the addresses on the virtual ethernet interface or
   an underlying MANET interface.  When prefixes are delegated, the MNR
   can assign and/or further sub-delegate them to networks connected on
   its ingress interfaces.  If the MANET subnetwork uses a proactive
   routing protocol, the MNR can advertise the delegated addresses/
   prefixes into the routing protocol during the duration of the
   delegation lifetimes.

   The DHCP server ensures IP address/prefix delegations that are unique
   within the MANET.  By assigning these IP addresses/prefixes only on
   ingress interfaces there is no requirement for the MNR to perform
   Duplicate Address Detection (DAD) over its MANET interfaces or
   virtual ethernet interface.  See Appendix A for further DAD
   considerations.

3.1.6.  Local-scope Address Autoconfiguration

   Independent of any global-scope addresses autoconfigured per
   Section 3.1.5, MNR's can self-generate IPv6 Unique Local Address
   (ULA) prefixes [RFC4193][I-D.ietf-ipv6-ula-central] and use them to
   assign addresses/prefixes on networks connected on its ingress
   interfaces.  Note that in some scenarios a MNR may not require any
   global-scope address/prefix assignments at all, and can use ULAs
   instead.  (This is particularly true for the use case of joining two



Templin, et al.         Expires December 31, 2007              [Page 10]

Internet-Draft           MANET Autoconfiguration               June 2007


   MANETs via either physical or virtual links.)

   Self-generated local-scope addresses are portable and not relative to
   the MNR's current MANET of attachment.  The addresses can therefore
   travel with the MNR as it moves to new MANETs.  Self-generation of
   local-scope addresses can therefore occur independently of any other
   MNR autoconfiguration considerations.

3.1.7.  Self-Generated IPv6 Interface Identifiers

   MNR's can create self-generated IPv6 interface identifiers such as
   specified for CGAs [RFC3972], IPv6 privacy address
   [I-D.ietf-ipv6-privacy-addrs-v2], etc.

   For global-scope address autoconfiguration (see: Section 3.1.5, the
   MNR can propose self-generated address to the DHCPv6 server which
   will delegate the address to the MNR for assignment on an ingress
   interface if the proposed address is unique.

   For local-scope address autoconfiguration (see: Section 3.1.6), the
   MNR simply assigns the address to an ingress interface, since it is
   the responsible delegation authority for its own local-scope
   prefixes.

3.1.8.  Packet Forwarding and Default MNBR Selection

   After the MNR configures IP addresses/prefixes, it can forward IP
   packets to on- and off-MANET destinations.  Packets can be forwarded
   to off-MANET destinations either by using any available MNBRs as
   egress gateways or by selecting specific MNBRs.

   For MANETs in which MNBRs can advertise a 'default' route that
   propagates throughout the routing protocol, the MNR can forward IP
   packets using the transparent virtual ethernet interface portal at
   the expense of extra TTL (IPv4) or Hop Limit (IPv6) decrementation.

   For MANETs in which the routing protocol cannot propagate a default
   route, or when the MNR wishes to select a specific MNBR as the egress
   gateway, the MNR can ensure that the packets will be forwarded
   through a specific MNBR by either 1) forwarding the packets via the
   opaque portal with an MLA for an MNBR as the destination address in
   the outer IP header, or 2) forwarding the packets via the transparent
   portal and inserting an IPv4 source routing header (likewise IPv6
   routing header) or a subnetwork-specific encapsulation.







Templin, et al.         Expires December 31, 2007              [Page 11]

Internet-Draft           MANET Autoconfiguration               June 2007


3.2.  MANET Border Router (MNBR) Operation

   MNBRs connect the MANET to upstream networks over its egress
   interfaces.

   MNBRs send/receive END messages on the virtual ethernet transparent
   portal and/or ordinary ND messages on the opaque portal.  When
   stateful configuration is desired, MNBRs should advertise prefixes in
   RA messages as not to be used for on-link determination or StateLess
   Address AutoConfiguration (SLAAC) [RFC2462] by setting the 'A', 'L'
   bits in Prefix Information Options to 0.  (But, see: Appendix B for
   further considerations on using SLAAC for MANET Autoconfiguration.)

   MNBRs act as DHCP relays and/or servers for a MNR's DHCP requests/
   replies.  For DHCPv4, when a MNBR acting as a relay forwards a DHCP
   request that includes an MLA option, it writes its own address in the
   'giaddr' field, i.e., it overwrites the value that was written into
   'giaddr' by the MNR's relay function.

3.3.  DHCP Server Extensions

   No MANET autoconfiguration-specific extensions are required for
   DHCPv6 servers.

   DHCPv4 servers examine DHCPv4 requests for a DHCPv4 MLA option (see:
   Section 3.4).  If a DHCPv4 MLA option is present, the DHCPv4 server
   copies the option into the corresponding DHCPv4 reply message(s).
   Note that this extension is only required for DHCPv4 servers that
   support global IPv4 address/prefix delegations for MNRs - see:
   Section 3.1.5.

3.4.  MLA Encapsulation

   For DHCPv6, the MLA is encoded directly in the "peer-address" field
   of DHCPv6 requests/replies.

   For DHCPv4 delegation of global IPv4 addresses/prefixes, a new DHCPv4
   option [RFC2132] called the 'MLA option' is required to encode an MLA
   for DHCP transactions that will traverse a MNBR, i.e., so that the
   MNBR has a MANET-relevant address to direct DHCPv4 replies to the
   correct MNR, which may be multiple IP hops away.  The format of the
   DHCPv4 MLA option is given below:

     Code  Len   Ether Type      MLA
   +-----+-----+-----+-----+-----+-----+---
   | TBD |  n  |    type   |  a1 |  a2 | ...
   +-----+-----+-----+-----+-----+-----+---




Templin, et al.         Expires December 31, 2007              [Page 12]

Internet-Draft           MANET Autoconfiguration               June 2007


   Code
      a one-octet field that identifies the option type (see:
      Section 4).

   Len
      a one-octet field that encodes the remaining option length.

   Ether Type
      a type value from the IANA "ethernet-numbers" registry.

   MLA
      a variable-length MANET Local Address (MLA).

3.5.  MANET Flooding

   When multicast service discovery is required, MANETs that operate
   routing as an IP layer service must use a multicast flooding
   mechanism (e.g., Simplified Multicast Forwarding (SMF)
   [I-D.ietf-manet-smf]) so that site-scoped multicast messages will be
   propagated across the MANET.

3.6.  Changes to the Neighbor Discovery Model

   Ordinary link-scoped ND messages work as-normal over the virtual
   ethernet opaque portal, so ND operation over the opaque portal
   requires no changes to the standard IP neighbor discovery protocols
   specified in [RFC1256][RFC2461].

   END messages over the virtual ethernet transparent portal must use a
   site-scoped unicast source address (i.e., an MLA) and an MLA or site-
   scoped multicast destination address such that the messages may be
   forwarded by a router and have their TTL/Hop Limit decremented on the
   path.  This means that END messages provide a site-scoped (and not
   link-scoped) discovery service which represents a departure from the
   link-scoped services specified in [RFC1256][RFC2461].


4.  IANA Considerations

   A new DHCPv4 option code is requested for the DHCPv4 MLA Option in
   the IANA "bootp-dhcp-parameters" registry (TBD, based on use case
   analysis for global IPv4 address configuration per Section 3.1).


5.  Security Considerations

   Threats relating to MANET routing protocols also apply to this
   document.



Templin, et al.         Expires December 31, 2007              [Page 13]

Internet-Draft           MANET Autoconfiguration               June 2007


6.  Related Work

   Telcordia has proposed DHCP-related solutions for the CECOM MOSAIC
   program.  The Naval Research Lab (NRL) Information Technology
   Division uses DHCP in their MANET research testbeds.  The virtual
   ethernet model was proposed by Quang Nguyen under the guidance of Dr.
   Lixia Zhang.  Various IETF AUTOCONF working group proposals have
   suggested similar mechanisms.


7.  Acknowledgements

   The following individuals gave direct and/or indirect input that was
   essential to the work: Jari Arkko, Emmanuel Bacelli, James Bound,
   Thomas Clausen, Joe Macker, Thomas Henderson, Bob Hinden, Thomas
   Narten, Alexandru Petrescu, Jinmei Tatuya, Dave Thaler, and others in
   the IETF AUTOCONF and MANET working groups.  Many others have
   provided guidance over the course of many years.


8.  Contributors

   Ian Chakeres (ian.chakeres@gmail.com) contributed to earlier versions
   of this document.


9.  References

9.1.  Normative References

   [RFC0791]  Postel, J., "Internet Protocol", STD 5, RFC 791,
              September 1981.

   [RFC1256]  Deering, S., "ICMP Router Discovery Messages", RFC 1256,
              September 1991.

   [RFC2131]  Droms, R., "Dynamic Host Configuration Protocol",
              RFC 2131, March 1997.

   [RFC2132]  Alexander, S. and R. Droms, "DHCP Options and BOOTP Vendor
              Extensions", RFC 2132, March 1997.

   [RFC2460]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", RFC 2460, December 1998.

   [RFC2461]  Narten, T., Nordmark, E., and W. Simpson, "Neighbor
              Discovery for IP Version 6 (IPv6)", RFC 2461,
              December 1998.



Templin, et al.         Expires December 31, 2007              [Page 14]

Internet-Draft           MANET Autoconfiguration               June 2007


   [RFC2462]  Thomson, S. and T. Narten, "IPv6 Stateless Address
              Autoconfiguration", RFC 2462, December 1998.

   [RFC3315]  Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
              and M. Carney, "Dynamic Host Configuration Protocol for
              IPv6 (DHCPv6)", RFC 3315, July 2003.

   [RFC3633]  Troan, O. and R. Droms, "IPv6 Prefix Options for Dynamic
              Host Configuration Protocol (DHCP) version 6", RFC 3633,
              December 2003.

   [RFC4214]  Templin, F., Gleeson, T., Talwar, M., and D. Thaler,
              "Intra-Site Automatic Tunnel Addressing Protocol
              (ISATAP)", RFC 4214, October 2005.

   [RFC4291]  Hinden, R. and S. Deering, "IP Version 6 Addressing
              Architecture", RFC 4291, February 2006.

9.2.  Informative References

   [I-D.ietf-autoconf-manetarch]
              Chakeres, I., "Mobile Ad hoc Network Architecture",
              draft-ietf-autoconf-manetarch-03 (work in progress),
              June 2007.

   [I-D.ietf-dhc-subnet-alloc]
              Johnson, R., "Subnet Allocation Option",
              draft-ietf-dhc-subnet-alloc-05 (work in progress),
              June 2007.

   [I-D.ietf-ipv6-privacy-addrs-v2]
              Narten, T., "Privacy Extensions for Stateless Address
              Autoconfiguration in IPv6",
              draft-ietf-ipv6-privacy-addrs-v2-05 (work in progress),
              October 2006.

   [I-D.ietf-ipv6-ula-central]
              Hinden, R., "Centrally Assigned Unique Local IPv6 Unicast
              Addresses", draft-ietf-ipv6-ula-central-02 (work in
              progress), June 2007.

   [I-D.ietf-manet-smf]
              Macker, J., "Simplified Multicast Forwarding for MANET",
              draft-ietf-manet-smf-05 (work in progress), June 2007.

   [RFC2501]  Corson, M. and J. Macker, "Mobile Ad hoc Networking
              (MANET): Routing Protocol Performance Issues and
              Evaluation Considerations", RFC 2501, January 1999.



Templin, et al.         Expires December 31, 2007              [Page 15]

Internet-Draft           MANET Autoconfiguration               June 2007


   [RFC3527]  Kinnear, K., Stapp, M., Johnson, R., and J. Kumarasamy,
              "Link Selection sub-option for the Relay Agent Information
              Option for DHCPv4", RFC 3527, April 2003.

   [RFC3753]  Manner, J. and M. Kojo, "Mobility Related Terminology",
              RFC 3753, June 2004.

   [RFC3819]  Karn, P., Bormann, C., Fairhurst, G., Grossman, D.,
              Ludwig, R., Mahdavi, J., Montenegro, G., Touch, J., and L.
              Wood, "Advice for Internet Subnetwork Designers", BCP 89,
              RFC 3819, July 2004.

   [RFC3927]  Cheshire, S., Aboba, B., and E. Guttman, "Dynamic
              Configuration of IPv4 Link-Local Addresses", RFC 3927,
              May 2005.

   [RFC3972]  Aura, T., "Cryptographically Generated Addresses (CGA)",
              RFC 3972, March 2005.

   [RFC4193]  Hinden, R. and B. Haberman, "Unique Local IPv6 Unicast
              Addresses", RFC 4193, October 2005.


Appendix A.  IPv6 Neighbor Discovery (ND) and Duplicate Address
             Detection (DAD)

   In terms of ND, existing standards [RFC2461][RFC4291] require that a
   node configure a link-local address on each of its IPv6-enabled
   interfaces, but the primary requirement for link-locals seems to be
   for the purpose of uniquely identifying routers on the link.  It is
   therefore for further study as to whether MNRs should send RAs on
   MANET interfaces (or even configure link local addresses on MANET
   interfaces at all), since the transparent view of the MANET appears
   as a multilink peering point between distinct sites and not a unified
   link.

   In terms of DAD, pre-service DAD for an MLA assigned on a MANET
   interface (such as specified in [RFC2462]) would require either
   flooding the entire MANET or somehow discovering a link in the MANET
   on which a node that configures a duplicate address is attached and
   performing a localized DAD exchange on that link.  But, the control
   message overhead for such a MANET-wide DAD would be substantial and
   prone to false-negatives due to packet loss and node mobility.  An
   alternative to pre-service DAD is to autoconfigure pseudo-random MLAs
   on MANET interfaces and employ a passive in-service DAD (e.g., one
   that monitors routing protocol messages for duplicate assignments).
   Pseudo-random link-local addresses can be generated with mechanisms
   such as CGAs, IPv6 privacy addresses, etc. with very small



Templin, et al.         Expires December 31, 2007              [Page 16]

Internet-Draft           MANET Autoconfiguration               June 2007


   probability of collision.  But, IPv6 ULAs also provide an additional
   40 pseudo-random bits in the IPv6 address prefix.

   Statistical properties for pseudo-random address self-generation can
   assure uniqueness for the MLAs assigned on a MNR's MANET interfaces,
   and careful operational practices can assure uniqueness for global-
   and local-scope addresses/prefixes.  However, a passive in-service
   DAD mechanism should still be used to detect duplicates that were
   assigned through other means, e.g., manual configuration.


Appendix B.  IPv6 StateLess Address AutoConfiguration (SLAAC)

   For IPv6, the use of StateLess Address AutoConfiguration (SLAAC)
   [RFC2462] could be indicated by prefix information options in END
   and/or ordinary ND messages with the 'A' bit set to 1.  MNRs that
   receive such messages could then self-generate an address from the
   prefix and assign it to the MANET's virtual ethernet interface, then
   use a passive in-service DAD approach to detect duplicates within the
   MANET.  But, if the MANET partitions, DAD might not be able to
   monitor the other partitions and address duplication could result.
   Further study on DAD implications for SLAAC in MANETs is required.


Appendix C.  Change Log

   Changes from -07 to -08:

   o  changed terms "unenhanced" and "enhanced" to "transparent" and
      "opaque".

   o  revised MANET Router diagram.

   o  introduced RFC3753 terminology for Mobile Router; ingress/egress
      interface.

   o  changed abbreviations to "MNR" and "MNBR".

   o  added text on ULAs and ULA-Cs to "Self-Generated Addresses".

   o  rearranged Section 3.1.

   o  various minor text cleanups

   Changes from -06 to -07:






Templin, et al.         Expires December 31, 2007              [Page 17]

Internet-Draft           MANET Autoconfiguration               June 2007


   o  added MANET Router diagram.

   o  added new references

   o  various minor text cleanups

   Changed from -05 to -06:

   o  Changed terms "raw" and "cooked" to "unenhanced" and "enhanced".

   o  minor changes to preserve generality

   Changed from -04 to -05:

   o  introduced conceptual "virtual ethernet" model.

   o  support "raw" and "cooked" modes as equivalent access methods on
      the virutal ethernet.

   Changed from -03 to -04:

   o  introduced conceptual "imaginary shared link" as a representation
      for a MANET.

   o  discussion of autonomous system and site abstractions for MANETs

   o  discussion of autoconfiguration of CGAs

   o  new appendix on IPv6 StateLess Address AutoConfiguration

   Changes from -02 to -03:

   o  updated terminology based on RFC2461 "asymmetric reachability"
      link type; IETF67 MANET Autoconf wg discussions.

   o  added new appendix on IPv6 Neighbor Discovery and Duplicate
      Address Detection

   o  relaxed DHCP server deployment considerations allow DHCP servers
      within the MANET itself

   Changes from -01 to -02:

   o  minor updates for consistency with recent developments

   Changes from -00 to -01:





Templin, et al.         Expires December 31, 2007              [Page 18]

Internet-Draft           MANET Autoconfiguration               June 2007


   o  new text on DHCPv6 prefix delegation and multilink subnet
      considerations.

   o  various editorial changes


Authors' Addresses

   Fred L. Templin
   Boeing Phantom Works
   P.O. Box 3707 MC 7L-49
   Seattle, WA  98124
   USA

   Email: fred.l.templin@boeing.com


   Steven W. Russert
   Boeing Phantom Works
   P.O. Box 3707 MC 7L-49
   Seattle, WA  98124
   USA

   Email: steven.w.russert@boeing.com


   Seung Yi
   Boeing Phantom Works
   P.O. Box 3707 MC 7L-49
   Seattle, WA  98124
   USA

   Email: seung.yi@boeing.com


















Templin, et al.         Expires December 31, 2007              [Page 19]

Internet-Draft           MANET Autoconfiguration               June 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Templin, et al.         Expires December 31, 2007              [Page 20]


