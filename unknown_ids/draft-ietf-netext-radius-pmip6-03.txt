


netext                                                            F. Xia
Internet-Draft                                               B. Sarikaya
Intended status: Standards Track                              Huawei USA
Expires: December 27, 2011                                   J. Korhonen
                                                  Nokia Siemens Networks
                                                           S. Gundavelli
                                                                   Cisco
                                                                D. Damic
                                                                 Siemens
                                                           June 25, 2011


                  RADIUS Support for Proxy Mobile IPv6
                   draft-ietf-netext-radius-pmip6-03

Abstract

   This document defines new attributes to facilitate Proxy Mobile IPv6
   operations using the RADIUS infrastructure.  The RADIUS interactions
   between the mobile access gateway and the RADIUS-based AAA server
   take place when the Mobile Node attaches, authenticates and
   authorizes to a Proxy Mobile IPv6 domain.  Furthermore, this document
   defines the RADIUS-based interface between the local mobility anchor
   and the AAA RADIUS server for authorizing received Proxy Binding
   Update messages for the mobile node's mobility session.  In addition
   to the mobility session setup related interactions, this document
   defines the baseline for the mobile access gateway and the local
   mobility anchor generated accounting.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on December 27, 2011.

Copyright Notice




Xia, et al.             Expires December 27, 2011               [Page 1]

Internet-Draft                RADIUS-PMIPv6                    June 2011


   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.







































Xia, et al.             Expires December 27, 2011               [Page 2]

Internet-Draft                RADIUS-PMIPv6                    June 2011


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  Solution Overview  . . . . . . . . . . . . . . . . . . . . . .  5
   4.  Attribute definitions  . . . . . . . . . . . . . . . . . . . .  9
     4.1.  MIP6-Feature-Vector  . . . . . . . . . . . . . . . . . . .  9
     4.2.  Mobile-Node-Identifier . . . . . . . . . . . . . . . . . . 10
     4.3.  Service-Selection  . . . . . . . . . . . . . . . . . . . . 11
     4.4.  PMIP6-Home-LMA-IPv6-Address  . . . . . . . . . . . . . . . 11
     4.5.  PMIP6-Visited-LMA-IPv6-Address . . . . . . . . . . . . . . 12
     4.6.  PMIP6-Home-LMA-IPv4-Address  . . . . . . . . . . . . . . . 13
     4.7.  PMIP6-Visited-LMA-IPv4-Address . . . . . . . . . . . . . . 14
     4.8.  PMIP6-Home-HN-Prefix . . . . . . . . . . . . . . . . . . . 15
     4.9.  PMIP6-Visited-HN-Prefix  . . . . . . . . . . . . . . . . . 16
     4.10. PMIP6-Home-Interface-ID  . . . . . . . . . . . . . . . . . 17
     4.11. PMIP6-Visited-Interface-ID . . . . . . . . . . . . . . . . 18
     4.12. PMIP6-Home-IPv4-HoA  . . . . . . . . . . . . . . . . . . . 19
     4.13. PMIP6-Visited-IPv4-HoA . . . . . . . . . . . . . . . . . . 20
     4.14. PMIP6-Home-DHCP4-Server-Address  . . . . . . . . . . . . . 21
     4.15. PMIP6-Visited-DHCP4-Server-Address . . . . . . . . . . . . 22
     4.16. PMIP6-Home-DHCP6-Server-Address  . . . . . . . . . . . . . 23
     4.17. PMIP6-Visited-DHCP6-Server-Address . . . . . . . . . . . . 23
     4.18. Calling-Station-Id . . . . . . . . . . . . . . . . . . . . 24
     4.19. Chargeable-User-Identity . . . . . . . . . . . . . . . . . 24
   5.  MAG to RADIUS AAA interface  . . . . . . . . . . . . . . . . . 25
     5.1.  Interface operations . . . . . . . . . . . . . . . . . . . 25
     5.2.  Table of Attributes  . . . . . . . . . . . . . . . . . . . 25
   6.  LMA to RADIUS AAA interface  . . . . . . . . . . . . . . . . . 27
     6.1.  Interface operations . . . . . . . . . . . . . . . . . . . 27
     6.2.  Table of Attributes  . . . . . . . . . . . . . . . . . . . 27
   7.  Accounting . . . . . . . . . . . . . . . . . . . . . . . . . . 28
     7.1.  Accounting at LMA  . . . . . . . . . . . . . . . . . . . . 28
     7.2.  Accounting at MAG  . . . . . . . . . . . . . . . . . . . . 28
     7.3.  Table of Attributes  . . . . . . . . . . . . . . . . . . . 28
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . . 30
   9.  IANA consideration . . . . . . . . . . . . . . . . . . . . . . 30
     9.1.  Attribute Type Codes . . . . . . . . . . . . . . . . . . . 30
     9.2.  Namespaces . . . . . . . . . . . . . . . . . . . . . . . . 30
   10. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 31
   11. References . . . . . . . . . . . . . . . . . . . . . . . . . . 32
     11.1. Normative References . . . . . . . . . . . . . . . . . . . 32
     11.2. Informative references . . . . . . . . . . . . . . . . . . 32
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 33







Xia, et al.             Expires December 27, 2011               [Page 3]

Internet-Draft                RADIUS-PMIPv6                    June 2011


1.  Introduction

   Proxy Mobile IPv6 (PMIPv6) [RFC5213] is a network-based mobility
   management protocol which allows IP mobility support for a mobile
   node without requiring the mobile node's participation in any
   mobility-related signaling.  The mobile management elements in the
   network, the mobile access gateway (MAG) and the local mobility
   anchor (LMA) are the two key functions in this network-based mobility
   system.  The mobile access gateway is responsible for detecting the
   mobile node's movements in the network and for initiating the needed
   mobility management signaling with the local mobility anchor (LMA).
   Both the mobility management agents make use of the AAA
   infrastructure to retrieve the mobile node's Policy Profile and for
   performing service authorization.

   This document defines a RADIUS-based [RFC2865] profile and
   corresponding attributes to be used on the AAA interface between the
   MAG and the AAA RADIUS server.  This interface is used to carry the
   per-MN Policy Profile from the remote Policy Store to the MAG.
   Furthermore, this document also defines a RADIUS-based interface
   between the LMA and the AAA RADIUS server for authorization of the
   received Proxy Mobile IPv6 signaling messages.  The AAA procedures
   defined in this document cover the following two deployment models:

   o  a mobile node connects to the Proxy Mobile IPv6 domain from the
      home network

   o  a mobile node connects to the Proxy Mobile IPv6 domain from a
      visitor network


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   All the mobility related terms used in this document are to be
   interpreted as defined in the Proxy Mobile IPv6 specification
   [RFC5213] and [RFC5844].  Additionally, this document uses the
   following abbreviations:

   Network Access Server (NAS):

      A function that provides authorization services for a device/user
      access to the network.  This function implements the the AAA
      RADIUS client that interfaces with the RADIUS-based AAA server.
      In the context of this document, the NAS function is logically



Xia, et al.             Expires December 27, 2011               [Page 4]

Internet-Draft                RADIUS-PMIPv6                    June 2011


      coupled with the MAG.  In deployments where the NAS function and
      the MAG functions are decoupled, the specific interactions needed
      for that to work is outside the scope of this document.

   Home AAA (HAAA):

      An Authentication, Authorization, and Accounting (AAA) server
      located in MN's home network.  This sever has access to mobile
      node's policy profiles.

   Visited AAA (VAAA):

      An Authentication, Authorization, and Accounting (AAA) server
      located in MN's visited network.  The VAAA server takes the role
      of a proxy-server, forwarding the received AAA service request to
      the HAAA server in the mobile node's home network and relaying the
      response to the requesting node, after applying any local access
      network policies.



3.  Solution Overview

   This document defines the RADIUS-based AAA interactions with the two
   mobility management elements in the Proxy Mobile IPv6 domain.

   o  Interactions between a MAG and a RADIUS-based AAA Server
   o  Interactions between a LMA and a RADIUS-based AAA Server

   The mobile node's Policy Profile [RFC5213] is present in a policy
   store and is needed by the PMIPv6 mobility management elements for
   authorizing the mobile node for mobility management service and for
   obtaining various service related parameters.  This policy store
   could be locally collocated with the mobility management agents
   enabling direct local access, or could be available from a AAA server
   through a RADIUS-based AAA interface.

   Any time a mobile node attaches to a PMIPv6 Domain, the NAS on that
   access network activates the network access authentication procedure.
   The choice of the authentication mechanism is specific to the access
   network deployment, however it is typically based on the Extensible
   Authentication Protocol (EAP) [RFC3748].  The NAS performs the
   network access authentication and queries the HAAA using RADIUS
   protocol.  If the network access authentication succeeds, the MN is
   authorized for PMIPv6 service and its Policy Profile is obtained as
   part of the RADIUS message exchange with the AAA server.

   The mobile node may be an IPv4-only node, IPv6-only node, or a dual-



Xia, et al.             Expires December 27, 2011               [Page 5]

Internet-Draft                RADIUS-PMIPv6                    June 2011


   stack (IPv4/v6) node.  Based on the policy specified in the Policy
   Profile, the network access authentication procedure SHALL provide
   the unambiguous indication of the type of address to be assigned for
   the MN in the network and with all other service related and policy
   parameters relevant to the mobility service.

   After the successful network access authentication and after
   obtaining the mobile node's Policy Profile, the MAG sends a PBU to
   the LMA.  Upon receiving the PBU, the LMA interacts with the HAAA for
   obtaining the mobile node's Policy Profile, needed for authorizing
   and setting up the mobility service.

   This document adds support for three distinct PMIPv6 mobility use
   cases, taking into account the administrative domains to which the
   MAG and the LMA belong to.  Following are the three relevant
   deployment models.

   1.  the MAG and LMA are both in the home network,
   2.  the MAG and LMA are both in the visited network
   3.  the MAG is in the visited network while the LMA is in the home
       network.

   Figure 1 shows participating network entities for the PMIPv6 mobility
   session which is located in the home network.  The MAG and LMA
   interact only with the HAAA.


       +--------+
       | HAAA & |  RADIUS  +-----+
       | Policy |<-------->| LMA |
       | Profile|          +-----+
       +--------+             | <--- LMA-Address
            ^                 |
            |               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // <- Tunnel1  \\ <- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +---->|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                     |                 |
                    MN1               MN2



Xia, et al.             Expires December 27, 2011               [Page 6]

Internet-Draft                RADIUS-PMIPv6                    June 2011


          Figure 1: The MAG and LMA are both in the home network

   Figure 2 shows both the LMA and MAG are in the visited network.  The
   MAG and LMA exchange signaling with the HAAA through the VAAA which
   acts as a Proxy.  The visited network may append additional
   information to the HAAA replies in order to reflect the local policy.


                       +---------------+
                       |    HAAA &     |
            +----------| Policy Profile|
            |          +---------------+
            |
       +--------+
       | VAAA & |  RADIUS  +-----+
       | Policy |<-------->| LMA |
       | Profile|          +-----+
       +--------+             | <--- LMA-Address
            ^               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // <- Tunnel1  \\ <- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +---->|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                    MN1               MN2


         Figure 2: The MAG and LMA are both in the visited network

   Figure 3 illustrates topology where MAG resides in the visited
   network while the associated LMA is in MN's home network.  Any
   message between the MAG and the HAAA passes through the VAAA that
   acts as a Proxy.  During the network authentication, the visited
   network's specific policy may also be propagated from the VAAA to the
   MAG.  The LMA has a direct access to the HAAA.









Xia, et al.             Expires December 27, 2011               [Page 7]

Internet-Draft                RADIUS-PMIPv6                    June 2011


                       +---------------+
                       |    HAAA &     |
            +----------| Policy Profile|
            |          +---------------+
            |                 |
            |               RADIUS
       +--------+             |
       | VAAA & |          +-----+
       | Policy |          | LMA |
       | Profile|          +-----+
       +--------+             | <--- LMA-Address
            ^               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // <- Tunnel1  \\ <- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +---->|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                    MN1               MN2


                Figure 3: Visited MAG and home LMA topology























Xia, et al.             Expires December 27, 2011               [Page 8]

Internet-Draft                RADIUS-PMIPv6                    June 2011


4.  Attribute definitions

4.1.  MIP6-Feature-Vector

   Diameter [RFC3588] reserves AVP Code space 1-255 as RADIUS attribute
   compatibility space.  The MIP6-Feature-Vector AVP (AVP Code 124)
   defined in [RFC5447] is of type OctetString and contains a 64-bit
   flags field of supported mobility capabilities.  This document
   reserves a new capability bit according to the rules in [RFC5447],
   and reuses the PMIPv6 capability bits defined by [RFC5779].  The
   following capability flag bits are used or defined in this document:

   PMIP6_SUPPORTED (0x0000010000000000)

      This capability bit is used as defined in [RFC5779].


   IP4_HOA_SUPPORTED (0x0000020000000000)

      This capability bit is used as defined in [RFC5779].  Assignment
      of the IPv4-HoA is defined by [RFC5844].


   LOCAL_MAG_ROUTING_SUPPORTED (0x0000040000000000)

      This capability bit is used as defined in [RFC5779].


   IP4_TRANSPORT_SUPPORTED (0x0000080000000000)

      This capability bit is used for negotiation of the IPv4 transport
      support between the MAG and AAA.  When the MAG sets this flag bit
      in the MIP6-Feature-Vector, it indicates ability of the MAG to
      provide IPv4 transport (i.e., IPv4-based encapsulation) for
      carrying IP traffic between the MAG and the LMA.  If this flag bit
      is unset in the returned MIP6-Feature-Vector AVP, the AAA does not
      authorize the use of IPv4 transport on the MAG-to-LMA tunnel.


   IP4_HOA_ONLY_SUPPORTED (0x0000100000000000)

      This capability bit is used for determination of the authorized
      PMIPv6 mobility mode.  When this bit is set by the AAA it
      indicates PMIPv6 mobility with IPv4 support has only been
      authorized for the MN.  As a result, the RADIUS Access-Accept
      SHOULD NOT carry the IPv6 HNP.  When this bit is set the
      PMIP6_SUPPORTED flag MUST also be set, and the IP4_HOA_SUPPORTED
      flag MUST NOT be set.



Xia, et al.             Expires December 27, 2011               [Page 9]

Internet-Draft                RADIUS-PMIPv6                    June 2011


   The MIP6-Feature-Vector attribute is also used on the LMA to the
   RADIUS AAA interface.  This capability announcement attribute enables
   direct capability negotiation between the LMA and the AAA.  The
   capabilities that are announced by both parties in the MIP6-Feature-
   Vector are known to be mutually supported.  The LMA may use this
   mechanism during authorization of the received PBU against the AAA to
   check individual PMIPv6 feature permissions for a particular MN.

4.2.  Mobile-Node-Identifier

   The Mobile-Node-Identifier attribute (AVP Code TBD) is of type String
   and contains the mobile node identifier (MN-Identifier), see
   [RFC5213]), in a form of a NAI [RFC4282].  This AVP is used on the
   interface between MAG and the AAA server.  The Mobile-Node-Identifier
   attribute is designed for deployments where the identity used during
   Network Access Authentication and the identity used for mobility
   management is decoupled.  It may also be the case where the MAG does
   not have means to find out the MN identity that could be used in
   subsequent PBU/PBA exchanges (e.g., due to identity hiding during the
   network access authentication) or when the HAAA wants to assign
   periodically changing identities to the MN.

   The Mobile-Node-Identifier attribute MAY be returned by HAAA in the
   RADIUS Access-Accept message that completes a successful
   authentication and authorization exchange between the MAG and the
   HAAA.  If the MAG has not acquired a valid MN-Identifier by other
   means, it MUST use the received MN-Identifier.


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Mobile Node Identifier...   ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     Mobile-Node-Identifier to be defined by IANA.

   Length:
      >= 3 octets

   Mobile Node Identifier:
      This field is of type String and contains the MN-ID
      of the MN to be used in the PBU/PBA exchange.







Xia, et al.             Expires December 27, 2011              [Page 10]

Internet-Draft                RADIUS-PMIPv6                    June 2011


4.3.  Service-Selection

   The Service-Selection attribute (AVP Code TBD) contains the name of
   the service or the external network that the mobility service for the
   particular MN SHOULD be associated with.  The identifier MUST be
   unique within the PMIPv6 Domain.

   The MAG MUST include the Service-Selection attribute in the Access-
   Request sent to the AAA if the information was acquired.  The AAA MAY
   return the Service-Selection to the MAG even if it was not included
   in the Access-Request as means to indicate MN's default service to
   the MAG.

   On the LMA-to-AAA interface, the LMA MAY populate the Service-
   Selection attribute in the Access-Request message using the service
   information found in the received PBU, if such mobility option was
   included.  The Service-Selection identifier should be used to assist
   the PBU authorization, the assignment of the MN-HNP and the IPv4-MN-
   HoA as described in [RFC5149] and [RFC5779].



    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |    Service Identifier...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      Service-Selection to be defined by IANA.

   Length:
      >= 3 octets

   Text:
      This field is of type UTF8String and contains the Service
      Identifier the MN is associated with.


4.4.  PMIP6-Home-LMA-IPv6-Address

   This attribute (AVP Code TBD) is used to deliver the IPv6 address of
   the LMA located in the Home network.
   Before the MAG can engage in Proxy Mobile IPv6 signaling it must be
   aware of the LMA's IP address.

   When the LMA is assigned to the MN from the home network, this
   attribute MAY be sent by the HAAA to the MAG in the RADIUS Access-



Xia, et al.             Expires December 27, 2011              [Page 11]

Internet-Draft                RADIUS-PMIPv6                    June 2011


   Accept message.


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |    Home LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Home LMA IPv6 address       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Home-LMA-IPv6-Address to be defined by IANA.

   Length:
      = 18 octets

   Home LMA IPv6 address:
      128-bit IPv6 address of the assigned home LMA IPv6 address.



4.5.  PMIP6-Visited-LMA-IPv6-Address

   This attribute (AVP Code TBD) is used to propose a particular LMA in
   the Visited network, and to authorize the use of the LMA in the
   Visited network.

   PMIP6-Visited-LMA-IPv6-Address attribute MAY be included by the MAG
   to VAAA in the RADIUS Access-Request packet as a proposal to allocate
   the particular LMA to the MN.  The LMA in the visited network may be
   assigned by the visited AAA as the result of retrieved Policy
   Profile.  If included by VAAA in the RADIUS Access-Accept sent to the
   MAG, the use of the LMA in the visited network is authorized and the
   attribute SHALL carry the IPv6 address of the visited LMA assigned
   for the particular MN.

   The AVP SHOULD NOT be included if the use of LMA in the Home Network
   is authorized (AVP PMIP6-Home-LMA-IPv6-Address already present).






Xia, et al.             Expires December 27, 2011              [Page 12]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Visited LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                 . . .
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      Visited LMA IPv6 address     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Visited-LMA-IPv6-Address to be defined by IANA.

   Length:
      = 18 octets

   Visited LMA IPv6 address:
      128-bit IPv6 address of the assigned visited LMA IPv6 address.



4.6.  PMIP6-Home-LMA-IPv4-Address

   The PMIP6-Home-LMA-IPv4-Address attribute (AVP Code TBD) contains the
   IPv4 address of the LMA assigned by the HAAA.  The [RFC5844] supports
   Proxy Mobile IPv6 signaling exchange between MAG and LMA using the
   IPv4 transport.

   When the LMA is located in the home network, this attribute MAY be
   sent by the HAAA to the MAG in the RADIUS Access-Accept message.

















Xia, et al.             Expires December 27, 2011              [Page 13]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home LMA IPv4 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Home LMA IPv4 address       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Home-LMA-IPv4-Address to be defined by IANA.

   Length:
      = 6 octets

   Home LMA IPv4 address:
      32-bit IPv4 address of the assigned LMA.



4.7.  PMIP6-Visited-LMA-IPv4-Address

   This attribute (AVP Code TBD) is used to propose a particular LMA in
   the Visited network, and to authorize the use of the LMA in the
   Visited network.

   PMIP6-Visited-LMA-IPv4-Address attribute MAY be included by the MAG
   to VAAA in the RADIUS Access-Request packet as a proposal to allocate
   the particular LMA to the MN.  The LMA in the visited network may be
   assigned by the visited AAA as the result of retrieved Policy
   Profile.  If included by VAAA in the RADIUS Access-Accept sent to the
   MAG, the use of the LMA in the visited network is authorized and the
   attribute SHALL carry the IPv4 address of the assigned visited LMA.

   The AVP SHOULD NOT be included if the use of LMA in the Home Network
   is authorized (AVP PMIP6-Home-LMA-IPv4-Address already present).
















Xia, et al.             Expires December 27, 2011              [Page 14]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |    Visited LMA IPv4 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      Visited LMA IPv4 address     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Visited-LMA-IPv4-Address to be defined by IANA.

   Length:
      = 6 octets

   IPv4 LMA address:
      32-bit IPv4 address of the assigned LMA.



4.8.  PMIP6-Home-HN-Prefix

   Mobile Node's Home Network Prefix (MN-HNP) is the IPv6 prefix (i.e.,
   the high 64 bits) assigned to the link between the MN and the MAG.
   The MN configures its IP interface from its home network prefix(es).
   When the LMA is located in the home network, PMIP6-Home-HN-Prefix
   attribute (AVP Code TBD) is used to deliver the MN-HNP from the HAAA
   to the MAG.

   The PMIP6-Home-HN-Prefix attribute is also used on the LMA-to-HAAA
   interface containing the prefix assigned to the MN.  If the LMA
   delegates the MN-HNP assignment to the HAAA, the attribute MUST
   contain all zeroes address (i.e., 0::0) in the Access-Request
   message.  The attribute MUST be present in RADIUS Access-Accept if
   the prior request already included one, and SHOULD carry the MN-HNP
   the HAAA assigned to the MN.
















Xia, et al.             Expires December 27, 2011              [Page 15]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length   |    Reserved     | Prefix-Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Home MN-HNP
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           Home MN-HNP                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Home-HN-Prefix to be defined by IANA.

   Length:
      = 12 octets.

   Reserved:
      Reserved for future use.  The bits MUST be set to zero by the
      sender, and MUST be ignored by the receiver.

   Prefix-Length:
      This field indicates the prefix length of the Home Network
      Prefix (maximum 8 octets).

   Home Network Prefix:
      Home Network Prefix for the MN's IPv6 address configuration.


4.9.  PMIP6-Visited-HN-Prefix

   When the LMA is assigned from the visited network, PMIP6-Visited-HN-
   Prefix attribute (AVP Code TBD) is used to deliver the concerning MN-
   HNP from the VAAA to the MAG.

   The PMIP6-Visited-HN-Prefix attribute is also used on the LMA to VAAA
   interface containing the IPv6 prefix assigned to the MN.  If the LMA
   delegates the assignment of the MN-HNP to the VAAA, the AVP MUST
   contain all zeroes address (i.e., 0::0) in the RADIUS Access-Request.
   The attribute MUST be present in Access-Accept if the prior request
   already included one, and SHOULD carry the MN-HNP the VAAA assigned
   to the MN.










Xia, et al.             Expires December 27, 2011              [Page 16]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length   |    Reserved     | Prefix-Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Visited MN-HNP
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                          Visited MN-HNP                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Visited-HN-Prefix to be defined by IANA.

   Length:
      = 12 octets.

   Reserved:
      Reserved for future use. The bits MUST be set to zero by the
      sender, and MUST be ignored by the receiver.

   Prefix-Length:
      This field indicates the prefix length of the Visited MN-HNP
      (maximum 8 octets).

   Visited Home Network Prefix:
      Home Network Prefix for the MN's IPv6 address configuration.


4.10.  PMIP6-Home-Interface-ID

   For Proxy Mobile IPv6 the Home Network Prefixes assigned to the
   mobile node have to be maintained on a per-interface basis.  When the
   LMA is located in the home network, PMIP6-Home-Interface-ID attribute
   conveys 64 bits interface identifier representing a particular MN's
   interface.  The attribute is assigned by the HAAA to the MAG for
   derivation of the MN-HoA.

   This attribute MAY be sent by the LMA or the MAG to the HAAA in the
   RADIUS Access-Request packet as a proposal.  This attribute MAY be
   sent by HAAA to the LMA in an Access-Accept packet, however it MUST
   be present if the prior request already included one.










Xia, et al.             Expires December 27, 2011              [Page 17]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       Home Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Home Interface Identifier     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Home-Interface-ID to be defined by IANA.

   Length:
      = 10 octets.

   Home Interface Identifier:
      The home interface identifier field is 8 octets.


4.11.  PMIP6-Visited-Interface-ID

   For Proxy Mobile IPv6 the visited Home Network Prefixes assigned to
   the mobile node have to be maintained on a per-interface basis.  When
   the LMA is located in the visited network, the attribute conveys 64
   bits interface identifier representing a particular MN's interface.
   The attribute is assigned by the VAAA to MAG for the derivation of
   MN-HoA.

   This attribute MAY be sent by the LMA or the MAG to the VAAA in an
   Access-Request packet as a proposal.  This attribute MAY be sent by
   HAAA to the LMA in an Access-Accept packet, however it MUST be
   present if the prior request already included one.


















Xia, et al.             Expires December 27, 2011              [Page 18]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Visited Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       Visited Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Visited Interface Identifier  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Visited-Interface-ID to be defined by IANA.

   Length:
      = 10 octets.

   Visited Interface Identifier:
      The visited interface identifier field is 8 octets.


4.12.  PMIP6-Home-IPv4-HoA

   [RFC5844] specifies extensions to Proxy Mobile IPv6 protocol which
   enable IPv4 home address mobility support to the MN.  The PMIP6-Home-
   IPv4-HoA attribute (AVP Code TBD) is of type Address and contains the
   IPv4 Home Address of the MN.  The primary use of this attribute is to
   deliver the assigned IPv4-HoA from HAAA to the MAG.

   The PMIP6-Home-IPv4-HoA is also used on the LMA-to-HAAA interface.
   If the LMA in the home network delegates the assignment of the IPv4-
   HoA to the HAAA, the attribute MUST contain all zeroes address in the
   request message.  The attribute MUST be included in by HAAA in the
   response if the previous request included it, and it contains the
   IPv4-HoA assigned to the MN.

















Xia, et al.             Expires December 27, 2011              [Page 19]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |     Reserved      |Prefix-Len |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Home IPv4 HoA                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Type:
      PMIP6-Home-IPv4-HoA to be defined by IANA.

   Length:
      = 8 octets

   Reserved
      The 10-bit field reserved for future use. Value MUST be
      initialized to zero by sender, and MUST be ignored by the
      receiver.

   Prefix-Len
      The 6-bit unsigned integer indicating the prefix length of the
      trailing IPv4 HoA

   Home IPv4 HoA:
      This field is of type Address and contains the IPv4 home
      address of the MN in the home network.


4.13.  PMIP6-Visited-IPv4-HoA

   When both MAG and the LMA are in the visited network, the PMIP6-
   Visited-IPv4-HoA attribute (AVP Code TBD) is used to exchange
   information between the VAAA and the MAG on the assignment of the
   IPv4 Home Address to the MN being present in the Visited network.

   The PMIP6-Visited-IPv4-HoA is also used on the LMA-to-VAAA interface.
   If the LMA delegates the assignment of the IPv4-HoA to the VAAA, the
   attribute MUST contain all zeroes address in the RADIUS Access-
   Request.  The Access-Accept message MUST have the attribute present
   if the prior request to VAAA already included one.










Xia, et al.             Expires December 27, 2011              [Page 20]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |     Reserved      |Prefix-Len |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Visited IPv4 HoA                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Type:
      PMIP6-Visited-IPv4-HoA to be defined by IANA.

   Length:
      = 8 octets

   Reserved:
      The 10-bit field reserved for future use. Value MUST be
      initialized to zero by the sender, and MUST be ignored by the
      receiver.

   Prefix-Len:
      6-bit unsigned integer indicating the prefix length of the
      trailing IPv4 HoA

   Visited IPv4 HoA:
      This field is of type Address and contains the IPv4 home
      address of the MN in the visited network.


4.14.  PMIP6-Home-DHCP4-Server-Address

   The PMIP6-Home-DHCP4-Server-Address (AVP Code TBD) contains the IPv4
   address of the DHCPv4 server in the home network.  The particular
   DHCP server address is indicated to the MAG that serves the
   concerning MN.  The HAAA MAY assign a DHCP server to the MAG in
   deployments where the MAG acts as a DHCP Relay, as defined in
   [RFC5844].














Xia, et al.             Expires December 27, 2011              [Page 21]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home DHCPv4 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    Home DHCPv4 server address     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Type:
     PMIP6-Home-DHCP4-Server-Address to be defined by IANA.

   Length:
      = 6 octets.

   Home DHCPv4 server address:
      This field is of type Address and contains a 4-octet IPv4 address
      of the DHCP server.


4.15.  PMIP6-Visited-DHCP4-Server-Address

   When both MAG and the LMA are in the visited network, the VAAA uses
   PMIP6-Visited-DHCP4-Server-Address attribute (AVP Code TBD) to
   deliver the IPv4 address of the DHCPv4 server from the visited
   network to the MAG.  The VAAA MAY assign a DHCPv4 server to the MAG
   in deployments where the MAG acts as a DHCP Relay, as defined in
   [RFC5844].


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      | Visited DHCPv4 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Visited DHCPv4 server address |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Type:
      PMIP6-Visited-DHCP4-Server-Address to be defined by IANA.

   Length:
      = 6 octets

   Visited DHCPv4 server address:
      This field is of type Address and contains a 4-octet IPv4 address
      of the DHCPv4 server



Xia, et al.             Expires December 27, 2011              [Page 22]

Internet-Draft                RADIUS-PMIPv6                    June 2011


4.16.  PMIP6-Home-DHCP6-Server-Address

   The PMIP6-Home-DHCP6-Server-Address (AVP Code TBD) contains the IPv6
   address of the DHCPv6 server in the home network indicated by HAAA to
   the MAG that serves the concerning MN.  The HAAA MAY assign a DHCPv6
   server to the MAG in deployments where the MAG acts as a DHCP Relay,
   as defined in [RFC5213].


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   .                                                               .
   .                   Home DHCPv6 server address                  .
   .                                                               .
   .                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   .                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


   Type:
     PMIP6-Home-DHCP6-Server-Address to be defined by IANA.

   Length:
      = 18 octets

   Home DHCPv6 server address:
      This field is of type Address and contains 16-octet IPv6 address
      of the DHCPv6 server.


4.17.  PMIP6-Visited-DHCP6-Server-Address

   When both MAG and the LMA are located in the visited network, the
   PMIP6-Visited-DHCP6-Server-Address attribute (AVP Code TBD) is used
   to deliver the IPv6 address of the DHCPv6 server from the visited
   network to the MAG that serves the MN.  The VAAA MAY assign a DHCPv6
   server to the MAG in deployments where the MAG acts as a DHCP Relay,
   as defined in [RFC5213].










Xia, et al.             Expires December 27, 2011              [Page 23]

Internet-Draft                RADIUS-PMIPv6                    June 2011


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      | Visited DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   .                                                               .
   .                Visited DHCPv6 server address                  .
   .                                                               .
   .                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   .                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Visited-DHCP6-Server-Address to be defined by IANA.

   Length:
      = 18 octets

   Visited DHCPv6 server address:
      This field is of type Address and contains the 16-octet IPv6
      address of the DHCPv6 server.


4.18.  Calling-Station-Id

   The Calling-Station-Id AVP (AVP Code 31) is of type String and when
   used for PMIPv6 it contains a link-layer identifier of the MN as
   defined in [RFC5213], Sections 2.2 and 8.6.

4.19.  Chargeable-User-Identity

   The Chargeable-User-Identity attribute or CUI (AVP Code 89) is an
   unique temporary handle used as means to, for example, correlate
   authentication, accounting and bill post-processing for a particular
   chargeable subscriber.  The CUI format and use follows guidelines
   defined by [RFC4372].

   In scope of this document, the CUI attribute MAY be present in the
   Access-Request.  The CUI MAY also be present in the Access-Accept.
   The CUI Identity MUST be present in the Access-Accept if it was
   present in the Access-Request.  If the use of the Chargeable User
   Identity is supported, then the MAG and/or the LMA commits to include
   the Chargeable User Identity in all subsequent RADIUS Accounting
   packets they send for the given user.







Xia, et al.             Expires December 27, 2011              [Page 24]

Internet-Draft                RADIUS-PMIPv6                    June 2011


5.  MAG to RADIUS AAA interface

5.1.  Interface operations

   The MAG to the AAA RADIUS server interface is used for retrieval of
   the Policy Profile when a MN tries to attach, authenticate and
   authorize to a PMIPv6 domain.  Depending on the policies and network
   capabilities the MAG may retrieve different sets of PMIPv6-session
   related parameters:

   o  Configuration attributes for Home- or Visited Network access
      scenario, depending on the location and attachment point of the
      MN,

   o  The IPv6 or IPv4 address of the designated LMA, depending on the
      access network's actual IP topology,

   o  The IPv6 or IPv4 configuration parameters for the MN, depending on
      the utilized IP configuration method and individual MN's service
      Policy,

   o  The DHCP Relay support attributes (IPv4 or IPv6) in case such
      functionality is supported in the network.

   In addition to PMIPv6-specific attributes, other RADIUS attributes
   are to be used on the MAG-to-AAA interface:
   The User-Name attribute (1) MUST be present in the Access-Request.
   It SHOULD carry the valid MN identity (PMIPv6 MN Identifier) in the
   form of a Network Access Identifier (NAI) [RFC4282], if such identity
   can be obtained.  The NAS-IP-Address (4) or NAS-IPv6-Address (95) or
   the NAS-Identifier (32) MUST be present in the Access-Request.  The
   Service-Type (6) and the NAS-Port-Type (69) SHOULD be present in the
   Access-Request.

5.2.  Table of Attributes

   The following table provides a guide to attributes that may be found
   in authentication and authorization RADIUS messages between MAG and
   the AAA Server.












Xia, et al.             Expires December 27, 2011              [Page 25]

Internet-Draft                RADIUS-PMIPv6                    June 2011


   Request Accept Reject Challenge #  Attribute

   1       0-1    0      0         1  User-Name
   0-1     0-1    0      0         4  NAS-IP-Address
   0-1     0-1    0      0         5  NAS-Port
   1       0-1    0      0         6  Service-Type
   0-1     0-1    0      0-1      24  State
   0       0-1    0      0        25  Class
   0       0-1    0      0-1      27  Session-Timeout
   0-1     0      0      0        31  Calling-Station-Id
   1       0      0      0        32  NAS-Identifier
   0-1     0-1    0      0        33  Proxy-State
   1       0      0      0        69  NAS-Port-Type
   1       1      1      1        80  Message-Authenticator
   0-1     0-1    0      0        89  Chargeable-User-Identity
   0-1     0-1    0      0        95  NAS-IPv6-Address
   0-1     0-1    0      0        124 MIP6-Feature-Vector
   0-1     0-1    0      0        TBD Service-Selection
   0       1      0      0        TBD Mobile-Node-Identifier
   0       0-1    0      0        TBD PMIP6-Home-LMA-IPv6-Address
   0-1     0-1    0      0        TBD PMIP6-Visited-LMA-IPv6-Address
   0       0-1    0      0        TBD PMIP6-Home-LMA-IPv4-Address
   0-1     0-1    0      0        TBD PMIP6-Visited-LMA-IPv4-Address
   0       0-1    0      0        TBD PMIP6-Home-HN-Prefix
   0       0-1    0      0        TBD PMIP6-Visited-HN-Prefix
   0       0-1    0      0        TBD PMIP6-Home-Interface-ID
   0       0-1    0      0        TBD PMIP6-Visited-Interface-ID
   0       0-1    0      0        TBD PMIP6-Home-IPv4-HoA
   0       0-1    0      0        TBD PMIP6-Visited-IPv4-HoA
   0       0-1    0      0        TBD PMIP6-Home-DHCP4-Server-Address
   0-1     0-1    0      0        TBD PMIP6-Visited-DHCP4-Server-Address
   0       0-1    0      0        TBD PMIP6-Home-DHCP6-Server-Address
   0-1     0-1    0      0        TBD PMIP6-Visited-DHCP6-Server-Address


















Xia, et al.             Expires December 27, 2011              [Page 26]

Internet-Draft                RADIUS-PMIPv6                    June 2011


6.  LMA to RADIUS AAA interface

6.1.  Interface operations

   The LMA-to-HAAA interface is used for multiple operations.  These
   operation include, but are not limited to, the authorization of the
   incoming PBU, updating the LMA address at the HAAA, accounting, and
   PMIPv6 session management.

6.2.  Table of Attributes

   The following table provides a guide to which attributes may be found
   in authentication and authorization process between LMA and the AAA.


   1         0-1      0        0        1    User-Name
   0-1       0-1      0        0        4    NAS-IP-Address
   0-1       0-1      0        0        5    NAS-Port
   1         0-1      0        0        6    Service-Type
   0         0-1      0        0        25   Class
   0         0-1      0        0-1      27   Session-Timeout
   0-1       0        0        0        31   Calling-Station-Id
   1         0        0        0        32   NAS-Identifier
   1         0        0        0        69   NAS-Port-Type
   1         1        1        1        80   Message-Authenticator
   0-1       0-1      0        0        89   Chargeable-User-Identity
   0-1       0-1      0        0        95   NAS-IPv6-Address
   0-1       0-1      0        0        124  MIP6-Feature-Vector
   0-1       0-1      0        0        TBD  Service-Selection
   1         0        0        0        TBD  Mobile-Node-Identifier
   0-1       0-1      0        0        TBD  PMIP6-Home-HN-Prefix
   0         0-1      0        0        TBD  PMIP6-Visited-HN-Prefix
   0-1       0-1      0        0        TBD  PMIP6-Home-IPv4-HoA
   0         0-1      0        0        TBD  PMIP6-Visited-IPv4-HoA
   0         0-1      0        0        TBD  PMIP6-Home-Interface-ID
   0         0-1      0        0        TBD  PMIP6-Visited-Interface-ID















Xia, et al.             Expires December 27, 2011              [Page 27]

Internet-Draft                RADIUS-PMIPv6                    June 2011


7.  Accounting

7.1.  Accounting at LMA

   The accounting at the LMA to AAA server interface is based on
   [RFC2865] and [RFC2866].  This interface must support the transfer of
   accounting records needed for service control and charging.  These
   records should include (but may not be limited to): time of binding
   cache entry creation and deletion, number of the octets sent and
   received by the MN over the bi-directional tunnel, etc.

7.2.  Accounting at MAG

   The accounting at the MAG to AAA server interface is based on
   [RFC2865] and [RFC2866].  The interface must also support the
   transfer of accounting records which should include: time of binding
   cache entry creation and deletion, number of the octets sent and
   received by the MN over the bi-directional tunnel, etc.

   If there is data traffic between a visiting MN and a correspondent
   node that is locally attached to an access link connected to the same
   MAG, the mobile access gateway MAY optimize on the delivery efforts
   by locally routing the packets instead of using reverse tunneling to
   the mobile node's LMA.  In this case, the local data traffic too MUST
   be reported to AAA Accounting servers by means of RADIUS protocol.

7.3.  Table of Attributes

   The following table provides a list of attributes that may be
   included in the RADIUS Accounting messages.  These attributes are to
   complement the set of accounting attributes already required by
   [RFC2866] and [RFC2869].


         Request   Interim  Stop     Attribute

         0-1       0        0-1      PMIP6-Home-LMA-IPv6-Address
         0-1       0        0-1      PMIP6-Visited-LMA-IPv6-Address
         0-1       0        0-1      PMIP6-Home-LMA-IPv4-Address
         0-1       0        0-1      PMIP6-Visited-LMA-IPv4-Address
         0-1       0        0-1      PMIP6-Home-HN-Prefix
         0-1       0        0-1      PMIP6-Visited-HN-Prefix
         0-1       0        0-1      PMIP6-Home-IPv4-HoA
         0-1       0        0-1      PMIP6-Visited-IPv4-HoA
         0-1       0        0-1      Service-Selection
         0-1       0        0-1      MIP6-Feature-Vector
         0-1       0-1      0-1      Mobile-Node-Identifier
         0-1       0        0-1      Calling-Station-Id



Xia, et al.             Expires December 27, 2011              [Page 28]

Internet-Draft                RADIUS-PMIPv6                    June 2011


         0-1       0-1      0-1      Chargeable-User-Identity


















































Xia, et al.             Expires December 27, 2011              [Page 29]

Internet-Draft                RADIUS-PMIPv6                    June 2011


8.  Security Considerations

   The RADIUS messages may be transported between the MAG and/or the LMA
   to the RADIUS server via one or more AAA brokers or RADIUS proxies.
   In this case the LMA to the RADIUS AAA server communication relies on
   the security properties of the intermediate AAA brokers and RADIUS
   proxies.


9.  IANA consideration

9.1.  Attribute Type Codes

   This specification defines the following new RADIUS attribute type
   codes:


           Mobile-Node-Identifier             <IANA>
           Service-Selection                  <IANA>
           PMIP6-Home-LMA-IPv6-Address        <IANA>
           PMIP6-Visited-LMA-IPv6-Address     <IANA>
           PMIP6-Home-LMA-IPv4-Address        <IANA>
           PMIP6-Visited-LMA-IPv4-Address     <IANA>
           PMIP6-Home-HN-Prefix               <IANA>
           PMIP6-Visited-HN-Prefix            <IANA>
           PMIP6-Home-Interface-ID            <IANA>
           PMIP6-Visited-Interface-ID         <IANA>
           PMIP6-Home-IPv4-HoA                <IANA>
           PMIP6-Visited-IPv4-HoA             <IANA>
           PMIP6-Home-DHCP4-Server-Address    <IANA>
           PMIP6-Visited-DHCP4-Server-Address <IANA>
           PMIP6-Home-DHCP6-Server-Address    <IANA>
           PMIP6-Visited-DHCP6-Server-Address <IANA>


9.2.  Namespaces

   This specification defines new values to the Mobility Capability
   registry (see [RFC5447]) for use with the MIP6- Feature-Vector AVP:


     Token                             | Value
     ----------------------------------+--------------------
     IP4_TRANSPORT_SUPPORTED           | 0x0000080000000000
     IP4_HOA_ONLY_SUPPORTED            | 0x0000100000000000






Xia, et al.             Expires December 27, 2011              [Page 30]

Internet-Draft                RADIUS-PMIPv6                    June 2011


10.  Acknowledgements

   First of all, the authors would like to acknowledge the
   standardization work and people of the WiMAX Forum that have set the
   foundation for this document.
   The authors would like to thank Glen Zorn, Avi Lior, Alan DeKok and
   Pete McCann for reviewing the document and providing valuable input.
   The authors would also like to thank the authors of [RFC5779] as this
   document re-uses some procedural ideas of the aforementioned
   specification.









































Xia, et al.             Expires December 27, 2011              [Page 31]

Internet-Draft                RADIUS-PMIPv6                    June 2011


11.  References

11.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2865]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              RFC 2865, June 2000.

   [RFC5213]  Gundavelli, S., Leung, K., Devarapalli, V., Chowdhury, K.,
              and B. Patil, "Proxy Mobile IPv6", RFC 5213, August 2008.

   [RFC4282]  Aboba, B., Beadles, M., Arkko, J., and P. Eronen, "The
              Network Access Identifier", RFC 4282, December 2005.

   [RFC5447]  Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C.,
              and K. Chowdhury, "Diameter Mobile IPv6: Support for
              Network Access Server to Diameter Server Interaction",
              RFC 5447, February 2009.

   [RFC3588]  Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J.
              Arkko, "Diameter Base Protocol", RFC 3588, September 2003.

   [RFC5844]  Wakikawa, R. and S. Gundavelli, "IPv4 Support for Proxy
              Mobile IPv6", RFC 5844, May 2010.

   [RFC5779]  Korhonen, J., Bournelle, J., Chowdhury, K., Muhanna, A.,
              and U. Meyer, "Diameter Proxy Mobile IPv6: Mobile Access
              Gateway and Local Mobility Anchor Interaction with
              Diameter Server", RFC 5779, February 2010.

   [RFC4372]  Adrangi, F., Lior, A., Korhonen, J., and J. Loughney,
              "Chargeable User Identity", RFC 4372, January 2006.

11.2.  Informative references

   [RFC2866]  Rigney, C., "RADIUS Accounting", RFC 2866, June 2000.

   [RFC2869]  Rigney, C., Willats, W., and P. Calhoun, "RADIUS
              Extensions", RFC 2869, June 2000.

   [RFC3748]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, "Extensible Authentication Protocol (EAP)",
              RFC 3748, June 2004.

   [RFC5149]  Korhonen, J., Nilsson, U., and V. Devarapalli, "Service



Xia, et al.             Expires December 27, 2011              [Page 32]

Internet-Draft                RADIUS-PMIPv6                    June 2011


              Selection for Mobile IPv6", RFC 5149, February 2008.


Authors' Addresses

   Frank Xia
   Huawei USA
   1700 Alma Dr. Suite 500
   Plano, TX  75075

   Phone: +1 972-509-5599
   Email: xiayangsong@huawei.com


   Behcet Sarikaya
   Huawei USA
   1700 Alma Dr. Suite 500
   Plano, TX  75075

   Phone: +1 972-509-5599
   Email: sarikaya@ieee.org


   Jouni Korhonen
   Nokia Siemens Networks
   Linnoitustie 6
   Espoo  FI-02600
   Finland

   Email: jouni.nospam@gmail.com


   Sri Gundavelli
   Cisco
   170 West Tasman Drive
   San Jose, CA  95134

   Email: sgundave@cisco.com


   Damjan Damic
   Siemens
   Heinzelova 70a
   Zagreb  10000
   Croatia

   Email: damjan.damic@siemens.com




Xia, et al.             Expires December 27, 2011              [Page 33]

