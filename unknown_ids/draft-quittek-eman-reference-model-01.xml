<?xml version="1.0" encoding="us-ascii"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY rfc3410 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3410.xml">
<!ENTITY rfc4741 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4741.xml">
<!ENTITY rfc5101 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5101.xml">
<!ENTITY rfc5675 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5675.xml">
<!ENTITY id.draft-claise-power-management-arch SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-claise-power-management-arch-02.xml">
<!ENTITY id.draft-quittek-power-monitoring-requirements SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-quittek-power-monitoring-requirements-02.xml">
]>
<!--<?rfc strict="yes"?>-->
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc tocompact="no"?>
<!--<?rfc footer="draft-quittek-eman-reference-model-01"?>-->
<?rfc compact="yes"?>
<!--<?rfc subcompact="compact"?>-->
<?rfc symrefs="yes"?>
<rfc category="info" docName="draft-quittek-eman-reference-model-01" ipr="trust200902">
  <front>
    <title>Reference Model for Energy Management</title>

    <author fullname="J&uuml;rgen Quittek" initials="J."
            surname="Quittek">
      <organization>NEC Europe Ltd.</organization>

      <address>
        <postal>
          <street>Network Research Division</street>

          <street>Kurfuersten-Anlage 36</street>

          <code>69115</code>

          <city>Heidelberg</city>

          <country>DE</country>
        </postal>

        <phone>+49 6221 4342-115</phone>

        <email>quittek@neclab.eu</email>
      </address>
    </author>

    <author fullname="Bruce Nordman" initials="B."
            surname="Nordman">
      <organization>Lawrence Berkeley National Laboratory</organization>

      <address>
        <postal>
          <street>1 Cyclotron Road</street>

          <code>94720</code>

          <city>Berkeley</city>

          <country>US</country>
        </postal>
        <phone>+1 510 486 7089</phone>

        <email>bnordman@lbl.gov</email>
      </address>
    </author>

    <date month="February" year="2011" />

    <abstract>
      <t>This memo discusses suggest a reference model for energy consumption
      monitoring and control. It defines entities involved in energy
      management, their roles, and relationships among them. Considered 
      entities include powered devices, power monitors, and power controllers, and
      energy management systems.
      </t>
    </abstract>
  </front>


  <middle>
  
  <section title="Introduction">

    <t>Managing energy consumption of devices with network connections is
    different from several well understood network management functions
    because of the special nature of energy supply and consumption.</t> 
    
    <t>The most basic example of energy management is a single device
    reporting information about its own energy status.</t>
      
    <t>However, in many cases, energy 
    consumption is not measured by the powered device itself, but by a power
    meter located upstream in the power distribution tree. An example is
    a power distribution unit (PDU) that measures energy
    consumption of attached devices and may report this to an energy
    management system. Unlike many other management functions, 
    the powered device is not involved in this process.</t>

    <t>This memo aims to clarify roles of entities involved in
    energy monitoring and control and the relationships among them.</t>

    <t>There is already a reference model defined in section 4 of <xref 
    target="I-D.claise-power-management-arch"/>. The intention of this
    memo is to refine this model based on recent discussions.</t>
    
    <t>The reference model specification below describes several kinds 
    of entities and interactions between them. According to the current
    scope of the EMAN WG, only reporting to the energy management
    system are potential subjects of standardization in this WG.</t> 

    <t>The reference model is described in two stages. Stage one is an 
    energy monitoring model specified in <xref target="monitoring-model"/>.
    It covers only monitoring of power states and energy consumption. 
    On stage two the monitoring model is extended to a full energy 
    management reference model by adding control functions for power 
    supply and power states. see <xref target="control-model"/>.</t> 
  </section>

  <section anchor="terms" title="Terminology">
      
    <t>This section defines terms used for the description of the
    energy management reference model. Names for entities of the model
    are not defined here but in <xref target="monitoring-entities"/> 
    and <xref target="control-entities"/>.</t> 
      
    <section title="Energy Management">
      <t>Energy management deals with assessing and influencing the
      consumption of energy in a network of powered devices. 
      A typical objective of energy management is reducing the energy
      consumption in the network. This objective may be limited by other
      objectives of a general network management system, such as
      service level objectives.</t>
    </section>

    <section title="Energy Monitoring">
      <t>Energy monitoring is a part of energy management. It only covers
      monitoring and does not include influencing the consumption 
      of energy.</t>
    </section>

    <section title="Power, Energy, and Energy Consumption">
      <t>Power is the rate of energy conversion. In 
      energy management scenarios, electrical energy is delivered to a
      device that consumes it by converting the energy to other forms.</t>

      <t>Power and consumed energy are essential quantities for network 
      management. Power can be an instantaneous value of the current
      energy conversion rate or an average value of power 
      over a time interval. Consumed energy is the total energy converted 
      by a powered device during a time interval.</t>
         
      <t>The term 'energy consumption' is commonly used for both, 
      for referring to the amount of consumed energy and also for 
      referring to the process of consuming energy. 
      In this document we use this ambiguous
      term for addressing both power and consumed energy.</t>
    </section>
    <section title="Identity">
      <t>Identity is basic information about what a device is, in function,
      in its specific instance of manufacture, and its specific local
      human-readable name. Identity is not energy-specific, but essential
      for useful interpretation of energy information.</t>
      
      <t>Some identify information never changes. The rest of it rarely or
      never changes. Thus, it needs to be queried much less frequently than
      the energy data.</t>
    </section>
  </section>

  <section anchor="monitoring-model" title="Energy Monitoring Reference Model">

    <t>This section specifies a reference model for energy monitoring. 
    After introducing basic concepts of energy monitoring in 
    <xref target="monitoring-intro"/> it defines entities of the model and
    their interactions in <xref target="monitoring-entities"/>. Examples of 
    devices and scenarios are illustrated in 
    <xref target="monitoring-scenarios"/>. </t>

    <section anchor="monitoring-intro" title="Introduction to Energy Monitoring">

      <t> In this section we introduce basic concepts of energy monitoring
      starting with the most basic scenario and extending it stepwise to our
      full reference model.</t>
      
      <t>The main subject of energy monitoring is a powered device. An energy
      monitoring system collects information about powered devices, their 
      current power state (for example: on, sleep, off) and their
      actual power consumption. </t>
    
      <section title="Basic Energy Monitoring (local metering)">


        <t>The most basic interaction in an energy monitoring system
        is a powered device directly reporting its own energy-related information,
        with no other devices involved, as shown below.</t>

        <figure>
          <artwork><![CDATA[
                         energy monitoring 
                              system       
                                 ^
                                 |
                              device       
          ]]></artwork>
        </figure>

      </section>

      <section title="External Metering">

        <t>Reporting its current power state is a relatively easy task 
        for a powered device because usually information on the current 
        power state is locally available at the device and a reporting function 
        just needs some additional software to implement it.</t> 
    
        <t>Reporting the current power level of a
        device and its accumulated energy consumption is a 
        harder task, particularly if there are strict requirements for accuracy.
        Today very few devices are 
        instrumented with means for measuring their own energy consumption
        as that usually implies adding hardware for this purpose.
        </t>

        <t>This can be addressed by external meters, that is,
        dedicated probes that can meter energy consumption on a power 
        source (line). Some Power Distributions Units (PDUs) 
        and <xref target="IEEE-802.3af">Power over Ethernet (PoE)</xref> 
        switches integrate power source and power metering for 
        individual devices.</t>
    
        <t> For supporting scenarios with external meters we extend the 
        basic model from above by an external power meter and a power 
        source as shown below.</t>

        <figure>
          <artwork><![CDATA[
                      energy monitoring system                      
                        ^         ^         ^     
                        |         |         |     
                      power     power    powered      
                      source    meter    device       
                           ###############
   
           symbols ######### represent a power supply line
          ]]></artwork>
        </figure>

        <t>All three potentially report to the energy monitoring system. 
        The power meter may report the current power and accumulated 
        energy consumption and the power source may report if the power 
        supply for the device is switched on or if it is off.</t>
        
        <t>Implementation may be incomplete.  For example, an energy management
        system may have access to only one or two of these three types of data.</t>


      </section>
      
      <section title="Functions and Entities">
        <t>This reference model operates at two levels/layers. One is simple basic
        functions that are implemented. The second is how they are arranged in
        devices. A device in this model may implement only a single function, or
        may implement many.</t>
          
        <t>That is, having multiple entities does not require 
        that all of them need to be instantiated by individual devices. 
        For example, the power meter function may be co-located and integrated with 
        the powered device, with the power source, or it may be
        implemented by a separate device.</t>
      </section>

      <section title="Power Monitors">

        <t>In the models above, the powered device and other
        components deliver reports directly to an
        energy monitoring system. However, there are energy monitoring
        scenarios where this is not possible or not desirable.</t>

        <t>Extreme examples are energy consumers that do not have IP interfaces
        but can communicate by other means. 
        For delivering their reports to an IP-based energy 
        monitoring system, it may be required to use a gateway that can 
        communicate with the energy monitoring system.</t>
        
        <t>However, even if all involved devices (PDUs, power meters, and powered devices)
        can communicate via IP, it may be desirable to have mediation 
        functions in place between powered devices and the energy monitoring 
        system. An example, is an aggregating device that aggregates and 
        reports information on several powered devices.</t>
        
        <t>There are several further useful scenarios. To generalize the model
        (and to not exclude any kind of gateway, proxy, relay, mediator or other device)
        we define reporting entities called 'monitors'. 
        The figure below shows three monitors, each of which
        reports to the energy monitoring system.
        This figure is the most generic representation of the energy monitoring
        reference model described by this document.</t>
        
        <figure>
          <artwork><![CDATA[
                  Energy Monitoring Reference Model

+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
          ^                       ^                       ^     
          |                       |                       |     
+-------------------+   +-------------------+   +-------------------+
|    power source   |   |    power usage    |   |    power state    |
|      monitor      |   |      monitor      |   |      monitor      |
+-------------------+   +-------------------+   +-------------------+
          |                       |                       |     
+-------------------+   +-------------------+   +-------------------+
|       power       |   |    power meter    |   |      powered      |
|       source      |   +-------------------+   |      device       |
+-------------------+###########################+-------------------+
   
           symbols ######### represent a power supply line
          ]]></artwork>
        </figure>

        <t>A monitor function reports directly to the energy monitoring
        system using the EMON protocol (an Internet protocol). 
        A monitor must have means to
        acquire the information it reports, but how this information
        is acquired is not relevant for our model.
        That is, only the interactions with a caret symbol in this and following
        diagrams is the subject of standardization.
        Those with only the vertical bar character are outside the scope of
        these documents; they may be IP or non-IP.</t>
        
        <t>The reference model defines the communication between 
        power monitors an the energy monitoring system. The communication
        lines between these entities are reference points of our model
        described in more detail in the following.</t>

      </section>

    </section>  

    <section anchor="monitoring-entities" title="Energy Monitoring Entities">

      <t>This section defines entities of the energy monitoring reference
      model and describes interactions between them. Examples scenarios are 
      illustrated in <xref target="monitoring-scenarios"/>. </t> 

      <section title="Powered Device">
        <t>A powered device is provided with energy (typically electrical)
        usuallly provided via power lines. Power state, 
        power and consumed energy of powered devices are subject to monitoring 
        and control functions of energy management.</t> 
      </section>

      <section title="Power Source">
        <t>A power source provides a powered device with energy, 
        typically via a power line.
		It may have means to switch on and off 
        the power for the powered device. A power source does not necessarily 
        generate power, but it may do so. It may be as simple as a power 
        switch or a power plug, but it may also be a battery or a power 
        generator. Regardless, the nature of the source does not affect
        energy monitoring.</t>
        
        <t>Note that an internal battery within a device, such as the battery
        of a notebok PC or of a mobile phone are not considered to be a power 
        source. When a device runs on battery only, there is n flow of energy 
        into the device and consequently the power to be reported for this 
        device is zero. On the other hand, when a device charges its battery,
        then the power supplied for charging needs to be accounted, even if the
        device is not operational.</t>
      </section>

      <section title="Power Meter">
        <t>A power meter measures power and/or consumed energy, and
        typically is electrically connected to power supply lines 
        for powered devices. However, many devices can also provide
        a reliable estimate of their power consumption based on internal
        status information without having dedicated metering hardware.
        Regardless, all metering information is qualified by an 
        indication of its accuracy.</t>
        
        <t>The meter function also includes integrating power consumption
        over time to provide a "meter reading" with a time stamp to
        enable an energy monitoring system to track energy consumption over time.</t>

      </section>

      <section title="Power Monitors">
        <t>A power monitor has access to energy-related information 
        concerning powered devices and is able to report this
        information to energy management systems.</t>

        <t>A power monitor may also provide information on identity 
        and properties of a powered device to the management system.</t>
        
        <t>A power monitor may store energy-related information and 
        process it, for example, for aggregating information or for 
        extracting statistics that are provided to an energy management 
        system.</t>
        
        <t>There are three power monitor functions 
        in the energy monitoring reference model: power state monitors,
        power source monitors, and power usage monitors.</t>
        
        <section title="Power State Monitor">
          <t>A power state monitor has access to the power state 
          of a powered device and is able to report this information to an
          energy monitoring system. For acquiring power state information 
          it may interact with powered devices.</t>
        </section>

        <section title="Power Source Monitor">
          <t>A power state monitor has access to information on the power supply 
          of powered devices and is able to report this information to an
          energy monitoring system. Typically, it will just report either 
          'on' or 'off'. In addition, it may report on power availability. 
          For acquiring power source information it may interact with the 
          power sources of powered devices. </t>
        </section>

        <section title="Power Usage Monitor">
          <t>A power usage monitor has access to information on
          energy consumption of powered devices and is able to report this
          information to energy management systems. For acquiring information
          on energy consumption it may interact with power meters.</t>
        </section>

      </section>

      <section title="Energy Monitoring System">
        <t>An energy monitoring system receives information
        from power monitors, such as: power states, power source states, 
        and energy consumption.
        An energy monitoring system may be centralized or distributed.
        In most of the example scenarios
        illustrated in <xref target="monitoring-scenarios"/> a centralized 
        energy monitoring system is shown but in all cases can be
        replaced by a distributed monitoring system.</t>
      </section>
    
    </section>

    <section anchor="monitoring-points" title="Standardization Scope">
        <t>The reference model specifies interactions of an 
        energy monitoring system with power monitors. They reference 
        points of the model are potential subjects of standardization 
        (in the EMAN working group). 
        Interactions of power monitors with other entities are
        currently not considered to be subject of standardization.</t>
    
        <t>It is argued in
        <xref target="I-D.quittek-power-monitoring-requirements"/> that
        for most of the relevant scenarios the best choice a management 
        protocol for the reference points is <xref target="RFC3410">SNMP</xref>.
        The reference model defined in this document does not assume a 
        specific protocol between energy monitoring system and power 
        monitors. It is also applicable if other protocols, such as, 
        for example, <xref target="RFC5675">Syslog</xref> or
        <xref target="RFC5101">IPFIX</xref> are used.</t>        
    </section>

    <section anchor="monitoring-relationships" title="Entity Relationships">
    
      <t>No restrictions on entity relationships have been identified for 
      interacting entities of the energy monitoring reference model specified 
      in this document. This means that all relationships between
      entities may be one-to-one, one-to-many, many-to-one, or many-to-many.
      For example, 
      <list style="symbols">
        <t>a single power state monitor may report the power state of
        multiples powered entities,</t>
        <t>a single powered entity may have its power states reported by< 
        multiple power state monitors,</t>
        <t>a single powered device may receive power from several power
        sources,</t>
        <t>a single power monitor may report to multiple energy monitoring 
        systems.</t>
      </list>
      A few of scenarios with multiple instances of units are illustrated 
      by the examples in the following <xref target="monitoring-scenarios"/>.
      </t>
    
    </section>

    <section anchor="monitoring-scenarios" title="Energy Monitoring Scenarios">
      <t>This section describes common example scenarios for energy
      monitoring and how they are modeled with the entities and interactions
      described in the previous sections.</t>

      <section title="Simple Device with Power Meter">
        <t>A very basic example is a powered device that has a built-in meter 
        for measuring its own energy consumption and that reports its power 
        state and power usage directly to the energy monitoring system.</t>

        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
                                            ^ 
                                            | 
                    +-----------------------------------------------+
                    |                       |                       |
                    |           +-----------+-----------+           |
                    |           |                       |           |
                    | +-------------------+   +-------------------+ |
                    | |    power usage    |   |    power state    | |
                    | |      monitor      |   |      monitor      | |
                    | +-------------------+   +-------------------+ |
                    |           |                       |           |
+-----------------+ | +-------------------+   +-------------------+ |
|      power      | | |    power meter    |   |      powered      | |
|      source     | | +---------#---------+   |      device       | |
+-----------------+#|#########################+-------------------+ |
                    |                                               |
                    | powered device with meter and power monitors  |
                    +-----------------------------------------------+

     Scenario 1: Powered device metering and self-reporting
          ]]></artwork>
        </figure>

        <t>Here four entities are combined in a single device: the 
        powered device, the power meter, and two power monitors.</t>

      </section>

      <section title="External Power Meter">
        <t>The second example shows a power meter that
        is attached to the power line of a powered device that does 
        not have means for measuring its own energy consumption.
        The meter is integrated with a power usage monitor that reports
        metered data. The powered device may report its own power state 
        by an integrated power state monitor.</t>
  
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
                                 ^                  
                                 |                    
                     +-----------------------+  
                     |  external | meter     |
                     | +-------------------+ |  
                     | |    power usage    | |  
                     | |      monitor      | |  
                     | +-------------------+ | 
                     |           |           |  
                     | +-------------------+ | 
+-----------------+  | |    power meter    | |  +-------------------+
|      power      |  | +---------#---------+ |  |      powered      |
|      source     |  +-----------#-----------+  |      device       |
+-----------------+#############################+-------------------+

                  Scenario 2: An external meter
          ]]></artwork>
        </figure>

      </section>

      <section title="External Power Meter for Multiple Powered Devices">
        <t>Power meters may be located at a power line that provides 
        power for multiple powered devices. In scenario 3, a single
        power meter measures the accumulated power and energy consumption
        of multiple powered devices. In general, In this scenario it is  
        usually not possible to derive power values for the individual 
        powered devices from the accumulated measurement.</t>
  
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
                                 ^                  
                                 |                    
                     +-----------------------+  
                     |  external | meter     |
                     | +-------------------+ |  
                     | |    power usage    | |     +----------------+
                     | |      monitor      | |     |    powered     | 
                     | +-------------------+ |     |    device      |
                     |           |           |  ###+----------------+ 
                     | +-------------------+ |  #
+-----------------+  | |    power meter    | |  #  +----------------+
|      power      |  | +---------#---------+ |  #  |    powered     |
|      source     |  +-----------#-----------+  #  |    device      |
+-----------------+################################+----------------+
                                                #
                                                #  +----------------+
                                                #  |    powered     |
                                                #  |    device      |
                                                ###+----------------+

       Scenario 3: An external meter for multiple powered devices
          ]]></artwork>
        </figure>

      </section>

<!--
      <section title="Device with Power Meter and Battery">
        <t>The powered device may be integrated with the power source.
        Scenario 4 shows a device with t built-in battery that is modeled
        as power source. In this case the power source monitor may also 
        send information about power availability, such as, for example,
        the remaining charge of the battery.</t>

        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
                                  ^                          
                                  |                                
+-------------------------------------------------------------------+
|                                 |                                 |
|           +---------------------+---------------------+           |
|           |                     |                     |           |
| +-------------------+ +-------------------+ +-------------------+ |
| |    power source   | |    power usage    | |    power state    | |
| |      monitor      | |      monitor      | |      monitor      | |
| +-------------------+ +-------------------+ +-------------------+ |
|           |                     |                     |           |
| +-------------------+ +-------------------+ +-------------------+ |
| |       power       | |    power meter    | |      powered      | |
| |       source      | +---------#---------+ |      device       | |
| +-------------------+#######################+-------------------+ |
|                                                                   |
| powered device with battery and meter                             |
+-------------------------------------------------------------------+

     Scenario 4: Powered device metering and reporting on its own
          ]]></artwork>
        </figure>

        <t>Here all entities of our monitoring reference model are 
        integrated at a single device. Only the energy monitoring 
        system is separated.</t>

      </section>
-->

      <section title="Powered Device with Dual Power Supply">
        <t>Some powered devices have dual power supply. It may
        be that one supply comes from a power grid and the other
        one from a battery. High-reliability devices may have two
        power sources from different power distribution networks,
        as shown in scenarios 4 and 5.</t>

        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
                                  ^  
                                  |  
             +-----------------------------------------+
             |                    |                    |
             | +-------------------------------------+ |  
             | |         power usage monitor         | |  
             | +-------------------------------------+ |  
             |      |                           |      |
             | +---------+  +-----------+  +---------+ |
+---------+  | |  power  |  |  powered  |  |  power  | |  +---------+    
|  power  |  | |  meter  |  |  device   |  |  meter  | |  |  power  |  
|  source |  | +----#----+  |           |  +----#----+ |  |  source |    
+---------+##|##############+-----------+##############|##+---------+
             |                                         |
             | powered device with dual power supply   |
             | and dual metering                       |
             +-----------------------------------------+

       Scenario 4: powered device with dual power supply
          ]]></artwork>
        </figure>

        <t>In scenario 4 the device uses two meters, one for each
        power line and reports from both to the energy monitoring system.
        If the two power sources belong to different power distribution
        domains, it may be necessary to report power and energy separately
        for each supply. 
        </t>

      </section>

      <section title="Two energy monitoring systems">
        <t>Scenario 5 is more complex. Both meters are individual 
        external devices and there are even two separate energy 
        monitoring systems involved, one for each
        power distribution tree.</t>
  
        <figure>
          <artwork><![CDATA[
+-------------------------------+   +-------------------------------+
|   energy monitoring system    |   |   energy monitoring system    |
+-------------------------------+   +-------------------------------+
                  ^                               ^
                  |                               |  
            +-----------+                   +-----------+
            |     |     |                   |     |     |
            | +-------+ |                   | +-------+ |  
            | |power  | |                   | |power  | |
            | |usage  | |                   | |usage  | |
            | |monitor| |                   | |monitor| |  
            | +-------+ |                   | +-------+ |  
            |     |     |                   |     |     |
            | +-------+ |                   | +-------+ |
            | | power | |                   | | power | |
+--------+  | | meter | |  +-------------+  | | meter | |  +--------+    
| power  |  | +---#---+ |  |   powered   |  | +---#---+ |  | power  |  
| source |  +-----#-----+  |   device    |  +-----#-----+  | source |    
+--------+#################+-------------+#################+--------+

          Scenario 5: powered device with dual power supply
               from different power distribution trees
          ]]></artwork>
        </figure>

      </section>

      <section title="Power over Ethernet Switch">
        <t>This example shows a <xref target="IEEE-802.3af">Power over 
        Ethernet (PoE)</xref> switch supplying a powered device. 
        The switch contains a power source and a meter for each of its
        ports. </t>

        <t>There typically are multiple instances of power sources 
        and power meters in a PoE switch, but the drawing below shows only a single 
        instance. The same applies to the powered devices that are 
        represented by a single instance only.</t>
        
        <t>Note that a typical PoE switch has also means to control 
        power supply for powered devices (not shown here).
        Control of power supply is a subject of <xref 
        target="control-model"/>.</t>

        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
                      ^                                             
                      |                                                  
+---------------------------------------------+
|                     |                       |
|          +----------+-----------+           |
|          |                      |           |     
| +-----------------+   +-------------------+ | 
| |   power source  |   |    power usage    | | 
| |     monitor     |   |      monitor      | | 
| +-----------------+   +-------------------+ | 
|          |                      |           |                
| +-----------------+   +-------------------+ | +-------------------+
| |      power      |   |    power meter    | | |      powered      |
| |      source     |   +---------#---------+ | |      device       |
| +-----------------+#########################|#+-------------------+
|                                             |
| Power over Ethernet switch                  |
| or Power Distribution Unit                  |
+---------------------------------------------+
  Scenarios 6 & 7: Power over Ethernet switch or Power Distribution 
  Unit reporting on power source and power usage of powered devices
          ]]></artwork>
        </figure>

        <t>In this scenario the identification of the powered device can
        be done by the PoE switch by observing MAC and IP addresses of 
        the powered devices. The switch can report them to the energy
        management system which then in turn can contact the devices
        directly to obtain further information.</t>
      </section>

      <section title="Power Distribution Unit">
        <t>The same figure as used for the PoE switch in the previous section 
        is be used for scenario 7 modeling a power distribution unit (PDU).
        A PDU with meters for every socket can report power for each.</t>

        <t>Identifying the powered devices can more difficult in this 
        scenario than in the previous one with the PoE switch, because
        the PDU does not necessarily communicate with the powered devices. 
        In this case the PDU or EMS needs to obtain this information by
        other means, for example by manual configuration.</t>
      </section>

      <section title="Aggregator">
        <t>Scenario 8 shows a power usage monitor acting as an aggregator.
        It collects power information from three powered devices and 
        delivers all of the information to the energy monitoring system.
        The aggregator 
        may deliver the full information or aggregated information, for
        example, just the sum of the power of all three powered devices.</t>
  
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
                                  ^                          
                                  |
+-------------------------------------------------------------------+
|                        power usage monitor                        |
+-------------------------------------------------------------------+
     |                       |                       |          
+-------------------+   +-------------------+   +-------------------+
|    |              |   |    |              |   |    |              |
|+-------+ +-------+|   |+-------+ +-------+|   |+-------+ +-------+|
|| power | |powered||   || power | |powered||   || power | |powered||
|| meter | |device ||   || meter | |device ||   || meter | |device ||
|+-------##+-------+|   |+-------##+-------+|   |+-------##+-------+|
+--------#----------+   +--------#----------+   +--------#----------+
         #                       #                       #
+-------------------------------------------------------------------+
|                          power source                             |
+-------------------------------------------------------------------+

     Scenario 8: An aggregator collecting monitoring information 
                      from three powered devices
          ]]></artwork>
        </figure>

      </section>

      <section title="Energy Monitoring Gateway">
        <t>Some energy monitoring scenarios include
        a gateway between the monitored units and the
        energy monitoring system.  The powered device and the power 
        meter may use means of communication other than IP.</t>
 
        <t>The gateway is a relay and protocol converter that delivers
        energy information to a power monitor.
        A single device may implement logically independent gateways
        for multiple devices.</t>
        
        <t> Scenario 9 can easily extended to a gateway that also
        contains a power source monitor.</t>

        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy monitoring system                      |
+-------------------------------------------------------------------+
                                              ^               
                                              |                   
                      +---------------------------------------------+
                      |                       |                     |
                      |           +-----------+----------+          |
                      |           |                      |          |
                      | +-------------------+   +-----------------+ |
                      | |    power usage    |   |   power state   | |
                      | |      monitor      |   |     monitor     | |
                      | +-------------------+   +-----------------+ |
                      | gateway   |                      |          |
                      +---------------------------------------------+
                                  |                      |     
+-------------------+   +-------------------+   +-----------------+
|       power       |   |    power meter    |   |     powered     |
|       source      |   +---------#---------+   |     device      |
+-------------------+###########################+-----------------+
   
             Scenario 9: A gateway between monitored devices 
                      and energy monitoring system
          ]]></artwork>
        </figure>

        <t>Here again, the problem of identifying the powered device has 
        become very difficult, because neither can the power monitor 
        provide an IP address of the powered device to the energy management 
        system nor can the energy management system directly communicate with 
        the powered device. Identification must be provided by other means.
        The Proxy can have a gateway function and relay identification
        between powered device and energy management system or the energy
        management system needs to acquire information on powered devices
        by other means, such as manual configuration.</t>
      </section>

      <section title="Further Scenarios">
        <t>More scenarios may be added to future versions of this document.
        Particularly, scenarios with multiple instances of an entity have not
        been elaborated a lot.

        <xref target="control-scenarios"/> shows scenarios for energy control.
        They can also be considered as further monitoring scenarios if only
        their power monitors are considered and power controllers are ignored.
        </t>
      </section>

    </section>

  </section>

  <section anchor="control-model" title="Energy Management Reference Model">
    <t>This section extends the energy monitoring reference model specified 
    in the previous <xref target="monitoring-model"/> by adding power control 
    functions. The resulting model is a complete energy management 
    reference model.</t>

    <t>As in <xref target="monitoring-model"/> we first discuss entities and
    their relationships and then illustrate the model with example scenarios.
    </t>
    
    <t> The extension from energy monitoring to energy management is straight
    forward. To achieve the required control functions the
    power source, power meter, and powered device have additional functions
    for control.
    For each power monitor a corresponding power controller is added 
    as shown below.</t>
    <figure>
      <artwork><![CDATA[
                  Energy Management Reference Model

+-------------------------------------------------------------------+
|                     energy management system                      |
+-------------------------------------------------------------------+
    ^          |            ^          |            ^          |
    |          v            |          v            |          v
+--------+ +--------+   +--------+ +--------+   +--------+ +--------+
| power  | | power  |   | power  | | power  |   | power  | | power  |
| source | | source |   | usage  | | meter  |   | state  | | state  |
| monitor| | ctrler |   | monitor| | ctrler |   | monitor| | ctrler |
+--------+ +--------+   +--------+ +--------+   +--------+ +--------+
    |          |            |          |            |          |
+-------------------+   +-------------------+   +-------------------+
|       power       |   |    power meter    |   |      powered      |
|       source      |   +-------------------+   |      device       |
+-------------------+###########################+-------------------+
   
           symbols ######### represent a power line
      ]]></artwork>
    </figure>

    <section anchor="control-entities" title="Energy Management Entities">

      <t>This section defines entities of the energy management reference
      model and describes interactions between them. Examples scenarios are 
      illustrated in <xref target="control-scenarios"/>. For entities already
      specified in <xref target="monitoring-entities"/> of the
      energy monitoring reference model, only their additional properties 
      are mentioned here. Power monitors are not discussed here again, 
      because their specification in the energy management reference model
      do not change.
      </t> 

      <section title="Powered Device">
        <t>A powered device may be capable of changing its own power state
        from a request from the energy management system. Some devices may
        not be able to power up from an off state based on EMS request.
        Most devices that are asleep will be able to wake on EMES request.</t> 
      </section>

      <section title="Power Source">
        <t>A power source may be capable of switching on and off power for
        powered devices.</t>
      </section>

      <section title="Power Meter">
        <t>A power meter may be switched on or off or have its metering
        parameters modified.</t>
      </section>

      <section title="Power Controllers">
        <t>A power controller receives commands from an energy management 
        system to change the status or parameters of power sources,
        power meters, or powered devices.</t>

        <t>There are three kinds of power controller entities: power state 
        controllers, power source controllers, and power meter controllers.</t>
        
        <section title="Power State Controller">
          <t>A power state controller can initiate a change in the power state
          of a powered device.</t>
        </section>

        <section title="Power Source Controller">
          <t>A power source controller can change the
          power supply of a powered device. Typically, it has means for
          switching power supply on and off. It may use these means without
          communicating with the affected powered device.</t>
        </section>

        <section title="Power Meter Controller">
          <t>A power meter controller has means for influencing the
          operation of a power meter. It may switch on and off the power 
          meters and change parameters of their operation. For this purpose 
          it may interact with power meters.</t>
        </section>

      </section>

      <section title="Energy Management System">
        <t>An energy management system is an energy monitoring system
        extended by control functions. It interacts with power monitors
        and power controllers in order to achieve objectives of energy 
        management. </t>

        <t>It sends commands to power controllers. To power state controllers
        it sends requested power states for powered devices. To power 
        source controllers it requests to switch on or off power for powered 
        devices. To power meter controllers it sends commands concerning
        the operation  of power meters.</t>      
      </section>
    
    </section>

    <section anchor="control-points" title="Reference Points">
        <t>Relevant for our reference model are interactions of the 
        energy management system with power monitors and power controllers. 
        They are reference points of our model and potential subjects of 
        standardization in the EMAN working group. Interactions of power 
        monitors and power controllers with other entities are
        currently not considered to be subject of standardization.</t>
    
        <t>Monitoring protocols have already been discussed in 
        <xref target="monitoring-points"/>. There are several choices 
        of control protocols to be used for energy management.
        Among them are <xref target="RFC3410">SNMP</xref> and
        <xref target="RFC4741">NETCONF</xref>.</t>                
    </section>

    <section anchor="control-relationships" title="Entity Relationships">
      <t>The considerations on entity relationships for the energy monitoring
      reference model described in  <xref target="monitoring-relationships"/>.
      apply as well to the energy management reference model: 
      No restrictions on entity relationships have been identified.</t>
    </section>

    <section anchor="control-scenarios" title="Energy Management Scenarios">
      <t>This section describes example scenarios for energy management
      and how they are modeled with the entities and interactions
      described above.</t>

      <section title="Simple Self-Managed Device">
        <t>The first two examples are expected to become very common 
        scenarios. Here, a powered device is managing its power state
        on its own based on input other than from the energy management system.
        The device may decide to change power state based on observation of
        its environment (no current load, high temperature, not sufficient 
        light, scheduled time for service interruption, etc.) or it may 
        receive external triggers, such as by a human-operated remote 
        control.</t>
        
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy management system                      |
+-------------------------------------------------------------------+
                                                  ^          
                                                  |          
                                            +-----------------------+
                                            |     |                 |
                                            | +--------+ +--------+ |
                                            | | power  | | power  | |
                                            | | state  | | state  | |
                                            | | monitor| | ctrler | |
                                            | +--------+ +--------+ |
                                            |     |          |      |
+-----------------+                         | +-------------------+ |
|      power      |                         | |      powered      | |
|      source     |                         | |      device       | |
+-----------------+#|#########################+-------------------+ |
                                            |                       |
                                            | powered device with   |
                                            | power state control   |
                                            +-----------------------+

               Scenario 10: A self-managed powered device
          ]]></artwork>
        </figure>

        <t>In any way, it's power state control is independent of the 
        energy management system. The only interaction with the system
        is reporting of power state to the energy management system in
        scenario 10, and in addition reporting of its current power and/or 
        accumulated consumed energy in scenario 11.</t>
        
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy management system                      |
+-------------------------------------------------------------------+
                                            ^          
                                            |          
                    +-----------------------------------------------+
                    |                       |                       |
                    |     +-----------------+-----+                 |
                    |     |                       |                 |
                    | +--------+ +--------+   +--------+ +--------+ |
                    | | power  | | power  |   | power  | | power  | |
                    | | usage  | | meter  |   | state  | | state  | |
                    | | monitor| | ctrler |   | monitor| | ctrler | |
                    | +--------+ +--------+   +--------+ +--------+ |
                    |     |          |            |          |      |
+-----------------+ | +-------------------+   +-------------------+ |
|      power      | | |    power meter    |   |      powered      | |
|      source     | | +---------#---------+   |      device       | |
+-----------------+#|#########################+-------------------+ |
                    |                                               |
                    | powered device with built-in meter            | 
                    | and autonomous control                        |
                    +-----------------------------------------------+

    Scenario 11: A self-managed powered device with built-in meter
          ]]></artwork>
        </figure>

        <t>In scenario 11 also the control of the power meter is handled
        by the device itself.</t>
      </section>
        
      <section title="Simple Managed Device">
        <t>In our model, the scenario does not change much if the
        powered devices are not self-managed but managed by the energy 
        management system. Scenarios 12 and 13 show that just an 
        interaction between the energy management system and the powered
        device is added that serves for sending commands concerning
        power states to the device.</t>
        
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy management system                      |
+-------------------------------------------------------------------+
                                                  ^          |
                                                  |          |
                                            +-----------------------+
                                            |     |          v      |
                                            | +--------+ +--------+ |
                                            | | power  | | power  | |
                                            | | state  | | state  | |
                                            | | monitor| | ctrler | |
                                            | +--------+ +--------+ |
                                            |     |          |      |
+-----------------+                         | +-------------------+ |
|      power      |                         | |      powered      | |
|      source     |                         | |      device       | |
+-----------------+#########################|#+-------------------+ |
                                            |                       |
                                            | powered device with   |
                                            | power state control   |
                                            +-----------------------+

               Scenario 12: A managed powered device
          ]]></artwork>
        </figure>

        <t>Control of the power meter by the management system can
        easily added to scenario 13. It is not included here, because
        for built-in meters this seems not to be necessary in many
        common cases.</t>
        
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy management system                      |
+-------------------------------------------------------------------+
                                            ^                |
                                            |                |
                    +-----------------------------------------------+
                    |                       |                |      |
                    |     +-----------------+-----+          |      |
                    |     |                       |          v      |
                    | +--------+ +--------+   +--------+ +--------+ |
                    | | power  | | power  |   | power  | | power  | |
                    | | usage  | | meter  |   | state  | | state  | |
                    | | monitor| | ctrler |   | monitor| | ctrler | |
                    | +--------+ +--------+   +--------+ +--------+ |
                    |     |          |            |          |      |
+-----------------+ | +-------------------+   +-------------------+ |
|      power      | | |    power meter    |   |      powered      | |
|      source     | | +---------#---------+   |      device       | |
+-----------------+#|#########################+-------------------+ |
                    |                                               | 
                    | powered device with built-in meter            |
                    | and autonomous control                        |
                    +-----------------------------------------------+

      Scenario 13: A managed powered device with built-in meter
          ]]></artwork>
        </figure>

      </section>
        
      <section title="Power over Ethernet Switch">
        <t>Scenario 14 adds control functions to the PoE switch of
        scenario 6 in <xref target="monitoring-scenarios"/>. Here the
        energy management system can explicitly request the power for
        a powered device to be switched on or off. It also can switch 
        on and off metering and reporting of energy consumption per 
        port of the switch</t> 
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy management system                      |
+-------------------------------------------------------------------+
                |     ^               |            ^         
                |     |               |            |         
+-------------------------------------------+ +---------------------+
|               |     |               |     | |    |                |
|    +----------------+----+          |     | |    |                |
|    |          v          |          v     | |    |                |
|+--------+ +--------+ +--------+ +--------+| |+--------+ +--------+|
|| power  | | power  | | power  | | power  || || power  | | power  ||
|| source | | source | | usage  | | meter  || || state  | | state  ||
|| monitor| | ctrler | | monitor| | ctrler || || monitor| | ctrler ||
|+--------+ +--------+ +--------+ +--------+| |+--------+ +--------+|
|    |          |          |          |     | |    |          |     |
|+-------------------+ +-------------------+| |+-------------------+|
||       power       | |    power meter    || ||      powered      ||
||       source      | +---------#---------+| ||      device       ||
|+-------------------+######################|#|+-------------------+|
|                                           | |                     |
| Power over Ethernet switch                | | powered device with |
| or Power Distribution Unit                | | power state control |
+-------------------------------------------+ +---------------------+

            Scenario 14 & 15: Power over Ethernet switch 
                     or Power Distribution Unit 
           ]]></artwork>
        </figure>
        <t>Still, the powered device in this scenario is self-managed 
        controlling its power state on its own and just reporting it
        to the energy management system.</t> 
      </section>

      <section title="Power Distribution Unit">
        <t>Again, as in <xref target="monitoring-scenarios"/> the scenario 
        for a power distribution unit looks exactly the same in our 
        reference model as the scenario for a power distribution unit.</t>
      </section>

      <section title="Energy Management Gateway">
        <t>Starting from an energy monitoring gateway in 
        <xref target="monitoring-scenarios"/> the extension towards
        an energy management gateway is again straight forward.</t>
 
        <figure>
          <artwork><![CDATA[
+-------------------------------------------------------------------+
|                     energy management system                      |
+-------------------------------------------------------------------+
                                     |      ^                |
                                     |      |                |
                    +-----------------------------------------------+
                    |                |      |                |      | 
                    |     +-----------------+-----+          |      | 
                    |     | gateway  v            |          v      |
                    | +--------+ +--------+   +--------+ +--------+ |
                    | | power  | | power  |   | power  | | power  | |
                    | | usage  | | meter  |   | state  | | state  | |
                    | | monitor| | ctrler |   | monitor| | ctrler | |
                    | +--------+ +--------+   +--------+ +--------+ |
                    |     |          |            |          |      |
                    +-----------------------------------------------+
                          |          |            |          |
+-----------------+   +-------------------+   +-------------------+
|      power      |   |    power meter    |   |      powered      |
|      source     |   +---------#---------+   |      device       |
+-----------------+###########################+-------------------+

           Scenario 16: A gateway between powered devices 
                      and energy monitoring system
             ]]></artwork>
        </figure>

        <t>Here again, the problem of identifying the powered device has 
        become very difficult, because neither can the power monitor 
        provide an IP address of the powered device to the energy management 
        system nor can the energy management system directly communicate with 
        the powered device. Identification must be provided by other means.
        The Proxy can have a gateway function and relay identification
        between powered device and energy management system or the energy
        management system needs to acquire information on powered devices
        by other means, such as manual configuration.</t>

      </section>

      <section title="Further Scenarios">
        <t>More scenarios may be added to future versions of this document.
        Particularly, scenarios with multiple instances of an entity have not
        been elaborated, yet.
        <xref target="control-scenarios"/> shows scenarios for energy control.
        They can also be considered as further monitoring scenarios if only
        their power monitors are considered and power controllers are ignored.
        </t>
      </section>

    </section>

  </section>

  <section title="Security Considerations">
    <t>This memo currently does not impose any security considerations.</t>
  </section>

  <section title="IANA Considerations">
    <t>This memo has no actions for IANA..</t>
  </section>
    
  <section title="Acknowledgements">
    <t>This memo was inspired by discussions with Benoit Claise,
    John Parello, Mouli Chandramouli, Rolf Winter, Thomas Dietz, 
    Bill Mielke, and Chris Verges at IETF #79.</t>
  </section>

  <section title="Open Isues">

    <section title="Short name for the protocol">
      <t>We talk a lot in this document about reporting energy-related 
      information to an energy management system. For this purpose the SNMP
      protocol will be used and required MIB modules are under development at
      the EMAN WG. It may simplify the text if we can refer to the process
      of reporting energy-related information with a placeholder, for example,
      'EMON' for energy monitoring.</t>
    </section>

    <section title="Identity Monitor">
      <t>Shall we add a new building block called 'identity Monitor'?.
      This would tie in the work of the so-called POWER-AWARE-MIB.</t>
    </section>

    <section title="Interactions with the EMS">
      <t>Shall we discuss different kinds of interactions with the EMS? 
      These would include</t>

      <t><list style="symbols">
        <t>broadcasting to a subnet asking for all power monitors to report,</t>
        <t>addressing a specific device and asking for all power monitor 
        information it has,</t> 
        <t>asking a specific device about itself,</t>
        <t>asking a specific device for specific information, which could 
        include particular proxied devices, or pieces of EMON (state, meter, 
        source, identity), aggregated data, or collected data.</t>
      </list></t>
      
      <t>Basically, these interactions are all cvered bythe IETF netwrk
      management framework. The question is whether to mention it explicitly
      in the reference model.</t>
    </section>

    <section title="Third basic state for power source?">
      <t>So far, a power source has the two basic states 'on' and 'off'.
      Should we describe a third basic state for a power source.  
      This would be minimal (?trickle) power to enable communications 
      but not activity.  Would this model the way USB and PoE work?  
      EMON would not specify the quantity of this power, but an EMS will 
      know typical levels for relevant physical layer technologies.</t>
    </section>

    <section title="Collector and Aggregator">
      <t>It looks like we need to extend the model by a collctor function and
      an agregators function. A collector would collect energy-related 
      information on other devices and report for multiple of them. 
      An aggregator would use information from several devices and exceute
      operations n them, for example calculating a sum.</t>
    </section>

    <section title="Gateways and Proxies">
      <t>Is a gateway rather a scenario or a function? Scenarios 9 and 16 
      may need to be revised. In scenario 9 we talk about a 'proxy'. 
      We need to explain what we mean with 'proxy'.</t>
    </section>

  </section>

  </middle>

  <back>
    <references title="Informative References">

      &id.draft-quittek-power-monitoring-requirements;
      
      &id.draft-claise-power-management-arch;
      
      &rfc3410;

      &rfc4741;
      
      &rfc5101;

      &rfc5675;

      <reference anchor="IEEE-802.3af">
      <front>
  			<title>IEEE Std 802.3af-2003 - Data Terminal Equipment (DTE) 
  			  Power via Media Dependent Interface (MDI)</title> 
  			<author initials="" surname="IEEE 802.3 Working Group" 
  			  fullname="IEEE 802.3 Working Group"></author>
  			<date year="2003" month="July" /> 
  		</front>
      </reference>

    </references>
  </back>
</rfc>
