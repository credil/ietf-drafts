<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
    <!ENTITY rfc2119 PUBLIC '' 
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>
]>
<?rfc toc="yes"?>
<?rfc compact="yes"?>
<?rfc strict="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<rfc category="std" ipr="full3978" docName="draft-ietf-lemonade-profile-bis-10.txt">
    <front>
        <title abbrev="Lemonade Profile">The Lemonade Profile</title>
        <author initials='D.A.' surname="Cridland" fullname="Dave Cridland" role="editor">
            <organization>Isode Limited</organization>
            <address>
              <postal>
                <street>5 Castle Business Village</street>
                <street>36 Station Road</street>
                <city>Hampton</city>
                <region>Middlesex</region>
                <code>TW12 2BX</code>
                <country>UK</country>
              </postal>
              <email>dave.cridland@isode.com</email>
            </address>
        </author>
        <author initials='A.' surname="Melnikov" fullname="Alexey Melnikov" role="editor">
            <organization>Isode Limited</organization>
            <address>
              <postal>
                <street>5 Castle Business Village</street>
                <street>36 Station Road</street>
                <city>Hampton</city>
                <region>Middlesex</region>
                <code>TW12 2BX</code>
                <country>UK</country>
              </postal>
              <email>Alexey.Melnikov@isode.com</email>
            </address>
        </author>
        <author initials="S. H." surname="Maes" fullname="Stephane H. Maes" role="editor">
            <organization abbrev="Oracle">Oracle</organization>
            <address>
              <postal>
                  <street>MS 4op634, 500 Oracle Parkway</street>
                  <city>Redwood Shores</city> <region>CA</region>
                  <code>94539</code>
                  <country>USA</country>
              </postal>
              <phone>+1-203-300-7786</phone>
              <email>stephane.maes@oracle.com</email>
            </address>
        </author>
 	<date year="2008"/>
 	<area>Applications</area>
        <workgroup>LEMONADE</workgroup>
        <abstract>
		<t>This document describes a profile (a set of required extensions, restrictions and usage modes) of the IMAP and mail submission protocols. This profile allows clients 
		(especially those that are constrained in memory, bandwidth, processing power, or other areas) to efficiently use IMAP and Submission to access and submit mail. This includes the ability to forward received mail without needing to
		download and upload the mail, to optimize submission and to efficiently resynchronize in case of loss of connectivity with the server.</t>

		<t>The Lemonade profile relies upon several extensions to IMAP and Mail Submission protocols.</t>
		
		<!-- <t>It also provides functionality for realizations of OMA mobile email enabler (MEM) (<xref target="OMA-MEM-REQ"/>
 and <xref target="OMA-MEM-ARCH"/>) using Internet Mail protocols defined by the IETF.</t> -->
         </abstract>
    </front>
    <middle>
        <section title="Conventions used in this document">
	<t>In examples, "M:", "I:" and "S:" indicate lines sent by the client messaging user agent, IMAP e-mail server and SMTP submit server
		respectively.</t>
			
		<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
                NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
                described in <xref target="KEYWORDS" dwdrfc-type='norm'/>. </t>
		
		<t>Other capitalised words are typically names of extensions or commands - these are uppercased for clarity only, and are case-insensitive.</t>
                
        <t>All examples in this document are optimized for Lemonade use and
   might not represent examples of proper protocol usage for a general
   use Submit/IMAP client. In particular examples assume that Submit and IMAP
   servers support all Lemonade extensions described in
   this document, so they do not demonstrate fallbacks in the absence of an
   extension.</t>
        </section>
    <section title="Introduction">
	<t>The Lemonade Profile, or simply Lemonade, provides enhancements to Internet email to support diverse
   service environments. Lemonade Mail Servers provide both a Lemonade Submission Server and a Lemonade Message Store, which are based on the existing <xref target='SUBMIT'/> and <xref target='IMAP'/> protocols respectively.</t>
   <!-- <t>It is an update of <xref target="profile"/>LEMONADE profile.</t> -->
   
	<t>This document describes the Lemonade profile that includes:
<list style='symbols'>
<t>General common enhancements to Internet Mail, described in <xref target='store-gen'/> and <xref target='submit-gen'/>.</t>
<t>"Forward without download" that describes exchanges between
           Lemonade clients and servers to allow to submit new email
           messages incorporating content which resides on locations
           external to the client, described in <xref target='fwd-main'/>.</t>
<t>Quick mailbox resynchronization, described in <xref target="imap-condstore"/>.</t>
<t>Extensions to support more precise, and broader, notifications from the store in support of notifications and view filters, described in <xref target='imap-idle'/> and <xref target='imap-vfolder'/>.</t>
</list></t>
<t>It is intended that the Lemonade profile support realizations of the OMA's mobile email enabler (MEM) (see <xref target="OMA-MEM-REQ"/> and <xref target="OMA-MEM-ARCH"/>) using Internet Mail protocols defined by the IETF.<vspace blankLines='99'/></t>
  </section>

<section title="Summary of the required support">

<section title="Lemonade Submission Servers">
<t>Lemonade Submission Servers MUST provide a service as described in <xref target='SUBMIT' dwdrfc-type='norm'/>, and MUST support the following. Note that the Lemonade Profile imposes further requirements for some cases, detailed in the sections cited.</t>

<texttable>
<ttcol align="center">SMTP extension</ttcol>
<ttcol align="center">Reference</ttcol>
<ttcol align="center">Requirements</ttcol>
<c>PIPELINING</c><c><xref target="SMTP-PIPELINING" dwdrfc-type='norm'/></c><c><xref target="esmtp-pipelining"/></c>
<c>DSN</c><c><xref target="SMTP-DSN" dwdrfc-type='norm'/></c><c><xref target="esmtp-dsn"/></c>
<c>SIZE</c><c><xref target="SMTP-SIZE" dwdrfc-type='norm'/></c><c><xref target="esmtp-size"/></c>
<c>ENHANCEDSTATUSCODES</c><c><xref target="SMTP-STATUSCODES" dwdrfc-type='norm'/></c><c><xref target="esmtp-enhancedstatuscodes"/></c>
<c>STARTTLS</c><c><xref target="SMTP-TLS" dwdrfc-type='norm'/></c><c><xref target="esmtp-starttls"/></c>
<c>BURL imap</c><c><xref target="SMTP-BURL" dwdrfc-type='norm'/></c><c><xref target="fwd-main"/></c>
<c>BINARYMIME</c><c><xref target="SMTP-BINARYMIME" dwdrfc-type='norm'/></c><c><xref target="esmtp-fwd"/></c>
<c>CHUNKING</c><c><xref target="SMTP-BINARYMIME" dwdrfc-type='norm'/></c><c><xref target="esmtp-fwd"/></c>
<c>8BITMIME</c><c><xref target="SMTP-8BITMIME" dwdrfc-type='norm'/></c><c><xref target='SMTP-BURL'/></c>
<c>AUTH</c><c><xref target="SMTP-AUTH" dwdrfc-type='norm'/></c><c><xref target='SUBMIT' dwdrfc-type='norm'/></c>
</texttable>
<t><vspace blankLines='99'/></t>

</section>
<section title="Lemonade Message Stores">

<t>Lemonade Message Stores MUST provide a service as described in <xref target='IMAP' dwdrfc-type='norm'/>, and MUST support the following. Note that the Lemonade Profile imposes further requirements for some cases, detailed in the sections cited.</t>
   
<texttable>
<ttcol align="center">IMAP extension</ttcol>
<ttcol align="center">Reference</ttcol>
<ttcol align="center">Requirements</ttcol>
<c>NAMESPACE</c><c><xref target="IMAP-NAMESPACE" dwdrfc-type='norm'/></c><c><xref target="imap-mbox"/></c>
<c>CONDSTORE</c><c><xref target="IMAP-CONDSTORE" dwdrfc-type='norm'/></c><c><xref target="imap-condstore"/></c>
<c>STARTTLS</c><c><xref target="IMAP" dwdrfc-type='norm'/></c><c>-</c>
<c>URLAUTH</c><c><xref target="IMAP-URLAUTH" dwdrfc-type='norm'/></c><c><xref target="imap-fwd"/></c>
<c>CATENATE</c><c><xref target="IMAP-CATENATE" dwdrfc-type='norm'/></c><c><xref target="imap-fwd"/></c>
<c>URL-PARTIAL</c><c><xref target="url-partial" dwdrfc-type='norm'/></c><c><xref target="imap-fwd"/></c>
<c>UIDPLUS</c><c><xref target="IMAP-UIDPLUS" dwdrfc-type='norm'/></c><c><xref target="imap-fwd"/></c>
<c>LITERAL+</c><c><xref target="IMAP-LITERAL+" dwdrfc-type='norm'/></c><c><xref target="imap-other"/></c>
<c>IDLE</c><c><xref target="IMAP-IDLE" dwdrfc-type='norm'/></c><c><xref target="imap-idle"/></c>
<c>NOTIFY</c><c><xref target="IMAP-NOTIFY" dwdrfc-type='norm'/></c><c><xref target="imap-idle"/></c>
<c>$Forwarded keyword</c><c>-</c><c><xref target="imap-fwd-keyword"/></c>
<c>$PendingSubmission keyword</c><c>-</c><c><xref target="imap-submission-keywords"/></c>
<c>$BeingSubmitted keyword</c><c>-</c><c><xref target="imap-submission-keywords"/></c>
<c>BINARY</c><c><xref target="IMAP-BINARY" dwdrfc-type='norm'/></c><c><xref target="imap-bodypart"/></c>
<c>QRESYNC</c><c><xref target="IMAP-QRESYNC" dwdrfc-type='norm'/></c><c><xref target="imap-condstore"/></c>
<c>ENABLE</c><c><xref target="IMAP-ENABLE" dwdrfc-type='norm'/></c><c><xref target="imap-condstore"/></c>
<c>ESEARCH</c><c><xref target="IMAP-ESEARCH" dwdrfc-type='norm'/></c><c><xref target="imap-vfolder"/></c>
<c>CONTEXT=SEARCH</c><c><xref target="IMAP-CONTEXT" dwdrfc-type='norm'/></c><c><xref target="imap-vfolder"/></c>
<c>SORT</c><c><xref target="IMAP-SORT" dwdrfc-type='norm'/></c><c><xref target="imap-vfolder"/></c>
<c>ESORT</c><c><xref target="IMAP-CONTEXT" dwdrfc-type='norm'/></c><c><xref target="imap-vfolder"/></c>
<c>CONTEXT=SORT</c><c><xref target="IMAP-CONTEXT" dwdrfc-type='norm'/></c><c><xref target="imap-vfolder"/></c>
<c>CONVERT</c><c><xref target="IMAP-CONVERT" dwdrfc-type='norm'/></c><c><xref target="imap-bodypart"/></c>
<c>COMPRESS=DEFLATE</c><c><xref target="IMAP-COMPRESS" dwdrfc-type='norm'/></c><c><xref target="imap-compression"/></c>
<c>I18NLEVEL=1</c><c><xref target="IMAP-I18N" dwdrfc-type='norm'/></c><c><xref target="imap-other"/></c>
<c>SASL-IR</c><c><xref target="IMAP-SASL-IR" dwdrfc-type='norm'/></c><c><xref target="imap-other"/></c>
</texttable>

<t>In addition to this list, any Lemonade Message Stores MUST send the CAPABILITY
response code (see Section 7.1 of <xref target='IMAP' dwdrfc-type='norm'/>) in
the initial server greeting and after the LOGIN/AUTHENTICATE commands.</t>
	
<t><vspace blankLines='99'/></t>
</section>

	
<section title="Lemonade Message Delivery Agents">

<t>Lemonade Message Delivery Agents MUST support Sieve mail filtering language as described
in <xref target='SIEVE' dwdrfc-type='norm'/>, and MUST support the following Sieve extensions.
Lemonade Message Delivery Agents MUST also support Sieve script management using the
<xref target='MANAGE-SIEVE' dwdrfc-type='norm'/> protocol.
Note that the Lemonade Profile imposes further requirements for some cases, detailed in the
sections cited.</t>
   
<texttable>
<ttcol align="center">Sieve extension</ttcol>
<ttcol align="center">Reference</ttcol>
<ttcol align="center">Requirements</ttcol>
<c>VACATION</c><c><xref target="SIEVE-VACATION" dwdrfc-type='norm'/></c><c><xref target="sieve-mda"/></c>
<c>ENOTIFY</c><c><xref target="SIEVE-NOTIFY" dwdrfc-type='norm'/></c><c><xref target="sieve-mda"/></c>
<c>VARIABLES</c><c><xref target="SIEVE-VARIABLES" dwdrfc-type='norm'/></c><c><xref target="sieve-mda"/></c>
<c>RELATIONAL</c><c><xref target="SIEVE-RELATIONAL" dwdrfc-type='norm'/></c><c><xref target="sieve-mda"/></c>
<c>IMAP4FLAGS</c><c><xref target="SIEVE-IMAP4FLAGS" dwdrfc-type='norm'/></c><c><xref target="sieve-mda"/></c>
<c>comparator-i;unicode-casemap</c><c><xref target="UNICODE-CASEMAP" dwdrfc-type='norm'/></c><c><xref target="sieve-mda"/></c>

</texttable>
	
<t><vspace blankLines='99'/></t>
</section>
	
</section>

<section anchor="submit-gen" title="Lemonade Submission Servers">

   <t>All Lemonade Submission Servers implement the Mail Submission protocol described in <xref target='SUBMIT' dwdrfc-type='norm'/>, which is in turn a specific profile of <xref target='ESMTP'/>. Therefore any MUA designed to submit email via <xref target='SUBMIT' dwdrfc-type='norm'/> or <xref target='ESMTP'/> will interoperate with Lemonade Submission Servers.</t>
   
   <t>In addition, Lemonade Submission Servers implement
   the following set of SMTP and Submission extensions to increase message
   submission
   efficiency.</t>
   
<section anchor="esmtp-fwd" title="Forward Without Download">
   <t>In order to optimize network usage for the typical case where message content is copied to, or sourced from, the IMAP store, Lemonade provides support for a suite of extensions collectively known as Forward Without Download, discussed in detail in <xref target='fwd-main'/>.</t>
   
   <t>Lemonade Submission Servers MUST support the BURL <xref target="SMTP-BURL" dwdrfc-type='norm'/>,
   8BITMIME <xref target="SMTP-8BITMIME" dwdrfc-type='norm'/>, BINARYMIME <xref target="SMTP-BINARYMIME" dwdrfc-type='norm'/> and CHUNKING <xref target="SMTP-BINARYMIME" dwdrfc-type='norm'/>.</t>
   <t>BURL MUST support
   URLAUTH type URLs <xref target="IMAP-URLAUTH" dwdrfc-type='norm'/>, and thus MUST advertise the "imap"
   option following the BURL EHLO keyword (See <xref target="SMTP-BURL" dwdrfc-type='norm'/> for more details).</t>
</section>   
   
<section anchor="esmtp-pipelining" title="Pipelining">
   
   <t>Some clients regularly use networks with a relatively high latency, such as Mobile or Satellite based networks.
   Avoidance of round-trips within a transaction has a great advantage
   for the reduction in both bandwidth and total transaction time. For
   this reason Lemonade compliant mail submission servers MUST support
   the SMTP Service Extensions for Command Pipelining <xref target="SMTP-PIPELINING" dwdrfc-type='norm'/>.</t>
   
</section>
   
<section anchor="esmtp-dsn" title="DSN Support">
   
   <t>Lemonade compliant mail submission servers MUST support SMTP service
   extensions for delivery status notifications <xref target="SMTP-DSN" dwdrfc-type='norm'/>.</t>
   
</section>
   
<section anchor="esmtp-size" title="Message size declaration">

   <t>There is a distinct advantage in detecting failure cases as early as
   possible in many cases, such as where the user is charged per-octet, or
   where bandwidth is low. This is especially true of large message sizes.</t>
   
   <t>Lemonade Submission Servers MUST support the SMTP
   Service Extension for Message Size Declaration <xref target="SMTP-SIZE" dwdrfc-type='norm'/>.</t>
   
   <t>Lemonade Submission Servers MUST NOT consider a supplied message size to be acceptable without expanding all BURL parts.</t>
   
   <t>A Lemonade capable client SHOULD use message size declaration. In
   particular the client MUST NOT send a message to a mail submission server,
   if it knows that the message exceeds the maximal message size
   advertised by the submission server.
   When including a message size in the MAIL FROM command, the client
   MUST use a value that is at least as large as the size of the assembled message data
   after resolution of all BURL parts.
   </t>
   
</section>
   
<section anchor="esmtp-enhancedstatuscodes" title="Enhanced status code Support">
   
   <t>Lemonade compliant mail submission servers MUST support SMTP Service
   Extension for Returning Enhanced Error Codes <xref target="SMTP-STATUSCODES" dwdrfc-type='norm'/>. These allow a client to determine the precise cause of failure.</t>
   
</section>
   
<section anchor="esmtp-starttls" title="Encryption and Compression">
   
   <t>Lemonade Compliant mail submission servers MUST support SMTP Service
   Extension for Secure SMTP over TLS <xref target="SMTP-TLS" dwdrfc-type='norm'/>.</t>
   
   <t>Support for the DEFLATE compression method, as described in <xref target="TLS-COMP" dwdrfc-type='norm'/>, is RECOMMENDED.</t>
<t><vspace blankLines='99'/></t>
</section>
</section>

<section anchor="store-gen" title="Lemonade Message Stores">

<t>All Lemonade Message Stores implement Internet Message Access Protocol, as defined in <xref target='IMAP' dwdrfc-type='norm'/>. Therefore any MUA written to access messages using the facilities described in <xref target='IMAP' dwdrfc-type='norm'/> will interoperate with a Lemonade Message Store.</t>

<t>In addition, Lemonade Message Stores provide a set of extensions to address the limitations of some clients and networks.</t>
   
<section anchor="imap-condstore" title="Quick resynchronization">

   <t>Resynchronization is a costly part of an IMAP session, and mobile networks are generally more prone to unintended disconnection, which in turns makes this problem more acute. Therefore Lemonade Message Stores provide a suite of extensions to reduce the synchronization cost.</t>
   
   <t>Lemonade Compliant IMAP servers MUST support the CONDSTORE
   <xref target="IMAP-CONDSTORE" dwdrfc-type='norm'/>, the QRESYNC
   <xref target="IMAP-QRESYNC" dwdrfc-type='norm'/> and the ENABLE
   <xref target="IMAP-ENABLE" dwdrfc-type='norm'/> extensions.
   These allow a client to quickly resynchronize
   any mailbox by asking the server to return all flag changes and expunges
   that have occurred since a previously recorded state.
   This can also speed up client reconnect in case the transport layer is cut,
   whether accidentally or as part of a change in network.
   </t>
   
   <t><xref target="IMAP-SYNC-HOWTO"/> details how clients perform efficient mailbox resynchronization.</t>
   
</section>

<section anchor="imap-bodypart" title="Message part handling">

   <t>The handling of message parts, especially attachments, represents a set of challenges to limited devices, both in terms of the bandwidth used, and the capability of the device.</t>

   <t>Lemonade Compliant IMAP servers MUST support the BINARY
   <xref target="IMAP-BINARY" dwdrfc-type='norm'/> extension. This moves MIME body part decoding operations
   from the client to the server. The decoded data is always equal or less than
   the encoded representation, so this reduces bandwidth effectively.</t>
   
   <t><xref target="IMAP-BINARY" dwdrfc-type='norm'/> allows for servers to refuse to accept uploaded
   messages containing binary data, by not accepting the Binary
   content-transfer-encoding; however Lemonade Compliant IMAP servers SHALL always
   accept binary encoded MIME messages in APPEND commands for any folder.</t>
   
   <t><xref target="IMAP-CONVERT" dwdrfc-type='norm'/> MUST also be supported by servers, which
   allows clients to request conversions between media types, and allows for
   scaling images, etc. This provides the ability to view attachments (and
   sometimes body parts) without the facility to cope with a wide range of
   media types, or to efficiently view attachments.</t>

</section>

<section anchor="imap-compression" title="Compression">

   <t>The IETF has for some time generally agreed that compression is best handled at as low a level as possible, therefore Lemonade Message Stores SHOULD support the Deflate compression algorithm for TLS, as defined in <xref target="TLS-COMP" dwdrfc-type='norm'/>.</t>
   
   <t>However, the working group acknowledges that for many endpoints, this is a rarely deployed technology, and as such, Lemonade Message Stores MUST provide <xref target="IMAP-COMPRESS" dwdrfc-type='norm'/> support for fallback application-level stream compression, where TLS is not actively providing compression.</t>

</section>

<section anchor='notifications' title="Notifications">
<t>The addition of Server-to-client notifications ransforms the
    LEMONADE profile into an event-based synchronization protocol.
    Whenever an event occurs that interests the MUA, a
    notification can be generated.</t>
<t>If the MUA is connected to the IMAP server, inband notifications are
    generated using the facilities outlined in <xref target='imap-idle'/>.</t>
<t>When the MUA is not connected, the Notification filter generates a
    outband notification.  The notification filter may be considered as
    acting on a PUSH repository.</t>
<t>If the MUA is not connected, and outband notification is disabled,
    the client must perform a quick-sync on reconnect to determine
    mailbox changes, using the mechanisms outlined in <xref target="imap-condstore"/>.</t>
<section anchor="imap-idle" title="IMAP Notifications">
   <t>Lemonade Message Stores MUST support the IDLE <xref target="IMAP-IDLE" dwdrfc-type='norm'/>
   extension. The extension allows clients to receive unsolicited
   notifications about changes in the selected mailbox, without needing
   to poll for changes. The responses forming these notifications MUST be
   sent in a timely manner when such changes happen.</t>
   
   <t>Lemonade Message Stores also provide the NOTIFY extension described in <xref target="IMAP-NOTIFY" dwdrfc-type='norm'/>, which allows clients to request specific event types to be sent immediately to the client, both for the currently selected folder and others. Such event types include message delivery, and mailbox renames.</t>
</section>
<section anchor="outband-notify" title="External Notifications">
<t>Lemonade, and TCP, provide for long-lived idle connections between the client and mail store, allowing the server to
push notifications within IMAP.  Some mobile networks support dormancy, which shuts down the radio traffic channel
during idle periods to conserve handset and network resources, while maintaining IP and TCP state.  (See the
<xref target='LEMONADE-DEPLOYMENTS'/> document for more information.)</t>

<t>However, there are environments where the email client cannot remain active indefinitely, or where it is not advisable
(or even always possible) for TCP connections to the server to remain up while idle for extended periods.  In these
situations, a good user experience requires that when "interesting" events occur in the mail store, the client be
informed so that it can connect and resynchronize.  At an absolute minimum, this requires that at least the arrival of
new mail generate some sort of wake-up to the email client.  A number of vendors have implemented various
solutions to this.  As examples of what has been done, for many years (long pre-dating cellular handsets) the
technique described in <xref target="FINGER-HACK"/> has been supported. Today, a number of email vendors include facilities to send SMS
or other simple non-stream messages to clients on handsets when new mail arrives.  OMA has published a
mechanism that uses WAP PUSH to send a basic message containing a URL <xref target="OMA-EMN"/>.  The IETF is investigating
ways to standardize enhanced functionality in this area.</t>

<t>A "push email" user experience can be achieved using any number of techniques, ranging from always-on TCP
connectivity to the server and the NOTIFY extension described above, to OMA EMN, or even a non-standard trigger
message over SMS.  In any technique, the client learns of the existence of new mail, and decides to fetch information
about it, some part of it, or all of it, and then presents this to the user.</t>
</section>
</section>

<section anchor="imap-vfolder" title="Searching and View Filters">
   <t>Lemonade Message Stores MUST support the ESEARCH <xref target="IMAP-ESEARCH" dwdrfc-type='norm'/>
   extension. The extension allows clients to efficiently find the first or last messages,
   find a count of matching messages, and obtain a list of matching messages in a
   considerably more compact representation.</t>

<t>Lemonade Message Stores also provide a mechanism for clients to avoid handling an entire mailbox, instead accessing a view of the mailbox. This technique, common in many desktop clients as a client-side capability, is useful for constrained clients to minimize the quantity of messages and notification data.</t>

	<t>Lemonade Message Stores therefore MUST implement the CONTEXT=SEARCH, ESORT and
	CONTEXT=SORT extensions defined in <xref target='IMAP-CONTEXT'/>, as well as the SORT
	extension defined in <xref target='IMAP-SORT'/>.</t>	
	
</section>

<section anchor='imap-mbox' title="Mailbox Handling">
   <t>Lemonade Message Stores MUST support the NAMESPACE
   <xref target="IMAP-NAMESPACE" dwdrfc-type='norm'/> extension. The extension allows clients to discover
   shared mailboxes and mailboxes belonging to other users, and provide a normalized
   hierarchy view of the mailboxes available.</t>
   
   <t>Lemonade Message Stores MUST support the I18NLEVEL=&lt;n&gt; <xref target="IMAP-I18N" dwdrfc-type='norm'/> extension,
   with &lt;n&gt; having value 1 or 2. It adds support for non-English (internationalized) search and sort functions.
   (Note that I18NLEVEL=2 implies support for I18NLEVEL=1, so a Lemonade compliant client that make use of this extension
   MUST recognize either one.)</t>
	
</section>
<section anchor="imap-fwd" title="Forward Without Download">
   <t>In order to optimize network usage for the typical case where message content is copied to, or sourced from, the IMAP store, Lemonade provides support for a suite of extensions collectively known as Forward Without Download, discussed in detail in <xref target='fwd-main'/>.</t>
   
   <t>Lemonade Message Stores MUST support
   CATENATE <xref target="IMAP-CATENATE" dwdrfc-type='norm'/>,
   UIDPLUS <xref target="IMAP-UIDPLUS" dwdrfc-type='norm'/> and
   URLAUTH <xref target="IMAP-URLAUTH" dwdrfc-type='norm'/>.
   Lemonade Message Stores MUST also support URL-PARTIAL <xref target="url-partial" dwdrfc-type='norm'/>.
   </t>

	<section anchor="url-partial" title="Support for PARTIAL in CATENATE and URLAUTH">
		
		<t><xref target="IMAP-URL"/> introduced a new syntactic element for referencing
		a byte range of a message/body part. This is done using the ;PARTIAL= field.
		If an IMAP server supports PARTIAL in IMAP URL used in CATENATE and URLAUTH extensions,
		then it MUST advertise the URL-PARTIAL capability in the CAPABILITY response/response code.
		</t>
		
	</section>
	
</section>
<section anchor="imap-other" title="Additional IMAP extensions">
   
   <t>Lemonade Message Stores MUST support the LITERAL+ <xref target="IMAP-LITERAL+"/>
   extension. The extension allows clients to save a round trip each
   time a non-synchronizing literal is sent.</t>
   
   <t>Lemonade Message Stores MUST also implement the SASL-IR <xref target="IMAP-SASL-IR"/> extension, which allows clients to save a round trip during authentication, potentially pipelining the entire authentication sequence.</t>
   
   <t>Lemonade Compliant IMAP servers MUST support IMAP over TLS <xref target="IMAP"/>
   as required by <xref target="IMAP"/>. As noted above in <xref target="imap-compression"/>, servers SHOULD support the deflate compression
   algorithm for TLS, as specified in <xref target="TLS-COMP"/>.</t>

</section>
<section anchor="imap-fwd-keyword" title="Registration of $Forwarded IMAP keyword">
   
   <t>The $Forwarded IMAP keyword is used by several IMAP clients to
   specify that the marked message was forwarded to another email address,
   embedded within or attached to a new message. A mail client sets this
   keyword when it successfully forwards the message to another email
   address. Typical usage of this keyword is to show a different (or
   additional) icon for a message that has been forwarded. Once set the
   flag SHOULD NOT be cleared.</t>
   
   <t>Lemonade Message Stores MUST be able to store the $Forwarded
   keyword. They MUST preserve it on the COPY operation.  The servers
   MUST support the SEARCH KEYWORD $Forwarded.</t>
   
</section>

<section anchor="imap-submission-keywords" title="Registration of $PendingSubmission and $BeingSubmitted IMAP keywords">

   <t>The $PendingSubmission IMAP keyword designates the message as
   awaiting to be submitted. This keyword allows to store messages waiting
   to be submitted in the same mailbox where messages that were already
   submitted and/or being edited are stored. A mail client sets this keyword
   when it decides that the message needs to be sent out.
   When a client (it might be a different client from the one that decided that
   the message is pending submission) starts sending the message, it atomically clears
   the $PendingSubmission keyword and sets the $BeingSubmitted keyword.
   Once submission is successful, the $BeingSubmitted keyword is cleared.
   The two keywords allow to distinguish messages being actively submitted from
   messages awaiting to be submitted. They also allow to find all messages that
   were supposed to be submitted, if the client submitting them crashes or quits
   before submitting them.
   </t>

   <t>Lemonade Message Stores MUST be able to store the $PendingSubmission
   and the $BeingSubmitted keyword. Lemonade Message Stores MUST preserve
   them on the COPY operation.  The servers MUST support the
   SEARCH KEYWORD $PendingSubmission and SEARCH KEYWORD $BeingSubmitted.</t>
   
</section>
	
<section title="Related IMAP extensions">

	<t>This section is non-normative.</t>
	
	<t>Server implementations targeting to fulfil OMA MEM requirements <xref target="OMA-MEM-REQ"/>
	should consider implementing <xref target="IMAP-FILTERS"/>, which provides a way to persist
	definition of virtual mailboxes on the server.</t>
	
</section>
	
</section>
<section anchor="sieve-mda" title="Lemonade Message Delivery Agents">
    <t>Lemonade Message Delivery Agents MUST support the <xref target='SIEVE' dwd-rfctype='norm'/> filtering language at the point of delivery, allowing the user to control which messages are accepted, and where they are filed.</t>

	<t>Lemonade Message Delivery Agents MUST support the Sieve Vacation extension
	<xref target='SIEVE-VACATION' dwdrfc-type='norm'/>, which allows the client
	to setup an auto-responder, typically to report being on vacation (thus the name
	of the Sieve extension).</t>

	<t>Lemonade Message Delivery Agents MUST support the Sieve Enotify extension
	<xref target='SIEVE-NOTIFY' dwdrfc-type='norm'/>, which allows a Sieve script
	to generate notifications (such as XMPP, SIP or email) about received messages.</t>

	<t>Lemonade Message Delivery Agents MUST support the Sieve Variables extension
	<xref target='SIEVE-VARIABLES' dwdrfc-type='norm'/>, which adds support for variables
	to the Sieve scripting language. This extension is typically used with Sieve Enotify
	or Vacation to customize responses/notifications.</t>

	<t>Lemonade Message Delivery Agents MUST support the Sieve Relational extension
	<xref target='SIEVE-RELATIONAL' dwdrfc-type='norm'/>, which adds support for relational
	comparisons to the Sieve scripting language. This extension is typically used
	together with Sieve Enotify.</t>

	<t>Lemonade Message Delivery Agents MUST support the Sieve Imap4Flags extension
	<xref target='SIEVE-IMAP4FLAGS' dwdrfc-type='norm'/>, which allows a Sieve script
	to set IMAP flags/keywords when delivering a message to a mailbox. For example
	this can be used to automatically mark certain messages as interesting, urgent, etc.</t>

	<t>Lemonade Message Delivery Agents MUST support the i;unicode-casemap comparator in Sieve
	<xref target='UNICODE-CASEMAP' dwdrfc-type='norm'/>. The comparator allows for case-insensitive
	matching of Unicode characters.</t>

	<t>Lemonade Message Delivery Agents MUST support Sieve script management using the
	<xref target='MANAGE-SIEVE' dwdrfc-type='norm'/> protocol. They MUST also advertise
	in <xref target='MANAGE-SIEVE' dwdrfc-type='norm'/> all Sieve extensions listed in
	this section.</t>
	
</section>
<section anchor="client-main" title="Lemonade Mail User Agents">
    <t>Although all existing IMAP MUAs are Lemonade compliant in as much as all Lemonade services are based on the existing <xref target='IMAP'/> and <xref target='SUBMIT'/> protocols, client implementors are encouraged to take full advantage of the facilities provided by Lemonade Submission Servers and Lemonade Message Stores, as described in <xref target='submit-gen'/> and <xref target='store-gen'/> respectively.</t>
    
    <t>Note that the explicit usage of <xref target='SUBMIT'/> means that when opening a connection to the submission server, clients MUST do so using port 587 unless explicitly configured to use an alternate port. If the TCP connection to the submission server fails to open using port 587, the client MAY then immediately retry using a different port, such as 25. See <xref target='SUBMIT'/> information on why using port 25 is likely to fail depending on the current location of the client, and may result in a failure code during the SMTP transaction.</t>
    
    <t>In addition, some specifications are useful to support interoperable messaging with an enhanced user experience.</t>
    
    <t>Lemonade capable clients SHOULD support the Format and DelSp parameters to the text/plain media type described in <xref target="FLOWED" dwdrfc-type='norm'/>, and generate this format for messages.</t>
    
    <t>Lemonade capable clients SHOULD support, and use, the $Forwarded keyword described in <xref target='imap-fwd-keyword'/>.</t>
    
</section>

<section anchor="fwd-main" title="Forward without download">
<section title="Motivations">
<t>The advent of client/server email using the <xref target="IMAP"/> and <xref target="SUBMIT"/> protocols changed what formerly were local disk
   operations to become repetitive network data transmissions.</t>
<t>Lemonade "forward without download" makes use of the <xref target="SMTP-BURL"/>
   extension to enable access to external sources during the submission
   of a message.  In combination with the <xref target="IMAP-URLAUTH"/> extension,
   inclusion of message parts or even entire messages from the IMAP mail
   store is possible with a minimal trust relationship between the IMAP
   and SMTP SUBMIT servers.</t>
<t>Lemonade "forward without download" has the advantage of maintaining
   one submission protocol, and thus avoids the risk of having multiple
   parallel and possibly divergent mechanisms for submission. The client
   can use <xref target="SUBMIT"/> extensions without these being added to
   IMAP. Furthermore, by keeping the details of message submission in
   the SMTP SUBMIT server, Lemonade "forward without download" can work
   with other message retrieval protocols such as POP, NNTP, or whatever
   else may be designed in the future.</t>
</section>
<section title="Message Sending Overview">
<t>The act of sending an email message can be thought of as involving
   multiple steps: initiation of a new draft, draft editing, message
   assembly, and message submission.</t>
   
   <t>Initiation of a new draft and draft editing takes place in the MUA.
   Frequently, users choose to save more complex messages on an
   <xref target="IMAP"/> server (via the APPEND command with the \Draft flag) for
   later recall by the MUA and resumption of the editing process.</t>
   
   <t>Message assembly is the process of producing a complete message from
   the final revision of the draft and external sources.  At assembly
   time, external data is retrieved and inserted in the message.</t>
   
   <t>Message submission is the process of inserting the assembled message
   into the <xref target="ESMTP"/> infrastructure, typically using the <xref target="SUBMIT"/>
   protocol.</t>
</section>
<section title="Traditional Strategy">
<t>Traditionally, messages are initiated, edited, and assembled entirely
   within an MUA, although drafts may be saved to an <xref target="IMAP"/> server
   and later retrieved from the server.  The completed text is then
   transmitted to an MSA for delivery.</t>
<t>There is often no clear boundary between the editing and assembly
   process.  If a message is forwarded, its content is often retrieved
   immediately and inserted into the message text.  Similarly, when
   external content is inserted or attached, the content is usually
   retrieved immediately and made part of the draft.</t>
<t>As a consequence, each save of a draft and subsequent retrieve of the
   draft transmits that entire (possibly large) content, as does message
   submission.</t>
<t>In the past, this was not much of a problem, because drafts, external
   data, and the message submission mechanism were typically located on
   the same system as the MUA.  The most common problem was running out
   of disk quota.</t>
</section>
<section title="Step by step description">
<figure>
   <preamble>The model distinguishes between a Messaging User Agent (MUA), an
   IMAPv4Rev1 Server (<xref target="IMAP"/>) and a SMTP submit server (<xref target="SUBMIT"/>), as
   illustrated in Figure 1.</preamble>
<artwork><![CDATA[
      +--------------------+               +--------------+
      |                    | <------------ |              |
      |     MUA (M)        |               | IMAPv4Rev1   |
      |                    |               |  Server      |
      |                    | ------------> | (Server I)   |
      +--------------------+               +--------------+
             ^    |                              ^     |
             |    |                              |     |
             |    |                              |     |
             |    |                              |     |
             |    |                              |     |
             |    |                              |     |
             |    |                              |     v
             |    |                        +--------------+
             |    |----------------------> |   SMTP       |
             |                             |   Submit     |
             |-----------------------------|   Server     |
                                           |  (Server S)  |
                                           +--------------+
]]></artwork>
<postamble>Figure 1:  Lemonade "forward without download"</postamble>
</figure>
   
   
   <t>Lemonade "forward without download" allows a Messaging User Agent to
   compose and forward an e-mail combining fragments that are located in
   an IMAP server, without having to download these fragments to the
   client.</t>
   
   <t>There are two ways to perform "forward without download" based on
   where the message assembly takes place.  The first uses extended
   APPEND command <xref target="IMAP-CATENATE"/> to edit a draft message in the message
   store and cause the message assembly on the IMAP server. This is most often used when a copy of the message is to be retained on the IMAP server, as discussed in <xref target='fcc-problem'/>.</t>
   
   <t>The second
   uses a succession of BURL and BDAT commands to submit and assemble
   through concatenation, message data from the client and external data
   fetched from the provided URL. The two subsequent sections provide
   step-by-step instructions on how "forward without download" is
   achieved.</t>
   
<section anchor="fwd-catenate" title="Message assembly using IMAP CATENATE extension">
   
   <t>In the <xref target="SMTP-BURL"/>/<xref target="IMAP-CATENATE"/> variant of the Lemonade "forward without
   download" strategy, messages are initially composed and edited within
   an MUA.  The <xref target="IMAP-CATENATE"/> extension to <xref target="IMAP"/> is then used to create
   the messages on the IMAP server by transmitting new text and
   assembling them. The UIDPLUS <xref target="IMAP-UIDPLUS"/> IMAP extension is used by the client
   in order to learn the UID of the created messages. Finally a
   <xref target="IMAP-URLAUTH"/> format URL is given to a <xref target="SUBMIT"/> server for submission
   using the BURL <xref target="SMTP-BURL"/> extension.</t>
   
   <t>The flow involved to support such a use case consists of:</t>
   <t>M: {to I -- Optional} The client connects to the IMAP server,
     optionally starts TLS (if data confidentiality is required),
     authenticates, opens a mailbox ("INBOX" in the example below) and
     fetches body structures (See <xref target="IMAP"/>).</t>
     
     <figure><preamble>Example:</preamble>
<artwork><![CDATA[
         M: A0051 UID FETCH 25627 (UID BODYSTRUCTURE)
         I: * 161 FETCH (UID 25627 BODYSTRUCTURE (("TEXT" "PLAIN"
             ("CHARSET" "US-ASCII") NIL NIL "7BIT" 1152 23)(
             "TEXT" "PLAIN" ("CHARSET" "US-ASCII" "NAME"
             "trip.txt")
             "<960723163407.20117h@washington.example.com>"
             "Your trip details" "BASE64" 4554 73) "MIXED"))
         I: A0051 OK completed
]]></artwork>
</figure>
     
      <t>M: {to I} The client invokes CATENATE (See <xref target="IMAP-CATENATE"/> for details
     of the semantics and steps) -- this allows the MUA to create
     messages on the IMAP server using new data combined with one or
     more message parts already present on the IMAP server.</t>
     
     <t>Note that the example for this step doesn't use the LITERAL+
     <xref target="IMAP-LITERAL+"/> extension. Without LITERAL+ the new message is
     constructed using 3 round-trips. If LITERAL+ is used, the new
     message can be constructed using one round-trip.</t>
     
<figure>
<artwork><![CDATA[
      M: A0052 APPEND Sent FLAGS (\Draft \Seen $MDNSent)
          CATENATE (TEXT {475}
      I: + Ready for literal data
      M: Message-ID: <419399E1.6000505@caernarfon.example.org>
      M: Date: Thu, 12 Nov 2004 16:57:05 +0000
      M: From: Bob Ar <bar@example.org>
      M: MIME-Version: 1.0
      M: To: foo@example.net
      M: Subject: About our holiday trip
      M: Content-Type: multipart/mixed;
      M:     boundary="------------030308070208000400050907"
      M:
      M: --------------030308070208000400050907
      M: Content-Type: text/plain; format=flowed
      M:
      M: Our travel agent has sent the updated schedule.
      M:
      M: Cheers,
      M: Bob
      M: --------------030308070208000400050907
      M:  URL "/INBOX;UIDVALIDITY=385759045/;
         UID=25627/;Section=2.MIME" URL "/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2" TEXT {44}
      I: + Ready for literal data
      M:
      M: --------------030308070208000400050907--
      M: )
      I: A0052 OK [APPENDUID 387899045 45] CATENATE Completed
]]></artwork>
</figure>
     
      <t>M: {to I} The client uses GENURLAUTH command to request a URLAUTH
     URL (See <xref target="IMAP-URLAUTH"/>).<vspace blankLines='0'/>
      I: {to M} The IMAP server returns a URLAUTH URL suitable for later
     retrieval with URLFETCH (See <xref target="IMAP-URLAUTH"/> for details of the semantics
     and steps).</t>
     
<figure>
<artwork>
      M: A0054 GENURLAUTH "imap://bob.ar@example.org/Sent;
         UIDVALIDITY=387899045/;uid=45;expire=2005-10-
         28T23:59:59Z;urlauth=submit+bob.ar" INTERNAL
      I: * GENURLAUTH "imap://bob.ar@example.org/Sent;
         UIDVALIDITY=387899045/;uid=45;expire=
         2005-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:91354a473744909de610943775f92038"
      I: A0054 OK GENURLAUTH completed
</artwork>
</figure>

      <t>M: {to S} The client connects to the mail submission server and
     starts a new mail transaction. It uses BURL to let the SMTP submit
     server fetch the content of the message from the IMAP server (See
     <xref target="IMAP-URLAUTH"/> for details of the semantics and steps -- this allows the
     MUA to authorize the SMTP submit server to access the message
     composed as a result of the CATENATE step). Note that the second
     EHLO command is required after a successful STARTTLS command.
     Also note that there might be a third required EHLO command if the
     second EHLO response doesn't list any BURL options. <xref target="fwd-chunking"/>
     demonstrates this.</t>
     
<figure>
<artwork><![CDATA[
      S: 220 owlry.example.org ESMTP
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL imap
      S: 250-CHUNKING
      S: 250-AUTH PLAIN
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250-STARTTLS
      S: 250 ENHANCEDSTATUSCODES
      M: STARTTLS
      S: 220 Ready to start TLS
      ...TLS negotiation, subsequent data is encrypted...
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL imap
      S: 250-CHUNKING
      S: 250-AUTH PLAIN
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250 ENHANCEDSTATUSCODES
      M: AUTH PLAIN aGFycnkAaGFycnkAYWNjaW8=
      S: 235 2.7.0 PLAIN authentication successful.
      M: MAIL FROM:<bob.ar@example.org>
      S: 250 2.5.0 Address Ok.
      M: RCPT TO:<foo@example.net>
      S: 250 2.1.5 foo@example.net OK.
      M: BURL imap://bob.ar@example.org/Sent;UIDVALIDITY=387899045/;
         uid=45/;urlauth=submit+bar:internal:
         91354a473744909de610943775f92038 LAST
]]></artwork>
</figure>
     
      <t>S: {to I} The mail submission server uses URLFETCH to fetch the
     message to be sent (See <xref target="IMAP-URLAUTH"/> for details of the semantics and
     steps. The so-called "pawn-ticket" authorization mechanism uses a
     URI which contains its own authorization credentials.).<vspace blankLines='0'/>
      I: {to S} Provides the message composed as a result of the
     CATENATE step).</t>
     
<figure>
     <preamble>Mail submission server opens IMAP connection to the IMAP server:</preamble>
     
<artwork>
      I: * OK [CAPABILITY IMAP4REV1 STARTTLS NAMESPACE LITERAL+
          CATENATE URLAUTH UIDPLUS CONDSTORE IDLE] imap.example.com
          IMAP server ready
      S: a000 STARTTLS
      I: a000 Start TLS negotiation now
      ...TLS negotiation, if successful - subsequent data
         is encrypted...
      S: a001 LOGIN submitserver secret
      I: a001 OK submitserver logged in
      S: a002 URLFETCH "imap://bob.ar@example.org/Sent;
         UIDVALIDITY=387899045/;uid=45/;urlauth=submit+bob.ar:
         internal:91354a473744909de610943775f92038"
      I: * URLFETCH "imap://bob.ar@example.org/Sent;
         UIDVALIDITY=387899045/;uid=45/;urlauth=submit+bob.ar:
         internal:91354a473744909de610943775f92038" {15065}
      ...message body follows...
      S: a002 OK URLFETCH completed
      I: a003 LOGOUT
      S: * BYE See you later
      S: a003 OK Logout successful
</artwork>
</figure>
     
     <t>Note that if the IMAP server doesn't send CAPABILITY response code
     in the greeting, the mail submission server must issue the
     CAPABILITY command to learn about supported IMAP extensions as
     described in <xref target="IMAP"/>.</t>
     
     <t>Also, if data confidentiality is not required the mail submission
     server may omit the STARTTLS command before issuing the LOGIN
     command.</t>
     
<figure>
      <preamble>S: {to M} Submission server assembles the complete message and if
     the assembly succeeds it returns OK to the MUA:</preamble>
<artwork>
      S: 250 2.5.0 Ok.
</artwork>
</figure>
     
<figure>
     <preamble>M: {to I} The client marks the message containing the forwarded attachment on the IMAP
     server.</preamble>
     
<artwork>
      M: A0053 UID STORE 25627 +FLAGS.SILENT ($Forwarded)
      I: * 215 FETCH (UID 25627 MODSEQ (12121231000))
      I: A0053 OK STORE completed
</artwork>
</figure>
     <t>Note: the UID STORE command shown above will only work if the
     marked message is in the currently selected mailbox; otherwise, it
     requires a SELECT. This command can be omitted, as it simply changes non-operational metadata not essential to client operations or interoperability.
     The untagged FETCH response is due to <xref target="IMAP-CONDSTORE"/>.
     The $Forwarded IMAP keyword is described in <xref target="imap-fwd-keyword"/>.</t>
</section>

   
<section anchor="fwd-chunking" title="Message assembly using SMTP CHUNKING and BURL extensions">
   
   <t>In the <xref target="IMAP-URLAUTH"/>/<xref target="SMTP-BURL"/> variant of the Lemonade "forward without
   download" strategy, messages are initially composed and edited within
   an MUA.  During submission <xref target="SUBMIT"/>, BURL <xref target="SMTP-BURL"/> and BDAT <xref target="SMTP-BINARYMIME"/>
   commands are used to create the messages from multiple parts. New
   body parts are supplied using BDAT commands, while existing body
   parts are referenced using <xref target="IMAP-URLAUTH"/> format URLs in BURL commands.</t>
   
   <t>The flow involved to support such a use case consists of:<vspace blankLines='0'/>
      M: {to I -- Optional} The client connects to the IMAP server,
     optionally starts TLS (if data confidentiality is required),
     authenticates, opens a mailbox ("INBOX" in the example below) and
     fetches body structures (See <xref target="IMAP"/>).</t>
     
<figure>
     <preamble>Example:</preamble>
<artwork><![CDATA[
         M: A0051 UID FETCH 25627 (UID BODYSTRUCTURE)
         I: * 161 FETCH (UID 25627 BODYSTRUCTURE (("TEXT" "PLAIN"
            ("CHARSET" "US-ASCII") NIL NIL "7BIT" 1152 23)(
            "TEXT" "PLAIN" ("CHARSET" "US-ASCII" "NAME"
            "trip.txt")
            "<960723163407.20117h@washington.example.com>"
            "Your trip details" "BASE64" 4554 73) "MIXED"))
         I: A0051 OK completed
]]></artwork>
</figure>
     
      <t>M: {to I} The client uses GENURLAUTH command to request URLAUTH
     URLs (See <xref target="IMAP-URLAUTH"/>) referencing pieces of the message to be
     assembled.<vspace blankLines='0'/>
      I: {to M} The IMAP server returns URLAUTH URLs suitable for later
     retrieval with URLFETCH (See <xref target="IMAP-URLAUTH"/> for details of the semantics
     and steps).</t>
     
<figure>
<artwork><![CDATA[
      M: A0054 GENURLAUTH "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar"
         INTERNAL "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar" INTERNAL
      I: * GENURLAUTH "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:A0DEAD473744909de610943775f9BEEF"
         "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:BEEFA0DEAD473744909de610943775f9"
      I: A0054 OK GENURLAUTH completed
]]></artwork>
</figure>

      <t>M: {to S} The client connects to the mail submission server and
     starts a new mail transaction. It uses BURL to instruct the SMTP
     submit server to fetch from the IMAP server pieces of the message
     to be sent (See <xref target="SMTP-BURL"/> for details of the semantics and steps).</t>
     <t>Note that the second EHLO command is required after a successful
     STARTTLS command. The third EHLO command is required if and only if
     the second EHLO response doesn't list any BURL options. See
      <xref target="fwd-catenate"/>
      for an example of submission where the third EHLO
     command/response is not present.</t>
     
<figure>
<artwork><![CDATA[
      S: 220 owlry.example.org ESMTP
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL
      S: 250-CHUNKING
      S: 250-AUTH DIGEST-MD5
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250-STARTTLS
      S: 250 ENHANCEDSTATUSCODES
      M: STARTTLS
      S: 220 Ready to start TLS
      ...TLS negotiation, subsequent data is encrypted...
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL
      S: 250-CHUNKING
      S: 250-AUTH DIGEST-MD5 CRAM-MD5 PLAIN EXTERNAL
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250 ENHANCEDSTATUSCODES
      M: AUTH PLAIN aGFycnkAaGFycnkAYWNjaW8=
      S: 235 2.7.0 PLAIN authentication successful.
      M: EHLO potter.example.org
      S: 250-owlry.example.com
      S: 250-8BITMIME
      S: 250-BINARYMIME
      S: 250-PIPELINING
      S: 250-BURL imap imap://imap.example.org
      S: 250-CHUNKING
      S: 250-AUTH DIGEST-MD5 CRAM-MD5 PLAIN EXTERNAL
      S: 250-DSN
      S: 250-SIZE 10240000
      S: 250 ENHANCEDSTATUSCODES
      M: MAIL FROM:<bob.ar@example.org> BODY=BINARY
      S: 250 2.5.0 Address Ok.
      M: RCPT TO:<foo@example.net>
      S: 250 2.1.5 foo@example.net OK.
      M: BDAT 475
      M: Message-ID: <419399E1.6000505@caernarfon.example.org>
      M: Date: Thu, 12 Nov 2004 16:57:05 +0000
      M: From: Bob Ar <bar@example.org>
      M: MIME-Version: 1.0
      M: To: foo@example.net
      M: Subject: About our holiday trip
      M: Content-Type: multipart/mixed;
      M:     boundary="------------030308070208000400050907"
      M:
      M: --------------030308070208000400050907
      M: Content-Type: text/plain; format=flowed
      M:
      M: Our travel agent has sent the updated schedule.
      M:
      M: Cheers,
      M: Bob
      M: --------------030308070208000400050907
      S: 250 2.5.0 OK
      M: BURL imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:A0DEAD473744909de610943775f9BEEF
      S: 250 2.5.0 OK
      M: BURL imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:BEEFA0DEAD473744909de610943775f9
      S: 250 2.5.0 OK
      M: BDAT 44 LAST
      M:
      M: --------------030308070208000400050907--
]]></artwork>
</figure>
     
      <t>S: {to I} The mail submission server uses URLFETCH to fetch the
     pieces of the message to be sent (See <xref target="SMTP-BURL"/> for details of the
     semantics and steps. The so-called "pawn-ticket" authorization
     mechanism uses a URI which contains its own authorization
     credentials.).<vspace blankLines='0'/>
      I: {to S} Returns the requested body parts.</t>
     
<figure>
     <preamble>Mail submission server opens IMAP connection to the IMAP server:</preamble>
     
<artwork>
      I: * OK [CAPABILITY IMAP4REV1 STARTTLS NAMESPACE LITERAL+
          CATENATE URLAUTH UIDPLUS CONDSTORE IDLE] imap.example.com
          IMAP server ready
      S: a001 LOGIN submitserver secret
      I: a001 OK submitserver logged in
      S: a002 URLFETCH "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:A0DEAD473744909de610943775f9BEEF" "imap://
         bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:BEEFA0DEAD473744909de610943775f9"
      I: * URLFETCH "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2.MIME;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:A0DEAD473744909de610943775f9BEEF" {84}
      ...message section follows...
          "imap://bob.ar@example.org/INBOX;
         UIDVALIDITY=385759045/;UID=25627/;Section=2;
         expire=2006-10-28T23:59:59Z;urlauth=submit+bob.ar:
         internal:BEEFA0DEAD473744909de610943775f9" {15065}
      ...message section follows...
      S: a002 OK URLFETCH completed
      I: a003 LOGOUT
      S: * BYE See you later
      S: a003 OK Logout successful
</artwork>
</figure>
     
     <t>Note that if the IMAP server doesn't send CAPABILITY response code
     in the greeting, the mail submission server must issue the
     CAPABILITY command to learn about supported IMAP extensions as
     described in <xref target="IMAP"/>.</t>
     
     <t>Also, if data confidentiality is required the mail submission
     server should start TLS before issuing the LOGIN command.</t>
     
<figure>
      <preamble>S: {to M} Submission server assembles the complete message and if
     the assembly succeeds it acknowledges acceptance of the message by
     sending 250 response to the last BDAT command:</preamble>
<artwork>
      S: 250 2.5.0 Ok, message accepted.
</artwork>
</figure>
     
<figure>
     <preamble>M: {to I} The client marks the message containing the forwarded attachment on the IMAP
     server.</preamble>
     
<artwork>
      M: A0053 UID STORE 25627 +FLAGS.SILENT ($Forwarded)
      I: * 215 FETCH (UID 25627 MODSEQ (12121231000))
      I: A0053 OK STORE completed
</artwork>
</figure>
     
<t>
     Note: the UID STORE command shown above will only work if the
     marked message is in the currently selected mailbox; otherwise, it
     requires a SELECT. As in the previous example, this command is not critical, and can be omitted.
     The untagged FETCH response is due to <xref target="IMAP-CONDSTORE"/>.
     The $Forwarded IMAP keyword is described in <xref target="imap-fwd-keyword"/>.
</t>
</section>   
</section>
   
<section title="Security Considerations for pawn-tickets.">
   
   <t>The so-called "pawn-ticket" authorization mechanism uses a URI, which
   contains its own authorization credentials using <xref target="IMAP-URLAUTH"/>.  The
   advantage of this mechanism is that the SMTP submit <xref target="SUBMIT"/> server
   cannot access any data on the <xref target="IMAP-URLAUTH"/> server without a "pawn-
   ticket" created by the client.</t>
   
   <t>The "pawn-ticket" grants access only to the specific data that the
   SMTP submit <xref target="SUBMIT"/> server is authorized to access, can be revoked
   by the client, and can have a time-limited validity.</t>
   
   
</section>
<section title="Copies of Sent messages: The fcc problem" anchor='fcc-problem'>
   
   <t>The "fcc problem" refers to delivering a copy of a message to a mailbox, or "file carbon copy".  By far, the most common case of fcc is a
   client leaving a copy of outgoing mail in a "Sent Mail" or "Outbox"
   mailbox.</t>
   
   <t>In the traditional strategy, the MUA duplicates the effort spent in
   transmitting to the MSA by writing the message to the fcc destination
   in a separate step.  This may be a write to a local disk file or an
   APPEND to a mailbox on an IMAP server.  The latter is one of the "repetitive
   network data transmissions" which represents the "problem"
   aspect of the "fcc problem".</t>
   
   <t>The BURL <xref target="SMTP-BURL"/> extension can be used to eliminate
   the additional transmission. The final message is uploaded to the mailbox
   designed for outgoing mail, by the APPEND command of <xref target="IMAP"/>.
   Note that APPEND, including when enhanced by <xref target="IMAP-CATENATE"/>, can
   only create a
   single copy of the message and this is only of use on the server which stages the outgoing
   message for submission. Additional copies of the message on the same server can be
   created by using one or more COPY commands.</t>
   
</section>
   
</section>
   
<section title="Deployment Considerations">
<t>Deployment considerations are discussed extensively in <xref target='LEMONADE-DEPLOYMENTS'/>.</t>
</section>
        
<section title="Security Considerations">
   <t>Implementors are advised to examine the Security Considerations of all the referenced documents. This section merely highlights these, and advises implementors on specific issues relating to the combination of extensions.</t>
   
   <t>Security considerations on Lemonade "forward without download" are
   discussed throughout <xref target="fwd-main"/>. Additional security considerations
   can be found in <xref target="IMAP"/> and other documents describing other SMTP
   and IMAP extensions comprising the Lemonade Profile.</t>
   
   <t>Note that the mandatory-to-implement authentication mechanism for
   SMTP submission is described in <xref target="SMTP-AUTH"/>. The mandatory-to-implement
   authentication mechanism for IMAP is described in <xref target="IMAP"/>.</t>
   
<section title="Confidentiality Protection of Submitted Messages">
   
   <t>When clients submit new messages, link protection such as TLS guards
   against an eavesdropper seeing the contents of the submitted message.
   It is worth noting, however, that even if TLS is not used, the
   security risks are no worse if BURL is used to reference the text
   than if the text is submitted directly.  If BURL is not used, an
   eavesdropper gains access to the full text of the message.  If BURL
   is used, the eavesdropper may or may not be able to gain such access,
   depending on the form of BURL used.  For example, some forms restrict
   use of the URL to an entity authorized as a submission server or a
   specific user.</t>
  
</section>

<section title="TLS">
   
   <t>When Lemonade clients use the BURL extension to mail submission, an
   extension that requires sending a URLAUTH token to the mail
   submission server, such a token should be protected from interception
   to avoid a replay attack that may disclose the contents of the
   message to an attacker. TLS based encryption of the mail submission
   path will provide protection against this attack.</t>
   
   <t>Lemonade clients SHOULD use TLS-protected IMAP and mail submission
   channels when using BURL-based message submission to protect the
   URLAUTH token from interception.</t>
   
   <t>Lemonade compliant mail submission servers SHOULD use TLS-protected
   IMAP connections when fetching message content using the URLAUTH
   token provided by the Lemonade client.</t>
   
   <t>When a client uses SMTP STARTTLS to send a BURL command which
   references non-public information, there is a user expectation that
   the entire message content will be treated confidentially.  To meet
   this expectation, the message submission server should use STARTTLS
   or a mechanism providing equivalent data confidentiality when
   fetching the content referenced by that URL.</t>
   
</section>

<section title="Additional extensions and deployment models">
  <t> This specification provides no additional security measures beyond those in the 
		    referenced Internet Mail and Lemonade documents.</t>
		 <t> We note however the security risks associated to:
		 <list style="symbols">
		 	<t>Outband notifications</t>
		 	<t>Server configuration by client</t>
		 	<t>Client configuration by server</t>
		 	<t>Presence of proxy servers</t>
		 	<t>Presence of servers as intermediaries</t>
		 	<t>In general the deployment models considered by OMA MEM that are not conventional IETF deployment models.</t>
		 	<t>Measures to address a perceived need to traverse firewalls and mobile network intermediaries.</t>
        </list></t>
</section>
</section>
        
        <section title="IANA considerations">
			<t>
			IMAP4 capabilities are registered by publishing a standards track or 
			IESG approved experimental RFC.  The registry is currently located at 
			&lt;http://www.iana.org/assignments/imap4-capabilities&gt;. This document 
			defines the URL-PARTIAL IMAP capability <xref target="url-partial"/>.
			IANA is requested to add this extension to the IANA IMAP Capability registry.
			</t>
        </section>
        
        <section title="Version history">

		 <t><cref>This section will be converted to the "Changes Since RFC 4550" section
		 before publication.</cref></t>
			
         <t><list style="symbols">
	  <t> Version 10:
		  <list style='symbols'>
			  <t>Added ManageSieve.</t>
			  <t>Added a requirement to support i;unicode-casemap in Sieve (already required in IMAP).</t>
			  <t>Added description of various Sieve extensions.</t>
			  <t>Added definition of URL-PARTIAL IMAP extension.</t>
			  <t>Added definition of $PendingSubmission and $BeingSubmitted IMAP keywords.</t>
		  </list>
	  </t>

	  <t> Version 9:
		  <list style='symbols'>
			  <t>Updated references and removed extensions that there was an agreement to remove.</t>
		  </list>
	  </t>
			 
	  <t> Version 08: <list style='symbols'>
	  <t>Removed LIST-EXTENDED, WITHIN and QUICKSTART.</t>
	  <t>Updated names of required extensions when they were renamed (e.g. COMPARATOR ==> I18NLEVEL=1).</t>
	  </list>
	 </t>
			 
	  <t> Version 06: <list style='symbols'>
	  <t>Updated references and added extensions agreed at the Lemonade interim in Spring 2007.</t>
	  <t>Require any Lemonade compliant IMAP server to support CAPABILITY response code.</t>
	  </list>
	 </t>
			 
	  <t> Version 04: <list style='symbols'>
	  <t>Major reorganization of text.</t>
	  <t>Move checklist summary to beginning of document, collate Submission and Store server requirements.</t>
	  </list>
	 </t>
          <t> Version 03: <list style="symbols">
            <t> Replaced RECONNECT (server side quick reconned) with QRESYNC (client side quick reconnect)</t>
            <t> Added WITHIN and LIST-EXTENDED.</t>
            <t> Moved IDLE extension to a separate section.</t>
            <t> Added requirement for clients to use Format=flowed.</t>
		  </list></t>
          <t> Version 02: <list style="symbols">
            <t> Update of references and how they are displayed in the text (Comments from Randy Gellens)</t>
            <t> Update of list of extensions to support as MUST by the Lemonade Profile Bis</t>
            <t> Update of options for compression via placeholder imap-compression section describing compression requirements</t>
            <t> Update of support of TCP chalenged environments</t>
            <t> Update of support of object level encryption</t>
            <t> Clarified the use of $Forwarded in the examples, and demonstrated how to remove the \Draft flag from the sent message</t>
            <t> Clarified $Forwarded </t>
            <t> Added RECONNECT to imap-condstore section</t>
            <t> Add new section imap-bodypart, "Message part handling", describing BINARY and CONVERT requirements</t>
            <t> Added placeholder section for notifications</t>
            <t> Added various extensions to imap-other section, and added clarifying comments to IDLE, NAMESPACE, and a further references to TLS DEFLATE compression </t>
            <t> Added extension names to IMAP table</t>
            <t> Fixed all issues found with original Lemonade profile so far.</t>
           </list></t>
         <t> Version 01: <list style="symbols">
            <t> Lemonade profile has been introduced in-line, with some updates / corrections. </t>
            <t> Subsequent re-organization of the text</t>
            <t> Details of extensions proper to Lemonade Profile-bis have been updated to refer to the drafts newly accepted as WG IETF drafts.</t>
            <t> Addition of appendix on attachements streaming.</t>
           </list></t>
         <t> Version 00: <list style="symbols">
            <t>It evolved from a combination of the content 
		of Lemonade profile and the 
		OMA MEM realization internet draft.</t>
           </list></t>
           </list></t>
        </section>
        <section title="Acknowledgements">
            <t>The editors acknowledge and appreciate the work and comments of the IETF Lemonade
                working group and the OMA MEM working group. </t>
		<t>In particular, the editors would like to thank Eric Burger, Randall Gellens, Filip Navara, Zoltan Ordogh, Greg Vaudreuil, and Fan Xiaohui for their comments and reviews.</t>
        </section>
    </middle>
    <back>
        <references title="Normative References" dwdrfc-type='norm'>
<dwdrfc-ref anchor='SMTP-8BITMIME' src="bibxml/reference.RFC.1652"/>
<dwdrfc-ref anchor='SMTP-SIZE' src="bibxml/reference.RFC.1870"/>
<dwdrfc-ref anchor='SMTP-STATUSCODES' src="bibxml/reference.RFC.2034"/>
<dwdrfc-ref anchor='IMAP-LITERAL+' src="bibxml/reference.RFC.2088"/>
<dwdrfc-ref anchor='KEYWORDS' src="bibxml/reference.RFC.2119"/>
<dwdrfc-ref anchor='SMTP-PIPELINING' src="bibxml/reference.RFC.2920"/>
<dwdrfc-ref anchor='SMTP-AUTH' src="bibxml/reference.RFC.4954"/>
<dwdrfc-ref anchor='SMTP-BINARYMIME' src="bibxml/reference.RFC.3030"/>
<dwdrfc-ref anchor='IMAP-BINARY' src="bibxml/reference.RFC.3516"/>
<dwdrfc-ref anchor='SMTP-DSN' src="bibxml/reference.RFC.3461"/>
<dwdrfc-ref anchor='IMAP-UIDPLUS' src="bibxml/reference.RFC.4315"/>
<dwdrfc-ref anchor='IMAP-NAMESPACE' src="bibxml/reference.RFC.2342"/>
<dwdrfc-ref anchor='IMAP' src="bibxml/reference.RFC.3501"/>
<dwdrfc-ref anchor='IMAP-URLAUTH' src="bibxml/reference.RFC.4467"/>
<dwdrfc-ref anchor='SMTP-BURL' src="bibxml/reference.RFC.4468"/>
<dwdrfc-ref anchor='IMAP-CATENATE' src="bibxml/reference.RFC.4469"/>
<!-- <dwdrfc-ref anchor='TLS' src="bibxml/reference.RFC.2246"/> -->
<dwdrfc-ref anchor='TLS-COMP' src="bibxml/reference.RFC.3749"/>
<dwdrfc-ref anchor='SMTP-TLS' src="bibxml/reference.RFC.3207"/>
<dwdrfc-ref anchor='IMAP-IDLE' src="bibxml/reference.RFC.2177"/>
<dwdrfc-ref anchor='SUBMIT' src="bibxml/reference.RFC.4409"/>
<dwdrfc-ref anchor='IMAP-CONDSTORE' src="bibxml/reference.RFC.4551"/>
<dwdrfc-ref anchor='FLOWED' src="bibxml/reference.RFC.3676"/>

<dwdrfc-ref anchor='IMAP-I18N' src="bibxml3/reference.RFC.5255"/>
<dwdrfc-ref anchor='IMAP-ENABLE' src="bibxml3/reference.RFC.5161"/>
<dwdrfc-ref anchor='IMAP-QRESYNC' src="bibxml3/reference.RFC.5162"/>
<dwdrfc-ref anchor='IMAP-CONVERT' src="bibxml3/reference.I-D.ietf-lemonade-convert"/>
<!--CONVERT is soon to be:
<dwdrfc-ref anchor='IMAP-CONVERT' src="bibxml3/reference.RFC.5259"/>
-->
<dwdrfc-ref anchor='IMAP-NOTIFY' src="bibxml3/reference.I-D.ietf-lemonade-imap-notify"/>
<dwdrfc-ref anchor='IMAP-CONTEXT' src="bibxml3/reference.I-D.cridland-imap-context"/>
<!--CONTEXT is soon to be:
<dwdrfc-ref anchor='IMAP-CONTEXT' src="bibxml3/reference.RFC.5267"/>
-->
<dwdrfc-ref anchor='IMAP-SORT' src="bibxml3/reference.RFC.5256"/>

<!-- <dwdrfc-ref anchor='FIXME' src="bibxml3/reference.I-D.maes-lemonade-notifications-server-to-client"?> -->
<!-- <dwdrfc-ref anchor='MAIL-ARCH' src="bibxml3/reference.I-D.crocker-email-arch"/> -->
<dwdrfc-ref anchor='IMAP-COMPRESS' src="bibxml/reference.RFC.4978"/>
<dwdrfc-ref anchor='IMAP-ESEARCH' src="bibxml/reference.RFC.4731"/>
<dwdrfc-ref anchor='IMAP-SASL-IR' src="bibxml/reference.RFC.4959"/>
<dwdrfc-ref anchor='IMAP-URL' src="bibxml3/reference.RFC.5092"/>

<dwdrfc-ref anchor='SIEVE' src="bibxml/reference.RFC.5228"/>
<dwdrfc-ref anchor='SIEVE-VARIABLES' src="bibxml/reference.RFC.5229"/>
<dwdrfc-ref anchor='SIEVE-VACATION' src="bibxml/reference.RFC.5230"/>
<dwdrfc-ref anchor='SIEVE-RELATIONAL' src="bibxml/reference.RFC.5231"/>
<dwdrfc-ref anchor='SIEVE-IMAP4FLAGS' src="bibxml/reference.RFC.5232"/>			
<dwdrfc-ref anchor='SIEVE-NOTIFY' src="bibxml3/reference.I-D.ietf-sieve-notify"/>
<dwdrfc-ref anchor='MANAGE-SIEVE' src="bibxml3/reference.I-D.martin-managesieve"/>
<dwdrfc-ref anchor='UNICODE-CASEMAP' src="bibxml/reference.RFC.5051"/>

<!-- <reference anchor="OMAMEMrealization">
                <front>
                    <title>Realization of OMA Mobile Email (MEM) Architecture using Internet Mail</title>
                    <author initials="S. H." surname="Maes"/>
					<author initials="G. W." surname="Parsons"/>
                </front>
                <seriesInfo name="Internet-Draft"
                    value="draft-ietf-lemonade-oma-mem-realization-xx"/>
</reference> -->
</references>
<references title="Informative References" dwdrfc-type='inform'>
<dwdrfc-ref anchor='IMAP-SYNC-HOWTO' src="bibxml/reference.RFC.4549"/>
<!-- <dwdrfc-ref anchor='Lemonade-NOTCP' src="bibxml3/reference.I-D.maes-lemonade-tcp-challenged-environments"/> -->
<dwdrfc-ref anchor='LEMONADE-DEPLOYMENTS' src="bibxml3/reference.I-D.ietf-lemonade-deployments"/>
<dwdrfc-ref anchor='ESMTP' src="bibxml/reference.RFC.2821"/>
<dwdrfc-ref anchor='FINGER-HACK' src="bibxml/reference.RFC.4146"/>
<dwdrfc-ref anchor='IMAP-FILTERS' src="bibxml3/reference.I-D.melnikov-imapext-filters"/>
<reference anchor="OMA-EMN">
                <front>
                    <title>Open Mobile Alliance Email Notification Version 1.0</title>
                    <author surname="Open Mobile Alliance"><organization/></author>
                    <date month="August" year="2002"/>
                </front>
                <seriesInfo name="OMA" value="http://www.openmobilealliance.org/tech/docs/EmailNot/OMA-Push-EMN-V1_0-20020830-C.pdf"/>
                <format type="PDF"
                    target="http://www.openmobilealliance.org/tech/docs/EmailNot/OMA-Push-EMN-V1_0-20020830-C.pdf"/>
</reference>

<reference anchor="OMA-MEM-ARCH">
                <front>
                    <title>Mobile Email Architecture Document</title>
                    <author surname="Open Mobile Alliance"><organization/></author>
                    <date month="October" year="2005"/>
                </front>
                <seriesInfo name="OMA" value="(Work in Progress), http://www.openmobilealliance.org/"/>
                <format type="PDF"
                    target="http://www.openmobilealliance.org/"/>
</reference>
<reference anchor="OMA-MEM-REQ">
                <front>
                    <title>Mobile Email Requirements Document</title>
                    <author surname="Open Mobile Alliance"><organization/></author>
                    <date month="Oct" year="2005"/>
                </front>
                <seriesInfo name="OMA" value="http://www.openmobilealliance.org/release_program/docs/RD/OMA-RD-MobileEmail-V1_0_20051018-C.pdf"/>
                <format type="PDF"
                    target="http://www.openmobilealliance.org/release_program/docs/RD/OMA-RD-MobileEmail-V1_0_20051018-C.pdf"/>
</reference>
<!-- <dwdrfc-ref anchor='Lemonade-INTERMEDIATES' src="bibxml3/reference.I-D.smaes-lemonade-intermediary-challenges"/> -->
<!-- <dwdrfc-ref anchor='FIXME' src="bibxml/reference.RFC.2979"/> -->
</references>
    </back>
</rfc>
