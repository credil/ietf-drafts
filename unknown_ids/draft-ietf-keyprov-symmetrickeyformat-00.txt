KEYPROV Working Group                                 Sean Turner, IECA 
Internet Draft                             Russ Housley, Vigil Security 
Intended Status: Standard Track                         August 31, 2007 
Expires: February 28, 2008 
 
 
                                      
                    Symmetric Key Package Content Type 
               draft-ietf-keyprov-symmetrickeyformat-00.txt 


Status of this Memo 

   By submitting this Internet-Draft, each author represents that any 
   applicable patent or other IPR claims of which he or she is aware 
   have been or will be disclosed, and any of which he or she becomes 
   aware will be disclosed, in accordance with Section 6 of BCP 79. 

   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups.  Note that 
   other groups may also distribute working documents as Internet-
   Drafts. 

   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at any 
   time.  It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress." 

   The list of current Internet-Drafts can be accessed at 
   http://www.ietf.org/ietf/1id-abstracts.txt 

   The list of Internet-Draft Shadow Directories can be accessed at 
   http://www.ietf.org/shadow.html 

   This Internet-Draft will expire on February 28, 2008. 

Copyright Notice 

   Copyright (C) The IETF Trust (2007). 

Abstract 

   This document defines the symmetric key format content type.  It is 
   transport independent. The Cryptographic Message Syntax [RFC3852] can 
   be used to digitally sign, digest, authenticate, or encrypt this 
   content type. 


 
 
 
Turner & Housley       Expires February 28, 2008              [Page 1] 

Internet-Draft    Symmetric Key Package Content Type        August 2007 
    

Table of Contents 

   1. Introduction...................................................2 
      1.1. Requirements Terminology..................................2 
      1.2. ASN.1 Syntax Notation.....................................2 
   2. Symmetric Key Package Content Type.............................3 
   3. Security Considerations........................................4 
   4. IANA Considerations............................................4 
   5. References.....................................................4 
      5.1. Normative References......................................4 
      5.2. Non-Normative References..................................4 
   APPENDIX A: ASN.1 Module..........................................5 
    
1. Introduction 

   This document defines the symmetric key format content type.  It is 
   transport independent. The Cryptographic Message Syntax [RFC3852] can 
   be used to digitally sign, digest, authenticate, or encrypt this 
   content type. 

1.1. Requirements Terminology 

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
   document are to be interpreted as described in [RFC2119]. 

1.2. ASN.1 Syntax Notation 

   The key package is defined using the ASN.1 [X.680]. 


















 
 
Turner & Housley       Expires February 28, 2008              [Page 2] 

Internet-Draft    Symmetric Key Package Content Type        August 2007 
    

2. Symmetric Key Package Content Type 

   The symmetric key package content type is used to transfer one or 
   more plaintext symmetric keys from one party to another.  A symmetric 
   key package MAY be encapsulated in one or more CMS protecting content 
   types.  This content type must be DER encoded [X.690]. 

   The symmetric key package content type has the following syntax: 

     PKCS7-CONTENT-TYPE ::= TYPE-IDENTIFIER 

     symmetric-key-package PKCS7-CONTENT-TYPE ::= 
       { SymmetricKeyPackage IDENTIFIED BY id-ct-KP-sKeyPackage } 

     id-ct-KP-sKeyPackage OBJECT IDENTIFIER ::= | 
       { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9) 
         smime(16) ct(1) 25 } 

     SymmetricKeyPackage ::= SEQUENCE { 
       version          KeyPkgVersion DEFAULT v1, 
       sKeyPkgAtts  [0] SEQUENCE SIZE (1..MAX) OF Attribute OPTIONAL, 
       sKeys            SymmetricKeys } 

     SymmetricKeys ::= SEQUENCE SIZE (1..MAX) OF OneSymmetricKey 

     OneSymmetricKey ::= SEQUENCE { 
       sKeyAttrs  SEQUENCE SIZE (1..MAX) OF Attribute OPTIONAL, 
       sKey       OCTET STRING } 

     KeyPkgVersion ::= INTEGER  { v1(1), ... } 

   The SymmetricKeyPackage fields are used as follows: 

   - version identifies version of the symmetric key package content 
     structure.  For this version of the specification, the default 
     value, v1, MUST be used. 

   - sKeyPkgAttrs optionally provides attributes that apply to all of 
     the symmetric keys in the package.  If an attribute appears here it 
     MUST not also be included in sKeyAttrs. 

   - sKeys contains a sequence of OneSymmetricKey values.  This 
     structure is discussed below. 




 
 
Turner & Housley       Expires February 28, 2008              [Page 3] 

Internet-Draft    Symmetric Key Package Content Type        August 2007 
    

   The OneSymmetricKey fields are used as follows: 

   - sKeyAttrs optionally provides attributes that apply to one 
      symmetric key. If an attribute appears here it MUST not also be 
      included in sKeyPkgAttrs. 

   - sKey contains the key value encoded as an OCTET STRING. 

3. Security Considerations 

   The symmetric key package contents are not protected.  This content 
   type can be combined with a security protocol to protect the contents 
   of the package. 

4. IANA Considerations 

   None: All identifiers are already registered.  Please remove this 
   section prior to publication as an RFC. 

5. References 

5.1. Normative References 

   [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate 
   Requirement Levels", BCP 14, RFC 2119, March 1997. 

   [X.680] ITU-T Recommendation X.680: Information Technology - Abstract 
   Syntax Notation One, 1997. 

   [X.690] ITU-T Recommendation X.690 Information Technology - ASN.1 
   encoding rules: Specification of Basic Encoding Rules (BER), 
   Canonical Encoding Rules (CER) and Distinguished Encoding Rules 
   (DER), 1997. 

5.2. Non-Normative References 

   [RFC3852] Housley, R., "Cryptographic Message Syntax (CMS)", RFC3852, 
   July 2004. 









 
 
Turner & Housley       Expires February 28, 2008              [Page 4] 

Internet-Draft    Symmetric Key Package Content Type        August 2007 
    

APPENDIX A: ASN.1 Module 

   This appendix provides the normative ASN.1 definitions for the 
   structures described in this specification using ASN.1 as defined in 
   X.680. 

   SymmetricKeyPackageModulev1 
     { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9) 
       smime(16) modules(0) 33 } 

   DEFINITIONS IMPLICIT TAGS ::= 

   BEGIN 

   -- EXPORTS ALL  

   -- IMPORTS NOTHING 

     PKCS7-CONTENT-TYPE ::= TYPE-IDENTIFIER 

     KeyPackageContentTypes PKCS7-CONTENT-TYPE ::= { 
       symmetric-key-package | 
       ... -- Expect additional content types -- 
     } 

     symmetric-key-package PKCS7-CONTENT-TYPE ::= 
       { SymmetricKeyPackage IDENTIFIED BY id-ct-KP-sKeyPackage } 

     id-ct-KP-sKeyPackage OBJECT IDENTIFIER ::= 
       { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs9(9) 
         smime(16) ct(1) 25 } 

     SymmetricKeyPackage ::= SEQUENCE { 
       version           KeyPkgVersion DEFAULT v1, 
       sKeyPkgAttrs  [0] SEQUENCE SIZE (1..MAX) OF Attribute OPTIONAL, 
       sKeys             SymmetricKeys } 

     SymmetricKeys ::= SEQUENCE SIZE (1..MAX) OF OneSymmetricKey 

     OneSymmetricKey ::= SEQUENCE { 
       sKeyAttrs        SEQUENCE SIZE (1..MAX) OF Attribute OPTIONAL, 
       sKey             OCTET STRING } 

     KeyPkgVersion ::= INTEGER  { v1(1), ... } 



 
 
Turner & Housley       Expires February 28, 2008              [Page 5] 

Internet-Draft    Symmetric Key Package Content Type        August 2007 
    

     Attribute ::= SEQUENCE { 
       type          ATTRIBUTE.&id ({SupportedAttributes}), 
       values        SET SIZE (1..MAX) OF ATTRIBUTE.&Type 
                          ({SupportedAttributes}{@type}) } 

     SupportedAttributes ATTRIBUTE ::= { ... } 

     ATTRIBUTE ::= CLASS { 
       &derivation             ATTRIBUTE OPTIONAL, 
       &Type                   OPTIONAL, 
       -- either &Type or &derivation required 
       &equality-match         MATCHING-RULE OPTIONAL, 
       &ordering-match         MATCHING-RULE OPTIONAL, 
       &substrings-match       MATCHING-RULE OPTIONAL, 
       &single-valued          BOOLEAN DEFAULT FALSE, 
       &collective             BOOLEAN DEFAULT FALSE, 
       -- operational extensions 
       &no-user-modification   BOOLEAN DEFAULT FALSE, 
       &usage                  AttributeUsage DEFAULT userApplications, 
       &id                     OBJECT IDENTIFIER UNIQUE } 
     WITH SYNTAX { 
       [ SUBTYPE OF               &derivation ] 
       [ WITH SYNTAX              &Type ] 
       [ EQUALITY MATCHING RULE   &equality-match ] 
       [ ORDERING MATCHING RULE   &ordering-match ] 
       [ SUBSTRINGS MATCHING RULE &substrings-match ] 
       [ SINGLE VALUE             &single-valued ] 
       [ COLLECTIVE               &collective ] 
       [ NO USER MODIFICATION     &no-user-modification ] 
       [ USAGE                    &usage ] 
       ID                         &id } 

     MATCHING-RULE ::= CLASS { 
       &AssertionType             OPTIONAL, 
       &id                        OBJECT IDENTIFIER UNIQUE } 
     WITH SYNTAX { 
       [ SYNTAX                   &AssertionType ] 
       ID                         &id } 

     AttributeType ::= ATTRIBUTE.&id 

     AttributeValue ::= ATTRIBUTE.&Type 





 
 
Turner & Housley       Expires February 28, 2008              [Page 6] 

Internet-Draft    Symmetric Key Package Content Type        August 2007 
    

     AttributeUsage ::= ENUMERATED { 
       userApplications          (0), 
       directoryOperation        (1), 
       distributedOperation      (2), 
       dSAOperation              (3) } 

   END 

Editor's Address 

   Sean Turner 
   IECA, Inc. 

   Email: turners (at) ieca (dot) com 

   Russ Housley 
   Vigil Security 

   Email: housley (at) vigilsec (dot) com 




























 
 
Turner & Housley       Expires February 28, 2008              [Page 7] 

Internet-Draft    Symmetric Key Package Content Type        August 2007 
    

Full Copyright Statement 

   Copyright (C) The IETF Trust (2007). 

   This document is subject to the rights, licenses and restrictions 
   contained in BCP 78, and except as set forth therein, the authors 
   retain all their rights. 

   This document and the information contained herein are provided on an 
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND 
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS 
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF 
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 

Intellectual Property 

   The IETF takes no position regarding the validity or scope of any 
   Intellectual Property Rights or other rights that might be claimed to 
   pertain to the implementation or use of the technology described in 
   this document or the extent to which any license under such rights 
   might or might not be available; nor does it represent that it has 
   made any independent effort to identify any such rights.  Information 
   on the procedures with respect to rights in RFC documents can be 
   found in BCP 78 and BCP 79. 

   Copies of IPR disclosures made to the IETF Secretariat and any 
   assurances of licenses to be made available, or the result of an 
   attempt made to obtain a general license or permission for the use of 
   such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF on-line IPR repository at 
   http://www.ietf.org/ipr. 

   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights that may cover technology that may be required to implement 
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org. 

Acknowledgment 

   Funding for the RFC Editor function is provided by the IETF 
   Administrative Support Activity (IASA). 



 
 
Turner & Housley       Expires February 28, 2008              [Page 8] 

