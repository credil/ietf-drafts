<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM 'rfc2629.dtd'>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="no" ?>
<?rfc comments="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="no"?>
<?rfc sortrefs="no" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<?rfc notedraftinprogress="yes" ?>

<rfc category="info" docName="draft-izumikawa-sipping-sipbicast-01" ipr="full3978">

  <!-- category values: std, bcp, info, exp, and historic
     ipr values: full3667, noModification3667, noDerivatives3667
     you can add the attributes updates="NNNN" and obsoletes="NNNN" 
     they will automatically be output with "(if approved)" -->

  <!-- ***** FRONT MATTER ***** -->

  <front>

    <title abbrev="SIP Session Bi-casting">SIP-based Bicasting for Seamless Handover between
      Heterogeneous Networks</title>

    <author fullname="Haruki Izumikawa" initials="H" surname="Izumikawa">
      <organization>KDDI Labs</organization>

      <address>
        <postal>
          <street>2-1-15 Ohara</street>
          <city>Fujimino</city>
          <region/>
          <code>356-8502</code>
          <country>JP</country>
        </postal>

        <phone>+81-49-278-7866</phone>
        <email>izumikawa@kddilabs.jp</email>
      </address>
    </author>

    <author fullname="Ross Lillie" initials="R" surname="Lillie">
      <organization>Motorola Labs</organization>

      <address>
	<postal>
	  <street>1301 East Algonquin Road, IL02/2240</street>
	  <city>Schaumburg</city><region>IL</region>
	  <code>60196</code>
	  <country>US</country>
	</postal>
	<phone>+1 847 576 0012</phone>
	<email>ross.lillie@motorola.com</email>
	  
      </address>
    </author>

    <date year="2008"/>

    <!-- If the month and year are both specified and are the current ones, xml2rfc will fill 
         in the current day for you. If only the current year is specified, xml2rfc will fill 
	 in the current day and month for you. If the year is not the current one, it is 
	 necessary to specify at least a month (xml2rfc assumes day="1" if not specified for the 
	 purpose of calculating the expiry date).  With drafts it is normally sufficient to 
	 specify just the year. -->

    <!-- Meta-data Declarations -->

    <area>Real-time Applications and Infrastructure</area>

    <workgroup>SIPPING Working Group</workgroup>

    <!-- WG name at the upperleft corner of the doc,
         IETF is fine for individual submissions.  
	       If this element is not present, the default is "Network Working Group",
         which is used by the RFC Editor as a nod to the history of the IETF. -->

    <keyword>draft</keyword>
    <keyword>SIP</keyword>
    <keyword>session mobility</keyword>
    <keyword>vertical handoff</keyword>
    <keyword>media bi-casting</keyword>

    <abstract>
      <t>A vertical session handoff occurs in heterogeneous networks when a session media is moved
        between access networks within the same device. During session handoff, bi-casting media
        streams to both access networks of the session's device may be desirable to insure a
        seamless session handoff. This document describes the general methods and specifies the
        signaling and media flows for providing this service using the Session Initiation Protocol
          <xref target="SIP">(SIP)</xref>.</t>
    </abstract>
  </front>

  <middle>
    <section title="Overview">
      <t>A wide variety of access networks have emerged along with the popularization of
        fixed/mobile data communications. Nowadays, a user can access the Internet via several
        access networks using the same device. For example, the user may use both cellular and WLAN
        access as the situation demands within the same device such as a smartphone and a laptop,
        e.g. cellular access on the outside, WLAN access in the house or on the hotspot. This seems
        to be the trend for the foreseeable future, i.e. we'll be surrounded by a heterogeneous
        network where several access networks supplement each other. In such heterogeneous network
        environments, it is important that users utilize appropriate access network according to
        their location and enjoy their services, especially IP-based multimedia communications, with
        the optimal quality. In order to continue multimedia communications with the optimal
        quality, a Correspondent Node (CN) can change a destination and a communication quality by
        receiving the SIP re-INVITE or the SIP UPDATE message from a Mobile Node (MN) when the MN
        switches its point of attachment between access networks. However, a real-time service can
        be interrupted in this case due to the different characteristics, in the access networks,
        such as throughput and latency. As compared with non-realtime services such as web access
        and file-downloading, realtime multimedia services such as voice and video can suffer
        degradation in a user's experience when the service is interrupted. Therefore, it is also
        important to avoid service interruption during switchover a session media between access
        networks, i.e. vertical session handoff (HO). During session HO, bi-casting media streams to
        both access networks of the session's device are desirable to avoid the service disruption
        and insure a seamless session handoff. In addition, bi-casting media streams can also help
        adjust the service quality of the realtime service according to the new network of
        attachment.</t>

      <t>Since IP-based multimedia sessions are handled or controlled by Session Initiation Protocol
          <xref target="SIP">(SIP)</xref>, this document introduces the general methods and
        specifies the signaling and media flows for providing this service using SIP.</t>

      <t>This document introduces a SIP-capable network element named the Handovff Assistive Server
        (HOAS) which becomes a media stream bi-casting control point and is located between UAs
        (i.e. MN and CN). A number of plausible protocol flows are presented to utilize the services
        of the HOAS in a heterogeneous vertical handoff. This document does not describe the HOAS
        discovery process, which is beyond the scope of this document and best addressed using
        various user agent provisioning or service discovery mechanisms. </t>

      <t>In <xref target="requirements"/> the requirements and constraints for media stream
        bi-casting in a vertical handoff are enumerated. <xref target="architecture"/> introduces
        the architectural elements involved in a bi-casted vertical handoff. <xref
          target="protocolflows"/> presents two alternative methods for achieving vertical session
        handoff with media bi-casting using HOAS assistance.</t>

    </section>

    <section title="Terminology" anchor="terminology">

      <t>This section presents a few terms used throughout the document.</t>

      <t>
        <list style="symbols">
          <t>Vertical handoff: A vertical handoff refers to changing a mobile node's point of
            attachment between different types of access networks, e.g. cellular and WLAN. The
            feature of a vertical handoff is that the transmission rate and latency may well differ
            significantly before and after handoff, respectively. </t>

          <t>Bi-cast: Bi-cast refers to the splitting of a packet stream destined to a mobile node
            into two streams. A mobile node receives two streams simultaneously if the mobile node
            attaches the two systems at the same time. Bi-cast is shown to be effective in reducing
            packet loss during handoff. </t>
        </list>
      </t>

    </section>

    <section title="Requirements" anchor="requirements">
      <t> This section describes general requirements for media stream bi-casting in a vertical
        handoff scenario. </t>
      <t>
        <list style="symbols">
          <t>Media streams bi-casting should be realized to leverage current or emerging practices
            in the SIP. In other words, a new method or an extra header for media streams bi-casting
            should not be required. This document introduces some examples leveraging Third-Party
            Call Control <xref target="THIRD">(3PCC)</xref> and SIP's UPDATE <xref target="UPDATE"/>
            methods.</t>

          <t>Correspondent Node (CN) should be an basic User Agent (UA) which only has basic SIP
            capabilities to expand the range of application for the media streams bi-casting. </t>

          <t>If HOAS has the functionality of a transcoding service, the bi-casted streams can have
            respective service qualities according to respective access systems where the MN
            attaches. Transcoding combined with media stream bi-casting results in a service quality
            adjustment, improving the end-user mobile experience as in <xref target="IZUMIKAWA"/>,
            when performing a vertical handoff between the heterogeneous access networks. </t>

        </list>
      </t>
    </section>

    <section title="Architecture" anchor="architecture">
      <t>The assumed network architecture is illustrated in Figure 1. In this figure, AN1 and AN2
        represent alternate access networks available to the mobile node. For example, they could
        represent a cellular access network and a wireless LAN (WiFi). The HOAS represents the
        SIP-enabled Handoff Assistive Server. During a vertical handoff, between the mobile node's
        access networks, the preexisting bearer path between MN and CN is switched to pass through
        the HOAS during the duration of the vertical handoff. During this period of the handoff, the
        HOAS performs packet replication of the media streams sent by the CN destined to the MN, and
        bi-casts the replicated streams across both access networks available to the MN. In
        addition, if the HOAS is capable of performing media transcoding, the service quality of the
        bi-casted streams can be adjusted to match the capabilities of each of the MN's access
        networks. Traffic sent by the MN, destined to CN, may also be simultaneously transmitted
        across each access network, whereby the HOAS can discard the duplicated packets from the MN.</t>

      <t>Note that the CN could serve as the bi-casting service during a vertical handoff. However,
        this forces the CN to have both enhanced media and SIP signaling capabilities over and above
        those required by a basic SIP client. Requiring this added functionality within a client
        device would limit the applicability and deployment of seamless vertical HO techniques
        employing media bicasting. As such, the use of the CN to control the seamless handoff is
        beyond the scope of this document.</t>

      <figure align="center"
        title="Figure 1 - Mobile Node handoff across Heterogeneous Access Networks">
        <artwork><![CDATA[
                  +-------+
                  |  CN   |
                  +-------+
                      |
             +------------------+     +----+
             |    Internet      |-----|HOAS|
             |                  |     +----+
             +------------------+
               |              |
              /                \
             /                  \
 +------------------+       +-----------------+
 | AN1              |       | AN2             |
 |                  |       |                 |
 +------------------+       +-----------------+
              \                  /
               \                /
                \              /
                 \            /
                  +-------+
                  |  MN   |--> MH handoff from AN1 to AN2
                  +-------+   


                        |  Service area covered by AN2 |
                        +------------------------------+
|         Service area covered by AN1                     |
+---------------------------------------------------------+
]]>
        </artwork>

      </figure>

      <t>Finally, it should be noted that the solutions proposed in this memo assume that the
        coverage areas of the access networks AN1 and AN2 have some degree of overlap.</t>

    </section>

    <section title="Vertical Session handoff with Media Bi-casting" anchor="protocolflows">

      <t>Application layer mobility using SIP was examined in <xref target="SCHULZRINNE"/> through
        the use of both Third-Party Call Control <xref target="THIRD">(3PCC)</xref> as well as SIP's
        REFER <xref target="REFER"/> method as possible solutions. More recently, <xref
          target="SHACHAM"/> has expanded upon this work and demonstrated the suitability of
        employing either 3PCC or SIP's REFER request as suitable mechanisms for session mobility
        between mobile devices. Similarly, <xref target="THIRD">3PCC</xref> has been demonstrated in
          <xref target="TRANSCODE2"/> as the protocol mechanism usefull for establishing media
        transcoding services in a new or existing session.</t>

      <t>Although SIP mobility <xref target="SCHULZRINNE"/> and the session mobility <xref
          target="SHACHAM"/> can provide a terminal mobility or a session mobility through the use
        of 3PCC <xref target="THIRD"/> or SIP's REFER <xref target="REFER"/> method, there can be a
        service interruption during the hard swithing (handoff). Bi-cast in the uplink direction,
        i.e. from an MN to a CN, is studied using SIP <xref target="SALSANO"/>. But this scheme does
        not take account of the change in the service quality based on the access networks.
        Furthermore, it requires both an extra header field and a new parameter in the Via header
        field, which cannot satisfy the first requirement described in <xref target="requirements"
        />.</t>

      <t>As stated above, it is desirable to avoid service interruptions during a vertical session
        handoff between access networks with different service characteristics. Furthermore, it is
        desirable to adapt the session's service quality in accordance with the capability of the
        target access network of the handoff. Bi-casting media streams to both access networks with
        respective service quality optimization is and effective means to avoid service disruptions
        while simultaneously improving the end user's experience. This document introduces general
        methods and specifies the signaling and media flows for providing bi-cast support in
        vertical handoffs using the SIP protocol.</t>

      <!--
      <t>Due to the similarity of this prior work to the function of the HOAS in
      a heterogeneous vertical handoff, the following sections will examine
      the similarity of the protocols flows for HOAS assisted vertical handoffs
      to those for general session mobility as well as media transcoding.</t>
-->
      <!-- 1. Mobile Node controlled handoff -->

      <section title="Mobile Node controlled Vertical handoff" anchor="mobileHO">

        <t> The use of the Handoff Assistive Server (HOAS) to perform media stream bicasting during
          a vertical handoff is similar to session mobility support using Third-Party Call Control
          (3PCC) signaling conventions as originally proposed in <xref target="TRANSCODE1"/>, <xref target="SCHULZRINNE"/>
          and <xref target="TRANSCODE2"/>. Figure 2 illustrates the
          protocol signaling to enable Bi-casting/Transcoding support during a vertical handoff.</t>

        <figure align="center"
          title="Figure 2 - A MN controlled vertical handoff supporting media
          bi-casting">
          <artwork>
            <![CDATA[
        MN-AN1         MN-AN2         HOAS           CN
        |              |              |              |
        |              |              |              |
        |              |              |              |
        |(1) INVITE AN1 params        |              |
        |------------------------------------------->|
        |(2) 200 OK CN params         |              |
        |<-------------------------------------------|
        |(3) ACK       |              |              |
        |------------------------------------------->|
        |(4) RTP       |              |              |
        |............................................|
        |              |              |              |
Handover|              |              |              |
Begins  |              |              |              |
        |              |              |              |
        |(5) INVITE no SDP            |              |
        |------------------------------------------->|
        |(6) 200 OK CN params         |              |
        |<-------------------------------------------|
        |(7) INVITE no SDP            |              |
        |------------->|              |              |
        |(8) 200 OK MN-AN2 params     |              |
        |<-------------|              |              |
        |(9) INVITE AN1, AN2, CN params              |
        |---------------------------->|              |
        |(10) 200 OK HOAS params      |              |
        |<----------------------------|              |
        |(11) ACK      |              |              |
        |---------------------------->|              |
        |(12) ACK HOAS params         |              |
        |------------->|              |              |
        |(13) ACK HOAS params         |              |
        |------------------------------------------->|
        |              |              |(14) RTP      |
        |              |              |..............|
        |(15) RTP      |              |              |
        |.............................|              |
        |              |(16) RTP    . |              |
        |              |............  |              |
        |              |              |              |
        |              |              |              |
            ]]>
          </artwork>
        </figure>

        <t>The example shown in Figure 2 illustrates the signaling used in a typical vertical
          handoff employing media bi-casting. The signaling follows that specified in
          <!-- <xref
          target="rfc3725">RFC3725</xref> --> for Third-Party Call Control,
          with the MN acting as the session mediator.</t>

        <figure>
          <preamble>In this example, the initial session is established during the first SIP
            transaction comprised of messages 1 through 3. Initially, message 1 is sent from MN to
            CN as follows:</preamble>
          <artwork>
            <![CDATA[
            INVITE sip:CN@example.com SIP/2.0
            To: sip:CN@exmaple.com
            From: sip:MN@example.com; tag=dc2c13
            Call-ID: 858ec@example.com
            Contact: sip:MN@an1.example.net
            
            m=video 20002 RTP/AVP 96
            c=IN IP4 an1.example.net
            a=rtpmap:96 MP4V_ES/90000
            a=framerate:5
            b=AS:200
            ]]>
          </artwork>
        </figure>

        <figure>
          <preamble>The bandwidth is specified using bandwidth attribute defined in <xref
              target="SDP"/> and <xref target="CASNER"/> in this example. The returned response,
            message 2, includes the following session parameters for CN:</preamble>
          <artwork>
            <![CDATA[
            SIP/2.0 200 OK
            To: sip:CN@exmaple.com; tag=12aae
            From: sip:MN@example.com; tag=dc2c13
            Call-ID: 858ec@example.com
            Contact: sip:CN@cn.example.net
            
            m=video 40002 RTP/AVP 96
            c=IN IP4 cn.example.net
            a=rtpmap:96 MP4V_ES/90000
            a=framerate:5
            b=AS:200
            ]]>
          </artwork>
        </figure>

        <t>To initiate the vertical handover between access networks AN1 and AN2, the mobile sends a
          SIP Re-INVITE (5) to the correspondent node, CN, without a payload to determine the media
          capabilities of the CN. This information might be cached by the mobile node from a
          previous session establishment with the CN. The CN responds with a SIP response (6)
          containing a SDP packet indicating its capabilities. </t>

        <figure>
          <preamble>For example, the returned response and SDP payload might look as follows:</preamble>
          <artwork>
            <![CDATA[
            SIP/2.0 200 OK
            To: sip:CN@example.com;tag=12aae
            From: sip:MN@example.com;tag=dc2c13
            Call-ID: 858ec@example.com
            Contact: sip:CN@cn.example.net
            
            m=video 40002 RTP/AVP 96 97
            c=IN IP4 cn.example.net
            a=rtpmap:96 MP4V_ES/90000
            a=framerate:5
            b=AS:200
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            ]]>
          </artwork>
        </figure>

        <t>The MN then sends a SIP INVITE (7) to its interface on the access network to which the
          vertical handover is directed, to determine the media capabilities of the MN on this
          access network. In most instances, this message dialog will be eliminated, but is included
          here for clarity. </t>

        <figure>
          <preamble>In (8) the response and enclosed SDP payload describing the media capabilities
            on this access network might look as follows:</preamble>
          <artwork>
            <![CDATA[
            SIP/2.0 200 OK
            To: sip:MN@example.com;tag=dddf23
            From: sip:MN@example.com;tag=1dddef
            Call-ID: 18365@example.net
            Contact: sip:MN@an2.example.net
                                                
            m=video 50002 RTP/AVP 97
            c=IN IP4 an2.example.net
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
          ]]>
          </artwork>
        </figure>

        <figure>
          <preamble>In message 9, the MN establishes the session with the HOAS for media bi-casting
            and transcoding as follows:</preamble>
          <artwork>
            <![CDATA[
            INVITE sip:HOAS@example.com SIP/2.0
            To: sip:HOAS@exmaple.com
            From: sip:MN@example.com;tag=dfad122
            Call-ID: 32625@example.net
            Contact: sip:MN@an1.example.net
                        
            m=video 20004 RTP/AVP 96
            c=IN IP4 an1.example.net
            a=rtpmap:96 MP4V_ES/90000
            a=framerate:5
            b=AS:200
            m=video 50002 RTP/AVP 97
            c=IN IP4 an2.example.net
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            m=video 40004 RTP/AVP 97
            c=IN IP4 cn.example.net
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            ]]></artwork>
        </figure>

        <t>The HOAS returns an SDP packet generated by the HOAS and indicating its media handling
          capabilities for MN-AN1, MN-AN2 and CN (10). </t>

        <figure>
          <artwork>
            <![CDATA[
            SIP/2.0 200 OK
            To: sip:HOAS@example.com;tag=f1234ee
            From: sip:MN@example.com;tag=dfad122
            Call-ID: 32625@example.com
            Contact: sip:HOAS@hoas.example.com
            
            m=video 30000 RTP/AVP 96
            c=IN IP4 hoas.example.com
            a=rtpmap:96 MP4V_ES/90000
            a=framerate:5
            b=AS:200
            m=video 30002 RTP/AVP 97
            c=IN IP4 hoas.example.com
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            m=video 30004 RTP/AVP 97
            c=IN IP4 hoas.example.com
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            ]]>
          </artwork>
        </figure>

        <figure>
          <preamble>At this point the MN has established an active session with the HOAS for the
            purpose of bi-cast and transcoding support during the vertical handoff. However no media
            is yet exchanged through the HOAS. In (12) the MN establishes a session with it's second
            interface for the duration of the vertical handoff as follows:</preamble>
          <artwork>
            <![CDATA[
            ACK sip:MN@example.net SIP/2.0
            To: sip:MN@example.net;tag=dddf23
            From: sip:MN@example.net;tag=1dddef
            Call-ID: 18365@example.net
            Contact: sip:MN@an1.example.net
            
            m=video 30002 RTP/AVP 97
            c=IN IP4 hoas.example.com
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            ]]>
          </artwork>
        </figure>

        <figure>
          <preamble>Finally, MN acknowledges the re-INVITE used to probe the capabilities of the CN
            (5) with new session parameters within the body of the ACK (13) directing CN to direct
            it's outbound media to the HOAS as follows:</preamble>
          <artwork>
            <![CDATA[
            ACK sip:CN@example.com SIP/2.0
            To: sip:CN@example.com;tag=12aae
            From: sip:MN@example.com;tag=dc2c13
            Call-ID: 858ec@example.com
            Contact: sip:MN@an1.example.net
            
            m=video 30004 RTP/AVP 97
            c=IN IP4 hoas.example.com
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            ]]>
          </artwork>
        </figure>

        <t>At the completion of the handoff event, an INVITE/Replaces to the CN is required to
          establish the MN's new access network as the primary media path. In addition, the
          resources within the HOAS need to be released as well as the temporary session resources
          that exist between MN IF2 and the HOAS. This protocol sequence is illustrated in Figure 3.</t>

        <figure title="Figure 3 - Bi-cast Handoff Completion using 3PCC protocol flows">
          <artwork>
            <![CDATA[
       MN-AN1         MN-AN2          HOAS            CN
         |              |              |              |
         |              |              |              |
Handoff  |              |              |              |
Completed|              |              |              |
         |              |              |              |
         |              |(1) INVITE Replaces AN2 params
         |              |---------------------------->|
         |              |(2) 200 OK CN params         |
         |              |<----------------------------|
         |(3) BYE       |              |              |
         |<-------------------------------------------|
         |(4) 200 OK    |              |              |
         |------------------------------------------->|
         |(5) BYE       |              |              |
         |<-------------|              |              |
         |(6) 200 OK    |              |              |
         |------------->|              |              |
         |(7) BYE       |              |              |
         |---------------------------->|              |
         |(8) 200 OK    |              |              |
         |<----------------------------|              |
         |              |(9) ACK       |              |
         |              |---------------------------->|
         |              |(10) RTP      |              |
         |              |.............................|
         |              |              |              |
         |              |              |              |
            ]]></artwork>
        </figure>

        <figure>
          <preamble>In Figure 3, the INVITE (1) replaces the preexisting dialog between MN_AN1 and
            CN, adjusting the session parameters to remove the HOAS from the media paths. The INVITE
            has the following form: </preamble>
          <artwork>
            <![CDATA[
            INVITE sip:CN@example.com SIP/2.0
            To: sip:CN@example.com
            From: sip:MN@example.com;tag=dd14f3
            Replaces: 858ec@example.com; to=12aae; from=dc2c13
            Call-ID: 18325@example.com
            Contact: sip:MN@an2.example.net
            
            m=video 50004 RTP/AVP 97
            c=IN IP4 an2.example.net
            a=rtpmap:97 MP4V_ES/90000
            a=framerate: 15
            b=AS:600
            ]]>
          </artwork>
        </figure>

        <figure>
          <preamble>with CN responding in message 2 with the following:</preamble>
          <artwork>
            <![CDATA[
            SIP/2.0 200 OK
            To: sip:CN@example.com;tag=569ff1
            From: sip:MN@example.com;tag=dd14f3
            Replaces: 858ec@example.com; to=12aae; from=dc2c13
            Call-ID: 18325@example.com
            Contact: sip:CN@cn.example.net
            
            m=video 40004 RTP/AVP 97
            c=IN IP4 cn.example.net
            a=rtpmap:97 MP4V_ES/90000
            a=framerate: 15
            b=AS:600
            ]]>
          </artwork>
        </figure>

        <t>This cause CN to terminate the original session with MN_AN1 through a BYE request (3) and
          the corresponding response from MN_AN1 (4)</t>

        <t>The BYE requests, in messages 5 and 7 terminate the dialogs established between the MN
          and HOAS, as well as the dialog between the MN's access networks.</t>
      </section>

      <!-- 2. Proxy-mediated vertical handoff -->

      <section title="A B2BUA Mediated Vertical handoff via Session Update" anchor="b2buaHO">

        <t>In the next example, a vertical handoff is accomplished with the HOAS functioning as a
          B2BUA instantiated in the protocol signaling path. This approach requires that the HOAS is
          instantiated in the signaling path's route set. From the MN's perspective, for example,
          the HOAS could be configured as the user agent's outbound proxy. This protocol flow
          utilizes the SIP UPDATE <xref target="UPDATE"/> methods to redirect, through the HOAS,
          media streams between the CN and MN. Note that the SIP re-INVITE request could be utilized
          instead of the SIP UPDATE, however with the semantics defined for UPDATE requests, this
          method is preferred in a vertical handoff scenario.</t>

        <t>Since the HOAS is now acting as a B2BUA, it maintains state information related to each
          active session in which it is in the signaling path. This approach also, optionally,
          introduces new attributes to the related Session Description Protocol <xref target="SDP"
            >SDP</xref> payload to assist the HOAS in determining when the underlying media streams
          need to be routed through the HOAS bicasting function.</t>

        <t>A possible signaling flow for the HOAS B2BUA use case is illustrated in Figure 4. In the
          initial INVITE transaction, establishing the session dialog between the MN and CN, the
          HOAS adds itself to the dialog's route set via SIP's Record-Route header, thus insuring
          that all further signaling related to the session traverses the HOAS. In this sense, the
          HOAS B2BUA can be viewed as a SIP proxy.</t>

        <t>The format for the initial INVITE in message 1 is as follow:</t>

        <figure>
          <artwork>
            <![CDATA[
            INVITE sip:CN@example.com SIP/2.0
            To: sip:CN@example.com
            From: sip:MN@example.com;tag=33dfff
            Route: <hoas.example.com;lr>
            Contact: sip:MN@an1.example.net
            Call-ID: 41010@example.com
            
            ...
            ]]>
          </artwork>
        </figure>

        <t>Alternately, the MN UAC can be configured with the HOAS as it's outbound proxy. In this
          case, the HOAS processes the INVITE request by adding a Record-Route header to the
          forwarded request. This would appear in message 2 as follows:</t>

        <figure>
          <artwork>
            <![CDATA[
            INVITE sip:CN@example.com SIP/2.0
            To: sip:CN@example.com
            From: sip:MN@example.com;tag=33dfff
            Record_Route: <sip:hoas.example.com;lf>
            Contact: sip:MN@an1.example.net
            Call_ID: 41010@example.com
            
            ...
            ]]>
          </artwork>
        </figure>

        <figure title="Figure 4 - HOAS Mediated handoff">
          <artwork>
            <![CDATA[
            
       MN-AN1          MN-AN2          HOAS            CN
         |               |               |              |
         |               |               |              |
         |(1) INVITE AN1 params          |(2) INVITE AN1 parms
         |---------------|-------------->|------------->|
         |(3) RTP        |               |              |
         |<.............................................|
         |(5) 200 OK CN params           |(4) 200 OK    |
         |<------------------------------|<-------------|
         |(6) RTP        |               |              |
         |.............................................>|
         |(7) ACK        |               |(8) ACK       |
         |------------------------------>|------------->|
         |               |               |              |
Handover |               |               |              |
Begins   |               |               |              |
         |(9)UPDATE bicast AN1,AN2 params|(10)UPDATE HOAS/CN
         |------------------------------>|------------->|
         |(12) 200 AN1, AN2 params       |(11) 200 OK   |
         |<------------------------------|<-------------|
         |               | (14) RTP      |(13) RTP      |
         |<.............................>|<............>|
         |               | (15) RTP    . |              |
         |<............................  |              |
         |               |               |              |
Handover |               |               |              |
Completed|               |               |              |
         |               |(16) UPDATE    |(17) UPDATE   |
         |               |-------------->|------------->|
         |               |(19) 200 OK    |(18) 200 OK   |
         |               |<--------------|<-------------|
         |               |               |              |
            ]]>
          </artwork>
        </figure>

        <t>The UPDATE request in message 9 triggers the HOAS to configure the necessary resources
          for media bi-casting to the MN's access networks. This requires the HOAS to modify session
          parameters established with CN such that all media sent from CN destined to the MN is now
          redirected through the HOAS.</t>

        <t>Since the use of media bi-casting is specific to a particular session, a new
          session-level attribute, named 'bicast', is applied to the SDP packet describing the
          bi-cast flows for the MN. The HOAS uses the session level identifier as well as this new
          session level attribute to determine when bi-casting support is required.</t>

        <figure>
          <preamble>The format of the UPDATE request used to trigger bi-casting support within the
            HOAS is as follows:</preamble>
          <artwork>
            <![CDATA[
            UPDATE sip:CN@example.com SIP/2.0
            To: sip:CN@example.com;tag=aaab33
            From: sip:MN@example.com;tag=111565
            Route: <sip:hoas.example.com;lr>
            Call-ID: 5c3ee@example.com
            Contact: sip:MN@an1.example.net
            
            a=bicast
            m=video 30002 RTP/AVP 97
            c=IN IP4 an1.example.net
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            m=video 30004 RTP/AVP 96
            c=IN IP4 an2.example.net
            a=rtpmap:96 MP4V_ES/90000
            a=framerate:5
            b=AS:200
            ]]>
          </artwork>

        </figure>

        <t>where the bicast attribute is parsed by the HOAS and used to control its media handling
          behavior.</t>

        <t>As an alternative to introducing a new session level attribute to the SDP payload, the
          semantics that allows for grouping of media streams may be applied to the SDP packet (9),
          as described in <xref target="GROUP"/>. However, as stated in <xref target="GROUP"/>,
          "...An application that encodes the same media using different codecs simultaneously MUST
          NOT use FID to group those media lines..." In this case, new bicasting semantics are
          introduced by introducing a bicast-specific media group tag, BC (Bi-Cast), to extend <xref
          target="GROUP"/> as follows:</t>


        <artwork>
          <![CDATA[
            UPDATE sip:CN@example.com SIP/2.0
            To: sip:CN@example.com;tag=aaab33
            From: sip:MN@example.com;tag=111565
            Route: <sip:hoas.example.com;lr>
            Call-ID: 5c3ee@example.com
            Contact: sip:MN@an1.example.net
            
            a=group:BC 1 2
            m=video 30002 RTP/AVP 97
            c=IN IP4 an1.example.net
            a=rtpmap:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            a=mid:1
            m=video 30004 RTP/AVP 96
            c=IN IP4 an2.example.net
            a=rtpmap:96 MP4V_ES/90000
            a=framerate:5
            b=AS:200
            a=mid:2
            ]]>
        </artwork>

        <t>Upon receiving an UPDATE request with a session description requesting bi-casting
          support, the HOAS sends a corresponding UPDATE request (message 10) directing the CN to
          direct its media flows to the HOAS.</t>

        <figure>
          <preamble>The corresponding SDP packet simply establishes the HOAS as the recipient for
            all CN media:</preamble>
          <artwork>
            <![CDATA[
            m=video 30006 RTP/AVP 97
            c=IN IP4 hoas.example.net
            a=fmtp:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            ]]>
          </artwork>
        </figure>

        <figure>
          <preamble>In message 12, the MN's updated media streams are redirected through the HOAS:</preamble>
          <artwork>
            <![CDATA[
            m=video 40006 RTP/AVP 97
            c=IN IP4 hoas.example.net
            a=fmtp:97 MP4V_ES/90000
            a=framerate:15
            b=AS:600
            m=video 50006 RTP/AVP 96
            a=fmtp:96 MP4V_ES/90000
            a=framerate:5
            b=AS:200
            ]]>
          </artwork>
        </figure>

        <t>Upon completion of the handoff, the session streams must again be adjusted such that the
          HOAS is no longer part of the media path. In message 16, the session is again updated by
          the MN to eliminate bi-casting within the HOAS.</t>

        <figure>
          <preamble>The corresponding SDP packet describing the new session parameters again
            contains a session level attribute used to trigger the HOAS to stop bi-casting support.
            The SDP packet takes the following form:</preamble>
          <artwork>
            <![CDATA[
            c=IN IP4 an2.example.net
            ...
            ]]>
          </artwork>

        </figure>

        <t>The absense of the bicast attribute in this updated session description now directs the
          HOAS to pass the UPDATE request directly to the CN and signals the HOAS that all resources
          used to support bi-casting for the session handoff can be released.</t>

      </section>

    </section>

    <section anchor="IANA" title="IANA Considerations">
      <t>This memo includes no request to IANA.</t>

    </section>

    <section anchor="Security" title="Security Considerations">
      <t>A detailed analysis of the security aspects of the solutions proposed in this document
        needs to be performed to insure that no additional security issues have been introduced. As
        the solution leverages current practices for Third Party Call Control <xref target="THIRD"
          >(3PCC)</xref> as well as the use of SIP's UPDATE <xref target="UPDATE"/> method, the
        security considerations of these proposals can be extended to the solutions proposed
      herein.</t> The specifications of the 3pcc and the conferencing transcoding models discuss
      security issues directly related to the implementation of those models. Additionally, there
      are some considerations that apply to transcoding in general. In a session, a transcoder has
      access to at least some of the media exchanged between the endpoints. In order to avoid rogue
      transcoders getting access to those media, it is recommended that endpoints authenticate the
      transcoder. TLS [1] and S/MIME [8] can be used for this purpose. To achieve a higher degree of
      privacy, endpoints following the 3pcc transcoding model can use one transcoder in one
      direction and a different one in the other direction. This way, no single transcoder has
      access to all the media exchanged between the endpoints. The fact that transcoders need to
      access media exchanged between the endpoints implies that endpoints cannot use end-to-end
      media security mechanisms. Media encryption would not allow the transcoder to access the media
      and media integrity protection would not allow the transcoder to modify the media (which is
      obviously necessary to perform the transcoding function). Nevertheless, endpoints can still
      use media security between the transcoder and themselves. </section>

    <section title="Acknowledgements">
      <t>The authors would kindly like to thank Mr. Phil Roberts of Motorola Laboratories for his
        assistance in navigating the draft submission process as well as helping to coordinate the
        initial meetings that resulted in this draft submission.</t>
    </section>

  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <references title="Normative References">
      <reference anchor="SIP">

        <front>
          <title>SIP: Session Initiation Protocol</title>
          <author initials="J." surname="Rosenberg" fullname="J. Rosenberg">
            <organization/>
          </author>
          <author initials="H." surname="Schulzrinne" fullname="H. Schulzrinne">
            <organization/>
          </author>
          <author initials="G." surname="Camarillo" fullname="G. Camarillo">
            <organization/>
          </author>
          <author initials="A." surname="Johnston" fullname="A. Johnston">
            <organization/>
          </author>
          <author initials="J." surname="Peterson" fullname="J. Peterson">
            <organization/>
          </author>

          <author initials="R." surname="Sparks" fullname="R. Sparks">
            <organization/>
          </author>
          <author initials="M." surname="Handley" fullname="M. Handley">
            <organization/>
          </author>
          <author initials="E." surname="Schooler" fullname="E. Schooler">
            <organization/>
          </author>
          <date year="2002" month="June"/>
          <abstract>
            <t>This document describes Session Initiation Protocol (SIP), an application-layer
              control (signaling) protocol for creating, modifying, and terminating sessions with
              one or more participants. These sessions include Internet telephone calls, multimedia
              distribution, and multimedia conferences. [STANDARDS TRACK] </t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="3261"/>
        <format type="TXT" octets="647976" target="ftp://ftp.isi.edu/in-notes/rfc3261.txt"/>
      </reference>

      <reference anchor="SDP">

        <front>
          <title>SDP: Session Description Protocol</title>
          <author initials="M." surname="Handley" fullname="M. Handley">
            <organization/>
          </author>
          <author initials="V." surname="Jacobson" fullname="V. Jacobson">
            <organization/>
          </author>
          <author initials="C." surname="Perkins" fullname="C. Perkins">
            <organization/>
          </author>
          <date year="2006" month="July"/>
          <abstract>
            <t>This memo defines the Session Description Protocol (SDP). SDP is intended for
              describing multimedia sessions for the purposes of session announcement, session
              invitation, and other forms of multimedia session initiation. [STANDARDS TRACK]</t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="4566"/>
        <format type="TXT" octets="108820" target="ftp://ftp.isi.edu/in-notes/rfc4566.txt"/>
      </reference>

      <reference anchor="THIRD">

        <front>
          <title>Best Current Practices for Third Party Call Control (3pcc) in the Session
            Initiation Protocol (SIP)</title>
          <author initials="J." surname="Rosenberg" fullname="J. Rosenberg">
            <organization/>
          </author>
          <author initials="J." surname="Peterson" fullname="J. Peterson">
            <organization/>
          </author>
          <author initials="H." surname="Schulzrinne" fullname="H. Schulzrinne">
            <organization/>
          </author>
          <author initials="G." surname="Camarillo" fullname="Gonzalo Camarillo">
            <organization/>
          </author>
          <date year="2004" month="April"/>
          <abstract>

            <t>Third party call control refers to the ability of one entity to create a call in
              which communication is actually between other parties. Third party call control is
              possible using the mechanisms specified within the Session Initiation Protocol (SIP).
              However, there are several possible approaches, each with different benefits and
              drawbacks. This document discusses best current practices for the usage of SIP for
              third party call control. This document specifies an Internet Best Current Practices
              for the Internet Community, and requests discussion and suggestions for improvements.
            </t>
          </abstract>
        </front>

        <seriesInfo name="BCP" value="85"/>
        <seriesInfo name="RFC" value="3725"/>
        <format type="TXT" octets="77308" target="ftp://ftp.isi.edu/in-notes/rfc3725.txt"/>
      </reference>

      <reference anchor="REFER">
        <front>
          <title>The Session Initiation Protocol (SIP) Refer Method</title>
          <author initials="R." surname="Sparks" fullname="R. Sparks">
            <organization/>
          </author>
          <date year="2003" month="April"/>
          <abstract>
            <t>This document defines the REFER method. This Session Initiation Protocol (SIP)
              extension requests that the recipient REFER to a resource provided in the request. It
              provides a mechanism allowing the party sending the REFER to be notified of the
              outcome of the referenced request. This can be used to enable many applications,
              including call transfer. In addition to the REFER method, this document defines the
              refer event package and the Refer-To request header. [STANDARDS TRACK] </t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="3515"/>
        <format type="TXT" octets="47788" target="ftp://ftp.isi.edu/in-notes/rfc3515.txt"/>
      </reference>

      <reference anchor="CASNER">
        <front>
          <title>A Session Description Protocol (SDP) Bandwidth Modifiers for RTP Control Protocol
            (RTCP) Bandwidth</title>
          <author initials="S" surname="Casner" fullname="Stephen L. Casner">
            <organization/>
          </author>
          <date year="2003" month="July"/>
          <abstract>
            <t>This document specifies an Internet standards track protocol for the Internet
              community, and requests discussion and suggestions for improvements. Please refer to
              the current edition of the "Internet Official Protocol Standards" (STD 1) for the
              standardization state and status of this protocol. Distribution of this memo is
              unlimited. [STANDARDS TRACK] </t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="3556"/>
        <format type="TXT" octets="15310" target="ftp://ftp.isi.edu/in-notes/rfc3556.txt"/>
      </reference>

      <reference anchor="TRANSCODE1">
        <front>
          <title>Transcoding Services Invocation in the Session Initiation Protocol (SIP) Using
            Third Party Call Control (3pcc)</title>
          <author initials="G." surname="Camarillo" fullname="Gonzalo Camarillo">
            <organization/>
          </author>
          <author initials="E." surname="Burger" fullname="Eric Burger">
            <organization/>
          </author>
          <author initials="H." surname="Schulzrinne" fullname="Henning Schulzrinne">
            <organization/>
          </author>
          <author initials="A." surname="Wijk" fullname="Arnoud van Wijk">
            <organization/>
          </author>
          <date year="2005" month="June"/>
          <abstract>
            <t>This memo provides information for the Internet community. It does not specify an
              Internet standard of any kind. Distribution of this memo is unlimited.[Informational]
            </t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="4117"/>
        <format type="TXT" octets="37951" target="ftp://ftp.isi.edu/in-notes/rfc4117.txt"/>
      </reference>

      <reference anchor="GROUP">
        <front>
          <title>Grouping of Media Lines in the Session Description Protocol (SDP) </title>
          <author initials="G." surname="Camarillo" fullname="Gonzalo Camarillo">
            <organization/>
          </author>
          <author initials="J." surname="Holler" fullname="J. Holler">
            <organization/>
          </author>
          <author initials="H." surname="Schulzrinne" fullname="Henning Schulzrinne">
            <organization/>
          </author>
          <date year="2002" month="December"/>
          <abstract>
            <t>This document defines two Session Description Protocol (SDP) attributes: "group" and
              "mid". They allow to group together several "m" lines for two different purposes: for
              lip synchronization and for receiving media from a single flow (several media streams)
              that are encoded in different formats during a particular session, on different ports
              and host interfaces.[STANDARDS TRACK] </t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="3388"/>
        <format type="TXT" octets="39365" target="ftp://ftp.isi.edu/in-notes/rfc3388.txt"/>
      </reference>

      <!-- SIP Events current not referenced anywhere within the document.
   <reference anchor="EVENT">

        <front>
          <title>Session Initiation Protocol (SIP)-Specific Event Notification</title>
          <author initials="A.B." surname="Roach" fullname="A.B. Roach">
            <organization />
          </author>
          <date year="2002" month="June" />
          <abstract>
            <t>This document describes an extension to the Session Initiation Protocol (SIP). The purpose of this extension is to provide an extensible framework by which SIP nodes can request notification from remote nodes indicating that certain events have occurred. [STANDARDS TRACK] </t>
          </abstract>
        </front>
 
        <seriesInfo name="RFC" value="3265" />
        <format type="TXT" octets="89005"
          target="ftp://ftp.isi.edu/in-notes/rfc3265.txt" />
      </reference>
 -->

      <reference anchor="UPDATE">

        <front>
          <title>The Session Initiation Protocol (SIP) UPDATE Method</title>
          <author initials="J." surname="Rosenberg" fullname="J. Rosenberg">
            <organization/>
          </author>
          <date year="2002" month="October"/>
        </front>

        <seriesInfo name="RFC" value="3311"/>
        <format type="TXT" octets="28125" target="ftp://ftp.isi.edu/in-notes/rfc3311.txt"/>
      </reference>

    </references>

    <references title="Informative References">

      <reference anchor="IZUMIKAWA">
        <front>
          <title>User-centric Seamless Handover Scheme for Realtime Applications</title>
          <author initials="H" surname="Izumikawa" fullname="Haruki Izumikawa">
            <organization/>
          </author>
          <author initials="T" surname="Fukuhara" fullname="Tadayuki Fukuhara">
            <organization/>
          </author>
          <author initials="T" surname="Matsunaka" fullname="Takashi Matsunaka">
            <organization/>
          </author>
          <author initials="K" surname="Sugiyama" fullname="Keizo Sugiyama">
            <organization> KDDI R&amp;D Laboratories, Inc. </organization>
          </author>
          <date year="2007"/>
        </front>
        <seriesInfo
          name="IEEE Internation Symposium on Personal, Indoor and
          Mobile Radio Communications"
          value="(PIMRC'07)"/>
      </reference>

      <reference anchor="SCHULZRINNE">
        <front>
          <title>Application-Layer Mobility Using SIP</title>
          <author initials="H" surname="Schulzrinne">
            <organization/>
          </author>
          <author initials="E" surname="Wedlund">
            <organization/>
          </author>

          <date month="July" year="2000"/>
        </front>
        <seriesInfo name="ACM Mobile Computing and Communications Review" value="Vol.4, No.3"/>
      </reference>

      <reference anchor="SHACHAM">
        <front>
          <title>Session Initiation Protocol (SIP) Session Mobility</title>

          <author initials="R" surname="Shacham" fullname="Ron Shacham">
            <organization/>
          </author>

          <date month="November" day="18" year="2007"/>

          <abstract>
            <t>Session mobility is the transfer of media of an ongoing communication session from
              one device to another. This document describes the general methods and specifies the
              signaling and media flows for providing this service using the Session Initiation
              Protocol (SIP). Service discovery is essential to locate targets for session transfer
              and is discussed using the Service Location Protocol (SLP) as an example.</t>
          </abstract>

        </front>

        <seriesInfo name="Internet-Draft" value="draft-shacham-sipping-session-mobility-05"/>
        <format type="TXT"
          target="http://www.ietf.org/internet-drafts/draft-shacham-sipping-session-mobility-05.txt"
        />
      </reference>

      <reference anchor="TRANSCODE2">
        <front>
          <title>Framework for Transcoding with the Session Initiation Protocol (SIP)</title>

          <author initials="G" surname="Camarillo" fullname="Gonzalo Camarillo">
            <organization/>
          </author>

          <date month="December" day="1" year="2006"/>

          <abstract>
            <t>This document defines a framework for transcoding with SIP. This framework includes
              how to discover the need for transcoding services in a session and how to invoke those
              transcoding services. Two models for transcoding services invocation are discussed:
              the conference bridge model and the third party call control model. Both models meet
              the requirements for SIP regarding transcoding services invocation to support deaf,
              hard of hearing, and speech-impaired individuals.</t>
          </abstract>

        </front>

        <seriesInfo name="Internet-Draft" value="draft-ietf-sipping-transc-framework-05"/>
        <format type="TXT"
          target="http://www.ietf.org/internet-drafts/draft-ietf-sipping-transc-framework-05.txt"/>
      </reference>

      <reference anchor="SALSANO">
        <front>
          <title>A solution for vertical handover of multimedia sessions using SIP</title>
          <author initials="S" surname="Salsano" fullname="Stefano Salsano">
            <organization> Univ. of Rome Tor Vergata </organization>
          </author>
          <author initials="N" surname="Niccolini" fullname="Saverio Niccolini">
            <organization> NEC </organization>
          </author>
          <author initials="V" surname="Veltri" fullname="Luca Veltri">
            <organization> Univ. of Parma </organization>
          </author>
          <author initials="P" surname="Polidoro" fullname="Andrea Polidoro">
            <organization> Univ. of Rome Tor Vergata </organization>
          </author>
          <date month="August" day="28" year="2007"/>
          <abstract>
            <t>This document proposes a solution for handling vertical handovers among different
              network technologies using SIP, fulfilling a set of requirements discussed in the
              document "Requirements for vertical handover of multimedia sessions using SIP"
              (draft-niccolini-sipping-siphandover-01). The solution requires a new header field
              (named "Handover") and a new parameter in the Via header field (named "MMID").</t>
          </abstract>
        </front>
        <seriesInfo name="Internet-Draft" value="draft-salsano-sipping-siphandover-solution-01"/>
        <format type="TXT"
          target="http://www.ietf.org/internet-drafts/draft-salsano-sipping-siphandover-solution-01.txt"
        />
      </reference>

    </references>
  </back>

</rfc>
