


Network Working Group                                     P. Saint-Andre
Internet-Draft                                 XMPP Standards Foundation
Intended status: Informational                           October 2, 2007
Expires: April 4, 2008


 Interdomain Presence Scaling Analysis for the Extensible Messaging and
                        Presence Protocol (XMPP)
               draft-saintandre-xmpp-presence-analysis-01

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on April 4, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This document analyzes the scalability of presence sharing between
   domains that federate using the Extensible Messaging and Presence
   Protocol (XMPP).  This analysis is provided as a source of comparison
   with a similar analysis being performed regarding the presence
   extensions to the Session Initiation Protocol (SIP).





Saint-Andre               Expires April 4, 2008                 [Page 1]

Internet-Draft           XMPP Presence Analysis             October 2007


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Assumptions  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  Protocol Flows . . . . . . . . . . . . . . . . . . . . . . . .  5
   4.  Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . .  6
     4.1.  Constants  . . . . . . . . . . . . . . . . . . . . . . . .  7
     4.2.  Initial Messages . . . . . . . . . . . . . . . . . . . . .  7
     4.3.  Steady State Messages  . . . . . . . . . . . . . . . . . .  8
     4.4.  Termination Messages . . . . . . . . . . . . . . . . . . .  8
     4.5.  Bottom Line  . . . . . . . . . . . . . . . . . . . . . . .  9
   5.  Scenarios  . . . . . . . . . . . . . . . . . . . . . . . . . .  9
     5.1.  Basic  . . . . . . . . . . . . . . . . . . . . . . . . . .  9
     5.2.  Widely Distributed Inter-Domain Presence . . . . . . . . . 11
     5.3.  Very Large Network Peering . . . . . . . . . . . . . . . . 13
     5.4.  Intra-Domain Peering . . . . . . . . . . . . . . . . . . . 15
   6.  Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . 16
   7.  Security Considerations  . . . . . . . . . . . . . . . . . . . 17
   8.  Informative References . . . . . . . . . . . . . . . . . . . . 17
   Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . 18
   Intellectual Property and Copyright Statements . . . . . . . . . . 19






























Saint-Andre               Expires April 4, 2008                 [Page 2]

Internet-Draft           XMPP Presence Analysis             October 2007


1.  Introduction

   Presence is information about the network availability of an
   individual (or, more precisely, of a presence address of the kind
   that is often but not necessarily associated with an individual).  As
   typically designed and deployed, presence is shared only with
   authorized entities, where the authorization takes the form of a
   subscription.  (In this document, we employ the term "user" to
   signify an account that generates presence information and the term
   "contact" to signify an annount that is subscribed to the user's
   presence.)

   The sharing of presence information can result in a large volume of
   traffic as users log on or off throughout the life of a presence
   session, especially for users with large numbers of contacts (e.g.,
   the author of this document has over 1,500 contacts in his list of
   presence subscribers).  The volume is increased by communication of
   information beyond basic on-off network availability, such as
   availability substates (e.g., "away" and "do not disturb").  The
   volume is further increased if the presence "transport" is used to
   communicate information such as geolocation, mood, activity, even the
   music to which an individual is listening.  Such traffic may be a
   concern even in a standalone presence domain.  However, when presence
   is shared across domain boundaries then such traffic may introduce a
   more significant impact on the functioning of the Internet as a
   whole.  Therefore it is important to analyze the traffic generated
   during interdomain communication of presence information.

   There are several standardized technologies for sharing presence
   information.  One is a set of extensions (commonly called "SIMPLE")
   to the Session Initiation Protocol (SIP), where the base protocol is
   defined in [SIP] and the extensions are defined in [SIP-EVENT] and
   [SIP-PRES].  Another is the Extensible Messaging and Presence
   Protocol (XMPP) as defined in [XMPP-CORE] and [XMPP-IM].

   [PROBLEM] analyzes several factors regarding the scalability of
   interdomain communication of presence information using SIP/SIMPLE
   technologies.  For the sake of comparison, this document aims to
   provide a similar analysis regarding XMPP technologies.  In
   particular, this document focuses on traffic load exclusively since
   bandwidth usage has the greatest potential impact on the Internet.
   By contrast, issues such as state management and server processing of
   presence information are implementation-specific.  This document also
   briefly mentions existing methods for improving the scalability of
   XMPP presence (and presence-like) communications.






Saint-Andre               Expires April 4, 2008                 [Page 3]

Internet-Draft           XMPP Presence Analysis             October 2007


2.  Assumptions

   The model for XMPP presence subscriptions is different from that of
   SIP.  In particular, XMPP presence subscriptions are long-lived, and
   once established last until cancelled.  Thus XMPP does not have
   subscription timeouts and refresh periods as SIP presence does.  In
   addition, this document does not include presence subscriptions in
   its protocol flows since in XMPP they are preconditions for the
   exchange of presence notifications (in any case, the number of XML
   stanzas exchanged in the process of establishing a presence
   subscription is negligible compared to the volume of presence
   notifications).

   XMPP presence subscriptions are typically bidirectional (i.e., the
   contact has a subscription to the user's presence and the user has a
   subscription to the contact's presence).  However, because [PROBLEM]
   assumes that subscriptions are uni-directional (i.e., the contact has
   a subscription to the user's presence but not vice-versa), the same
   assumption is made herein.

   Although an XMPP user or contact may have multiple connected
   "resources" (e.g., client or device) at any one time, for the sake of
   simplification this document assumes that each entity has only one
   simultaneous resource.

   Note that, unlike in SIP, XMPP packets are not typically acknowledged
   with the equivalent of a 200/OK message.

   [PROBLEM] assumes that presence notification packets will typically
   be on the order of 3.5 kilobytes in size (not including TCP or UDP
   overhead).  XMPP presence notification packets tend to be much
   smaller than SIP presence notification packets; in this document we
   assume (based on deployment experience) that they are typically 200
   bytes in size for basic on-off presence.  However, some XMPP
   applications may include additional information in a presence
   notification packet, such as entity capabilities as described in
   [XEP-0115].

   Both [XMPP-CORE] and [XMPP-IM] strongly recommend that XMPP presence
   notifications should include only information that is relevant to a
   user's willingness or ability to communicate using real-time methods
   such as instant messaging.  However, some XMPP applications include
   information that is not communications-relevant, such as the hash of
   a user's avatar icon (see [XEP-0153] and even metadata about the
   music to which a user is listening (see [XEP-0118]).  Although it is
   recommended to communicate such information using the XMPP publish-
   subscribe extension (see [XEP-0060]) and appropriate profiles thereof
   (e.g., [XEP-0163]), some existing XMPP clients send non-



Saint-Andre               Expires April 4, 2008                 [Page 4]

Internet-Draft           XMPP Presence Analysis             October 2007


   communications-relevant information using presence notifications
   instead of dedicated publish-subscribe nodes.  Such behavior
   marginally increases notification size but can drastically increase
   the number of notifications sent (e.g., one notification every 3 or 4
   minutes when the user begins listening to a new music track).  This
   document does not discuss such usage, since it is actively
   discouraged and borders on abusive.

   This document does not discuss various optimizations for SIMPLE (for
   which see [PROBLEM]) or XMPP.  The primary deployed optimization for
   XMPP is stream compression, implemented either at the TLS level via
   native TLS compression or at the XMPP level where TLS compression is
   not available (see [XEP-0138]).  Because XMPP communications occur
   over long-lived TCP connections and associated long-lived XML
   streams, such compression has been found to yield significant
   bandwidth savings, up to 90% or even 95%.  Stream compression is
   therefore the recommended method for reducing bandwidth consumption
   in XMPP systems.


3.  Protocol Flows

   When a contact (in these examples romeo@example.net) becomes
   available, the contact's server sends an XMPP presence stanza of type
   "probe" to the user (in these examples juliet@example.com) on behalf
   of the contact, as shown in the following example (this can be seen
   as similar to the initial SUBSCRIBE in SIP presence):

   Contact's server sends presence probe to user (82 bytes):

   <presence
       from='romeo@example.net/orchard'
       to='juliet@example.com'
       type='probe'/>

   If the user's server determines that the contact is authorized to see
   the user's presence, the user's server return's the user's current
   presence state to the contact (this is equivalent to the "Initial
   NOTIFY" in SIP presence).












Saint-Andre               Expires April 4, 2008                 [Page 5]

Internet-Draft           XMPP Presence Analysis             October 2007


   User's server sends presence to contact (170 bytes):

   <presence
       from='juliet@example.com/balcony'
       to='romeo@example.net/orchard'
       xml:lang='en'>
     <show>away</show>
     <status>be right back</status>
     <priority>0</priority>
   </presence>

   If the user subsequently changes her presence, the user's server
   sends an updated presence notification to the contact.

   User's server sends updated presence to contact (160 bytes):

   <presence
       from='juliet@example.com/balcony'
       to='romeo@example.net/orchard'
       xml:lang='en'>
     <show>xa</show>
     <status>bbiab</status>
     <priority>0</priority>
   </presence>

   A presence session can include any number of presence changes.

   When the user goes offline, the user's server sends a presence stanza
   of type "unavailable" to the contact.

   User's server sends unavailable presence to contact (96 bytes):

   <presence
       from='juliet@example.com/balcony'
       to='romeo@example.net/orchard'
       type='unavailable'/>

   Naturally, similar protocol flows are generated by the contact during
   the life of his presence session.


4.  Analysis

   To enable valid comparison between SIMPLE and XMPP with regard to
   interdomain presence scaling, this document adheres as closely as
   possible to the analysis presented in [PROBLEM], with appropriate
   modifications given differences between the two technologies.  In
   particular, traffic calculations are based on the following inputs



Saint-Andre               Expires April 4, 2008                 [Page 6]

Internet-Draft           XMPP Presence Analysis             October 2007


   and formulae, where the numbering follows that in [PROBLEM] and the
   terminology is adjusted to conform to XMPP.

4.1.  Constants

   o  (C01) Presence session lifetime in hours -- assumed to be 8 hours.
   o  (C02) Presence state changes per hour -- assumed to be 3 times per
      hour.
   o  (C03) Subscription refresh interval per hour -- does not apply
      since XMPP presence subscriptions are long-lived.
   o  (C04) Total federated contacts per user -- varies based on the
      scenario under discussion.
   o  (C05) Number of dialogs to maintain per watcher -- does not apply
      to XMPP since XMPP presence subscriptions are long-lived, for
      purposes of calculation treated as equal to C04.
   o  (C06) Number of federated users -- varies based on the scenario
      under discussion.
   o  (C07) Subscription request size in bytes -- 100 bytes.
   o  (C08) Subscription approval size in bytes -- 100 bytes.
   o  (C09) Presence notification size in bytes -- 200 bytes.
   o  (C10) Presence notification ack size in bytes -- does not apply
      since XMPP presence notifications are not acked.
   o  (C11) Presence document size in bytes -- does not apply since XMPP
      presence notifications do not include presence documents.

4.2.  Initial Messages

   o  (I01) Number of initial subscribe requests per presence session --
      the XMPP equivalent is a presence probe, of which there is 1 per
      contact ( = C04 ), equal in size to a presence subscription
      request or approval (100 bytes).
   o  (I02) Number of initial subscription approvals per presence
      session -- does not apply since XMPP presence probes are not
      acked.
   o  (I03) Number of initial presence notifications -- 1 per contact (
      = C04 ).
   o  (I04) Number of initial presence acks -- does not apply since XMPP
      presence notifications are not acked.
   o  (I05) Total number and bytes of initial subscribe messages --
      Number = (I01*C06) and Bytes = (I01*C06*C07).
   o  (I06) Total number and bytes of initial subscribe acks -- Number =
      (I02*C06) and Bytes = (I02*C06*C07), both equal to zero since I02
      equals zero for XMPP.
   o  (I07) Total number and bytes of initial notifications -- Number =
      (I03*C06) and Bytes = (I03*C06*C09), note that this formula does
      not take into account optimizations of the kind discussed in
      [PROBLEM].




Saint-Andre               Expires April 4, 2008                 [Page 7]

Internet-Draft           XMPP Presence Analysis             October 2007


   o  (I08) Total number and bytes of initial notification acks --
      Number = (I04*C10) and Bytes = (I04*C06*C10), both equal to zero
      since I02 equals zero for XMPP.
   o  (I09) Total number and bytes of initial messages per presence
      session -- Number = (numbers in I05+I06+I07+I08) and Bytes =
      (bytes in I05+I06+I07+I08).

4.3.  Steady State Messages

   o  (S01) Presence notifications caused by state changes -- (C02*(C01
      - 2)).
   o  (S02) Notification acks for state change notifications -- zero
      since XMPP presence notifications are not acked.
   o  (S03) Number and size of presence notifications caused by state
      changes -- Number = (S01*C06*C04), Bytes = (S01*C06*C04)*(C09+C10+
      C11).
   o  (S04) Subscription refreshes -- zero since XMPP presence
      subscriptions are long-lived.
   o  (S05) Acks for subscription refreshes -- zero since there are no
      subscription refreshes in XMPP.
   o  (S06) Notify messages caused by subscription refreshes -- zero
      since there are no subscription refreshes in XMPP.
   o  (S07) Acks for notify messages caused by subscription refreshes --
      zero since there are no subscription refreshes in XMPP.
   o  (S08) Number and size of messages caused by subscription refreshes
      -- zero since there are no subscription refreshes in XMPP.
   o  (S09) Total number and bytes of steady-state messages per session
      -- Number = (numbers in S03+S08), Bytes = (bytes in S03+S08).

4.4.  Termination Messages

   o  (T01) Number of terminating subscribe messages -- zero since XMPP
      presence subscriptions are long-lived.
   o  (T02) Number of acks for terminating subscribe messages -- zero
      since there are no terminating subscribe messages in XMPP.
   o  (T03) Number of terminating notifications -- in XMPP this is
      unavailable presence sent when user goes offline = C05.
   o  (T04) Number of acks for terminating notifications -- zero since
      XMPP presence notifications are not acked.
   o  (T05) Total number and size of terminating subscribe messages --
      zero since there are no terminating subscribe messages in XMPP.
   o  (T06) Total number and size of acks for terminating subscribe
      messages -- zero since there are no terminating subscribe messages
      in XMPP.
   o  (T07) Total number and size of terminating notifications -- Number
      = (numbers in T03*C06), Bytes = (T03*C06*(C09+C11)).





Saint-Andre               Expires April 4, 2008                 [Page 8]

Internet-Draft           XMPP Presence Analysis             October 2007


   o  (T08) Total number and size of acks for terminating notifications
      -- zero since XMPP presence notifications are not acked.
   o  (T09) Total number and size of terminating messages per session --
      Number = (numbers in T05+T06+T07+T08), Bytes = (bytes in T05+T06+
      T07+T08).

4.5.  Bottom Line

   o  (B01) Total number and bytes per presence session = (I09+S09+T09).
   o  (B02) Total number and bytes per second = (B01/(C01*3600)).


5.  Scenarios

5.1.  Basic

   This scenario assumes two domains, each with 20,000 users, where each
   user has 4 contacts in the other domain and changes presence 3 times
   per hour during an 8-hour presence session.  The calculations are as
   follows.

   CONSTANTS
   (C01) Presence session lifetime (hours) ....................... 8
   (C02) Presence state changes per hour ......................... 3
   (C03) Subscription refresh interval per hour ................ N/A
   (C04) Total federated contacts per user ....................... 4
   (C05) Number of dialogs to maintain per watcher ............... 4
   (C06) Number of federated users .......................... 40,000
   (C07) Subscription request size in bytes .................... 100
   (C08) Subscription approval size in bytes ................... 100
   (C09) Presence notification size in bytes ................... 200
   (C10) Presence notification ack size in bytes ............... N/A
   (C11) Presence document size in bytes ....................... N/A

   INITIAL MESSAGES
   (I01) Initial subscribe requests per presence session ......... 4
   (I02) Initial subscription approvals per presence session ..... 0
   (I03) Number of initial presence notifications ................ 4
   (I04) Number of initial presence acks ......................... 0
   (I05) Total number and bytes of initial subscribe messages
               Number ...................................... 160,000
               Bytes  ................................... 16,000,000
   (I06) Total number and bytes of initial subscribe acks
               Number ............................................ 0
               Bytes ............................................. 0
   (I07) Total number and bytes of initial notifications
               Number ...................................... 160,000
               Bytes  ................................... 32,000,000



Saint-Andre               Expires April 4, 2008                 [Page 9]

Internet-Draft           XMPP Presence Analysis             October 2007


   (I08) Total number and bytes of initial notification acks
               Number ............................................ 0
               Bytes ............................................. 0
   (I09) Total number and bytes of initial messages
               Number ...................................... 320,000
               Bytes  ................................... 48,000,000

   STEADY STATE MESSAGES
   (S01) Presence notifications caused by state changes ......... 18
   (S02) Notification acks for state change notifications ........ 0
   (S03) Number and size of steady-state presence notifications
               Number .................................... 2,880,000
               Bytes ................................... 576,000,000
   (S04) Subscription refreshes .................................. 0
   (S05) Acks for subscription refreshes ......................... 0
   (S06) Notify messages caused by refreshes ..................... 0
   (S07) Acks for notify messages caused by refreshes ............ 0
   (S08) Number and size of messages caused by refreshes ......... 0
   (S09) Total number and bytes of steady-state messages
               Number .................................... 2,880,000
               Bytes ................................... 576,000,000

   TERMINATION MESSAGES
   (T01) Number of terminating subscribe messages ................ 0
   (T02) Number of acks for terminating subscribe messages ....... 0
   (T03) Number of terminating notifications ..................... 4
   (T04) Number of acks for terminating notifications ............ 0
   (T05) Total number and size of terminates
               Number ............................................ 0
               Bytes ............................................. 0
   (T06) Total number and size of acks for terminates
               Number ............................................ 0
               Bytes ............................................. 0
   (T07) Total number and size of terminating notifications
               Number ...................................... 160,000
               Bytes  ................................... 16,000,000
   (T08) Total number and size of acks for terminating notifications
               Number ............................................ 0
               Bytes ............................................. 0
   (T09) Total number and size of terminating messages per session
               Number ...................................... 160,000
               Bytes  ................................... 16,000,000

   BOTTOM LINE
   (B01) Total number and bytes per presence session
               Number .................................... 3,360,000
               Bytes  .................................. 640,000,000
   (B02) Total number and bytes per second



Saint-Andre               Expires April 4, 2008                [Page 10]

Internet-Draft           XMPP Presence Analysis             October 2007


               Number .......................................... 116
               Bytes  ....................................... 22,222

   For the bottom-line figures, the comparable numbers for SIMPLE in a
   non-optimized state (see [PROBLEM]) are 12,800,000 total messages,
   49,756,800,000 bytes, 444 messages per second, and 1,727,667 bytes
   per second; thus for this scenario XMPP uses 26% of the messages and
   1.3% of the bytes used by SIMPLE.

5.2.  Widely Distributed Inter-Domain Presence

   This scenario assumes two domains, each with 20,000 users, where each
   user has 20 contacts in the other domain and changes presence 3 times
   per hour during an 8-hour presence session.  The calculations are as
   follows.

   CONSTANTS
   (C01) Presence session lifetime (hours) ....................... 8
   (C02) Presence state changes per hour ......................... 3
   (C03) Subscription refresh interval per hour ................ N/A
   (C04) Total federated contacts per user ...................... 20
   (C05) Number of dialogs to maintain per watcher .............. 20
   (C06) Number of federated users .......................... 40,000
   (C07) Subscription request size in bytes .................... 100
   (C08) Subscription approval size in bytes ................... 100
   (C09) Presence notification size in bytes ................... 200
   (C09) Presence notification ack size in bytes ............... N/A
   (C11) Presence document size in bytes ....................... N/A

   INITIAL MESSAGES
   (I01) Initial subscribe requests per presence session ........ 20
   (I02) Initial subscription approvals per presence session ..... 0
   (I03) Number of initial presence notifications ............... 20
   (I04) Number of initial presence acks ......................... 0
   (I05) Total number and bytes of initial subscribe messages
               Number ...................................... 800,000
               Bytes  ................................... 80,000,000
   (I06) Total number and bytes of initial subscribe acks
               Number ............................................ 0
               Bytes ............................................. 0
   (I07) Total number and bytes of initial notifications
               Number ...................................... 800,000
               Bytes  .................................. 160,000,000
   (I08) Total number and bytes of initial notification acks
               Number ............................................ 0
               Bytes ............................................. 0
   (I09) Total number and bytes of initial messages
               Number .................................... 1,600,000



Saint-Andre               Expires April 4, 2008                [Page 11]

Internet-Draft           XMPP Presence Analysis             October 2007


               Bytes  .................................. 240,000,000

   STEADY STATE MESSAGES
   (S01) Presence notifications caused by state changes ......... 18
   (S02) Notification acks for state change notifications ........ 0
   (S03) Number and size of steady-state presence notifications
               Number ................................... 14,400,000
               Bytes ................................. 2,880,000,000
   (S04) Subscription refreshes .................................. 0
   (S05) Acks for subscription refreshes ......................... 0
   (S06) Notify messages caused by refreshes ..................... 0
   (S07) Acks for notify messages caused by refreshes ............ 0
   (S08) Number and size of messages caused by refreshes ......... 0
   (S09) Total number and bytes of steady-state messages
               Number ................................... 14,400,000
               Bytes ................................. 2,880,000,000

   TERMINATION MESSAGES
   (T01) Number of terminating subscribe messages ................ 0
   (T02) Number of acks for terminating subscribe messages ....... 0
   (T03) Number of terminating notifications .................... 20
   (T04) Number of acks for terminating notifications ............ 0
   (T05) Total number and size of terminates
               Number ............................................ 0
               Bytes ............................................. 0
   (T06) Total number and size of acks for terminates
               Number ............................................ 0
               Bytes ............................................. 0
   (T07) Total number and size of terminating notifications
               Number ...................................... 800,000
               Bytes  .................................. 160,000,000
   (T08) Total number and size of acks for terminating notifications
               Number ............................................ 0
               Bytes ............................................. 0
   (T09) Total number and size of terminating messages per session
               Number ...................................... 800,000
               Bytes  .................................. 160,000,000

   BOTTOM LINE
   (B01) Total number and bytes per presence session
               Number ................................... 16,800,000
               Bytes  ................................ 3,280,000,000
   (B02) Total number and bytes per second
               Number .......................................... 583
               Bytes  ...................................... 113,889

   For the bottom-line figures, the comparable numbers for SIMPLE in a
   non-optimized state (see [PROBLEM]) are 65,000,000 total messages,



Saint-Andre               Expires April 4, 2008                [Page 12]

Internet-Draft           XMPP Presence Analysis             October 2007


   248,784,000,000 bytes, 2,222 messages per second, and 8,638,333 bytes
   per second; thus for this scenario XMPP uses 26% of the messages and
   1.3% of the bytes used by SIMPLE.

5.3.  Very Large Network Peering

   This scenario assumes two domains, each with 10,000,000 users, where
   each user has 10 contacts in the other domain and changes presence 6
   times per hour during an 8-hour presence session.  The calculations
   are as follows.

   CONSTANTS
   (C01) Presence session lifetime (hours) ....................... 8
   (C02) Presence state changes per hour ......................... 3
   (C03) Subscription refresh interval per hour ................ N/A
   (C04) Total federated contacts per user ...................... 10
   (C05) Number of dialogs to maintain per watcher .............. 10
   (C06) Number of federated users ...................... 20,000,000
   (C07) Subscription request size in bytes .................... 100
   (C08) Subscription approval size in bytes ................... 100
   (C09) Presence notification size in bytes ................... 200
   (C09) Presence notification ack size in bytes ............... N/A
   (C11) Presence document size in bytes ....................... N/A

   INITIAL MESSAGES
   (I01) Initial subscribe requests per presence session ........ 10
   (I02) Initial subscription approvals per presence session ..... 0
   (I03) Number of initial presence notifications ............... 10
   (I04) Number of initial presence acks ......................... 0
   (I05) Total number and bytes of initial subscribe messages
               Number .................................. 200,000,000
               Bytes  ............................... 20,000,000,000
   (I06) Total number and bytes of initial subscribe acks
               Number ............................................ 0
               Bytes ............................................. 0
   (I07) Total number and bytes of initial notifications
               Number .................................. 200,000,000
               Bytes  ............................... 40,000,000,000
   (I08) Total number and bytes of initial notification acks
               Number ............................................ 0
               Bytes ............................................. 0
   (I09) Total number and bytes of initial messages
               Number .................................. 400,000,000
               Bytes  ............................... 60,000,000,000

   STEADY STATE MESSAGES
   (S01) Presence notifications caused by state changes ......... 18
   (S02) Notification acks for state change notifications ........ 0



Saint-Andre               Expires April 4, 2008                [Page 13]

Internet-Draft           XMPP Presence Analysis             October 2007


   (S03) Number and size of steady-state presence notifications
               Number ................................ 3,600,000,000
               Bytes ............................... 720,000,000,000
   (S04) Subscription refreshes .................................. 0
   (S05) Acks for subscription refreshes ......................... 0
   (S06) Notify messages caused by refreshes ..................... 0
   (S07) Acks for notify messages caused by refreshes ............ 0
   (S08) Number and size of messages caused by refreshes ......... 0
   (S09) Total number and bytes of steady-state messages
               Number ................................ 3,600,000,000
               Bytes ............................... 720,000,000,000

   TERMINATION MESSAGES
   (T01) Number of terminating subscribe messages ................ 0
   (T02) Number of acks for terminating subscribe messages ....... 0
   (T03) Number of terminating notifications .................... 10
   (T04) Number of acks for terminating notifications ............ 0
   (T05) Total number and size of terminates
               Number ............................................ 0
               Bytes ............................................. 0
   (T06) Total number and size of acks for terminates
               Number ............................................ 0
               Bytes ............................................. 0
   (T07) Total number and size of terminating notifications
               Number .................................. 200,000,000
               Bytes  ............................... 20,000,000,000
   (T08) Total number and size of acks for terminating notifications
               Number ............................................ 0
               Bytes ............................................. 0
   (T09) Total number and size of terminating messages per session
               Number .................................. 200,000,000
               Bytes  ............................... 20,000,000,000

   BOTTOM LINE
   (B01) Total number and bytes per presence session
               Number ................................ 4,200,000,000
               Bytes ............................... 800,000,000,000
   (B02) Total number and bytes per second
               Number ...................................... 145,833
               Bytes  ................................... 27,777,777

   For the bottom-line figures, the comparable numbers for SIMPLE in a
   non-optimized state (see [PROBLEM]) are 25,600,000,000 total
   messages, 99,348,000,000,000 bytes, 888,889 messages per second, and
   3,449,583,333 bytes per second; thus for this scenario XMPP uses 16%
   of the messages and 0.8% of the bytes used by SIMPLE.





Saint-Andre               Expires April 4, 2008                [Page 14]

Internet-Draft           XMPP Presence Analysis             October 2007


5.4.  Intra-Domain Peering

   This scenario assumes two domains, each with 60,000 users, where each
   user has 10 contacts in the other domain and changes presence 3 times
   per hour during an 8-hour presence session.  The calculations are as
   follows.

   CONSTANTS
   (C01) Presence session lifetime (hours) ....................... 8
   (C02) Presence state changes per hour ......................... 3
   (C03) Subscription refresh interval per hour ................ N/A
   (C04) Total federated contacts per user ...................... 10
   (C05) Number of dialogs to maintain per watcher .............. 10
   (C06) Number of federated users ......................... 120,000
   (C07) Subscription request size in bytes .................... 100
   (C08) Subscription approval size in bytes ................... 100
   (C09) Presence notification size in bytes ................... 200
   (C09) Presence notification ack size in bytes ............... N/A
   (C11) Presence document size in bytes ....................... N/A

   INITIAL MESSAGES
   (I01) Initial subscribe requests per presence session ........ 10
   (I02) Initial subscription approvals per presence session ..... 0
   (I03) Number of initial presence notifications ............... 10
   (I04) Number of initial presence acks ......................... 0
   (I05) Total number and bytes of initial subscribe messages
               Number .................................... 1,200,000
               Bytes  .................................. 120,000,000
   (I06) Total number and bytes of initial subscribe acks
               Number ............................................ 0
               Bytes ............................................. 0
   (I07) Total number and bytes of initial notifications
               Number .................................... 1,200,000
               Bytes  .................................. 240,000,000
   (I08) Total number and bytes of initial notification acks
               Number ............................................ 0
               Bytes ............................................. 0
   (I09) Total number and bytes of initial messages
               Number .................................... 2,400,000
               Bytes  .................................. 360,000,000

   STEADY STATE MESSAGES
   (S01) Presence notifications caused by state changes ......... 18
   (S02) Notification acks for state change notifications ........ 0
   (S03) Number and size of steady-state presence notifications
               Number ................................... 21,600,000
               Bytes ................................. 4,320,000,000
   (S04) Subscription refreshes .................................. 0



Saint-Andre               Expires April 4, 2008                [Page 15]

Internet-Draft           XMPP Presence Analysis             October 2007


   (S05) Acks for subscription refreshes ......................... 0
   (S06) Notify messages caused by refreshes ..................... 0
   (S07) Acks for notify messages caused by refreshes ............ 0
   (S08) Number and size of messages caused by refreshes ......... 0
   (S09) Total number and bytes of steady-state messages
               Number ................................... 21,600,000
               Bytes ................................. 4,320,000,000

   TERMINATION MESSAGES
   (T01) Number of terminating subscribe messages ................ 0
   (T02) Number of acks for terminating subscribe messages ....... 0
   (T03) Number of terminating notifications .................... 10
   (T04) Number of acks for terminating notifications ............ 0
   (T05) Total number and size of terminates
               Number ............................................ 0
               Bytes ............................................. 0
   (T06) Total number and size of acks for terminates
               Number ............................................ 0
               Bytes ............................................. 0
   (T07) Total number and size of terminating notifications
               Number .................................... 1,200,000
               Bytes  .................................. 240,000,000
   (T08) Total number and size of acks for terminating notifications
               Number ............................................ 0
               Bytes ............................................. 0
   (T09) Total number and size of terminating messages per session
               Number .................................... 1,200,000
               Bytes  .................................. 240,000,000

   BOTTOM LINE
   (B01) Total number and bytes per presence session
               Number ................................... 25,200,000
               Bytes ................................. 4,920,000,000
   (B02) Total number and bytes per second
               Number .......................................... 875
               Bytes  ...................................... 170,833

   For the bottom-line figures, the comparable numbers for SIMPLE in a
   non-optimized state (see [PROBLEM]) are 96,000,000 total messages,
   373,176,000,000 bytes, 3,333 messages per second, and 12,957,500
   bytes per second; thus for this scenario XMPP uses 26% of the
   messages and 1.3% of the bytes used by SIMPLE.


6.  Conclusion

   With respect to presence scaling, the differences between XMPP
   systems and SIP-based systems are startling.  In particular, this



Saint-Andre               Expires April 4, 2008                [Page 16]

Internet-Draft           XMPP Presence Analysis             October 2007


   analysis indicates that XMPP requires only about 1.5% of the
   bandwidth required by SIMPLE.  There are two primary causes for this
   disparity: (1) XMPP requires only about 25% of the packets required
   by SIMPLE and (2) XMPP packets are about 5% of the size of SIMPLE
   packets for presence notifications and 20% of the size for subscribe
   packets.  Together, these two factors appear to result in a
   significant disparity with respect to the scalability of presence
   technologies.  Naturally, real-world studies of deployed systems will
   be necessary to determine if these theorized differences occur in
   reality.


7.  Security Considerations

   This document introduces and addresses no security concerns above and
   beyond those already defined in [XMPP-CORE] and [XMPP-IM].


8.  Informative References

   [PROBLEM]  Houri, A., "Presence Interdomain Scaling Analysis for SIP/
              SIMPLE", draft-ietf-simple-interdomain-scaling-analysis-01
              (work in progress), July 2007.

   [SIP]      Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", RFC 3261,
              June 2002.

   [SIP-EVENT]
              Roach, A., "Session Initiation Protocol (SIP)-Specific
              Event Notification", RFC 3265, June 2002.

   [SIP-PRES]
              Rosenberg, J., "A Presence Event Package for the Session
              Initiation Protocol (SIP)", RFC 3856, August 2004.

   [XEP-0060]
              Millard, P., Saint-Andre, P., and R. Meijer, "Publish-
              Subscribe", XSF XEP 0060, September 2007.

   [XEP-0115]
              Hildebrand, J., Saint-Andre, P., and R. Troncon, "Entity
              Capabilities", XSF XEP 0115, August 2007.

   [XEP-0118]
              Saint-Andre, P., "User Tune", XSF XEP 0118, June 2007.




Saint-Andre               Expires April 4, 2008                [Page 17]

Internet-Draft           XMPP Presence Analysis             October 2007


   [XEP-0138]
              Hildebrand, J. and P. Saint-Andre, "Stream Compression",
              XSF XEP 0138, September 2007.

   [XEP-0153]
              Saint-Andre, P., "vCard-Based Avatars", XSF XEP 0153,
              August 2006.

   [XEP-0163]
              Saint-Andre, P. and K. Smith, "Personal Eventing via
              Pubsub", XSF XEP 0163, September 2007.

   [XMPP-CORE]
              Saint-Andre, P., "Extensible Messaging and Presence
              Protocol (XMPP): Core", RFC 3920, October 2004.

   [XMPP-IM]  Saint-Andre, P., "Extensible Messaging and Presence
              Protocol (XMPP): Instant Messaging and Presence",
              RFC 3921, October 2004.


Author's Address

   Peter Saint-Andre
   XMPP Standards Foundation
   P.O. Box 1641
   Denver, CO  80201
   USA

   Email: stpeter@jabber.org
   URI:   https://stpeter.im/




















Saint-Andre               Expires April 4, 2008                [Page 18]

Internet-Draft           XMPP Presence Analysis             October 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Saint-Andre               Expires April 4, 2008                [Page 19]

