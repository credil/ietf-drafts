


Internet Engineering Task Force                               J. Scudder
Internet-Draft                                          Juniper Networks
Intended status: Standards Track                              R. Chandra
Expires: June 19, 2009                                     Sonoa Systems
                                                       December 16, 2008


                 Capabilities Advertisement with BGP-4
                    draft-ietf-idr-rfc3392bis-03.txt

Status of this Memo

   This Internet-Draft is submitted to IETF in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on June 19, 2009.

Copyright Notice

   Copyright (c) 2008 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Abstract

   This document defines an Optional Parameter, called Capabilities,



Scudder & Chandra         Expires June 19, 2009                 [Page 1]

Internet-Draft         Capabilities Advertisement          December 2008


   that is expected to facilitate the introduction of new capabilities
   in the Border Gateway Protocol (BGP) by providing graceful capability
   advertisement without requiring that BGP peering be terminated.  This
   document obsoletes RFC 3392.


1.  Introduction

   The base BGP-4 specification [RFC4271] requires that when a BGP
   speaker receives an OPEN message with one or more unrecognized
   Optional Parameters, the speaker must terminate the BGP peering.
   This complicates the introduction of new capabilities in BGP.


2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].


3.  Overview of Operations

   When a BGP speaker [RFC4271] that supports capabilities advertisement
   sends an OPEN message to its BGP peer, the message MAY include an
   Optional Parameter, called Capabilities.  The parameter lists the
   capabilities supported by the speaker.

   A BGP speaker determines the capabilities supported by its peer by
   examining the list of capabilities present in the Capabilities
   Optional Parameter carried by the OPEN message that the speaker
   receives from the peer.

   A BGP speaker that supports a particular capability may use this
   capability with its peer after the speaker determines (as described
   above) that the peer supports this capability.  Simply put, a given
   capability can be used on a peering if that capability has been
   advertised by both peers.  If either peer has not advertised it, the
   capability cannot be used.

   A BGP speaker determines that its peer doesn't support capabilities
   advertisement, if in response to an OPEN message that carries the
   Capabilities Optional Parameter, the speaker receives a NOTIFICATION
   message with the Error Subcode set to Unsupported Optional Parameter.
   (This is a consequence of the base BGP-4 specification [RFC4271] and
   not a new requirement.)  In this case the speaker SHOULD attempt to
   re-establish a BGP connection with the peer without sending to the
   peer the Capabilities Optional Parameter.



Scudder & Chandra         Expires June 19, 2009                 [Page 2]

Internet-Draft         Capabilities Advertisement          December 2008


   If a BGP speaker that supports a certain capability requires that
   this capability be used on a peering but determines that its peer
   doesn't support this capability, the speaker MAY send a NOTIFICATION
   message to the peer and terminate peering (see Section "Extensions to
   Error Handling" for more details).  The Error Subcode in the message
   is set to Unsupported Capability.  The message SHOULD contain the
   capability (capabilities) that causes the speaker to send the
   message.  The decision to send the message and terminate the peering
   is local to the speaker.  If terminated, such peering SHOULD NOT be
   re-established automatically.  An example of when this procedure
   might be followed is if a BGP speaker is attempting to establish an
   IPv6 peering but determines that its peer does not support
   Multiprotocol Extensions for BGP-4 [RFC4760].

   If a BGP speaker receives from its peer a capability which it does
   not itself support or recognize, it SHOULD ignore that capability.
   In particular, the Unsupported Capability NOTIFICATION message MUST
   NOT be generated in response to reception of a capability which is
   not supported by the local speaker.


4.  Capabilities Optional Parameter (Parameter Type 2):

   This is an Optional Parameter that is used by a BGP speaker to convey
   to its BGP peer the list of capabilities supported by the speaker.
   The encoding of BGP Optional Parameters is specified in Section 4.2
   of [RFC4271].  The parameter type of the Capabilities Optional
   Parameter is 2.

   The parameter contains one or more triples <Capability Code,
   Capability Length, Capability Value>, where each triple is encoded as
   shown below:

          +------------------------------+
          | Capability Code (1 octet)    |
          +------------------------------+
          | Capability Length (1 octet)  |
          +------------------------------+
          | Capability Value (variable)  |
          ~                              ~
          +------------------------------+

   The use and meaning of these fields are as follows:

      Capability Code:






Scudder & Chandra         Expires June 19, 2009                 [Page 3]

Internet-Draft         Capabilities Advertisement          December 2008


         Capability Code is a one octet unsigned binary integer that
         unambiguously identifies individual capabilities.

      Capability Length:

         Capability Length is a one octet unsigned binary integer that
         contains the length of the Capability Value field in octets.

      Capability Value:

         Capability Value is a variable length field that is interpreted
         according to the value of the Capability Code field.

   BGP speakers SHOULD NOT include more than one instance of a
   capability with the same Capability Code, Capability Length, and
   Capability Value.  Note however, that processing of multiple
   instances of such capability does not require special handling, as
   additional instances do not change the meaning of the announced
   capability.

   BGP speakers MAY include more than one instance of a capability (as
   identified by the Capability Code) with non-zero Capability Length
   field, but with different Capability Value, and either the same or
   different Capability Length.  Processing of these capability
   instances is specific to the Capability Code and MUST be described in
   the document introducing the new capability.

   The Capabilities Optional Parameter (OPEN Optional Parameter Type 2)
   SHOULD only be included in the OPEN message once.  If the BGP speaker
   wishes to include multiple capabilities in the OPEN message, it
   SHOULD do so as discussed above, by listing all those capabilities as
   TLVs within a single Capabilities Optional Parameter.  However, for
   backward compatibility a BGP speaker MUST be prepared to receive an
   OPEN message which contains multiple Capabilities Optional
   Parameters, each of which contains one or more capabilities TLVs.
   The set of capabilities should be processed in the same way in either
   case, whether it is enumerated within a single Capabilities Optional
   Parameter of the OPEN message, or split across multiple.


5.  Extensions to Error Handling

   This document defines a new Error Subcode, Unsupported Capability.
   The value of this Subcode is 7.  The Data field in the NOTIFICATION
   message SHOULD list the set of capabilities that cause the speaker to
   send the message.  Each such capability is encoded in the same way as
   it would be encoded in the OPEN message.




Scudder & Chandra         Expires June 19, 2009                 [Page 4]

Internet-Draft         Capabilities Advertisement          December 2008


   As explained in the Overview of Operations section, the Unsupported
   Capability NOTIFICATION is a way for a BGP speaker to complain that
   its peer does not support a required capability, without which the
   peering cannot proceed.  It MUST NOT be used when a BGP speaker
   receives a capability which it does not understand; such capabilities
   SHOULD be ignored.


6.  IANA Considerations

   This document defines a Capability Optional Parameter along with a
   Capability Code field.  IANA maintains the registry for Capability
   Code values.  Capability Code value 0 is reserved.  Capability Code
   values 1 through 63 are to be assigned by IANA using the "IETF
   Consensus" policy defined in [RFC5226].  Capability Code values 64
   through 127 are to be assigned by IANA, using the "First Come First
   Served" policy defined in [RFC5226].  Capability Code values 128
   through 255 are for "Private Use" as defined in [RFC5226].


7.  Security Considerations

   This extension to BGP does not change the underlying security issues
   inherent in the existing BGP [RFC4272].


8.  Acknowledgements

   The authors would like to thank members of the IDR Working Group for
   their review and comments.


9.  References

9.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC4271]  Rekhter, Y., Li, T., and S. Hares, "A Border Gateway
              Protocol 4 (BGP-4)", RFC 4271, January 2006.

   [RFC5226]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", BCP 26, RFC 5226,
              May 2008.






Scudder & Chandra         Expires June 19, 2009                 [Page 5]

Internet-Draft         Capabilities Advertisement          December 2008


9.2.  Informative References

   [RFC4272]  Murphy, S., "BGP Security Vulnerabilities Analysis",
              RFC 4272, January 2006.

   [RFC4760]  Bates, T., Chandra, R., Katz, D., and Y. Rekhter,
              "Multiprotocol Extensions for BGP-4", RFC 4760,
              January 2007.


Appendix A.  Comparison with RFC 2842

   In addition to several minor editorial changes, RFC 3392 also
   clarified how to handle multiple instances of the same capability.


Appendix B.  Comparison with RFC 3392

   In addition to minor editorial changes and updated references, this
   document also clarifies the use of the Unsupported Optional Parameter
   NOTIFICATION message and clarifies behavior when the Capabilities
   parameter is included in the OPEN message multiple times.


Authors' Addresses

   John G. Scudder
   Juniper Networks

   Email: jgs@juniper.net


   Ravi Chandra
   Sonoa Systems

   Email: rchandra@sonoasystems.com















Scudder & Chandra         Expires June 19, 2009                 [Page 6]


