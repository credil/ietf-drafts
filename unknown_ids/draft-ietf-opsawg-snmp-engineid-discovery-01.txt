


Network Working Group                                   J. Schoenwaelder
Internet-Draft                                  Jacobs University Bremen
Updates: 3411 (if approved)                             January 21, 2008
Intended status: Standards Track
Expires: July 24, 2008


  Simple Network Management Protocol (SNMP) Context EngineID Discovery
            draft-ietf-opsawg-snmp-engineid-discovery-01.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on July 24, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2008).

Abstract

   The Simple Network Management Protocol (SNMP) version three (SNMPv3)
   requires that an application knows the identifier (snmpEngineID) of
   the remote SNMP protocol engine in order to retrieve or manipulate
   objects maintained on the remote SNMP entity.

   This document introduces a well-known localEngineID and a discovery
   mechanism which can be used to learn the snmpEngineID of a remote



Schoenwaelder             Expires July 24, 2008                 [Page 1]

Internet-Draft       SNMP Context EngineID Discovery        January 2008


   SNMP protocol engine.  The proposed mechanism is independent of the
   features provided by SNMP security models and may also be used by
   other protocol interfaces providing access to managed objects.

   This document updates RFC 3411.


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 3
   2.  Background  . . . . . . . . . . . . . . . . . . . . . . . . . . 3
   3.  Procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
     3.1.  Local EngineID  . . . . . . . . . . . . . . . . . . . . . . 4
     3.2.  EngineID Discovery  . . . . . . . . . . . . . . . . . . . . 5
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . 6
   5.  Security Considerations . . . . . . . . . . . . . . . . . . . . 6
   6.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . 7
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . 7
     7.1.  Normative References  . . . . . . . . . . . . . . . . . . . 7
     7.2.  Informative References  . . . . . . . . . . . . . . . . . . 8
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . . . 8
   Intellectual Property and Copyright Statements  . . . . . . . . . . 9





























Schoenwaelder             Expires July 24, 2008                 [Page 2]

Internet-Draft       SNMP Context EngineID Discovery        January 2008


1.  Introduction

   To retrieve or manipulate management information using the third
   version of the Simple Network Management Protocol (SNMPv3) [RFC3410],
   it is necessary to know the identifier of the remote SNMP protocol
   engine, the so called snmpEngineID [RFC3411].  While an appropriate
   snmpEngineID can in principle be configured on each management
   application for each SNMP agent, it is often desirable to discover
   the snmpEngineID automatically.

   This document introduces a discovery mechanism which can be used to
   learn the snmpEngineID of a remote SNMP protocol engine.  The
   proposed mechanism is independent of the features provided by SNMP
   security models.  The mechanism has been designed to co-exist with
   discovery mechanisms that may exist in SNMP security models, such as
   the authoritative engine identifier discovery of the User-based
   Security Model (USM) of SNMP [RFC3414].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].


2.  Background

   Within an administrative domain, an SNMP engine is uniquely
   identified by an snmpEngineID value [RFC3411].  An SNMP entity, which
   consists of an SNMP engine and several SNMP applications, may provide
   access to multiple contexts.

   An SNMP context is a collection of management information accessible
   by an SNMP entity.  An item of management information may exist in
   more than one context and an SNMP entity potentially has access to
   many contexts [RFC3411].  A context is identified by the snmpEngineID
   value of the entity hosting the management information (also called a
   contextEngineID) and a context name which identifies the specific
   context (also called a contextName).

   To identify an individual item of management information within an
   administrative domain, a four tuple is used consisting of

   1.  a contextEngineID,
   2.  a contextName,
   3.  an object type, and
   4.  its instance identification.

   The last two elements are encoded in an object identifier (OID)
   value.  The contextName is a character string (following the



Schoenwaelder             Expires July 24, 2008                 [Page 3]

Internet-Draft       SNMP Context EngineID Discovery        January 2008


   SnmpAdminString textual convention of the SNMP-FRAMEWORK-MIB
   [RFC3411]) while the contextEngineID is an octet string constructed
   according to the rules defined as part of the SnmpEngineID textual
   convention of the SNMP-FRAMEWORK-MIB [RFC3411].

   The SNMP protocol operations and the protocol data units (PDUs)
   operate on OIDs and thus deal with object types and instances
   [RFC3416].  The SNMP architecture [RFC3411] introduces the concept of
   a scopedPDU as a data structure containing a contextEngineID, a
   contextName, and a PDU.  The SNMP version 3 (SNMPv3) message format
   uses ScopedPDUs to exchange management information [RFC3412].

   Within the SNMP framework, contextEngineIDs serve as end-to-end
   identifiers.  This becomes important in situations where SNMP proxies
   are deployed to translate between protocol versions or to cross
   middleboxes such as network address translators.  In addition,
   snmpEngineIDs separate the identification of an SNMP engine from the
   transport addresses used to communicate with an SNMP engine.  This
   property can be used to correlate management information easily even
   in situations where multiple different transports were used to
   retrieve the information or where transport addresses can change
   dynamically.

   To retrieve data from an SNMPv3 agent, it is necessary to know the
   appropriate contextEngineID.  The User-based Security Model (USM) of
   SNMPv3 provides a mechanism to discover the snmpEngineID of the
   remote SNMP engine since this is needed for security processing
   reasons.  The discovered snmpEngineID can subsequently be used as a
   contextEngineID in a ScopedPDU to access management information local
   to the remote SNMP engine.  Other security models, such as the
   Transport Security Model (TSM) [I-D.TSM], lack such a procedure and
   may use the discovery mechanism defined in this memo.


3.  Procedure

   The proposed discovery mechanism consists of two parts, namely (i)
   the definition of a special well-known snmpEngineID value, called the
   localEngineID, which always refers to a local default context, and
   (ii) the definition of a procedure to acquire the snmpEngineID scalar
   of the SNMP-FRAMEWORK-MIB [RFC3411] using the special well-known
   local localEngineID value.

3.1.  Local EngineID

   An SNMP command responder implementing this specification MUST
   register their pduTypes using the localEngineID snmpEngineID value
   (defined below) using the registerContextEngineID() Abstract Service



Schoenwaelder             Expires July 24, 2008                 [Page 4]

Internet-Draft       SNMP Context EngineID Discovery        January 2008


   Interface (ASI) defined in RFC 3412 [RFC3412].  This registration is
   done in addition to the normal registration under the SNMP engine's
   snmpEngineID.  This is consistent with the SNMPv3 specifications
   since they explicitly allow to register multiple engineIDs and
   multiple pduTypes [RFC3412].

   The SnmpEngineID textual convention [RFC3411] defines that an
   snmpEngineID value MUST be between 5 and 32 octets long.  This
   specification proposes to use the variable length format 3) and to
   allocate the reserved, unused format value 6, using the enterprise ID
   0 for the localEngineID.  An ASN.1 definition for localEngineID would
   look like this:

               localEngineID OCTET STRING ::= '8000000006'H

   The localEngineID value always provides access to the default context
   of an SNMP engine.

3.2.  EngineID Discovery

   Discovery of the snmpEngineID is done by sending a Read Class
   protocol operation (see section 2.8 of [RFC3411]) to retrieve the
   snmpEngineID scalar using the localEngineID defined above as a
   contextEngineID value.  Implementations SHOULD only perform this
   discovery step when it is needed.  In particular, if security models
   are used that already discover the remote snmpEngineID (such as USM),
   then no further discovery is necessary.  The same is true in
   situations where the application already knows a suitable
   snmpEngineID value.

   The procedure to discover the snmpEngineID of a remote SNMP engine
   can be described as follows:

   1.  Check whether a suitable contextEngineID value is already known.
       If yes, use the provided contextEngineID value and stop the
       discovery procedure.
   2.  Check whether the selected security model supports discovery of
       the remote snmpEngineID (e.g., USM with its discovery mechanism).
       If yes, let the security model perform the discovery.  If the
       remote snmpEngineID value has been successfully determined,
       assign it to the contextEngineID and stop the discovery
       procedure.
   3.  Send a Read Class operation to the remote SNMP engine using the
       localEngineID value as the contextEngineID in order to retrieve
       the scalar snmpEngineID.0 of the SNMP-FRAMEWORK-MIB [RFC3411].
       If successful, set the contextEngineID to the retrieved value and
       stop the discovery procedure.




Schoenwaelder             Expires July 24, 2008                 [Page 5]

Internet-Draft       SNMP Context EngineID Discovery        January 2008


   4.  Return an error indication that a suitable contextEngineID could
       not be discovered.

   The procedure outlined above is an example and can be modified to
   retrieve more variables in step 3), such as the sysObjectID.0 scalar
   or the snmpSetSerialNo.0 scalar of the SNMPv2-MIB [RFC3418].


4.  IANA Considerations

   IANA has to create a registry for SnmpEngineID formats.  The first
   four octets of an SnmpEngineID carry an enterprise number while the
   fifth octet in a variable length SnmpEngineID value, called the
   format octet, indicates how the following octets are formed.  The
   following format values were defined in [RFC3411]:

     Format    Description                     References
     -------   -----------                     ----------
          0    reserved, unused                 [RFC3411]
          1    IPv4 address                     [RFC3411]
          2    IPv6 address                     [RFC3411]
          3    MAC address                      [RFC3411]
          4    administratively assigned text   [RFC3411]
          5    administratively assigned octets [RFC3411]
       6-127   reserved, unused                 [RFC3411]
     128-255   enterprise specific              [RFC3411]

   IANA has to create a registry to assign new format values out of the
   originally assigned and reserved number space 1-127.  For new
   assignments, a specification is required as per [RFC2434].

   This document requested the following assignment:

     Format    Description                     References
     -------   -----------                     ----------
          6    local engine                     [RFCXXXX]

     [RFC Ed.: replace XXXX with RFC number assigned to the document]


5.  Security Considerations

   SNMP version 3 (SNMPv3) provides cryptographic security to protect
   devices from unauthorized access.  This specification recommends to
   use the security services provided by SNMPv3.  In particular, it is
   RECOMMENDED to protect the discovery exchange.

   In situations where SNMPv3 is used without security (i.e., the



Schoenwaelder             Expires July 24, 2008                 [Page 6]

Internet-Draft       SNMP Context EngineID Discovery        January 2008


   security level of noAuthNoPriv is used), the introduction of a
   localEngineID may make it slightly easier for an attacker to discover
   suitable snmpEngineID values.  However, since SNMP messages with a
   security level of noAuthNoPriv are normally carried in clear-text
   over the wire, it is usually easy for an attacker to discover
   snmpEngineID values by sniffing on the wire and any attempts to keep
   snmpEngineID values private will not lead to strong security.  The
   usage of SNMPv3 without security is therefore generally NOT
   RECOMMENDED.

   If a device configuration permits non-secure SNMPv1/v2c access to a
   target system, then reading the snmpEngineID variable of the SNMP-
   FRAMEWORK-MIB will also reveal a suitable contextEngineID value for
   subsequent SNMPv3 usage.  However, implementations should not rely on
   non-secure SNMPv1/v2c access and therefore MUST implement this
   specification to enable secure contextEngineID discovery.

   The isAccessAllowed() abstract service primitive of the SNMP access
   control subsystem does not take the contextEngineID into account when
   checking access rights [RFC3411].  As a consequence, it is not
   possible to define a special view for context engineID discovery.  A
   request with a localEngineID is thus treated like a request with the
   correct snmpEngineID by the access control subsystem.  This is inline
   with the SNMPv3 design where the authenticated identity is the
   securityName (together with the securityModel and securityLevel
   information) and transport addresses or knowledge of contextEngineID
   values do not impact to the access control decision.


6.  Acknowledgments

   Dave Perkins suggested to introduce a "local" contextEngineID during
   the interim meeting of the ISMS working group in Boston, 2006.  Joe
   Fernandez, David Harrington, and Dan Romascanu provided helpful
   review and feedback, which helped to improve this document.


7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC3411]  Harrington, D., Presuhn, R., and B. Wijnen, "An
              Architecture for Describing Simple Network Management
              Protocol (SNMP) Management Frameworks", STD 62, RFC 3411,
              December 2002.



Schoenwaelder             Expires July 24, 2008                 [Page 7]

Internet-Draft       SNMP Context EngineID Discovery        January 2008


   [RFC3412]  Case, J., Harrington, D., Presuhn, R., and B. Wijnen,
              "Message Processing and Dispatching for the Simple Network
              Management Protocol (SNMP)", STD 62, RFC 3412,
              December 2002.

   [RFC3414]  Blumenthal, U. and B. Wijnen, "User-based Security Model
              (USM) for version 3 of the Simple Network Management
              Protocol (SNMPv3)", STD 62, RFC 3414, December 2002.

   [RFC3416]  Presuhn, R., "Version 2 of the Protocol Operations for the
              Simple Network Management Protocol (SNMP)", STD 62,
              RFC 3416, December 2002.

   [RFC2434]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", BCP 26, RFC 2434,
              October 1998.

7.2.  Informative References

   [RFC3410]  Case, J., Mundy, R., Partain, D., and B. Stewart,
              "Introduction and Applicability Statements for Internet-
              Standard Management Framework", RFC 3410, December 2002.

   [RFC3418]  Presuhn, R., "Management Information Base (MIB) for the
              Simple Network Management Protocol (SNMP)", STD 62,
              RFC 3418, December 2002.

   [I-D.TSM]  Harrington, D., "Transport Security Model for SNMP",
              draft-ietf-isms-transport-security-model-07.txt (work in
              progress), November 2007.


Author's Address

   Juergen Schoenwaelder
   Jacobs University Bremen
   Campus Ring 1
   28725 Bremen
   Germany

   Phone: +49 421 200-3587
   Email: j.schoenwaelder@jacobs-university.de









Schoenwaelder             Expires July 24, 2008                 [Page 8]

Internet-Draft       SNMP Context EngineID Discovery        January 2008


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Schoenwaelder             Expires July 24, 2008                 [Page 9]

