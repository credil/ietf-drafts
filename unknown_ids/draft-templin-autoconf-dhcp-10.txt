


Network Working Group                                         F. Templin
Internet-Draft                                                S. Russert
Intended status: Informational                                     S. Yi
Expires: May 17, 2008                               Boeing Phantom Works
                                                       November 14, 2007


                        MANET Autoconfiguration
                   draft-templin-autoconf-dhcp-10.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on May 17, 2008.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   Mobile Ad-hoc Networks (MANETs) connect routers on links with
   asymmetric reachability characteristics, and may also connect to
   other networks including the Internet.  Routers in MANETs must have a
   way to automatically provision IP addresses/prefixes and other
   information.  This document specifies mechanisms for MANET
   autoconfiguration; both IPv4 and IPv6 are discussed.




Templin, et al.           Expires May 17, 2008                  [Page 1]

Internet-Draft           MANET Autoconfiguration           November 2007


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  MANET Autoconfiguration  . . . . . . . . . . . . . . . . . . .  6
     3.1.  MANET Router (MNR) Operation . . . . . . . . . . . . . . .  6
       3.1.1.  MANET Local Address (MLA) Configuration  . . . . . . .  6
       3.1.2.  MNBR List Discovery  . . . . . . . . . . . . . . . . .  7
       3.1.3.  VET Interface Configuration  . . . . . . . . . . . . .  8
       3.1.4.  Reachability Confirmation  . . . . . . . . . . . . . .  9
       3.1.5.  MNBR-Aggregated Address/Prefix Autoconfiguration . . .  9
       3.1.6.  Unique-local Address Autoconfiguration . . . . . . . . 11
       3.1.7.  Self-Generated IPv6 Interface Identifiers  . . . . . . 11
       3.1.8.  Forwarding Packets to Off-MANET Destinations . . . . . 11
     3.2.  MANET Border Router (MNBR) Operation . . . . . . . . . . . 12
     3.3.  MANET Flooding . . . . . . . . . . . . . . . . . . . . . . 12
     3.4.  Changes to the Neighbor Discovery Model  . . . . . . . . . 12
   4.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 12
   5.  Security Considerations  . . . . . . . . . . . . . . . . . . . 13
   6.  Related Work . . . . . . . . . . . . . . . . . . . . . . . . . 13
   7.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 13
   8.  Contributors . . . . . . . . . . . . . . . . . . . . . . . . . 13
   9.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 13
     9.1.  Normative References . . . . . . . . . . . . . . . . . . . 13
     9.2.  Informative References . . . . . . . . . . . . . . . . . . 14
   Appendix A.  IPv6 Neighbor Discovery (ND) and Duplicate
                Address Detection (DAD) . . . . . . . . . . . . . . . 15
   Appendix B.  IPv6 StateLess Address AutoConfiguration (SLAAC)  . . 16
   Appendix C.  Change Log  . . . . . . . . . . . . . . . . . . . . . 16
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 18
   Intellectual Property and Copyright Statements . . . . . . . . . . 20




















Templin, et al.           Expires May 17, 2008                  [Page 2]

Internet-Draft           MANET Autoconfiguration           November 2007


1.  Introduction

   Mobile Ad-hoc Networks (MANETs) connect MANET Routers (MNRs) on links
   with asymmetric reachability characteristics (see: [RFC2461], Section
   2.2).  MNRs may participate in a routing protocol over MANET
   interfaces to discover routes across the MANET using multiple Layer-2
   or Layer-3 forwarding hops if necessary.  MANETs may also connect to
   other networks including the Internet via MANET Border Routers
   (MNBRs), and MNRs may be multiple hops away from their nearest MNBR
   in some scenarios.  A MANET may span an entire Autonomous System (AS)
   or may be as simple as a small collection of MNRs (and their attached
   networks).  A MANET may contain other MANETs, and may also be a
   subnetwork of a larger MANET.

   MANETs that comprise homogeneous link types can configure the routing
   protocol to operate as a sub-IP layer mechanism such that IP sees the
   MANET as an ordinary shared link the same as for a (bridged) campus
   LAN.  In that case, a single IP hop is sufficient to traverse the
   MANET.

   MANETs that comprise heterogeneous link types must instead (or, in
   addition) provide a routing service that operates as an IP layer
   mechanism to accommodate media types with dissimilar Layer-2 address
   formats and maximum transmission units (MTUs).  In that case,
   multiple IP hops may be necessary to traverse the MANET such that
   MNRs require specialized autoconfiguration procedures to avoid
   multilink subnet issues [RFC4903].

   Conceptually, a MNR embodies a router entity that connects its
   attached networks to MANETs and/or other networks including the
   Internet (see: Figure 1).  The router entity also connects to an
   imaginary Virtual Ethernet (VET) via a virtual interface configured
   over its MANET interfaces and used to avoid multilink subnet issues.
   An "opaque" view of the VET sees the MANET as a fully-connected
   shared link that connects all MNRs, while a "transparent" view sees
   the MANET as a multilink site.  For each distinct MANET to which they
   connect, MNRs discover a list of MNBRs that determines the MANET's
   identity.  An MNR (and its attached networks) is a "site" unto
   itself, therefore a MANET is a "site-of-sites".

   This document specifies mechanisms and operational practices for
   MANET autoconfiguration with multilink subnet avoidance.  Operation
   using standard DHCP
   [RFC2131][I-D.ietf-dhc-subnet-alloc][RFC3315][RFC3633] and neighbor
   discovery [RFC1256][RFC2461][RFC2462] mechanisms is assumed unless
   otherwise specified.  Both IPv4 [RFC0791] and IPv6 [RFC2460] are
   discussed.




Templin, et al.           Expires May 17, 2008                  [Page 3]

Internet-Draft           MANET Autoconfiguration           November 2007


2.  Terminology

   The terminology in [I-D.ietf-autoconf-manetarch] and the normative
   references apply.  The following terms are defined within the scope
   of this document:

   subnetwork
      the same as defined in [RFC3819].

   egress/ingress interface
      the same as defined in ([RFC3753], Section 3).

   Mobile Ad-hoc Network (MANET)
      a connected network region of MANET routers that maintain a
      routing structure among themselves over asymmetric reachability
      links (see: [RFC2461], Section 2.2).  A MANET may span an entire
      Autonomous System (AS) or only a small collection of MANET
      routers, and a MANET may also be a subnetwork of a larger MANET.
      A MANET router (and its attached networks) is a site unto itself,
      and a MANET is therefore a site-of-sites.  (Note that this
      document considers the terms "MANET" and "site" as functional
      equivalents.)

      Further information on the characteristics of MANETs can be found
      in [RFC2501].

   MANET Router (MNR)
      a mobile router that forwards packets on behalf of both other MNRs
      over its MANET interfaces and networks attached on its ingress
      interfaces.  A MNR can also forward packets to other networks
      either directly via its egress interfaces or indirectly via an
      MNBR.  For the purpose of this specification, an MNR comprises a
      router entity, one or more host entities, and its attached
      ingress/egress/MANET interfaces (see: Figure 1).

   MANET Border Router (MNBR)
      an MNR that connects a MANET to "upstream" networks (e.g., the
      Internet) via egress interfaces, and delegates addresses/prefixes
      to other MNRs.

   MANET Interface
      a MANET Router's attachment to a link in a MANET.  A MANET
      interface is "neutral" in its orientation, i.e., it is inherently
      neither egress nor ingress.  In particular, a packet may need to
      traverse several MANET interfaces before it is forwarded via
      either an egress or ingress interface.





Templin, et al.           Expires May 17, 2008                  [Page 4]

Internet-Draft           MANET Autoconfiguration           November 2007


   MANET Local Address (MLA)
      an address configured by an MNR that is unique within the MANET;
      it is used as an identifier for operating the routing protocol and
      may also be assigned to a MANET interface as a locator for packet
      forwarding within the scope of the MANET.

   Virtual Ethernet (VET)
      an imaginary shared link that connects all MNRs in a MANET.

   VET interface
      a MNR's attachment to a VET.  Each VET interface is configured
      over a set of underlying MANET interface(s) belonging to the same
      MANET, and presents both opaque and transparent "portals" (see:
      Figure 2 and Figure 3).

      The opaque portal encapsulates each IP packet in an outer IP
      header then sends it on an underlying MANET interface such that
      the TTL/HOP Limit in the inner IP header is not decremented as the
      packet traverses the MANET, i.e., the opaque portal views the
      MANET as a unified shared link.  In this sense, the opaque portal
      presents an automatic tunneling abstraction.

      The transparent portal sends each IP packet on an underlying MANET
      interface without further encapsulation such that the TTL/Hop
      Limit may be decremented as the packet traverses the MANET, i.e.,
      the transparent portal views the MANET as a multilink site.

   Extended Neighbor Discovery (END) message
      an IP Neighbor Discovery (ND) message [RFC1256] [RFC2461]
      transmitted on the transparent portal of a VET interface with an
      MLA of the underlying MANET interface as a source address and with
      destination address set to an MLA or a site-scoped multicast
      address.  The TTL/Hop Limit in END messages may be decremented as
      the message traverses the MANET.

   The following figure depicts the architectural model for a MANET
   router:














Templin, et al.           Expires May 17, 2008                  [Page 5]

Internet-Draft           MANET Autoconfiguration           November 2007


                              Egress Interfaces (to Internet)
                                      x   x        x
                                      |   |        |
             +------------------------+---+--------+----------+
             | Internal hosts         |   |        |          |    M
             |  and routers           |   |  ....  |          |    A
             |       ,-.    |     +---+---+--------+---+      |    N
             |      (H1 )---+     |                   /|      |    E
             |   |   `-'    |     |                I /*+------+--< T
             | . |  +---+   |     |                n|**|      |
             | . +--|R1 |---+-----+                t|**|      |    I
             | . |  +---+   |     |    Router    V e|**+------+--< n
             |   |   ,-.    |     |              E r|**|  .   |    t
             |      (H2 )---+     |    Entity    T f|**|  .   |    e
             |       `-'    |  .  |                a|**|  .   |    r
             |                 .  |                c|**|  .   |    f
             |       ,-.       .  |                e \*+------+--< a
             |      (Hn )---------+                   \|      |    c
             |       `-'          +---+---+--------+---+      |    e
             | Ingress Interfaces     |   |  ....  |          |    s
             | (to internal networks) |   |        |          |
             +------------------------+---+--------+----------+
                                      |   |        |
                                      x   x        x
                      Ingress Interfaces (to mobile networks)

                          Figure 1: MANET Router


3.  MANET Autoconfiguration

3.1.  MANET Router (MNR) Operation

   MNRs configure egress interfaces that connect "upstream" toward fixed
   Internet infrastructure, ingress interfaces that connect "downstream"
   toward attached mobile networks, and MANET interfaces that are
   "neutral" in the sense that the packets they forward may need to
   traverse several other MANET interfaces before they are forwarded via
   either an egress or ingress interface.  MNRs configure VET interfaces
   and engage in the routing protocol over their MANET interfaces; they
   also obtain addresses/prefixes and other autoconfiguration
   information using the mechanisms and operational practices specified
   in the following sections:

3.1.1.  MANET Local Address (MLA) Configuration

   Upon joining a MANET, each MNR first configures MANET Local Addresses
   (MLAs) that it will use for operating the routing protocol and/or for



Templin, et al.           Expires May 17, 2008                  [Page 6]

Internet-Draft           MANET Autoconfiguration           November 2007


   local communications within the MANET.

   IPv6 MLAs can be manually configured, administratively assigned,
   autoconfigured using DHCP, autoconfigured using IPv6 StateLess
   Address AutoConfiguration (SLAAC) [RFC2462], or self-generated using
   IPv6 Unique Local Addresses (ULAs)
   [RFC4193][I-D.ietf-ipv6-ula-central].  IPv6 MLAs include interface
   identifiers that are either managed for uniqueness (e.g., see:
   [RFC4291], Appendix A) or self-generated using a suitable pseudo-
   random interface identifier generation mechanism (e.g.,
   Cryptographically Generated Addresses (CGAs) [RFC3972], IPv6 privacy
   addresses [I-D.ietf-ipv6-privacy-addrs-v2], etc.).

   IPv4 MLAs can be manually configured, administratively assigned,
   autoconfigured using DHCP or self-generated using an unspecified IPv4
   unique local address configuration mechanism.  (Such a mechanism
   could be considered as a site-scoped equivalent to IPv4 link-local
   addresses [RFC3927].)

   When there is no manually configured/administratively assigned MLA,
   the choice of autoconfiguring an MLA using DHCP or self-generating
   one using some other mechanism is up to the MNR and may depend on the
   particular MANET deployment scenario.  DHCP-generated MLAs have the
   benefit of a "managed" avoidance of address collisions, while self-
   generated MLAs must be monitored for collisions with other nodes that
   might assign a duplicate.  Note also that DHCP service for MLA
   configuration may not be available in all MANETs.

   Since a MNR initially has no non-link-local addresses, DHCP
   configuration of MLAs may require relay support from other MNRs that
   have already been autoconfigured within the MANET.  This means that
   MNRs with assigned MLAs should be prepared to relay another MNR's
   DHCP requests, e.g. to a site-scoped multicast address, to a unicast
   address(es), etc.

3.1.2.  MNBR List Discovery

   After configuring MLAs, the MNR next engages in any routing
   protocol(s) over its MANET interfaces and discovers the list of MNBRs
   (if any) on the MANET.  The list of MNBRs can be discovered through
   information conveyed in the routing protocol, or through an alternate
   discovery mechanism, e.g., per [RFC4214], Section 8.3.2.

   The list of MNBRs serves as an identifier for the MANET.  If the list
   of MNBRs is NULL, an alternate token such as the Layer-2 address of
   an ordinary MNR can serve as an identifier for the MANET.





Templin, et al.           Expires May 17, 2008                  [Page 7]

Internet-Draft           MANET Autoconfiguration           November 2007


3.1.3.  VET Interface Configuration

   The MNR configures a VET interface for the MANET over the underlying
   MANET interfaces.

   The opaque portal of the VET interface configures a link-local
   address that is assured to be unique among the VET interfaces of all
   MNRs in the MANET, e.g., an ISATAP link-local address ([RFC4214],
   Section 6.2) derived from the IPv4 MLA of an underlying MANET
   interface.  IP packets sent via the opaque portal are encapsulated in
   an outer IP header then submitted to ip_output() for transmission on
   an underlying MANET interface.

   The transparent portal of the VET interface configures no addresses
   itself, but rather provides IP with direct access to the underlying
   MANET interfaces and their associated MLAs.  IP packets sent via the
   transparent portal are transmitted unencapsulated on an underlying
   MANET interface, but may require an IPv4 source routing header
   (likewise IPv6 routing header) or a subnetwork-specific encapsulation
   to direct packets to specific MNBRs.

   Figure 2 depicts the protocol stack model for the VET output routine,
   and Figure 3 depicts the corresponding model for the VET input
   routine:

       +--------------------------------------------------+   |
       |                   ip_output()                    |   |
       +--------------------------------------------------+   |
       |                   vet_output()                   |   |
       |                                                  |
       | _ transparent portal _   ___ opaque portal _____ |   p
       |/                      \ /                       \|   a
       | - MANET intf already   | - select MANET intf     |   c
       |   selected             | - encapsulate in IP     |   k
       | - insert routing hdr   | - forward to MANET intf |   e
       |   (if necessary)       |   via ip_output()       |   t
       | - forward directly to  +-------------------------+   s
       |   MANET intf           |       ip_output()       |
       +--------------+---------+----+-...-+--------------+   |
       | MANET Intf 0 | MANET Intf 1 | ... | MANET Intf n |   |
       |    (MLA 0)   |    (MLA 1)   | ... |    (MLA n)   |   |
       +--------------+--------------+-...-+--------------+   v

                          Figure 2: vet_output()







Templin, et al.           Expires May 17, 2008                  [Page 8]

Internet-Draft           MANET Autoconfiguration           November 2007


       +--------------------------------------------------+   ^
       |                    ip_input()                    |   |
       +--------------------------------------------------+   |
       |                    vet_input()                   |
       |                                                  |   p
       | _ transparent portal _   ___ opaque portal  ____ |   a
       |/                      \ /                       \|   c
       | - submit to ip_input() | - decapsulate packet    |   k
       |                        | - submit to ip_input()  |   e
       |                        +-------------------------+   t
       |                        |        ip_input()       |   s
       +--------------+---------+----+-...-+--------------+
       | MANET Intf 0 | MANET Intf 1 | ... | MANET Intf n |   |
       |    (MLA 0)   |    (MLA 1)   | ... |    (MLA n)   |   |
       +--------------+--------------+-...-+--------------+   |

                           Figure 3: vet_input()

3.1.4.  Reachability Confirmation

   After the MNR configures a VET interface, it can confirm reachability
   of MNRs/MNBRs and (in the case of IPv6) discover prefixes associated
   with the VET.  The MNR can confirm reachability by sending/receiving
   END messages over the transparent portal, by sending/receiving
   ordinary ND messages over the opaque portal, by issuing DHCP
   requests, via reachability information conveyed in the routing
   protocol itself, or through some other means associated with the
   particular MANET subnetwork technology.

3.1.5.  MNBR-Aggregated Address/Prefix Autoconfiguration

   After the MNR discovers MNBRs, it can acquire MNBR-aggregated
   addresses/prefixes using either DHCP or IPv6 Stateless Address
   AutoConfiguration (SLAAC) (but see Appendix B for further
   considerations on SLAAC).  These addresses/prefixes are delegated by
   specific MNBRs, and may be:

   o  global-scope and provider aggregated

   o  global-scope and provider-independent

   o  global-scope and 6to4 [RFC3056]

   o  unique-local scope and centrally administrated

   o  unique-local scope and locally assigned





Templin, et al.           Expires May 17, 2008                  [Page 9]

Internet-Draft           MANET Autoconfiguration           November 2007


   o  other non-link-local scope

   When DHCP is used, a DHCP client associated with the MNR's host
   entity forwards a DHCP DISCOVER (DHCPv4) or Solicit (DHCPv6) request
   to a DHCP relay associated with its router entity to request IP
   address/prefix delegations (i.e., the MNR acts as both DHCP client
   and relay).  The relay function then forwards the request to the
   unicast addresses of one or more MNBRs, to a site-scoped multicast
   address, or to another known DHCP server within the MANET.

   For DHCPv6, the MNR's relay function writes an address from the VET
   interface in the "peer-address" field and also writes an address from
   the prefix associated with the VET in the "link-address" field (if a
   prefix is available).  The MNR can also (or, instead) use DHCPv6
   prefix delegation [RFC3633] to obtain addresses/prefixes via MNBRs
   for assignment and/or further sub-delegation on networks connected on
   its ingress interfaces.  (Note that the MNR can obtain /128 prefixes
   using DHCP prefix delegation the same as for any IPv6 prefix.)

   For DHCPv4, the MNR's relay function writes an address from the VET
   interface in the 'giaddr' field.  If necessary to identify the MNR's
   ingress interface, the relay also includes a link selection sub-
   option [RFC3527] with an address from the prefix associated with the
   VET (if a prefix is available).  The MNR can also (or, instead) use
   DHCPv4 prefix delegation [I-D.ietf-dhc-subnet-alloc] to obtain
   addresses/prefixes via MNBRs for further assignment and/or further
   sub-delegation on networks connected on its ingress interfaces.
   (Note that the MNR can obtain /32 prefixes using DHCP prefix
   delegation the same as for any IPv4 prefix.)

   The DHCP request will elicit a DHCP reply from a server with IP
   address/prefix delegations that are aggregated by one or more MNBRs.
   When addresses are delegated, the MNR assigns the resulting addresses
   to an ingress interface, i.e., it does not assign the addresses on
   the VET interface or an underlying MANET interface.  When prefixes
   are delegated, the MNR can assign and/or further sub-delegate them to
   networks connected on its ingress interfaces.  If the MANET
   subnetwork uses a proactive routing protocol, the MNR can advertise
   the delegated addresses/prefixes into the routing protocol during the
   duration of the delegation lifetimes.

   The DHCP server ensures IP address/prefix delegations that are unique
   within the MANET.  By assigning these IP addresses/prefixes only on
   ingress interfaces there is no requirement for the MNR to perform
   Duplicate Address Detection (DAD) for them over its MANET interfaces
   or VET interfaces (but see Appendix A for further DAD
   considerations).




Templin, et al.           Expires May 17, 2008                 [Page 10]

Internet-Draft           MANET Autoconfiguration           November 2007


3.1.6.  Unique-local Address Autoconfiguration

   Independent of any MNBR-aggregated addresses/prefixes (see:
   Section 3.1.5), MNRs can self-generate IPv6 Unique Local Address
   (ULA) prefixes [RFC4193][I-D.ietf-ipv6-ula-central] and sub-delegate
   them on networks connected on their ingress interfaces.  Note that in
   some scenarios a MNR may not require any MNBR-aggregated address/
   prefix assignments at all, and can use its own ULAs instead.

   Self-generated unique-local addresses are portable and not aggregated
   by MNBRs.  The addresses can therefore travel with the MNR as it
   moves to new MANETs and/or configures peering arrangements with MNRs
   in other MANETs.  Self-generation of unique-local addresses can
   therefore occur independently of any other MNR autoconfiguration
   considerations.

3.1.7.  Self-Generated IPv6 Interface Identifiers

   MNR's can self-generate IPv6 interface identifiers such as specified
   for CGAs [RFC3972], IPv6 privacy address
   [I-D.ietf-ipv6-privacy-addrs-v2], etc.

   For MNBR-aggregated address/prefix autoconfiguration (see:
   Section 3.1.5), the MNR can propose a self-generated address to the
   DHCPv6 server which will delegate the address to the MNR for
   assignment on an ingress interface if the proposed address is unique.

3.1.8.  Forwarding Packets to Off-MANET Destinations

   After the MNR configures IP addresses/prefixes, it can forward IP
   packets to off-MANET destinations.

   For IPv6, MNRs can discover default router preferences and more-
   specific routes per [RFC4191] by sending unicast Router Solicitations
   over the VET interface opaque portal to elicit Router Advertisements
   from MNBRs and other MNRs.  MNRs/MNBRs should therefore send Router
   Advertisements with default router preferences and/or more-specific
   routes in response to unicast Router Solicitations.  This matches the
   operational framework established by ISATAP [RFC4214].

   Once default routers and/or more-specific routes are discovered, the
   MNR can either 1) forward the packets via the opaque portal with an
   MLA for an MNR/MNBR as the destination in the outer IP header, or 2)
   forward the packets via the transparent portal and insert an IPv4
   source routing header (likewise IPv6 routing header) or a subnetwork-
   specific encapsulation.

   (For MANETs in which 'default' and/or more-specific routes are made



Templin, et al.           Expires May 17, 2008                 [Page 11]

Internet-Draft           MANET Autoconfiguration           November 2007


   available through the routing protocol, the MNR can optionally
   forward IP packets to off-MANET destinations using the transparent
   VET interface portal.)

3.2.  MANET Border Router (MNBR) Operation

   MNBRs connect the MANET to upstream networks over egress interfaces.

   MNBRs send/receive END messages on the VET interface transparent
   portal and/or send/receive ordinary ND messages on the opaque portal.
   When stateful configuration is desired, MNBRs should set the M bit to
   1 in the RA messages they send.  (Stateless configuration is also
   possible, but see: Appendix B for further considerations on using
   SLAAC for MANET Autoconfiguration.)

   For DHCPv6, MNBRs act as DHCP relays and/or servers for a MNR's DHCP
   requests/replies.  For DHCPv4, MNBRs may only act as DHCP servers,
   since the MLA address in the 'giaddr' field is not routable outside
   the scope of the MANET.

3.3.  MANET Flooding

   MANETs that operate routing as an IP layer service should deploy a
   multicast flooding service (e.g., Simplified Multicast Forwarding
   (SMF) [I-D.ietf-manet-smf]) so that site-scoped multicast messages
   will be propagated across the MANET.

3.4.  Changes to the Neighbor Discovery Model

   Ordinary link-scoped ND messages work as-normal over the VET
   interface opaque portal, so ND operation over the opaque portal
   requires no changes to the standard IP neighbor discovery protocols
   specified in [RFC1256][RFC2461].

   END messages over the VET interface transparent portal must use a
   site-scoped unicast source address (i.e., an MLA) and an MLA or site-
   scoped multicast destination address such that the messages may be
   forwarded by a router and have their TTL/Hop Limit decremented on the
   path.  This means that END messages provide a site-scoped (and not
   link-scoped) discovery service which represents a departure from the
   link-scoped services specified in [RFC1256][RFC2461].


4.  IANA Considerations

   A site-scoped IPv4 multicast group for: "All-MANET-Routers", or:
   "All-Site-Routers" is requested, e.g., to support MANET flooding for
   site-scoped service discovery (see: Section 3.3).



Templin, et al.           Expires May 17, 2008                 [Page 12]

Internet-Draft           MANET Autoconfiguration           November 2007


5.  Security Considerations

   Threats relating to MANET routing protocols also apply to this
   document.


6.  Related Work

   The authors acknowledge the work done by Brian Carpenter and Cyndi
   Jung in [RFC2529] that introduced the concept of intra-site automatic
   tunneling.  This concept was later called: "Virtual Ethernet" and
   researched by Quang Nguyen under the guidance of Dr. Lixia Zhang.

   Telcordia has proposed DHCP-related solutions for the CECOM MOSAIC
   program.  The Naval Research Lab (NRL) Information Technology
   Division uses DHCP in their MANET research testbeds.  Various IETF
   AUTOCONF working group proposals have suggested similar mechanisms.


7.  Acknowledgements

   The following individuals gave direct and/or indirect input that was
   essential to the work: Jari Arkko, Teco Boot, Emmanuel Bacelli, James
   Bound, Thomas Clausen, Eric Fleischman, Bob Hinden, Joe Macker,
   Thomas Narten, Alexandru Petrescu, Jinmei Tatuya, Dave Thaler, and
   others in the IETF AUTOCONF and MANET working groups.  Many others
   have provided guidance over the course of many years.


8.  Contributors

   Thomas Henderson (thomas.r.henderson@boeing.com) contributed to this
   document.  Ian Chakeres (ian.chakeres@gmail.com) contributed to
   earlier versions of the document.


9.  References

9.1.  Normative References

   [RFC0791]  Postel, J., "Internet Protocol", STD 5, RFC 791,
              September 1981.

   [RFC1256]  Deering, S., "ICMP Router Discovery Messages", RFC 1256,
              September 1991.

   [RFC2131]  Droms, R., "Dynamic Host Configuration Protocol",
              RFC 2131, March 1997.



Templin, et al.           Expires May 17, 2008                 [Page 13]

Internet-Draft           MANET Autoconfiguration           November 2007


   [RFC2132]  Alexander, S. and R. Droms, "DHCP Options and BOOTP Vendor
              Extensions", RFC 2132, March 1997.

   [RFC2460]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", RFC 2460, December 1998.

   [RFC2461]  Narten, T., Nordmark, E., and W. Simpson, "Neighbor
              Discovery for IP Version 6 (IPv6)", RFC 2461,
              December 1998.

   [RFC2462]  Thomson, S. and T. Narten, "IPv6 Stateless Address
              Autoconfiguration", RFC 2462, December 1998.

   [RFC3315]  Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
              and M. Carney, "Dynamic Host Configuration Protocol for
              IPv6 (DHCPv6)", RFC 3315, July 2003.

   [RFC3633]  Troan, O. and R. Droms, "IPv6 Prefix Options for Dynamic
              Host Configuration Protocol (DHCP) version 6", RFC 3633,
              December 2003.

   [RFC4191]  Draves, R. and D. Thaler, "Default Router Preferences and
              More-Specific Routes", RFC 4191, November 2005.

   [RFC4214]  Templin, F., Gleeson, T., Talwar, M., and D. Thaler,
              "Intra-Site Automatic Tunnel Addressing Protocol
              (ISATAP)", RFC 4214, October 2005.

   [RFC4291]  Hinden, R. and S. Deering, "IP Version 6 Addressing
              Architecture", RFC 4291, February 2006.

9.2.  Informative References

   [I-D.ietf-autoconf-manetarch]
              Chakeres, I., Macker, J., and T. Clausen, "Mobile Ad hoc
              Network Architecture", draft-ietf-autoconf-manetarch-07
              (work in progress), November 2007.

   [I-D.ietf-dhc-subnet-alloc]
              Johnson, R., "Subnet Allocation Option",
              draft-ietf-dhc-subnet-alloc-05 (work in progress),
              June 2007.

   [I-D.ietf-ipv6-privacy-addrs-v2]
              Narten, T., "Privacy Extensions for Stateless Address
              Autoconfiguration in IPv6",
              draft-ietf-ipv6-privacy-addrs-v2-05 (work in progress),
              October 2006.



Templin, et al.           Expires May 17, 2008                 [Page 14]

Internet-Draft           MANET Autoconfiguration           November 2007


   [I-D.ietf-ipv6-ula-central]
              Hinden, R., "Centrally Assigned Unique Local IPv6 Unicast
              Addresses", draft-ietf-ipv6-ula-central-02 (work in
              progress), June 2007.

   [I-D.ietf-manet-smf]
              Macker, J., "Simplified Multicast Forwarding for MANET",
              draft-ietf-manet-smf-05 (work in progress), June 2007.

   [RFC2501]  Corson, M. and J. Macker, "Mobile Ad hoc Networking
              (MANET): Routing Protocol Performance Issues and
              Evaluation Considerations", RFC 2501, January 1999.

   [RFC2529]  Carpenter, B. and C. Jung, "Transmission of IPv6 over IPv4
              Domains without Explicit Tunnels", RFC 2529, March 1999.

   [RFC3527]  Kinnear, K., Stapp, M., Johnson, R., and J. Kumarasamy,
              "Link Selection sub-option for the Relay Agent Information
              Option for DHCPv4", RFC 3527, April 2003.

   [RFC3753]  Manner, J. and M. Kojo, "Mobility Related Terminology",
              RFC 3753, June 2004.

   [RFC3819]  Karn, P., Bormann, C., Fairhurst, G., Grossman, D.,
              Ludwig, R., Mahdavi, J., Montenegro, G., Touch, J., and L.
              Wood, "Advice for Internet Subnetwork Designers", BCP 89,
              RFC 3819, July 2004.

   [RFC3927]  Cheshire, S., Aboba, B., and E. Guttman, "Dynamic
              Configuration of IPv4 Link-Local Addresses", RFC 3927,
              May 2005.

   [RFC3972]  Aura, T., "Cryptographically Generated Addresses (CGA)",
              RFC 3972, March 2005.

   [RFC4193]  Hinden, R. and B. Haberman, "Unique Local IPv6 Unicast
              Addresses", RFC 4193, October 2005.

   [RFC4903]  Thaler, D., "Multi-Link Subnet Issues", RFC 4903,
              June 2007.


Appendix A.  IPv6 Neighbor Discovery (ND) and Duplicate Address
             Detection (DAD)

   In terms of ND, existing standards [RFC2461][RFC4291] require that a
   node configure a link-local address on each of its IPv6-enabled
   interfaces, but the primary requirement for link-locals seems to be



Templin, et al.           Expires May 17, 2008                 [Page 15]

Internet-Draft           MANET Autoconfiguration           November 2007


   for the purpose of uniquely identifying routers on the link.  It is
   therefore for further study as to whether MNRs should send RAs on
   MANET interfaces (or even configure link local addresses on MANET
   interfaces at all), since the transparent view of the MANET appears
   as a multilink peering point between distinct sites, and not a
   unified link.

   In terms of DAD, pre-service DAD for an MLA assigned on a MANET
   interface (such as specified in [RFC2462]) would require either
   flooding the entire MANET or somehow discovering a link in the MANET
   on which a node that configures a duplicate address is attached and
   performing a localized DAD exchange on that link.  But, the control
   message overhead for such a MANET-wide DAD would be substantial and
   prone to false-negatives due to packet loss and node mobility.  An
   alternative to pre-service DAD is to autoconfigure pseudo-random MLAs
   on MANET interfaces and employ a passive in-service DAD (e.g., one
   that monitors routing protocol messages for duplicate assignments).
   Pseudo-random link-local addresses can be generated with mechanisms
   such as CGAs, IPv6 privacy addresses, etc. with very small
   probability of collision.  But, IPv6 ULAs also provide an additional
   40 pseudo-random bits in the prefix.

   Statistical properties for pseudo-random address self-generation can
   assure uniqueness for the MLAs assigned on a MNR's MANET interfaces,
   and consistent operational practices can assure uniqueness for MNBR-
   aggregated addresses/prefixes.  However, a passive in-service DAD
   mechanism should still be used to detect duplicates that were
   assigned through other means, e.g., manual configuration.


Appendix B.  IPv6 StateLess Address AutoConfiguration (SLAAC)

   For IPv6, the use of StateLess Address AutoConfiguration (SLAAC)
   [RFC2462] could be indicated by prefix information options in END
   and/or ordinary ND messages with the 'A' bit set to 1.  MNRs that
   receive such messages could then self-generate an address from the
   prefix and assign it to the VET interface, then use a passive in-
   service DAD approach to detect duplicates within the MANET.  But, if
   the MANET partitions, DAD might not be able to monitor the other
   partitions and address duplication could result.  Further study on
   DAD implications for SLAAC in MANETs is required.


Appendix C.  Change Log

   (Note to RFC editor - this section to be removed before publication
   as an RFC.)




Templin, et al.           Expires May 17, 2008                 [Page 16]

Internet-Draft           MANET Autoconfiguration           November 2007


   Changes from -08 to -09:

   o  Introduced the term "VET".

   o  Changed address delegation language to speak of "MNBR-aggregated"
      instead of global/local.

   o  Updated figures 1-3.

   o  Explained why a MANET interface is "neutral".

   o  Removed DHCPv4 "MLA Address option".  Now, MNBRs can only be
      DHCPv4 servers; not relays.

   Changes from -07 to -08:

   o  changed terms "unenhanced" and "enhanced" to "transparent" and
      "opaque".

   o  revised MANET Router diagram.

   o  introduced RFC3753 terminology for Mobile Router; ingress/egress
      interface.

   o  changed abbreviations to "MNR" and "MNBR".

   o  added text on ULAs and ULA-Cs to "Self-Generated Addresses".

   o  rearranged Section 3.1.

   o  various minor text cleanups

   Changes from -06 to -07:

   o  added MANET Router diagram.

   o  added new references

   o  various minor text cleanups

   Changed from -05 to -06:

   o  Changed terms "raw" and "cooked" to "unenhanced" and "enhanced".

   o  minor changes to preserve generality

   Changed from -04 to -05:




Templin, et al.           Expires May 17, 2008                 [Page 17]

Internet-Draft           MANET Autoconfiguration           November 2007


   o  introduced conceptual "virtual ethernet" model.

   o  support "raw" and "cooked" modes as equivalent access methods on
      the virutal ethernet.

   Changed from -03 to -04:

   o  introduced conceptual "imaginary shared link" as a representation
      for a MANET.

   o  discussion of autonomous system and site abstractions for MANETs

   o  discussion of autoconfiguration of CGAs

   o  new appendix on IPv6 StateLess Address AutoConfiguration

   Changes from -02 to -03:

   o  updated terminology based on RFC2461 "asymmetric reachability"
      link type; IETF67 MANET Autoconf wg discussions.

   o  added new appendix on IPv6 Neighbor Discovery and Duplicate
      Address Detection

   o  relaxed DHCP server deployment considerations allow DHCP servers
      within the MANET itself

   Changes from -01 to -02:

   o  minor updates for consistency with recent developments

   Changes from -00 to -01:

   o  new text on DHCPv6 prefix delegation and multilink subnet
      considerations.

   o  various editorial changes














Templin, et al.           Expires May 17, 2008                 [Page 18]

Internet-Draft           MANET Autoconfiguration           November 2007


Authors' Addresses

   Fred L. Templin
   Boeing Phantom Works
   P.O. Box 3707 MC 7L-49
   Seattle, WA  98124
   USA

   Email: fred.l.templin@boeing.com


   Steven W. Russert
   Boeing Phantom Works
   P.O. Box 3707 MC 7L-49
   Seattle, WA  98124
   USA

   Email: steven.w.russert@boeing.com


   Seung Yi
   Boeing Phantom Works
   P.O. Box 3707 MC 7L-49
   Seattle, WA  98124
   USA

   Email: seung.yi@boeing.com
























Templin, et al.           Expires May 17, 2008                 [Page 19]

Internet-Draft           MANET Autoconfiguration           November 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Templin, et al.           Expires May 17, 2008                 [Page 20]


