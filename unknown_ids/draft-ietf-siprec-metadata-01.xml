<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc3667.dtd">
<?rfc toc='yes'?>
<?rfc tocdepth='4'?>
<?rfc compact="yes"?>
<!--rfc category="info" ipr="full3978"-->
<rfc category="std" ipr='trust200902'>
	<front>
		<title abbrev="SIP Recording Metadata">Session Initiation Protocol (SIP) Recording Metadata</title>
		   <author initials="Ram Mohan" surname="Ravindranath" fullname="Ram Mohan Ravindranath">
			<organization>Cisco Systems, Inc.</organization>
			<address>
				<postal>
					<street>Cessna Business Park,</street>
                                        <street>Kadabeesanahalli Village, Varthur Hobli,</street>
                                        <street>Sarjapur-Marathahalli Outer Ring Road</street>
					<city>Bangalore</city>
					<region>Karnataka</region>
					<code>560103</code>
					<country>India</country>
				</postal>
				<email>rmohanr@cisco.com</email>
			</address>
		    </author>
                <author initials="Parthasarathi" surname="Ravindran" fullname="Parthasarathi Ravindran">
			<organization>Cisco Systems, Inc.</organization>
			<address>
				<postal>
					<street>Cessna Business Park,</street>
                                        <street>Kadabeesanahalli Village, Varthur Hobli,</street>
                                        <street>Sarjapur-Marathahalli Outer Ring Road</street>
					<city>Bangalore</city>
					<region>Karnataka</region>
					<code>560103</code>
					<country>India</country>
				</postal>
				<email>partr@cisco.com</email>
			</address>
		</author>
		<author initials="Paul" surname="Kyzivat" fullname="Paul Kyzivat">
			<organization>Cisco Systems, Inc.</organization>
			<address>
				<postal>
					<street>1414 Massachusetts Avenue</street>
					<region>Boxborough, MA</region>
					<code>01719</code>
					<country>USA</country>
				</postal>
				<email>pkyzivat@cisco.com</email>
			</address>
		</author>
		<date year="2011" />
		<area>Transport</area>
		<workgroup>SIPREC</workgroup>
		<abstract>
			<t>
				Session recording is a critical requirement in many communications environments such as call centers and financial trading. In some of these environments, all calls must be recorded for regulatory, compliance, and consumer protection reasons.  Recording of a session is typically performed by sending a copy of a media stream to a recording device.  This document describes the metadata model as viewed by Session Recording Server(SRS).
			</t>
		</abstract>
	</front>
	<middle>

 <section title="Introduction">
			<t>
				Session recording is a critical requirement in many communications environments such as call centers and financial trading.  In some of	these environments, all calls must be recorded for regulatory, compliance, and consumer protection reasons.  Recording of a session is typically performed by sending a copy of a media stream to a recording device. This document focuses on the Recording metadata which describes the communication session. The document describes a metadata model as viewed by Session Recording Server, the requirements for which are described in <xref target="I-D.ietf-siprec-req"/> and the architecture for which is described in <xref target="I-D.ietf-siprec-architecture"/>.
			</t>
		</section>

		<section title="Terminology" anchor="sec-term">
			<t>
				The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
				"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
				document are to be interpreted as described in <xref target="RFC2119"/>.  This
				document only uses these key words when referencing normative
				statements in existing RFCs."

			</t>
		</section>
		
		<section title ="Metadata Model">
			<t>
				Metadata is the information that describes recorded media and the CS to which they relate. Below diagram shows a model for Metadata as viewed by Session Recording Server (SRS).
			</t>
		
			<artwork>
				<![CDATA[


+-------------------------------+       1        
| Recording Session (RS)        |---------------+               
+-------------------------------+               |
      |1..*           | 1..*                    |
      |               |                         |
      |               | 0..*                    |
      |        +-----------------+              |
      |        | Communication   |              |
      |        |  Session (CS)   |      1       |
      |        |    Group        |--------------|
      |        +-----------------+              |         
      |              | 0..1                     |
      |              |                          |
      |0..*          | 1..*                     |
+-------------------------------+               |
|   Communication Session (CS)  |       1       |
|                               |---------------|
+-------------------------------+               |       +------------+
      | 1..*                 |1..*              |       |            |
      |                      |                  |  0..* |Extension   |
      | 2..*                 |0..*              |-------| Data       |
+-------------+ receives +----------------+     |       |            |
| Participant |----------|  Media Streams |     |       +------------+
|             |0..*  0..*|                |     |
|             |          |                |     |
|             |          |                |     |
|             |  sends   |                |     |
|             |----------|                |     |
|             |1.*   0..*|                |     |
+-------------+          +----------------+     |
       |                         |              |
       |1                        |1             |
       |                         |              |
       +----------------------------------------+           
      
      
				 ]]>
</artwork>
<t>The mechanism MUST provide a means to convey every attribute mentioned in the metadata model.
Session Recording Client (SRC) MAY initiate the Recording Session.
Here, Recording Session is a completely independent from the Communication Session that is being recorded at both the SIP dialog level and at the session level.
The metadata MUST be conveyed from SRC to SRS. The metadata MAY be conveyed within the Recording Session Dialog.
</t>

<t>	Note that the metadata model captures changes that occur over the duration of the recording session. For example, if the call is transferred from one participant to another, then the SRC SHALL convey a change of participant and the properties of the new media stream to the SRS.</t>
<t>Some of the data in the model may not be conveyed explicitly from the SRC to the SRS, if it can be obtained contextually by the SRS. For instance, the timing of RS block changes(like Start / Stop time) may not be explicitly conveyed from the SRC to the SRS (The Date header in RS dialog SIP message MAY provide the timing, but it is optional). In such cases the time a change occurred may be assumed to be the same as the time when notification of the change is received by the SRS.</t>
		</section>

		<section title="Recording Metadata elements">
			<t>
				This section describes each element of the metadata model, and the attributes of each element. This section also describes how different elements are associated.</t>
			<section title="Recording Session">
				<artwork>
					<![CDATA[
+-------------------------------+               
| Recording Session (RS)        |               
+-------------------------------+               
|                               |            +-----------------+
|     Start/End Time            |    1  0..* |                 |
|                               |------------|Extension Data   |
|                               |            |                 |
|                               |            +-----------------+
+-------------------------------+ 
      |1..*            | 1..* 
      |                |      
      |0..*            | 0..* 
 Communication    Communication 
 Session          Session Group(CS Group)
					]]>
				</artwork>
				<t>A Recording Session element represents a SIP session created between an SRC and SRS for the purpose of recording a Communication Session. A SIP RS dialog SHALL be mapped to this element and hence there is no need for this element to be reflected in metadata XML.</t>
				
			<section title="Attributes">
				<t> A Recording Session element MAY have attributes like:</t>
				<list style='symbols'>
					<t> Start/End Time - Start and End time value SHALL be derived from Date header(if present in SIP message) in RS. In cases where Date header is not present, Start/End time SHALL be the time at which SRS receive the SIP message to setup RS / disconnect RS.  </t>
				</list> 
								
				</section>
				<section title="Associations">
					<t>One instance of Recording Session SHALL have:</t>
					<t>
						<list style='symbols'>
							<t>Zero or more instances of  Communication Session Group. CSG may be zero because it is optional metadata block. Also the allowance of zero instances is to accommodate persistent recording, where there may be none.</t>
							<t>Zero or more instances of Communication Session blocks.</t>
							<t>Each CS Group MUST be associated with one or more Recording Sessions [Here each RS can be setup by the potentially different SRCs.] </t>
						</list>
					</t>
				</section>
			</section>
			<section title="Communication Session Group">
				<artwork>
					<![CDATA[
 Recording Session (RS)
           | 1..*
           | 
           | 0..* 
+-------------------------------+               
| Communication Session         |
|     Group                     |               
+-------------------------------+               
|  Unique-ID                    |           +----------------+
|                               |   1  0..* |                |
|                               |-----------|Extension Data  |
|                               |           |                |
+-------------------------------+           +----------------+
           | 0..1                               
           |                                    
           | 1..*                               
 Communication Session (CS)
					]]>
				</artwork>
			
				<t>
					A Communication Session Group provides  association or linking of Communication Sessions.
				</t>
				<section title="Attributes">
					<t> A CS Group MUST have a Unique-ID attribute. This Unique-ID is to group different CSs that are related. SRC (or MAY be SRS) MUST ensure the uniqueness of Unique-ID in case multiple SRC interacts with the same SRS. The mechanism by which SRC groups the CS is outside the scope of SIPREC. </t>
				</section>
				<section title="Associations">
					<t>A communication Session Group SHALL be associated with RS and CS in the following manner:</t>
					<t>
						<list style='symbols'>
							<t> There can be one or more Recording Session elements per Communication Session Group. </t>
							<t>Each Communication Session Group MUST be associated with one or more RS [Here each RS can be setup by the potentially different SRCs] </t>
							<t> There MAY be one or more Communication Sessions per CS Group [e.g. Consult Transfer]</t>
							<t>Each CS MAY be associated to zero or one CS-Group</t>
						</list>
					</t>
				</section>
			</section>

			<section title="Communication Session">
				<artwork>
					<![CDATA[
 
Recording	       Communication 
Session            Session Group(CS Group)
   |1..*                  | 0..1
   |                      | 
   |0..*                  | 1..* 
+-------------------------------+               +-----------------+
|   Communication Session (CS)  |       1  0..* |                 |
|                               |---------------|Extension Data   |
+-------------------------------+               |                 |
|   CS Identifier               |               +-----------------+
|   Termination Reason          |
|   Start Time                  |
|   End Time                    |
+-------------------------------+
   |                      |
   | 1..*                 |1..*              
   |                      |                  
   | 2..*                 |0..*              
Participant              Media Stream

					]]>
				</artwork>
				<t>A Communication Session block/element in the metadata model represents Communication Session and its properties needed as seen by SRC. </t>
				
				<section title="Attributes">
					<t> A communication Session block SHALL have the following attributes:</t>
					<t>
						<list style='symbols'>
							<t>Termination Reason - This represents the reason why a CS was terminated. The communication session MAY contain a Call Termination Reason. This MAY be derived from SIP Reason header of CS.</t>
							<t>CS Identifier - This attribute is used to uniquely identify a CS.</t>
							<t>Start Time - This optional attribute represents CS start time</t>
							<t>End Time - This optional attribute represents CS end time</t>
						</list>	
					</t>
					<t>Attributes like Retention (represent the value/duration for which Media streams of the CS needs to be retained), Force Deletion, Access Information e.t.c  that are primarily related to policy  will not be passed in metadata from SRC to SRS. However if there are implementations where SRC has enough information, this could be sent as Extension Data attached to CS</t>
					</section>
				<section title="Associations">
					<t>
						A Communication Session SHALL be associated to CS-Group, Participant, Media Stream and Recording Session blocks. Cardinalities between CS and Participant allows:
					</t>
					<t>
						<list style='symbols'>
							<t>CS to have atleast two or more participants</t>
							<t>Participant SHALL be associated with one or more CS’s. This may even includes participants who are not directly part of any CS. An example of such a case is participants in a premixed media stream. The SRC may have knowledge of such Participants, yet not have any signaling relationship with them. This might arise if one participant in CS is a conf focus. Another use case is if one UA in CS works in 3pcc mode to acquire an MoH media stream, this might be reflected as unique source for media stream without having a reported signaling relationship to it. In all these cases if SRC can learn enough information about the Participant, they SHALL be associated with CS.</t>
							<t>The model also allows participants in CS that are not participants in the media. An example is the identity of a 3pcc controller that has initiated a CS to two or more participants of the CS. Another example is the identity of a conference focus. Of course a focus is probably in the media, but since it may only be there as a mixer, it may not report itself as a participant in any of the media streams.</t>
						</list>
					</t>
					<t>Cardinalities between CS and Media Stream allows:</t>
					<t>
						<list style='symbols'>
							<t>A CS to have zero or more Streams</t>
							<t>
								A stream can be associated with 1 or more CS. An example is multicast MoH stream which might be associated with many CSs. Also if we were to consider a B2BUA to have a separate CS on each "side" then they might share a stream.(Though more likely this would be treated as a single CS.)
							</t>
						</list>
					</t>
					<t>Cardinalities between CS and RS allows:</t>
					<t>
						<list style='symbols'>
							<t>One instance of RS SHALL have Zero or more instances of Communication Session blocks.</t>
							<t>Each CS SHALL be associated with one more RS [ Here each RS can be potentially setup by different SRCs]</t>
						</list>
					</t>
				</section>
			</section>

			<section title="Participant">
				<artwork>
					<![CDATA[
 Communication Session (CS)
           | 1..*
           | 
           | 2..* 
+-------------------------------+               
|          Participant          |
|                               |               
+-------------------------------+               
|  AoR list                     |            +-----------------+
|  Name                         |    1  0..* |                 |
|  Participant Type             |------------|Extension Data   |
|                               |            |                 |
+-------------------------------+            +-----------------+
        | 0..*       1..*|                            
receives|                |sends                    
        | 0..*       0..*|                        
          Media Stream
		  
]]>
				</artwork>	
				<t>
					A Participant block has information about a device that is part of a CS and/or contributes/consumes media stream(s) belonging to a CS.</t>
				<section title="Attributes">
					<t> Participant has attributes like:</t>
					<t>
					<list style='symbols'>
						<t>AoR list - Has list of AoRs. An AoR MAY be SIP/SIPS/TEL URI. There MAY be cases where a participant can have more than one AoR [ e.g. P-Asserted-ID which can have both SIP and TEL URIs]</t>
						<t>Name - This attribute represents Participant name(SIP display name) or DN number ( in case it is known)</t>
					</list>
					<t>Other attributes [ like Participant Role, Participant type ] MAY be carried as part of extension data to Participant from SRC to SRS.</t>
					</t>
				</section>
				<section title="Associations">
					<t>Cardinalities between participant and Media Stream allows:</t>
					<t>
					<list style='symbols'>
						<t> Participant to receives zero or more media streams</t>
						<t> Participant to send zero or more media streams. (Same participant provides multiple streams e.g. audio and video)</t>
						<t>	Media stream to be received by zero or more participants. Its possible, though perhaps unlikely, that a stream is generated but sent only to the SRC and SRS, not to any participant. E.g. In conferencing where all participants are on hold and the SRC is collocated with the focus. Also a media stream may be received by multiple participants (e.g. Whisper calls, side conversations).</t>
						<t>	Media stream to be sent by one or more participants (pre-mixed streams).</t>
					</list>
					<t>
						Example of a case where a participant may receive Zero or more streams - a Supervisor may have side conversation with Agent, while Agent converses with customer.
					</t>
					</t>
				</section>
			</section>
			
			<section title="Media Stream">
				<artwork>
					<![CDATA[
                              Participant			
                            | 0..*       1..*|                            
                    receives|                |sends                    
                            | 0..*       0..*|                        
                         +-------------------------+               
                         |          Media Stream   |
                         |                         |               
Communication 1..*  0..* +-------------------------+               
  Session    ------------|  Start Time             |        +----------+
                         |  End Time               |1  0..* |          |
                         |  Media Stream Reference |--------|Extension |
                         |                         |        | Data     |
                         +-------------------------+        +----------+
					]]>
				</artwork>
				<t>A Media Stream block SHALL have properties of media as seen by SRC and sent to SRS. Different instances of Media Stream block would be created whenever there is a change in media (e.g. dir change like pause/resume and/or codec change and/or participant change.).</t>
				<section title="Attributes">
					<t>A Media Stream block SHALL have the following attributes:</t>
					<t>
						<list style='symbols'>
							<t>Start Time - Represents Media Start time at SRC.</t>
							<t>End Time - Represents Media End time at SRC. This is an optional attribute and MAY be included after a stream ends</t>
							<t>Media Stream Reference - In implementations this can reference to m-line </t>
						</list>
					</t>
					<t>The metadata model should include media streams that are not being delivered to the SRS. Examples include cases where SRC offered certain media types but SRS chooses to accept only a subset of them OR an SRC may not even offer a certain media type due it its restrictions to record</t>
				</section>
			<section title="Associations">
				<t>A Media Stream SHALL be associated with Participant  and CS. The details of association with the Participant are described in the Participant block section. The details of association with CS is mentioned in the CS section. </t>
			</section>
			</section>
					
			<section title="Extension Data">
				<t>
					A recording metadata object contains additional data not specified as part of siprec. This is intended to accommodate future standards track extensions, as well as vendor and user specific extensions. The mechanism MUST provide a means of unambiguously distinguishing such extension data.</t>
				
				</section>
		
		</section>

		<section title="Metadata Model Object Instances">
			<t>This section describes the metadata model object instances for different use cases of SIPREC. For the sake of simplicity as the media streams sent by each of the participants is received by every other participant in these use cases, it is NOT shown in the object instance diagrams below. Also for the sake of ease not all attributes of each block are shown in these instance diagrams.</t>
			<section title="Use case 1: Basic Call">
				<t> Basic call between two Participants A and B. In this use case each participant sends one Media Stream. For the sake of simplicity "receives" lines are not shown in this instance diagram. Media Streams sent by each participant is received all other participants of that CS. </t>
				<artwork>
					<![CDATA[
+-------------------------------+             
| Recording Session (RS)        |              
+-------------------------------+     
           |                             
           | 
           |     
  +----------------+ 
  | Communication  |
  | Session (CS)   |
  +----------------+-----------------------+
  |  Start Time    |                       |
  +----------------+                       |
           |                               |
           |-------------------+           |
           |                   |           |
+---------------+     +---------------+    |
| ParticipantA  |     | ParticipantB  |    |
|               |     |               |    |
+---------------+     +---------------+    |
           |                  |            |
  sends    |                  |  sends     |
           |                  |            | 
+---------------+       +---------------+  |
|Media Stream A1|       |Media Stream B1|  | 
+---------------+       +---------------+  |
|MediaStream Ref|       |MediaStream Ref|  |
|Start Time     |       |Start Time     |  |
+---------------+       +---------------+  |
       |                       |           |
       +-----------------------------------+ 
				 ]]>
				</artwork>
			</section>

			<section title="Use case 2: Basic Call with hold/resume">
				<t> Basic call between two Participants A and B and with Participant A or B doing a Hold/Resume. In this use case each participant sends one Media Stream. After Hold/Resume the properties of Media MAY change. For the sake of simplicity "receives" lines are not shown in this instance diagram. Media Streams sent by each participant is received all other participants of that CS.</t>
				<artwork>
					<![CDATA[
+-------------------------------+             
| Recording Session (RS)        |              
+-------------------------------+               
           |                   |                 
           |                   |                 
           |                   |                
           |                 +-------------------------------+
           |                 |   Communication Session (CS)  |
           |     +-----------|      Group(CSG)               |
           |     |           +-------------------------------+
           |     |           |   Unique-id1                  |
           |     |           +-------------------------------+
           |     |                        
           |     |                             
           |     |
  +----------------+ 
  | Communication  |
+-| Session (CS)   |----------------------------------------------+
| +----------------+                                              |
| |                |                                              |
| +----------------+                                              |
|            |                                                    |
|            |-------------------+                                |
|            |                   |                                |
| +---------------+     +---------------+                         |
| | ParticipantA  |     | ParticipantB  |-----------+             |
| |               |--+  |               |           |             |
| +---------------+  |  +---------------+           |sends(After  |
|       |       |    |       |         |            |     Resume) |
|       |       |    |       |         |         +--------------+ |
| sends |       |     +--+   |  sends  |         |MediaStream B3| |
|       |       -----+   |   |          +-----+  +--------------+ |
| +---------------+  |   |  +---------------+ |  |MediaStreamRef|-|
| |Media Stream A1|  |   |  |Media Stream B1| |  | Start Time   | |
| +---------------+  |   |  +---------------+ |  |              | |
+-|MediaStreamref |  |   |  |MediaStreamRef | |  +--------------+ |
  |Start Time     |  |   |  |Start Time     |-|-------------------|
  +---------------+  |   |  +---------------+ |                   |
                     |   |                    |                   |
        +------------+   |sends               |sends (hold)       |
        | sends          |(Resume)            |                   |
        | (hold)         +-------+             +-------+          |
        |                        |                     |          |
  +---------------+       +---------------+   +--------------+    |
  |Media Stream A2|       |Media Stream A3|   |MediaStream B2|    |
  +---------------+       +---------------+   |              |    |
  |MediaStreamref |       |MediaStreamRef |   +--------------+    |
  |End Time       |       |Start Time     |   |Codec Params  |    |
  +---------------+       +---------------+   |end Time      |    |
           |                     |            |              |    |
           |                     |            +--------------+    |
           |                     |                  |             |
           +------------------------------------------------------+
				 ]]> 
				</artwork>
			</section>
			<section title="Use case 3: Basic call with Transfer">
				<t> Basic call between two Participants A and B and with Participant A  transfer(consult transfer) to Participant C. In this use case each participant sends one Media Stream. After transfer the properties of Participant A Media MAY change. For the sake of simplicity "receives" lines are not shown in this instance diagram. Media Streams sent by each participant is received all other participants of that CS.</t>
				<artwork>
					<![CDATA[
+-------------------------------+             
| Recording Session (RS)        |-------+              
+-------------------------------+       |        
           |                            |        
           |                            |        
           |                            |       
+-------------------------------+       |      
|   Communication Session (CS)  |       |   
|      Group(CSG)               |       |
+-------------------------------+       |
|   Unique-id1                  |       |
+-------------------------------+       |     
           |                            | 
           |----------------------------+
           |
           |-----------------+          
           |                 |
+----------------+     +----------------+
| Communication  |     | Communication  | 
| Session (CS)1  |     | Session (CS)2  | 
+----------------+     +----------------+-----------+
|                |     |                |           |
+----------------+     +----------------+           |
           |                                        |
           |-------------------+                    |
           |        |          |                    |
+---------------+   | +---------------+             |
| ParticipantA  |   | | ParticipantB  |             |
|               |   | |               |             |
+---------------+   | +---------------+             |
           |        |         |                     |
  sends    |        |         |  sends              |
           |        |         |                     |
+---------------+   |   +---------------+           |
|Media Stream A1|   |   |Media Stream B1|           |
+---------------+   |   +---------------+           |
|               |   |   |               |           |
|               |   |   | Media Stream  |           |
| Media Stream  |---+---|  Ref          |           |
| Ref           |       |               |           |
+---------------+       +---------------+           |
                                                    |
                                                    |
                       +----------------------------|
                       |                            |
      +--------------------------------+            |
      |                                |            |
+---------------+                +---------------+  |
| Participant A |                | Participant C |  |
|   (same)      |                |               |  |
+---------------+                +---------------+  |
      |                                    |        |
      | sends (After transfer)             | sends  |
+----------------+                +----------------+|
| Media Stream A2|                | Media Stream C1||
+----------------+                +----------------+|
| Media StreamRef|                | Media StreamRef||
|                |                |                ||
|                |                |                ||
+----------------+                +----------------+|
        |                                  |        |
        |                                  |        |
        |                                  |        |
        +-------------------------------------------+
				 ]]>
				</artwork>

			</section>
			<section title="Conference Use Cases">
				<t>Depending on who act as SRC and the information that an SRC has there can be several ways to model conference use cases. This section has instance diagrams for the following cases:</t>
				<t>
					<list style='symbols'>
						<t>A CS where one of the participant (which is also SRC) is a user in a conference</t>
						<t>A CS where one of the participant is focus ( which is also SRC)</t>
						<t>A CS where one of the participant is user and the SRC is a different entity like B2BUA</t>
						<t>A CS where one of the participant is focus and the SRC is a different entity like B2BUA</t>
					</list>
					<t>NOTE: There MAY be other ways to model the same use cases depending on what information the SRC has.</t>
				</t>
				<section title='Case 1:'>
					<t>This is the usecase where there is a CS with one of the participant (who is also SRC) as a user in a conference. For the sake of simplicity the receive lines for each of the participant is not shown.</t>
					<artwork>
						<![CDATA[
+---------------------------------------------------+
|      Communication Session                        |
| +-------------+              +--------------+     |
| |             |              |              |     |
| |Participant B|              | Participant A|     |
| |  (User in   |--------------|              |     |
| |  conf/SRC)  |              |              |     |
| +-------------+              +--------------+     | 
|   |  |  |  |                                      | 
+---------------------------------------------------+
    |  |  |  |
    |  |  |  |
    D   E  F  G (Participants of Conference)


Instance Diagram:

+-------------------------------+             
| Recording Session (RS)        |--+            
+-------------------------------+  |   
           |                       | 
           |                       |
           |                       |
+-------------------------------+  |           
|   Communication Session (CS)  |  |        
|      Group(CSG)               |  |
+-------------------------------+  |
|   Unique-id1                  |  |
+-------------------------------+  |         
           |                       |      
           |-----------------------+ 
           |     
  +----------------+ 
  | Communication  |
  | Session (CS)   |--+----------------+-----+
  +----------------+  |                |     |
  |                |  |                |     |
  +----------------+  |                |     |
           |          |                |     |
           |          |                |     |
           |          |                |     |
+---------------+     |                |     |
| ParticipantA  |     |                |     |
|               |     |                |     |
+---------------+     |                |     |
           |          |                |     |
  sends    |          |                |     |
           |          |                |     |
+---------------+     |                |     |
|Media Stream A1|     |                |     |
+---------------+     |                |     |
|MediaStream Ref|-----|----------------+     |
|               |     |                |     |
+---------------+     |                |     |
                      |                |     |
                      |                |     |
        +-------------+                |     |
        |                              |     |
        |                              |     |
+----------------+                     |     |
| Participant B  |                     |     |
|  (in conf)     |                     |     |
+----------------+                     |     | 
        |                              |     |
 sends  |                              |     |
        |                              |     | 
+----------------+                     |     |
| Media Stream B1|---------------------+     | 
+----------------+        sends              |
| MediaStream Ref|                           |
|                |         +-----------------+
+----------------+         |      
           |               |
           |sends          |
           |               |
     +-----------------+-------------+------------+
     |                 |             |            | 
     |                 |             |            |
+------------+  +------------+ +------------+ +-------------+
|participantD|  |ParticipantE| |ParticipantF| |Participant G|
+------------+  +------------+ +------------+ +-------------+ 

						]]>
					</artwork>
					<t>In this example we have two participants A and B who are part of a Communication Session(CS). One of the participants B is part of a conference and also acts as SRC.There can be two cases here. B can be a participant of the conference or B can be a focus. In this instance diagram Participant B is a user in a conference. The SRC (Participant B) MAY subscribe to conference event package to get the details of other particiants. Participant B(SRC) SHALL send the same through the metadata to SRS. In this instance diagram the Media Stream(mixed stream) sent from Participant B SHALL have media streams contributed by conference participants (D,E,F and G). For the sake of simplicity the "receives" line is not shown here. In this example the media stream sent by each participant(A or B) of CS is received by all other participant(A or B).</t>
				</section>
				<section title='Case 2:'>
					<t>This is the usecase where there is a CS where one of the participant is focus ( which is also SRC). </t>
					<artwork>
						<![CDATA[
						
+---------------------------------------------------+
|      Communication Session                        |
| +--------------+              +--------------+    |
| |              |--------------|              |    |
| |Participant C |              | Participant A|    |
| |  (Focus in   |------+       |              |    |
| | conf and SRC)|---+  |       +--------------+    |
| +--------------+   |  |                           |
|   |                |  +---------+                 |
|   |                |            |                 |
| +--------------+   |         +---------------+    |
| | Participant B|   +---+     | Participant D |    |
| |              |       |     |               |    |
| +--------------+       |     +---------------+    |
|                        |                          |
|                   +--------------+                |
|                   |Participant E |                |
|                   |              |                |
|                   +--------------+                |
|                                                   |
+---------------------------------------------------+

Instance Diagram:

+-------------------------------+ 
| Recording Session (RS)        |  
+-------------------------------+     
           |-------------------------+
           |                         |
           |                         |
+-------------------------------+    |
|   Communication Session (CS)  |    |
|      Group(CSG)               |    |
+-------------------------------+    |
|   Unique-id1                  |    |
+-------------------------------+    |       
           |                         |    
           |-------------------------+ 
           |     
  +----------------+ 
  | Communication  |
  | Session (CS)   |----------------------+  
  +----------------+                      | 
  |                |                      |
  +----------------+                      |
           |                              |
           |-------------------+          |
           |        |          |          |
+---------------+   | +---------------+   |
| ParticipantA  |   | | ParticipantB  |   |
|               |   | |               |   |
+---------------+   | +---------------+   |
           |        |         |           |
  sends    |        |         |  sends    |
           |        |         |           |
+---------------+   |   +---------------+ |
|Media Stream A1|   |   |Media Stream B1| |
+---------------+   |   +---------------+ |
|MediaStream Ref|   |   |MediaStream Ref| |
|               |---+---|               | |
+---------------+       +---------------+ |
                                          |
       +----------------------------------+
       |            |         |           |
       |            |         |           |
+---------------+   | +---------------+   |
| ParticipantD  |   | | ParticipantE  |   |
|               |   | |               |   |
+---------------+   | +---------------+   |
           |        |         |           |
  sends    |        |         |  sends    |
           |        |         |           |
+---------------+   |   +---------------+ |
|Media Stream D1|   |   |Media Stream E1| |
+---------------+   |   +---------------+ |
|MediaStream Ref|   |   |MediaStream Ref| |
|               |---+---|               | |
+---------------+       +---------------+ |
                                          |
                                          |
                               +----------+
             +-----------------|
             |                 | 
             |                 |
            +----------------+ |
            | Participant C  | |   
            |  (focus +src)  | |
            +----------------+ |
                    |          |
             Sends  |  +-------+
                    |  |
"sends" OR          |  |   
contributed +----------------+
 by         | Media Stream C1| 
Participants+----------------+  "receives" by participants A,B,D,E
A,B,D,E     | MediaStream Ref|------------------------------------
------------| Codec Params   | 
            +----------------+

						]]>
					</artwork>
					<t>In this example we have two participants A and B who are part of a Communication Session(CS). One of the participants (C) is focus of a conference and also acts as SRC. The SRC (Participant C) being the Focus of the conference SHALL have access to the details of other particiants. SRC (Participant C) SHALL send the same through the metadata to SRS. In this instance diagram the Media Stream(mixed stream) sent by C SHALL have media streams contributed by conference participants (A, B, D and E). Participants A, B,D and E SHALL send Media Streams A1, B1, D1 and E1 respectively. The media stream sent by Participant C(Focus) shall be received by all other participants of CS. For the sake of simplicity the "receives" line is not shown linked to all other participants.</t>
					<t>NOTE: SRC ( Participant C) MAY send mixed stream or seperate streams to SRS</t>
				</section>
				<section title='Case 3:'>
					<t>A CS where one of the participant is user and the SRC is a different entity like B2BUA. In this case the SRC MAY not know that one of the user is part of conference. Hence the instance diagram will not have information about the conference participants.</t>
					<artwork>
						<![CDATA[
+---------------------------------------------------+
|      Communication Session                        |
| +-------------+  +------+    +--------------+     |
| |             |  | (SRC)|    |              |     |
| |Participant B|--|B2BUA |----| Participant A|     |
| |  (User in   |  +------+    |              |     |
| |  conf)      |              |              |     |
| +-------------+              +--------------+     |
|   |  |  |  |                                      |
+---------------------------------------------------+
    |  |  |  |
    |  |  |  |
    D   E  F  G (Participants of Conference)
						]]>
					</artwork>
				</section>
				<section title='Case 4:'>
					<t>A CS where one of the participant is focus and the SRC is a different entity like B2BUA. In this case the participant which is focus MAY send "isfocus" in SIP message to SRC. The SRC MAY subscribe to conference event package on seeing this "isfocus". SRC SHALL learn the details of other participants of conference from the conference package and send the same in metadata to SRS. The instance diagram for this use case SHALL be same as Case 1.</t>
					<artwork>
						<![CDATA[
	   +--------------------------------+
	   |   Conference Event Package     |
	   |                                |
	   +--------------------------------+ 
                      |
                      | subscribes
                      |
+---------------------|-----------------------------+
|      Communication  |Session                      |
| +-------------+  +------+    +--------------+     |
| |             |  | (SRC)|    |              |     |
| |Participant B|--|B2BUA |----| Participant A|     |
| |  (FOCUS in  |  +------+    |              |     |
| |  conf)      |              |              |     |
| +-------------+              +--------------+     |
|   |  |  |  |                                      |
+---------------------------------------------------+
    |  |  |  |
    |  |  |  |
    D   E  F  G (Participants of Conference)
						]]>
					</artwork>
				</section>
			</section>
		</section>

		<section title="Security Considerations">
			<t>The metadata information sent from SRC to SRS MAY reveal sensitive Information about different participants of CS.  For this reason, it is RECOMMENDED that a SRC use a strong means for authentication and metadata information protection and that it apply comprehensive authorization rules when using the metadata model defined in this document. The security considerations for this SHALL be defined in the solution document.</t>
		</section>
		<section title="IANA Considerations" anchor="sec.iana-considerations">
			<t>Not Applicable</t>
		</section>
		<section title="Acknowledgement">
			<t>
				We wish to thank John Elwell, Henry Lum, Leon Portman, De Villers, Andrew Hutton, Deepanshu Gautam, Charles Eckel, Muthu Arul  for their valuable comments.
			</t>
		</section>

	</middle>
	<back>
 		<references title="Normative References">
			<?rfc include="reference.RFC.2119"?>
            </references>
            <references title="Informative References">
			  <?rfc include="reference.I-D.ietf-siprec-req"?>
			  <?rfc include="reference.I-D.ietf-siprec-architecture"?>
		  </references>
	</back>
</rfc>

