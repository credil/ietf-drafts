<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" >
<?rfc sortrefs='yes' ?>
<?rfc iprnotified='yes' ?>
<?rfc topblock='yes' ?>
<?rfc toc='yes' ?>
<?rfc strict='yes' ?>
<?rfc compact='yes' ?>
<?rfc subcompact='no' ?>
<?rfc symrefs='no' ?>
<?rfc notedraftinprogress='yes' ?>
<rfc ipr="trust200902" category="info" submissionType="IETF" docName="A Session Initiation Protocol (SIP) Event Package for Communication
  Barring Notification Information in support of the Dynamic Incoming Communication Barring (ICB) service
       draft-avasarala-dispatch-comm-barring-notification-01.txt">

<front>
<title abbrev="SIP Communication Barring Notification"></title>
<author fullname="Ranjit Avasarala" initials="Ranjit" surname="Avasarala">
<organization abbrev="Motorola Solutions Inc">Motorola Solutions India Pvt Ltd</organization>
    <address>
      <postal>
        <street> Bagamane Tech Park, C V Raman Nagar </street>
        <city> Bangalore </city>
        <code> 560093 </code>
        <country> India </country>
      </postal>
      <email>ranjit@motorolasolutions.com</email>
   </address>
</author>
<author fullname="Roland Jesske" initials="R" surname="Jesske">
<organization abbrev="Deutsche Telekom">Deutsche Telekom</organization>
    <address>
    <postal>
    <street> Heinrich-Hertz-Strasse 3-7 </street>
    <city> Darmstadt </city>
    <code> 64307 </code>
    <country> Germany </country>
    </postal>
     <email>r.jesske@telekom.de</email>
    </address>
</author>
<date></date>
<workgroup>DISPATCH</workgroup>
<abstract>
   <t> 3GPP is defining the protocol specification for the Communication
   Barring (CB) service using IP Multimedia (IM) Core Network (CN)
   subsystem supplementary service and more particularly the dynamic
   incoming communication barring service.  As part of dynamic incoming
   communication barring (ICB) service, a SIP based Event package
   framework is used for notifying users about communication barrings
   (dynamic and rule based) of their incoming communication sessions.
   This document proposes a new SIP event package for allowing users to
   subscribe to and receive such notifications.  Users can further
   define filters to control the rate and content of such notifications.
   The proposed event package is applicable to the ICB supplementary
   service in IMS and may not be applicable to the general internet..
   </t>
</abstract>
</front>   
<middle>
<section title="Introduction" toc="default">
<t> 3GPP is currently maintaining and specifying incoming communication
   barring mechanisms which allow users to dynamically block incoming
   communications from callers whom they consider as unwanted or
   unsolicited.  The intention of such mechanisms is to provide users
   with sufficient flexibility to manage their incoming communications
   in a better way.  The most common example is the Anonymous
   Communication Rejection (ACR) where in the incoming communications
   from senders whose identity is marked as "Anonymous" is rejected.
   Similarly other variants of ICB include dynamically blocking a
   particular caller by the subscribers, called the dynamic ICB which is
   specified in 3GPP specification <xref target="3GPP.24.611"></xref>.
<vspace blankLines="1"></vspace>
However, However, with the increasing number of unwanted calls and increased
   usage of incoming communication barring services, users may have lot
   of callers being blocked from time to time and for different periods
   based on temporary or permanent block.  For instance, a user may have
   blocked a particular caller for a temporary period and specified the
   period as 1 year.  Though there are ways by which users can keep
   track of their communication barrings, there is no efficient
   mechanism for the users to get information of their communication
   barrings that get enacted in the network.  This information would
   help them to verify their rules and rectify if required
<vspace blankLines="1"></vspace>
This document defines a SIP event package that allows a SIP User
   Agents to subscribe to and be notified of communication barrings
   enacted on their behalf
</t>
</section>                                 
<section title="Terminology">
<t> In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
   and "OPTIONAL" are to be interpreted as described in RFC 2119 <xref target="RFC2119"></xref>
   and indicate requirement levels for compliant implementations.  </t>
</section>
<section title="Applicability Statement">
<t> It is believed that the SIP event package defined here is not applicable to the general Internet and has been designed to serve the
architecture of the Dynamic ICB service defined for IMS core networks. The aim of this memo is to follow the procedure indicated in RFC 5727
<xref target="RFC5727"></xref> and to register a new event package with event name "comm-barring-info" with IANA.
 </t>
</section>
<section title="Abbreviations and Definitions">
<section title="Abbreviations">
<t>
<list style="empty">
<t> CB: Communication Barring. </t>
<t> CBN: Communication Barring Notification. </t>
<t> ICB: Incoming Communication Barring. </t>
</list>
</t>
</section>
<section title="Definitions">
<t>
<list style="empty">
<t> Subscriber - The User Agent who has subscribed to the Communication Barring notification service. </t>
<t> User - Another term for the subscriber. </t>
<t> Barring User - The User Agent who has configured a Communication Barring. This could be the User Agent who has configured
    the Incoming Communication Barring service rules in the network. </t>
<t> Originating User - The User Agent who is the originator of the incoming communication, The Originating
      User is also referred to as the Caller. </t>
<t> IMS Core Network - This refers to the IMS based SIP based network that conforms to the <xref target='3GPP.24.229'></xref> 
    and not the general SIP network as defined in <xref target='RFC3261'></xref>.</t>
</list>
</t> 
</section>
</section>
<section title="Requirements">
<t>The Communication Barring Notification (CBN) service enables a user to receive notification about the barring of any of his/her incoming 
   communications, which were addressed to the user's address. A comprehensive description of all the requirements that affect the 
   CBN service developed by 3GPP and is found in <xref target="3GPP.22.173"> and </xref> and <xref target="3GPP.24.611"></xref>
</t>
</section>
<section title="Package Definition">
<t> This section fills in the details needed for an event package as defined in Section 4.4 of <xref target="RFC3265"></xref>.</t>
<section title="Event Package Name">
<t> The SIP Events specification requires package definitions to specify the name of their package or template-package.
<vspace blankLines="1"></vspace>
The name of this package is "comm-barring-info". As specified in <xref target="RFC3265"></xref>, this value appears in the Event
header present in SUBSCRIBE and NOTIFY requests. </t>
</section>
<section title="Event Package Parameters">
<t> The SIP Events specification <xref target="RFC3265"></xref> allows packages to define additional parameters. This event package 
 "comm-barring-info" does not define additional parameters.
. </t>
</section>
<section title="SUBSCRIBE bodies">
<t> The SIP Events specification requires package or template-package definitions to define the usage, if any, of bodies in SUBSCRIBE requests.
<vspace blankLines="1"></vspace>
A SUBSCRIBE for Communication Barring event MAY contain a body. The purpose of the body depends on its type. Subscriptions to
the Comm_barring-info event package SHALL only include a body of MIME type "application/comm-barring-info+xml". 
<vspace blankLines="1"></vspace>
A body of the SUBSCRIBE request with content type set to MIME type "application/comm-barring-info+xml" contains information about the communication
barring notification information filter criteria and notification trigger criteria.  The subscriber SHALL also verify that this information conforms to a valid XML document as defined in 
<xref target="W3C.REC-xml-20001006"></xref>. The subscriber SHALL also verify that the information contained in the XML document contains elements defined
in <xref target='comm-barring-subs-info'></xref> only. </t>
</section>
<section title="Subscription Duration">
<t> The default expiration time for subscriptions within this package is 3600 seconds.  As per <xref target='RFC3265'></xref>, the subscriber
    MAY specify an alternate expiration in the Expires header field.
</t>
</section>
<section title="Notify bodies">
<t>The SIP Events specification requires package definitions to define a default value for subscription durations, and to discuss 
reasonable choices for durations when they are explicitly specified.
<vspace blankLines="1"></vspace>
The NOTIFY message contains bodies. This body is a format listed in the Accept header field of the SUBSCRIBE request or a package 
specific default format if the Accept header field was omitted from the SUBSCRIBE request.
<vspace blankLines="1"></vspace>
In this event package, the body of the notification contains the communication barring information pertaining to the barring
that occurred in the network on behalf of the subscriber. The format of the communication barring information is an XML document
as per elements defined in <xref target='comm-barring-ntfy-info'></xref>.
<vspace blankLines="1"></vspace>
All subscribers and notifiers of the "comm-barring-info" event package MUST support the "application/comm-barring-info+xml" data format
described in <xref target="comm-barring-info-doc"></xref>. The SUBSCRIBE request MAY contain an Accept header field. If no such header 
field is present, it has a default value of "application/comm-barring-info+xml" (assuming Event header has a value of "comm-barring-info"). 
If the Accept header field is present, it MUST contain the value "application/comm-barring-info+xml".   </t>
</section>
<section title="Notifier Processing of SUBSCRIBE requests" anchor="NotifierP">
<t>
The contents of a document containing comm-barring-info information can contain sensitive information that can reveal some privacy 
information.  Therefore, such comm-barring-info documents MUST only be sent to authorized subscribers. In order to determine if a 
subscription originates in an authorized user, the subscriber MUST be authenticated as described in <xref target="Auth"></xref>
and then the user MUST be authorized to be a subscriber as described in <xref target="Autho"></xref>.
<vspace blankLines="1"/>
The Notifier MUST look into the SUBSCRIBE request body for a comm-barring-info document containing filter criteria.  If the 
filter criteria is present, it should check if the filter criteria conforms to the format described in Section 8.1.1.  If the received 
criteria is valid, then the NOTIFIER MUST use that for generating notifications about communication barrings that occur on behalf of
the user. 
</t>
<section title="Authentication" anchor="Auth">
<t>Notifiers MUST authenticate all subscription requests.  This authentication can be done using any of the mechanisms defined in
<xref target="RFC3261"></xref> and other authentication extensions.
</t>
</section>
<section title="Authorization" anchor="Autho">
<t> Once authenticated, the notifier makes an authorization decision.  A notifier MUST NOT accept a subscription unless 
authorization has been provided by the user.  The means by which authorization are provided are outside the scope of this document. 
Authorization may have been provided ahead of time through access lists, perhaps specified in a web page.  Authorization may have 
been provided by means of uploading some kind of standardized access control list document
</t>
</section>
</section>
<section title="Notifier Generation of NOTIFY requests" anchor="NotifierG">
<t> The SIP Events specification details the formatting and structure of NOTIFY messages. However, packages are mandated to provide 
detailed information on when to send a NOTIFY, how to compute the state of the resource, how to generate neutral or fake state information,
and whether state information is complete or partial.  This section describes those details for the "comm-barring-info" event package.
<vspace blankLines="1"></vspace>
A notifier MUST send a NOTIFY when a communication barring is enacted on behalf of the user. If there is a stored filter criteria for 
the user, then the notifier MUST look into the filter criteria before generating the NOTIFY request towards the user. If the filter criteria
matches, then the notifier generates the NOTIFY request and sends the NOTIFY request to the user. If the filter criteria does not match the
enacted communication barring, then the notifier just increments the communication barring count and does not send any NOTIFY request towards
the user.
<vspace blankLines="1"/>
The body of the NOTIFY MUST be sent using the type "application/comm-barring-info+xml" and must contain the elements defined in 
<xref target='comm-barring-ntfy-info'></xref> only. The Content-Type header field MUST be set to "application/comm-barring-info+xml".
<vspace blankLines="1"></vspace>
It is RECOMMENDED that the notifiers do maintain the history of last N communication barrings that occurred, where the value N >=1 as
part of state information for that server and include it in the communication barring notification information sent to the user. in addition to this 
it is also RECOMMENDED that the notifiers maintain the list of last M communication barring notifications sent to the user, where M equal to or less
than N. M equals N if notifications are sent for all communication barrings that occurred. The value M is decremented whenever a communication 
barring notification is sent to the user. The notifiers check the value of M as being greater than 0 prior to generating the notification information.
<vspace blankLines="1"/>
The value of N could be configured and is left to server policy to determine appropriate value. 
<vspace blankLines="1"></vspace>
The state information is retained even after the notification for those barrings are sent to the subscriber and changes when new barring 
occurs and whenever a notification is sent. So every time a new barring occurs and a notification is sent, the state information changes to reflect
the latest barring removing the oldest barring information and to reflect the latest notification information sent.
 </t>
</section>
<section title="Subscriber Processing of NOTIFY Requests">
<t> The SIP Events specification expects event packages to describe the process followed by the subscriber upon receipt of a 
NOTIFY request. In this specification, each NOTIFY request contains a comm-barring-info document
</t>
</section>
<section title="Handling of Forked Requests">
<t> The SIP Events specification requires each package to describe handling of forked Requests. 
<vspace blankLines="1"></vspace>
Though the incoming SUBSCRIBE request could be forked, this specification only allows a single dialog to be constructed as 
a result of emitting an initial SUBSCRIBE request, This guarantees that only a single notifier is generating notifications 
for a particular subscription to a particular user.
</t>
</section>
<section title="Rate of Notifications">
<t>
The SIP Events specification requires each package to specify maximum rate at which notifications can be sent . 
<vspace blankLines="1"></vspace>
Comm_barring-info notifiers SHOULD NOT generate notifications for a
  single subscription at a rate of more than once every five seconds.
</t>
</section>
<section title="State Agents">
<t>
The notifiers maintain the state of last N communication barrings and last M communication barring notification sent, where N (N>=1) is the
number of communication barrings that occurred in the network on behalf of the subscriber and M is the number of communication barring notifications
sent to the user. If notifications are sent for every communication barring that occurred, then M will be equal to N, else M will be less than N if
filter criteria comes into play. 
<vspace blankLines="1"></vspace>
Thus at any point of time a subscriber MAY know the state of communication barrings enacted on his or her behalf and number of notifications sent
by the server.
</t>
</section>
</section>
<section title="Comm_barring-info Document" anchor="Comm_barring-info">
<t> Comm_barring-info document is an XML document <xref target="W3C.REC-xml-20001006"></xref> that MUST be well-formed
and SHOULD be valid. Communication Barring Information documents MUST be based on XML 1.0 and MUST be encoded using UTF-8 
<xref target="RFC4745"></xref>.   </t>
</section>
<section title="Structure of Comm_barring-info Format" anchor="comm-barring-info-doc">
<t>A Communications Barring Information document starts with a "comm-barring-info" element. 
 The comm-barring-info element has a series of elements describing the particular communication barring or the filter criteria for
 receiving the communication barring information.  </t>
 <section title="Comm_barring-info Element" anchor="comm-barring-info-ele">
    <t> The comm-barring-info element gives information about the specific communication barring or it could give information 
    about a particular selection criteria for the user receiving the communication barring information.   </t>
     <section title="comm-barring-subs-info Element" anchor="comm-barring-subs-info">
        <t>The comm-barring-subs-info element is used by the subscribing user to specify the communication barring information
           selection criteria and the communication barring notification trigger criteria. It contains the following elements:
        </t>
        <section title="comm-barring-selection-criteria" anchor="sel">
          <t> This element contains information about communication barring information selection criteria. It contains
              following sub-elements for specifying the selection criteria. </t>
              <section title="originating-user-selection-criteria" anchor="orig">
                <t>This element specifies the originating user information for the communication i.e. the caller. This is specified
                   in the form of "user-name" and "user-uri". E.g. sip:Alice@domain.com. The Username as well as User-URI specified
                   will be compared with the originating user information of the current user and if there is a match, then
                   information about the barring of this specific communication would be selected for notification to the
                   Subscriber. It consists of the following sub-elements. </t>
                <section title="user-info" anchor="ui-info">
                  <t>This element gives user details like username and URI. This element has further sub-elements for
                     describing username and user URI</t>
                  <section title="User-name" anchor="uu">
                    <t> This element gives Username. "Alice". </t> 
                  </section>
                  <section title="User-URI" anchor="ui">
                    <t> This element gives User URI. E.g "sip:Alice@domain.com". It takes the form of any URI scheme like sip.
                        sips, tel or any other URI scheme</t>
                  </section> 
                </section>
              </section>
              <section title="barring-time-selection-criteria" anchor="div-time-sel">
                 <t>This element specifies the time range for receiving notifications. It contains following additional elements
                    .</t>
                 <section title="time-range" anchor="time">
                    <t> This element specifies the time range at which notifications for communication barrings can be sent
                        to the subscriber. This could be specified in the form of a time-interval to enable periodic triggering
                        of notifications of communication barrings which took place in that time-interval. 
                        <vspace blankLines="1"></vspace>
                        NOTE: If the time-range element is not specified, then notifications about every communication barring
                        that occurs is sent to the subscriber.
                    </t>
                        <section title="start-time" anchor="start">
                        <t> This element specifies the start time for receiving notifications. Its value is expressed in
                            YYYY:MM:DDTHH:MM:SSZ format.</t>
                    </section>
                    <section title="end-time" anchor="end">
                        <t> This element specifies the end time for receiving notifications. Its value is expressed in
                             YYYY:MM:DDTHH:MM:SSZ format.  </t>
                    </section>
                 </section>
              </section>
              <section title="barring-reason-selection-criteria" anchor="div-rea-sel">
                 <t>This element contains the reason for communication barring. It contains following sub-element: </t>
                 <section title="barring-reason-info" anchor="div-reason">
                   <t> This element gives the actual reason for the communication barring. E.g. "Call Forward on Busy".</t>
                 </section>
             </section>
             <section title="number-of-barrings-selection-criteria" anchor="div-num-sel">
                 <t> This element contains the total number of barrings that occurred in network on behalf of the user till then. </t>
             </section>
             <section title="number-of-notifications-selection-criteria" anchor="div-not-sel">
                 <t> This element contains the total number of communication barring notifications sent by the network to user till then. </t>
             </section>
        </section>
        <section title="comm-barring-ntfy-trigger-criteria" anchor="comm-barring-ntfy-tri">
           <section title="notification-time-selection-criteria" anchor="ntfy-time-sel">
             <t> This element informs the server about the time at which the notification should be triggered. </t>
           </section>
           <section title="presence-status-selection-criteria" anchor="pres-sel">
             <t> This element gives the presence status of the subscriber, based on which the decision can be made, whether the
                 subscriber wishes to receive notification information or not. </t>
             <section title="presence-selection-info" anchor="pres-info">
               <t> This element specifies the presence status of the subscriber within which the subscriber expects to receive 
                   notifications about communication barrings.
               </t>
             </section>
           </section>
        </section>
     </section>
     <section title="Comm-barring-ntfy-info Element" anchor="comm-barring-ntfy-info">
        <t> This element gives the notification information. This element has following sub-elements: </t>
        <section title="originating-user-info">
          <t> Refer to <xref target="orig"></xref> for details of this element. </t>
        </section>
        <section title="barring-time-info" anchor="bar-time">
           <t> This element gives the time of communication barring. Its value is expressed in 
               YYYY:MM:DDTHH:MM:SS format.  </t>
        </section>
        <section title="barring-reason-info" anchor="bar-reas">
           <t> This element contains the reason for the communication barring which could be because of the standard rules like
               ICB or ACR or any other custom rule defined by the subscriber. </t>
        </section>
        <section title="num-barrings" anchor="num-bar">
           <t> This element gives the number of communication barrings that occurred in the network on behalf of the user till date. </t>
        </section>
        <section title="num-notifications" anchor="num-not">
           <t> This element gives the number of communication barring notifications sent till date to the user. </t>
        </section>
     </section>
     <section title="Comm_barring-info-selection-criteria" anchor="comm-barring-info-sel">
       <t> This element gives the subscriber various to select communication barring information. This element has following
           sub-elements. </t>
       <section title="disable-originating-user-info" anchor="dis-orig">
           <t> This element gives the subscriber option of adding originating user information to the notification information. The
            default value is false which means the subscriber wants the originating-user-info element to be present in the
            notification information.
           </t>
       </section>   
       <section title="disable-barring-time-info" anchor="dis-div-time">
           <t> This element gives the subscriber option of adding barring-time information to the notification information.  The
            default value is false which means the subscriber wants the barring-time-info to be present in the notification
            information.
           </t>
       </section>
       <section title="disable-barring-reason" anchor="dis-div-rea">
           <t> This element gives the subscriber option of adding barring-reason information to the notification information.   The
            default value is false which means the subscriber wants the barring-reason information to be present in the
            notification information.
           </t>
       </section>       
       <section title="disable-barring-rule" anchor="dis-div-rule">
           <t> This element gives the subscriber option of adding barring-rule information to the notification information. The
               default value is false which means the subscriber wants the barring-rule information to be present in the
               notification information.
           </t>
       </section>
       <section title="disable-number-of-barrings" anchor="dis-num-div">
           <t> This element gives the subscriber option of adding number of barrings that occurred till date to the notification information.
               The default value is false which means the subscriber wants the number of barrings that occurred till date information to be present in
               the notification information
           </t>
       </section>
       <section title="disable-number-of-notifications" anchor="dis-num-not">
           <t> This element gives the subscriber option of adding number of communication barring notifications sent to the user till date to
               the notification information.  The default value is false which means the subscriber wants the number of notifications that were 
               sent to the user till date information to be present in the notification information.
           </t>
       </section>
     </section>
 </section>
 <section title="Sample Notification body" anchor="samnot">
    <section title="Instance of communication barring subscription filter document">
      <figure>
        <artwork>
          <![CDATA[
<comm-barring-info>
  <comm-barring-subs-info>
      <comm-barring-selection-criteria>
         <originating-user-selection-criteria>
           <user-info>
             <user-name>Boss</user-name>
             <user-URI>
               sip:boss@office.com
             </user-URI>
           </user-info>
         </originating-user-selection-criteria>
         <barring-time-selection-criteria>
           <time-range>
            <start-time>1999-05-31T13:20:00-05:00Z</start-time>
            <end-time>2006-05-06T13:20:00-05:00Z</end-time>
           </time-range>
         </barring-time-selection-criteria>
         <barring-reason-selection-criteria>
           <barring-reason-info>404 302</barring-reason-info>
         </barring-reason-selection-criteria>
       </comm-barring-selection-criteria>
       <comm-barring-ntfy-trigger-criteria>
         <notification-time-selection-criteria>
           <time-range>
            <start-time>1999-05-31T13:20:00-05:00Z</start-time>
            <end-time>2006-05-06T13:20:00-05:00Z</end-time>
           </time-range>
         </notification-time-selection-criteria>
       </comm-barring-ntfy-trigger-criteria>
   </comm-barring-subs-info>
</comm-barring-info>
         ]]>
       </artwork>
      </figure>
 </section>
 <section title="Instance of communication barring notification document">
     <figure>
        <artwork>
          <![CDATA[
<comm-barring-info>
  <comm-barring-ntfy-info>
    <originating-user-info>
      <user-name>Boss</user-name>
      <user-URI>sip:boss@office.com</user-URI>
    </originating-user-info>
    <barring-time-info>1999-06-01T13:20:00-05:00Z
    </barring-time-info>
    <barring-reason-info>404</barring-reason-info>
    <num-barrings>1 </num-barrings>
    <num-notifications>1</num-notifications>
  </comm-barring-ntfy-info>
</comm-barring-info>
          ]]>
       </artwork>
      </figure>
 </section>
 </section>
 <section title="Schema" anchor="schema">
 <figure>
   <artwork>
     <![CDATA[
<?xml version="1.0" encoding="UTF-8" ?>
<xs:schema
  targetNamespace="urn:ietf:params:xml:ns:comm-barring-info"
  xmlns:xs="http://www.w3.org/2001/XMLSchema
  xmlns:tns="urn:ietf:params:xml:ns:comm-barring-info
  xmlns="http://uri.etsi.org/ngn/params/xml/comm-barring-info"
  elementFormDefault="qualified"
  attributeFormDefault="unqualified">
  <!--
  This import brings in the XML language definition
  -->
  <xs:import namespace="http://www.w3.org/XML/1998/namespace"
    schemaLocation="http://www.w3.org/2001/03/xml.xsd"/>
  <!--
  Communication Barring Information. This is the top-level XML element
  -->
  <xs:element name="comm-barring-info"
    type="comm-barring-info-type" />
  <!--
  Communication Barring Information Type.
  This is the top-level XML element
  -->
  <xs:complexType name="comm-barring-info-type">
    <xs:sequence>
  <xs:element name="comm-barring-subs-info"
        type="comm-barring-subs-info-type" minOccurs="0" />
      <xs:element name="comm-barring-ntfy-info"
        type="comm-barring-ntfy-info-type" minOccurs="0" />
      <xs:any namespace="##other" processContents="lax"
        minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
    <xs:attribute name="entity" type="xs:anyURI"
      use="required"/>
  </xs:complexType>
  <!---
  Communication Barring Subscription Type.
  Used at Subscription time to
        select Communication Barrings for notification,
        when to notify them and
        what to notify.
  -->
  <xs:complexType name="comm-barring-subs-info-type">
    <xs:sequence>
      <xs:element name="comm-barring-selection-criteria"
        type="comm-barring-selection-criteria-type"
        minOccurs="0" />
      <xs:element name="comm-barring-ntfy-trigger-criteria"
        type="comm-barring-ntfy-trigger-criteria-type"
        minOccurs="0" />
      <xs:element name="comm-barring-info-selection-criteria"
        type="comm-barring-info-selection-criteria-type"
        minOccurs="0" />
      <xs:any namespace="##other" processContents="lax"
        minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
    <xs:anyAttribute namespace="##other" processContents="lax"/>
  </xs:complexType>
  <!---
  Communication Barring Notification Information Type
  Used while notifying the User about the Communication Barring
  -->
  <xs:complexType name="comm-barring-ntfy-info-type">
    <xs:sequence>
      <xs:element name="originating-user-info"
        type="user-info-type" minOccurs="0" />
      <xs:element name="barring-time-info"
        type="xs:dateTime" minOccurs="0" />
      <xs:element name="barring-reason-info"
        type="barring-reason-info-type" minOccurs="0" />
      <xs:element name="barring-rule-info"
        type="barring-rule-info-type" minOccurs="0" />
      <xs:element name="num-barrings" use="optional"
        type="xs:interger" minOccurs="0" />
      <xs:element name="num-notifications" use="optional"
        type="xs:integer" minOccurs="0"/>
      <xs:any namespace="##other" processContents="lax"
        minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
  </xs:complexType>
  <!--
  COMMUNICATION BARRING SELECTION CRITERIA
  -->
  <xs:complexType name="comm-barring-selection-criteria-type">
    <xs:sequence>
      <xs:element name="originating-user-selection-criteria"
        type="user-selection-criteria-type" minOccurs="0" />
      <xs:element name="barring-time-selection-criteria"
        type="time-range-selection-criteria-type"
        minOccurs="0" />
      <xs:element name="barring-reason-selection-criteria"
        type="barring-reason-selection-criteria-type"
        minOccurs="0" />
      <xs:any namespace="##other" processContents="lax"
        minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
  </xs:complexType>
  <!--
  COMMUNICATION BARRING NOTIFICATION TRIGGER CRITERIA
  -->
  <xs:complexType name="comm-barring-ntfy-trigger-criteria-type">
    <xs:sequence>
      <xs:element name="notification-time-selection-criteria"
        type="time-range-selection-criteria-type"
        minOccurs="0" />
      <xs:element name="presence-status-selection-criteria"
        type="presence-status-selection-criteria-type"
        minOccurs="0" />
      <xs:element name="notification-buffer-interval"
      minOccurs="0" default="86400">
        <xs:simpleType>
          <xs:restriction base="xs:integer">
      <xs:maxInclusive value="86400"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:element>
      <xs:any namespace="##other" processContents="lax"
        minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
   </xs:complexType>
  <!--
  COMMUNICATION BARRING INFORMATION SELECTION CRITERIA
  -->
  <xs:complexType name="comm-barring-info-selection-criteria-type">
    <xs:sequence>
      <xs:element name="disable-originating-user-info"
        type="xs:boolean" default="false" minOccurs="0" />
      <xs:element name="disable-barring-time-info"
        type="xs:boolean" default="false" minOccurs="0" />
      <xs:element name="disable-barring-reason-info"
        type="xs:boolean" default="false" minOccurs="0" />
      <xs:element name="disable-barring-rule-info"
        type="xs:boolean" default="false" minOccurs="0" />
      <xs:element name="disable-number-of-barrings"
        type="xs:boolean" default="false" minOccurs="0" />
      <xs:element name="disable-number-of-notifications"
        type="xs:boolean" default="false" minOccurs="0" />
      <xs:any namespace="##other" processContents="lax"
        minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
   </xs:complexType>

  <!-- User Info Type -->
  <xs:complexType name="user-info-type">
    <xs:sequence>
      <xs:element name="user-name" type="xs:string"
      minOccurs="0" maxOccurs="1"/>
      <xs:element name="user-URI" type="xs:anyURI"/>
    </xs:sequence>
  </xs:complexType>

  <!--
  BARRING REASON INFO
  -->

    <xs:simpleType name="barring-reason-info-types">
        <xs:list itemType="barring-reason-info-type"/>
    </xs:simpleType>
  <xs:simpleType name="barring-reason-info-type">
        <xs:restriction base="xs:integer">
            <xs:enumeration value="ICB"/>
            <xs:enumeration value="ACR"/>
            <xs:enumeration value="RULE"/>
        </xs:restriction>
  </xs:simpleType>
  <!--
  BARRING RULE INFO
  -->
  <xs:complexType name="barring-rule-info-type">
    <xs:sequence>
      <xs:element name="rule-id" type="xs:interger"/>
      <xs:element name="rule-name" type="xs:string"/>
    </xs:sequence>
  </xs:complexType>
  <!--
  ORIGINATING USER SELECTION CRITERIA
  -->
  <xs:complexType name="user-selection-criteria-type">
    <xs:sequence>
      <xs:element name="user-info"
        type="user-info-type" minOccurs="0"
        maxOccurs="unbounded" />
    </xs:sequence>
  </xs:complexType>
  <!--
  BARRING REASON SELECTION CRITERIA
  -->
  <xs:complexType name="barring-reason-selection-criteria-type">
    <xs:sequence>
      <xs:element name="barring-reason-info"
        type="barring-reason-info-types"/>
    </xs:sequence>
  </xs:complexType>
  <!--
  TIME RANGE SELECTION CRITERIA
  -->
  <xs:complexType name="time-range-selection-criteria-type">
    <xs:sequence>
      <xs:element name="time-range"
    type="time-range-type" minOccurs="0"
        maxOccurs="unbounded" />
    </xs:sequence>
  </xs:complexType>
  <!--
  TIME RANGE INFO
  -->
  <xs:complexType name="time-range-type">
    <xs:sequence>
      <xs:element name="start-time" type="xs:dateTime" />
      <xs:element name="end-time" type="xs:dateTime" />
    </xs:sequence>
  </xs:complexType>
  <!--
  PRESENCE STATUS SELECTION CRITERIA
  -->
  <xs:complexType name="presence-status-selection-criteria-type">
    <xs:sequence>
      <xs:element name="presence-status-info"
        type="presence-status-info-type" minOccurs="0"
        maxOccurs="unbounded" />
    </xs:sequence>
  </xs:complexType>
  <!--
  PRESENCE STATUS INFO
  -->
  <xs:complexType name="presence-status-info-type">
    <xs:sequence>
      <xs:element name="presence-status" type="xs:string" />
    </xs:sequence>
  </xs:complexType>
</xs:schema>
     ]]>
   </artwork>
 </figure>
 </section>
</section>
<section title="Security Considerations" anchor="sec-cond">
<t>
Authentication and authorization of subscriptions have been discussed
in <xref target="NotifierP"></xref>.  Lack of authentication or authorization may provide
comm-barring-info information to unauthorized parties and can reveal
sensitive information with regards to the user's call receiving
patterns.  For example, who calls the user and at what time, etc.  
<vspace blankLines="1"></vspace>
Integrity protection and confidentiality of notifications are also
discussed in <xref target="NotifierG"></xref>.  If a notifier does not encrypt bodies of
NOTIFY requests, an eavesdropper could learn the status of a SIP user
agent and use it to create malicious sessions.  If the notifier
does not integrity protect the bodies of NOTIFY requests, a man-in-
the-middle attacker or malicious SIP proxy could modify the contents
of the comm-barring-info event package notification.  Although this does
not cause harm, it can create annoyances. </t>
</section>
<section title="IANA Considerations">
<t> This document registers the new SIP Event Package. </t>
 <section title="Communication Barring Information Event Package Registration">
   <figure>
    <artwork>
     <![CDATA[
Package Name: Comm_barring-info

Type: Package

Contact:  Jon Merdith, <John.meredith@3gpp.org>

Published Specification: RFC XXXX (Note to RFC Editor)
     ]]>
    </artwork>
   </figure>
  </section>
</section>
<section title="Acknowledgements">
  <t> The authors would like to thank Samir Saklikar, Subir Saha, Ban Al-Bakri, John Elwell, Paul Kyzivat and Mary Barnes for their useful suggestions. </t>
</section>
</middle>
<back>
<references title="Normative References">
<?rfc include="reference.3GPP.24.611.xml" ?>
<?rfc include="reference.3GPP.22.173.xml" ?>
<?rfc include="reference.RFC.2119.xml" ?>
<?rfc include="reference.RFC.3261.xml" ?>
<?rfc include="reference.RFC.3265.xml" ?>
<?rfc include="reference.RFC.5727.xml" ?>
</references>
<references title="Informative References">
<?rfc include="reference.3GPP.24.229.xml"?>
<?rfc include="reference.W3C.REC-xml-20001006.xml" ?>
<?rfc include="reference.RFC.4745.xml" ?>
</references>
<section title="Change log">
<figure>
  <artwork>
    <![CDATA[
[RFC EDITOR NOTE: Please remove this section when publishing]
    ]]>   
    </artwork>
  </figure>
<t>Changes from draft-avasarala-sipping-comm-barring-notification-00
<list style="symbols">
<t> Moved from SIPPING to DISPATCH WG. </t>
<t> Incorporated review comments.      </t>
<t> Re-submitting since -00 expired    </t>
</list>
</t>
</section>
</back>
</rfc>
