<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>SMTP Transferred-By-Reference (TBR) Extension</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SMTP Transferred-By-Reference (TBR) Extension">
<meta name="keywords" content="TBR-EXT, Draft">
<meta name="generator" content="xml2rfc v1.32 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SMTP</td><td class="header">D. Otis</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Trend Micro, NSSG</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Leslie</td></tr>
<tr><td class="header">Expires: March 4, 2008</td><td class="header">JLC.net</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">September 2007</td></tr>
</table></td></tr></table>
<h1><br />SMTP Transferred-By-Reference (TBR) Extension<br />draft-otis-smtp-tbr-ext-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 4, 2008.</p>

<h3>Copyright Notice</h3>
<p>
Copyright &copy; The IETF Trust (2007).</p>

<h3>Abstract</h3>

<p>This document describes an extension to SMTP that allows email to be exchanged as a storage
        system immutable XAM (eXtensible Access Method) reference. When MTAs employ the TBR mode,
        message origination can not be spoofed, and message acceptance is not asserted until
        retrieval of the referenced message. This strategy ensures a minimal SMTP overhead,
        increasing the responsibility of senders in order to limit the load of unwanted messages
        upon receivers.
</p>
<p>In addition, the TBR extension requires an [RFC2821] MAIL FROM address in the same domain
        as the server from which the XAM will be fetched, so that a dependable status-reporting path
        is assured.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Conventions Used in this Document<br />
<a href="#anchor3">3.</a>&nbsp;
TBR SMTP Extension<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
SMTP TBR Extension Registration<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
TBR Transaction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
TBR Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.1.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.4.</a>&nbsp;
Formal Syntax<br />
<a href="#anchor9">4.</a>&nbsp;
8-Bit and Binary<br />
<a href="#anchor10">5.</a>&nbsp;
Handoff of responsibility to deliver or report errors<br />
<a href="#anchor11">6.</a>&nbsp;
Additional Enhanced Status Codes (RFC3463)<br />
<a href="#anchor12">7.</a>&nbsp;
Response Codes<br />
<a href="#Reputation">8.</a>&nbsp;
Reputation Checking<br />
<a href="#Handoff">9.</a>&nbsp;
Handoff of responsibility to deliver or report errors<br />
<a href="#IANA">10.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">11.</a>&nbsp;
Security Considerations<br />
<a href="#Acknowledgements">12.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">13.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">13.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">13.2.</a>&nbsp;
Informative References<br />
<a href="#anchor15">Appendix&nbsp;A.</a>&nbsp;
Change Log<br />
<a href="#anchor16">Appendix&nbsp;B.</a>&nbsp;
XUID overview<br />
<a href="#anchor17">Appendix&nbsp;C.</a>&nbsp;
Meeting regulatory requirements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document defines an extension to Simple Mail Transfer Protocol (SMTP) that permits
        messages to be Transferred-By-Reference (TBR) using HTTP and eXtensible Access Method (XAM)
        infrastructure.
</p>
<p>The TBR command changes the responsibility for storing an email message in transit such
        that a Message Transmission Agent (normally the Message Submission Agent) retains
        responsibility for storing the message instead of handing off responsibility at each SMTP
        step.
</p>
<p>A Message Submission Agent (MSA) or subsequent MTA, upon initial receipt, stores messages
        using XAM infrastructure and provides XAM access via HTTP or HTTPS. Conversion from TBR mode
        is expected to be performed by Message Delivery Agents. This extension MAY be used in
        conjunction with a command PIPELINING mechanism <a class='info' href='#RFC2920'>[RFC2920]<span> (</span><span class='info'>Freed, N., &ldquo;SMTP Service Extension for Command Pipelining,&rdquo; September&nbsp;2000.</span><span>)</span></a>.
</p>
<p>Once published, the message can be fetched from a publicly accessible HTTP or HTTPS server
        using the eXAM-URI reference. Within the eXAM-URI reference, two parameters indirectly
        identify the originator and intended recipient. HTTP server logs permit identifying which
        messages have been retrieved by their recipient. By using the intended recipient reference
        parameters, publishing domains are able to identify messages which have not been delivered
        without reliance on SMTP feedback.
</p>
<p>Upon receiving a TBR eXAM-URI email reference, the receiving SMTP server MAY perform any
        domain-reputation and/or IP-address-reputation checks called for by their policies. The TBR
        mode allows reputation checks to be done on the actual originator of an email (rather than
        merely the last-hop) before formal handoff, thus greatly simplifying and reducing the
        computational/network load on the receiver.
</p>
<p>The TBR mode eliminates any need to send "unknown recipient" notifications to dubious
        sources, thwarting the "harvesting" of known-good email addresses.
</p>
<p>Failure to receive a request to fetch the eXAM-URI should be logged by the TBR originator
        after a suitable delay, and a notice of failure SHOULD be forwarded to the original sender.
        Likewise, failure to complete fetching should be logged by the Message Delivery Agent, and a
        notice of failure MAY be sent to the recipient if such an option is requested. The number
        and timing of attempts to fetch the TBR eXAM-URI is a local option, but SHOULD follow an
        exponential backoff algorithm if more than one attempt is made.
</p>
<p>Since a high percentage of current email is unwanted, it is expected that only a minority
        of TBR eXAM-URIs will actually be fetched. This is good in that it reduces network traffic.
        Intentional failures to fetch behaves very much like graylisting, in that it may benefit the
        sender to keep the message queued, but the sender gets no indication of why the fetching is
        delayed.
</p>
<p>TBR provides an alternative strategy that reduces the overhead in handling high levels of
        undesired messages. The TBR option offers a safe and immediate means to exchange messages.
        TBR messages can be processed for patterns of abuse prior to formally accepting the
        obligation to deliver by fetching the message. A message not being retrieved might be due to
        the source itself being considered abusive, or the recipient being invalid. When the content
        of a message is found to be undesired after fetching, the address for a DSN will have been
        assured. TBR protects the identify of valid recipients and eliminates any need for inbound
        email services to maintain a list of valid recipients. This strategy enables TBR to restore
        the integrity of email delivery.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions Used in this Document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>The formal syntax uses the Augmented Backus-Naur Form (ABNF) <a class='info' href='#RFC4234'>[RFC4234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; October&nbsp;2005.</span><span>)</span></a>
        notation including the core rules defined in Appendix B of RFC 4234.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
TBR SMTP Extension</h3>

<p>This section defines the TBR SMTP Extension. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
SMTP TBR Extension Registration</h3>

<p>
          </p>
<ol class="text">
<li>The name of this submission extension is "TBR". This extends regular SMTP <a class='info' href='#RFC2821'>[RFC2821]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a> server on port 25, and SHOULD NOT be advertised for Message
              Submission protocol on port 587 per <a class='info' href='#RFC4409'>[RFC4409]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a>.
</li>
<li>The EHLO keyword value associated with the extension is "TBR".
</li>
<li>An MTA which supports TBR will respond to EHLO with a TBR keyword. Clients MUST
              ignore arguments after the TBR EHLO keyword, unless defined by a subsequent IETF
              specification.
</li>
<li>This extension adds the TBR SMTP verb. This verb is used as a replacement for the
              DATA command and is only permitted during a mail transaction after at least one RCPT
              TO which was not rejected.
</li>
</ol><p>
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
TBR Transaction</h3>

<p>The TBR command supports transfer of http or https eXAM-URIs, instead of message content
          using the DATA command.
</p>
<p>A simple TBR transaction will consist of MAIL FROM, one or more RCPT TO commands, and a
          TBR command terminating with the End-Mark tag. The TBR command takes the place of the DATA
          command, and includes three, or four arguments:</p>
<ul class="text">
<li>Forwarding Count (mandatory)<br />
 Starting at zero, this count is expressed as a
              decimal integer representing the number of times the TBR eXAM-URI has been transferred
              by SMTP.
</li>
<li>eXAM URI (mandatory)<br />
 This is a URI pointing to a fully formed message ready
              for injection into SMTP infrastructure.
</li>
<li>Additional Trace Headers (optional)<br />
 Each MTA after the one which first
              encodes the eXAM-URI MAY include trace headers to be prepended when the eXAM URI is
              retrieved; however there is no assurance that they will be passed on through the chain
              of MTAs. Each MTA receiving these optional headers MAY log them instead of passing
              them on. If present, trace header(s) will be preceded and followed by CRLF, and a line
              containing only the End-Mark tag will follow the last trace header. Trace headers MUST
              follow the format defined in <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>.
</li>
<li>End-Mark tag (mandatory)<br />
 The End-Mark tag is a line containing only the
              character "." (period or full stop) followed by CRLF.
</li>
</ul>

<p>If PIPELINING <a class='info' href='#RFC2920'>[RFC2920]<span> (</span><span class='info'>Freed, N., &ldquo;SMTP Service Extension for Command Pipelining,&rdquo; September&nbsp;2000.</span><span>)</span></a> is advertised, the client MAY send the entire
          transaction in one round trip. If no valid RCPT TO address is supplied, the TBR command
          will simply fail. If at least one valid RCPT TO address is supplied, then the TBR eXAM-URI
          argument will be accepted.
</p>
<p>Trace Headers can call for large amounts of storage which serves no useful purpose in the
          case where eXAM-URI retrieval will not be done. Thus, storage of Trace Headers included
          within the TBR command is entirely optional (even on a message-by-message basis).
</p>
<p>When Trace Headers are not saved for passing on to succeeding MTAs, storage requirements
          per TBR command SHOULD be limited to the 512 bytes as specified by <a class='info' href='#RFC2821'>[RFC2821]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a> for SMTP commands. The TBR command includes the TBR verb and line containing the
          eXAM-URI, in addition to the terminating line containing the End-Mark tag.
</p>
<p>When validation of message acceptance by each recipient is desired, this necessitates
          separate messages containing one recipient and an eXAM-URI containing a corresponding
          'rcpt-ref' field.
</p>
<p>If PIPELINING <a class='info' href='#RFC2920'>[RFC2920]<span> (</span><span class='info'>Freed, N., &ldquo;SMTP Service Extension for Command Pipelining,&rdquo; September&nbsp;2000.</span><span>)</span></a> is also advertised, then the client may pipeline
          the entire transaction in one round-trip. However, the client MUST wait for the results of
          the End-Mark tag in the TBR command prior to initiating a new transaction. The TBR command
          does not direct the server to fetch the message to which the eXAM-URI refers, nor to
          replace the eXAM-URI.
</p>
<p>The Forwarding count (fwd-cnt) is initially set to zero. Every time the eXAM-URI is
          forwarded, the count is incremented. When the forwarding count exceeds 100, as recommended
          by <a class='info' href='#RFC2821'>[RFC2821]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a> in Section 6.2 Loop Detection, a routing loop has been
          detected, and should be handled accordingly.
</p>
<p>Prior to being fetched, TBR messages are not required to generate Delivery Status
          Notifications when being dropped. Instead, fetching the referenced message offers the
          indication of message acceptance.
</p>
<p>When an MTA has accepted a TBR message and must forward it to an MTA which does not
          support TBR, it MAY (after all appropriate checking) retrieve the replacement message
          content from the eXAM-URI, prepend any additional trace headers, and forward it as a
          non-TBR message. As an alternative, instead of retrieving the replacement message content,
          it MAY prepend any additional trace headers to a notification sent to the recipient
          containing the eXAM-URI itself, along with any other appropriate information.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
TBR Requirements</h3>

<p>The domain part of the <a class='info' href='#RFC2821'>[RFC2821]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a> MAIL FROM address MUST exactly match the
          domain part of the URI, in order to assure that recipients do not generate "backscatter"
          to forged return addresses at domains which do not support TBR. A domain which supports
          TBR SHOULD employ methods of coding the localpart so as to recognize (and discard)
          backscatter DSNs. The MX server for the TBR domain SHOULD coordinate with the encoding MTA
          to properly decode and check the localpart of the return address.
</p>
<p>The assurance that a domain supports TBR is proven by the DNS records for a domain
          starting with _tbr.* returning both MX and address records (adequate for fetching the
          URI). Ideally, address record(s) will be present for each address family (such as IPv4 and
          IPv6) currently in use: if it turns out there's a mismatch, the MTA attempting retrieval
          should generate a DSN (after performing these validity checks).
</p>
<p>Fetching the message SHOULD occur after the Mail Delivery Agent has finished all
          processing prior to placing the email into a mailbox or forwarding it to a processing
          program.
</p>
<p> Removal of published messages should be delayed for a short period to accommodate a
          retry resulting from possible message storage related failures.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Examples</h3>

<p>In examples, "C:" and "S:" indicate lines sent by the client and server, respectively.
            If a single "C:" or "S:" label applies to multiple lines, then the line breaks between
            those lines are for editorial clarity only and are not part of the actual protocol
            exchange. To simplify the example, an abbreviated XUID is used. Two successful
            submissions (without and with pipelining) follow:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  (non-pipelined transaction)
  C: EHLO client.example.com
  S: 250-server.example.com
  S: 250-TBR
  S: 250-ENHANCEDSTATUSCODES
  S: 250-PIPELINING
  S: 250-8BITMIME
  S: 250-SIZE 30000000
  S: 250-DSN
  S: 250-ETRN
  S: 250-AUTH PLAIN LOGIN
  S: 250-STARTTLS
  S: 250-DELIVERBY
  S: 250 HELP
  C: MAIL FROM:&lt;prvs=02460E6DB6=tom@_tbr.example.com&gt;
  S: 250 2.5.0 Address Ok.
  C: RCPT TO:&lt;dick@users.example.com&gt;
  S: 250 2.1.5 dick@users.example.com OK.
  C: TBR 0 https://_tbr.example.com/~Q012?XUID=A42L0M726P&amp;RCPT=R012
  C: .
  S: 250 2.5.0 Ok.

  (pipelined transaction)
  C: EHLO client.example.com
  S: 250-server.example.com
  S: 250-TBR
  S: 250-ENHANCEDSTATUSCODES
  S: 250-PIPELINING
  S: 250-8BITMIME
  S: 250-SIZE 30000000
  S: 250-DSN
  S: 250-ETRN
  S: 250-AUTH PLAIN LOGIN
  S: 250-STARTTLS
  S: 250-DELIVERBY
  S: 250 HELP
  C: MAIL FROM:&lt;prvs=02460E6DB6=tom@_tbr.example.com&gt;
  C: RCPT TO:&lt;dick@users.example.com&gt;
  C: TBR 0 https://_tbr.example.com/~Q012?XUID=A42L0M726P&amp;RCPT=R012
  C: .
  S: 235 2.7.0 PLAIN authentication successful.
  S: 250 2.5.0 Address Ok.
  S: 250 2.1.5 dick@users.example.com OK.
  S: 250 2.5.0 Ok.
</pre></div>
<p>Some examples of failure cases:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  C: MAIL FROM:&lt;prvs=02460E6DB6=tom@_tbr.example.com&gt;
  C: RCPT TO:&lt;harry@users.example.com&gt;
  C: TBR 0 https://_tbr.example.com/~Q012?XUID=A42L0M726P&amp;RCPT=R012
  C: .
  S: 250 2.5.0 Address Ok.
  S: 550 5.7.1 Relaying not allowed: harry@users.example.com
  S: 554 5.5.0 No recipients have been specified.
</pre></div>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Formal Syntax</h3>

<p>This specification inherits ABNF <a class='info' href='#RFC4234'>[RFC4234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; October&nbsp;2005.</span><span>)</span></a>, Uniform Resource Identifiers
            <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> and Internet Message Format <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  dash          = %d45  ; "-"
  dot           = %d46  ; "."
  slash         = %d47  ; "/"
  underscore    = %d95  ; "_"
  tilde         = %d126 ; "~"

  tbr-ref       = *(ALPHA      /
                    DIGIT      /
                    dash       /
                    dot        /
                    underscore /
                    tilde      /
                    slash      /
                    pct-encoded)

  pct-encoded   = "%" HEXDIG HEXDIG
  dns-char      = ALPHA / DIGIT / dash
  id-prefix     = ALPHA / DIGIT
  label         = id-prefix [*61dns-char id-prefix]
  sldn          = label dot label

  hostname      = *(label dot) sldn
                ; not to exceed 249 characters
                ; excluding "_tbr."

  tbr-prot      = "http" / "https"

  tbr-host      = "_tbr." hostname

  port          = 1*5DIGIT

  base-char     = (dns-char / "_")

  rcpt-ref      = *43(base-char) *2("=")

  orig-ref      = *43(base-char) *2("=")

  con-id        = 1*107(base-char) *2("=")   ; url safe base64

  tbr-cmd       = "TBR" SP fwd-cnt SP eXAM-URI FWS tbr-end

  tbr-end       = [trace] end-mark CRLF

  fwd-cnt       = 1*3DIGIT

  end-mark      = dot

  tbr-pub       = tbr-prot"://"tbr-host[":" port]

  tbr-ref       = orig-ref"?XUID="con-id"&amp;RCPT="rcpt-ref

  eXAM-URI      = tbr-pub "/" tbr-ref

  eXAM-ref      = "TBR" SP fwd-cnt SP eXAM-URI
</pre></div>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
8-Bit and Binary</h3>

<p>A submit server that advertises TBR MUST also advertise 8BITMIME <a class='info' href='#RFC1652'>[RFC1652]<span> (</span><span class='info'>Klensin, J., Freed, N., Rose, M., Stefferud, E., and D. Crocker, &ldquo;SMTP Service Extension for 8bit-MIMEtransport,&rdquo; July&nbsp;1994.</span><span>)</span></a>
        and MUST perform the down conversion described in that specification on the resulting
        complete message if 8-bit data is obtained after replacing the eXAM-URI with the referenced
        message and passed to a 7-bit server. If the eXAM-URI argument to TBR refers to binary data,
        then the submit server MUST down convert as described in Binary SMTP <a class='info' href='#RFC3030'>[RFC3030]<span> (</span><span class='info'>Vaudreuil, G., &ldquo;SMTP Service Extensions for Transmission of Large and Binary MIME Messages,&rdquo; December&nbsp;2000.</span><span>)</span></a>. The correct character repertoire MUST be asserted when offering 8-bit data. See <a class='info' href='#RFC4646'>[RFC4646]<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2006.</span><span>)</span></a> and <a class='info' href='#RFC4647'>[RFC4647]<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Matching of Language Tags,&rdquo; September&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Handoff of responsibility to deliver or report errors</h3>

<p>When a TBR command is given, the formal handoff of responsibility does not occur during the
        SMTP session, but is delayed until the eXAM-URI is fetched. The formal handoff of
        responsibility to deliver or report problems comes when the command to fetch the URI is
        sent. There MAY be no failure report when TBR messages are undesired and thus never fetched.
        When an attempt to fetch a message is made, the fetching agent thereby accepts
        responsibility for either delivering the message or properly reporting a failure to do so.
</p>
<p>The SMTP server receiving a TBR reference MAY reject invalid recipients during the SMTP
        session, or it may quietly ignore recipients which turn out to be invalid. It MUST NOT
        generate Delivery Status Notification messages before it verifies that the MAIL FROM domain
        exactly matches the domain part of the URI, and that the same domain also publishes an MX
        record. Having verified that, it MAY report any conditions via DSNs, but is not required to
        report any errors until it finishes reputation checks and fetches the URI.
</p>
<p>Postponing the formal handoff of responsibility requires the originating MSA to obtain
        notification when an eXAM-URI has not been fetched after some period. This period is
        determined by local option, but should be set to suppress most failure notifications which
        might occur while delivery of the eXAM-URI is still pending.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Additional Enhanced Status Codes (RFC3463)</h3>

<p>SMTP or Submit servers that advertise ENHANCEDSTATUSCODES <a class='info' href='#RFC2034'>[RFC2034]<span> (</span><span class='info'>Freed, N., &ldquo;SMTP Service Extension for Returning Enhanced Error Codes,&rdquo; October&nbsp;1996.</span><span>)</span></a> use
        enhanced status codes defined in <a class='info' href='#RFC3463'>[RFC3463]<span> (</span><span class='info'>Vaudreuil, G., &ldquo;Enhanced Mail System Status Codes,&rdquo; January&nbsp;2003.</span><span>)</span></a>. The TBR extension introduces new
        error cases that RFC 3463 did not consider. The following additional enhanced status codes
        are defined by this specification:
</p>
<p>451 4.7.8 TBR HTTP/HTTPS mode requested for immediate acceptance
</p>
<p>451 4.7.9 TBR HTTP mode requested for immediate acceptance
</p>
<p>451 4.7.10 TBR HTTPS mode requested for immediate acceptance
</p>
<p>Where a receiving SMTP server implements greylisting due to low trust in the sending SMTP
        server or the originating domain, this temporary error may be given, committing the receiver
        to accepting a TBR email without further temporary errors for greylisting.
</p>
<p>550 5.1.9 MAIL FROM not within eXAM-URI domain
</p>
<p>The domain publishing the message MUST receive all Delivery Status Notifications and MAY
        redirect them to the original RFC2821 MAIL FROM address, or otherwise process them in
        accordance with directives agreed to by the originator and MSA.
</p>
<p>504 5.5.6 eXAM-URI protocol not supported
</p>
<p>The domain fetching the message does not support the protocol indicated within the
        eXAM-URI. This status code can also extend a response code of 504 (504 Command parameter not
        implemented).
</p>
<p>504 5.5.7 eXAM-URI IP address not supported
</p>
<p>The domain fetching the message does not support the IP address returned for the eXAM-URI
        host.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Response Codes</h3>

<p>This section includes example response codes to the TBR command. Other text may be used
        with the same response codes. This list is not exhaustive, and TBR clients MUST tolerate any
        valid SMTP response code. Most of these examples include the appropriate enhanced status
        code <a class='info' href='#RFC3463'>[RFC3463]<span> (</span><span class='info'>Vaudreuil, G., &ldquo;Enhanced Mail System Status Codes,&rdquo; January&nbsp;2003.</span><span>)</span></a>.
</p>
<p>554 5.5.0 No recipients have been specified
</p>
<p>This response code occurs when TBR is used (for example, with PIPELINING) and all RCPT TOs
        failed.
</p>
<p>503 5.5.0 Valid RCPT TO required before TBR
</p>
<p>This response code is an alternative to the previous one when TBR is used (for example,
        with PIPELINING) and all RCPT TOs failed.
</p>
<p>503 5.5.0 TBR command not terminated
</p>
<p>A TBR command without the "." End-Mark tag was sent. The eXAM-URI may have been received,
        but will not be forwarded.
</p>
<p>554 5.3.4 Message too big for system
</p>
<p>The message (subsequent to eXAM-URI message replacement) is larger than the per-message
        size limit for this server.
</p>
<p>552 5.2.2 Mailbox full
</p>
<p>The recipient is local, the submit server supports direct delivery, and the recipient has
        exceeded his quota and any grace period for delivery attempts.
</p>
<p>554 5.6.7 eXAM-URI resolution failed
</p>
<p>Obtaining the message from the HTTP server returned an error or no data.
</p>
<p>250 2.5.0 Ok.
</p>
<p>The eXAM-URI was accepted.
</p>
<a name="Reputation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Reputation Checking</h3>

<p>The TBR mode of operation allows greater emphasis to be placed upon the reputation of the
        originator. Messages containing malware or undesired content can be substantially reduced
        without risking ever-growing burdens upon the receiving server. The TBR mode of operation is
        able to ensure that application of message security remains scalable, and does so by
        imposing a greater burden upon the sender.
</p>
<p>Upon receiving a TBR email reference, the receiving SMTP server MAY perform any
        domain-reputation and/or IP-address-reputation checks called for by their policies. The TBR
        mode allows reputation checks to be done on the actual originator of an email (rather than
        merely the last-hop) before formal handoff, thus greatly simplifying the
        computational/network load on the receiver.
</p>
<p>Since a high percentage of current email is unwanted, it is expected that only a minority
        of TBR URIs will actually be fetched. This is good in that it reduces network traffic.
        Intentional failure to fetch behaves very much like graylisting, in that it may benefit the
        sender to keep the message queued, but the sender gets no indication of why the fetching is
        delayed.
</p>
<p>The TBR mode eliminates any need to send "unknown recipient" notifications to dubious
        sources, thwarting the "harvesting" of known-good email addresses.
</p>
<a name="Handoff"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Handoff of responsibility to deliver or report errors</h3>

<p>The SMTP server receiving a TBR reference does not immediately accept responsibility for
        delivery or reporting problems. It MAY reject invalid recipients during the SMTP session, or
        it may quietly ignore recipients which turn out to be invalid. It MUST NOT generate Delivery
        Status Notification messages before it verifies that the MAIL FROM domain exactly matches
        the domain part of the URI, and that the same domain also publishes an MX record. Having
        verified that, it MAY report any conditions via DSNs, but is not required to report any
        errors until it finishes reputation checks and fetches the URI.
</p>
<p>There may be no failure report if TBR messages are undesired and thus not fetched. If the
        message is fetched, the fetching agent accepts responsibility for either delivering the
        message or properly reporting a failure to do so. The formal handoff of responsibility to
        deliver or report problems comes when the command to fetch the URI is sent.
</p>
<p>Defining formal handoff this way replaces a single race-condition (whether the 250 response
        to DATA is received) with a more complicated set of race-conditions. We define the sending
        of the command to fetch the URI as formal handoff, without regard to whether the command is
        received, or even whether a server exists to receive it. While the RFC2821 race-condition
        could theoretically generate duplicate messages, the TBR race-conditions cannot. It is
        critical, of course, that the validity tests for the DSN path be performed before the
        command to fetch is issued, so that a DSN may be issued if fetching fails.
</p>
<p>Postponing the formal handoff of responsibility requires the originating MSA to obtain
        notification when an eXAM-URI has not been fetched after some period. This period is
        determined by local option, but should be set to suppress most failure notifications which
        might occur while delivery of the eXAM-URI is still pending.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>The "TBR" SMTP extension as described in Section 3 needs to be registered. This
        registration should be marked in the registry as not intended for message submission <a class='info' href='#RFC4409'>[RFC4409]<span> (</span><span class='info'>Gellens, R. and J. Klensin, &ldquo;Message Submission for Mail,&rdquo; April&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<p>Messages published on HTTP servers could in principle be subject to URI-guessing attacks.
        Protective schemes SHOULD be employed to discourage testing large numbers of generated URIs
        in hopes of obtaining a private email; this issue has been addressed in systems that depend
        upon confidential responses prior to granting access. Often protective schemes log an IP
        address and related CIDR with invalid reference attempts where delays are introduced to
        rate-limit guessing.
</p>
<p>In addition to the XUID obscuring valid message locations, the eXAM-URI should
        cryptographically encode a valid recipient and a path component that represents the
        originator. This added protection further ensures message access is not obtained through
        guessing.
</p>
<p>The TBR mode of operation requires greater emphasis be placed upon the reputation of the
        originator. Detection of messages containing malware or undesired content can be defeated
        with polymorphic techniques which place ever growing burdens upon the receiving server. Only
        the TBR mode of operation is able to ensure that application of message security remains
        scalable, and does so by imposing a greater burden upon the sender.
      
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgements</h3>

<p>This document follows the general structure of Message Submission BURL Extension <a class='info' href='#RFC4468'>[RFC4468]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>.<br />
<br />
<br />
<br />
<br />
<br />

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1652">[RFC1652]</a></td>
<td class="author-text"><a href="mailto:klensin@mci.net">Klensin, J.</a>, <a href="mailto:ned@innosoft.com">Freed, N.</a>, <a href="mailto:mrose@dbc.mtview.ca.us">Rose, M.</a>, <a href="mailto:stef@nma.com">Stefferud, E.</a>, and <a href="mailto:dcrocker@sgi.com">D. Crocker</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc1652.txt">SMTP Service Extension for 8bit-MIMEtransport</a>,&rdquo; RFC&nbsp;1652, July&nbsp;1994.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2034">[RFC2034]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2034.txt">SMTP Service Extension for Returning Enhanced Error Codes</a>,&rdquo; RFC&nbsp;2034, October&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc2034.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2034.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2034.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2387">[RFC2387]</a></td>
<td class="author-text"><a href="mailto:XIson@cnj.digex.com">Levinson, E.</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2387.txt">The MIME Multipart/Related Content-type</a>,&rdquo; RFC&nbsp;2387, August&nbsp;1998 (<a href="ftp://ftp.isi.edu/in-notes/rfc2387.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2387.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2387.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2821">[RFC2821]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2821.txt">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;2821, April&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2822">[RFC2822]</a></td>
<td class="author-text">Resnick, P., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2822.txt">Internet Message Format</a>,&rdquo; RFC&nbsp;2822, April&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2920">[RFC2920]</a></td>
<td class="author-text">Freed, N., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2920.txt">SMTP Service Extension for Command Pipelining</a>,&rdquo; STD&nbsp;60, RFC&nbsp;2920, September&nbsp;2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3030">[RFC3030]</a></td>
<td class="author-text">Vaudreuil, G., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3030.txt">SMTP Service Extensions for Transmission of Large and Binary MIME Messages</a>,&rdquo; RFC&nbsp;3030, December&nbsp;2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3463">[RFC3463]</a></td>
<td class="author-text">Vaudreuil, G., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3463.txt">Enhanced Mail System Status Codes</a>,&rdquo; RFC&nbsp;3463, January&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3629.txt">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3986.txt">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4234">[RFC4234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4234.txt">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; RFC&nbsp;4234, October&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4234.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc4234.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc4234.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4646">[RFC4646]</a></td>
<td class="author-text">Phillips, A. and M. Davis, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4646.txt">Tags for Identifying Languages</a>,&rdquo; BCP&nbsp;47, RFC&nbsp;4646, September&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4647">[RFC4647]</a></td>
<td class="author-text">Phillips, A. and M. Davis, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4647.txt">Matching of Language Tags</a>,&rdquo; BCP&nbsp;47, RFC&nbsp;4647, September&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4648.txt">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="XAM_Arch">[XAM_Arch]</a></td>
<td class="author-text"><a href="http://www.snia.org">Storage Networking Industry Association</a>, &ldquo;<a href="http://www.snia.org/xam">XAM Architecture Specification version 0.64</a>,&rdquo; XAM&nbsp;Arch-S, August 6&nbsp;2007.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>13.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.crocker-email-arch">[I-D.crocker-email-arch]</a></td>
<td class="author-text">Crocker, D., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-crocker-email-arch-09.txt">Internet Mail Architecture</a>,&rdquo; draft-crocker-email-arch-09 (work in progress), May&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-crocker-email-arch-09.txt">TXT</a>, <a href="http://www.ietf.org/internet-drafts/draft-crocker-email-arch-09.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2045">[RFC2045]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2045.txt">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>,&rdquo; RFC&nbsp;2045, November&nbsp;1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2046">[RFC2046]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2046.txt">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</a>,&rdquo; RFC&nbsp;2046, November&nbsp;1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2231">[RFC2231]</a></td>
<td class="author-text"><a href="mailto:ned.freed@innosoft.com">Freed, N.</a> and <a href="mailto:moore@cs.utk.edu">K. Moore</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2231.txt">MIME Parameter Value and Encoded Word Extensions: Character Sets, Languages, and Continuations</a>,&rdquo; RFC&nbsp;2231, November&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2231.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2231.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2231.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2578">[RFC2578]</a></td>
<td class="author-text"><a href="mailto:kzm@cisco.com">McCloghrie, K., Ed.</a>, <a href="mailto:dperkins@snmpinfo.com">Perkins, D., Ed.</a>, and <a href="mailto:schoenw@ibr.cs.tu-bs.de">J. Schoenwaelder, Ed.</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2578.txt">Structure of Management Information Version 2 (SMIv2)</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2578, April&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="ftp://ftp.isi.edu/in-notes/rfc2616.txt">TXT</a>, <a href="ftp://ftp.isi.edu/in-notes/rfc2616.ps">PS</a>, <a href="ftp://ftp.isi.edu/in-notes/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3676">[RFC3676]</a></td>
<td class="author-text">Gellens, R., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3676.txt">The Text/Plain Format and DelSp Parameters</a>,&rdquo; RFC&nbsp;3676, February&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3798">[RFC3798]</a></td>
<td class="author-text">Hansen, T. and G. Vaudreuil, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3798.txt">Message Disposition Notification</a>,&rdquo; RFC&nbsp;3798, May&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3987">[RFC3987]</a></td>
<td class="author-text">Duerst, M. and M. Suignard, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc3987.txt">Internationalized Resource Identifiers (IRIs)</a>,&rdquo; RFC&nbsp;3987, January&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4346.txt">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4366">[RFC4366]</a></td>
<td class="author-text">Blake-Wilson, S., Nystrom, M., Hopwood, D., Mikkelsen, J., and T. Wright, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4366.txt">Transport Layer Security (TLS) Extensions</a>,&rdquo; RFC&nbsp;4366, April&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4409">[RFC4409]</a></td>
<td class="author-text">Gellens, R. and J. Klensin, &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4409.txt">Message Submission for Mail</a>,&rdquo; RFC&nbsp;4409, April&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4468">[RFC4468]</a></td>
<td class="author-text">Newman, C., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc4468.txt">Message Submission BURL Extension</a>,&rdquo; RFC&nbsp;4468, May&nbsp;2006.</td></tr>
</table>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log</h3>

<p>
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
XUID overview</h3>

<p>An XSet (data and metadata storage entity) is identified by a XUID. The XUID (XSet Unique
        Identifier, pronounced zoo'id) is created by the XAM storage system. The XUID conforms to a
        defined format. See http://www.snia.org/xam. The native format of a XUID is a
        variable-length byte string, with a maximum length of 80 bytes. XAM applications are
        expected to treat XUIDs as opaque byte strings. However, the XUID format is defined such
        that the XUID integrity can be validated, and that vendors are able to assign XUID values
        independently.
</p>
<p>An OID field is contained within the XUID. The OID field represents the SNMP enterprise
        number of the XAM Storage System vendor that created the XUID, in network byte order. See
          <a class='info' href='#RFC2578'>[RFC2578]<span> (</span><span class='info'>McCloghrie, K., Ed., Perkins, D., Ed., and J. Schoenwaelder, Ed., &ldquo;Structure of Management Information Version 2 (SMIv2),&rdquo; April&nbsp;1999.</span><span>)</span></a> and http://www.iana.org/assignments/enterprisenumbers. An OID of
        0 is reserved.
</p>
<p>The native format for a XUID is binary. The XUID textual representation will be "URL and
        Filename safe" base64-encoded, as described in <a class='info' href='#RFC4648'>[RFC4648]<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a>, which uses
        US-ASCII. The XUID is able to contain a hash as large as 576 bits allowing as many as 2.47 x
        10^173 different values.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Meeting regulatory requirements</h3>

<p>Government agencies are introducing new requirements for retention of email, such as United
        State's SEC rule 17a-4 which defines preservation requirements. Archiving and preservation
        of email is satisfied by XAM Storage. Rule 17a-4 contains at least three important
        requirements accommodated by XAM storage:
</p>
<p> (1) immutable storage,
</p>
<p> (2) verifiable accuracy, and 
</p>
<p> (3) deterministic retention.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Douglas Otis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trend Micro, NSSG</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10101 N. De Anza Blvd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1.408.257-1500</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:doug_otis@trendmicro.com">doug_otis@trendmicro.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Leslie</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">JLC.net</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 Souhegan Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milford, NH  03055</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1.603.673.6132</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:john@jlc.net">john@jlc.net</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
<h3>Acknowledgment</h3>
<p class='copyright'>
Funding for the RFC Editor function is provided by
the IETF Administrative Support Activity (IASA).</p>
</body></html>
