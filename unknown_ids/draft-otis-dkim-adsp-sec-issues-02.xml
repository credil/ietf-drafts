<?xml version='1.0' encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY I-D.ietf-dkim-ssp PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-dkim-ssp.xml'>
  <!ENTITY rfc1034 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.1034.xml'>
  <!ENTITY rfc2119 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>
  <!ENTITY rfc2181 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2181.xml'>
  <!ENTITY rfc2606 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2606.xml'>
  <!ENTITY rfc2782 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2782.xml'>
  <!ENTITY rfc2821 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2821.xml'>
  <!ENTITY rfc2822 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2822.xml'>
  <!ENTITY rfc4033 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4033.xml'>
  <!ENTITY rfc4034 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4034.xml'>
  <!ENTITY rfc4686 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4686.xml'>
  <!ENTITY rfc4871 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4871.xml'>
  <!ENTITY rfc5016 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5016.xml'>
  <!ENTITY rfc5234 PUBLIC '' 'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5234.xml'>
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<?rfc toc="yes" ?>
<?rfc tocindent="yes" ?>
<?rfc tocdepth="2" ?>
<?rfc symrefs="yes" ?>
<?rfc sortrefs="yes"?>
<?rfc iprnotified="no" ?>
<rfc category="std" docName="draft-otis-dkim-adsp-sec-issues-02" ipr="full3978">
  <front>
    <title abbrev="ADSP-SEC-ISSUES">DKIM Author Domain Signing Practices (ADSP) Security Issues</title>
    <author fullname="Douglas Otis" initials="D." surname="Otis">
      <organization>Trend Micro, NSSG</organization>
      <address>
         <postal>
           <street>10101 N. De Anza Blvd</street>
           <city>Cupertino</city>
           <region>CA</region>
           <code>95014</code>
           <country>USA</country>
         </postal>
         <phone>+1.408.257-1500</phone>
         <email>doug_otis@trendmicro.com</email>
       </address>
    </author>

    <date day="4" month="September" year="2008"/>
    <area>Internet Area</area>
    <workgroup>DKIM Working Group</workgroup>

    <keyword>email, e-mail, rfc2822, rfc 2822, rfc822, rfc 822, rfc2821, rfc 2821, rfc821, rfc 821,
      rfc4871, rfc 4871, DKIM, domain keys, domainkeys, ADSP, ADSP, SSP, architecture, mta, user,
      delivery, smtp, submission, email, e-mail, smtp, Internet, mailfrom, mail from, author, return
      address, sender signing, signing practices, key domain, author key domain, author address,
      author domain, security issues</keyword>

    <abstract>
      <t>The proposed <xref target="I-D.ietf-dkim-ssp"/> defines DNS records that advertise the
        extent to which a domain employs <xref target="RFC4871"/> to sign <xref target="RFC2822"/>
        messages, and defines how other hosts can access these advertisements. Its laudable goal is
        to allow domains control over the use of the From header field. When a message is not
        adequately signed, advertised assertions, referenced by a domain in the From header field,
        assist in resolving the message's intended disposition.</t>

      <t>However, <xref target="I-D.ietf-dkim-ssp"/> fails to discern that restricted identities
        imposed upon remote signing agents require additional control be afforded the domain,
        irrespective of the domain's advertised practices. <xref target="I-D.ietf-dkim-ssp"/>
        employs a flawed two-stage signature validation process that occurs in conjunction with
        advertised practices. The two-stage approach impairs the range of authentication assertions
        and related security tactics. Advertised practices not only determine whether a signature
        should be expected, they may constrain the &quot;on-behalf-of&quot; identity applied
        by signing agents that are not otherwise so restricted. By constraining the
        &quot;on-behalf-of&quot; identity for all signing agents, the draft neglects the
        predominate role of the domain as a point of trust, and incorrectly assumes the signature is
        limited to supporting assertions regarding the identity of the author. In addition, the only
        directly actionable practice is defined using a term that is likely to negatively impact the
        integrity of delivery status.</t>

      <t><xref target="I-D.ietf-dkim-ssp"/> impairs security in other ways as well, but fortunately
        minor changes to the definition of a valid signature can significantly remedy the most
        critical security issue.</t>
    </abstract>
    <note title="Requirements Language">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <xref target="RFC2119"/>.</t>
    </note>
  </front>
  <middle>
    <section title="Introduction">
      <t>Both <xref target="RFC4871"/> and <xref target="I-D.ietf-dkim-ssp"/> would benefit from a
        general requirement for signatures with keys that restrict a remote signing agent's
        &quot;on-behalf-of&quot; identity, where this identity must also match against the
        From header field before being considered valid. This change to the definition of a valid
        signature would significantly remedy what is likely to become critical security issues.</t>

      <t><xref target="RFC4871"/> makes a statement that is emblematic of how the signature's role
        can be distorted. This statement can not be applied as a basis for message acceptance, does
        not acknowledge that restricted identities for remote signing agents require greater control
        be afforded the domain, and ignores the predominate role of the domain by assuming the DKIM
        signature is to make assertions regarding the identity of the author. In section 6.3
        paragraph 5, <list style="hanging">
          <t>&quot;If the message is signed on behalf of any address other than that in the
            From: header field, the mail system SHOULD take pains to ensure that the actual signing
            identity is clear to the reader.&quot;</t>
        </list></t>

      <t>At best, DKIM might make a weak assertion regarding the identity of the author. However,
        these assertions lack a wide range of supporting conventions where reliance upon an author
        identity would be unsafe. To sustain delivery integrity, whether the signature is valid must
        remain clear. The &quot;on-behalf-of&quot; identity may be opaque whenever the key
        employed by the signing agent can sign on behalf of the entire domain. Signing agents,
        afforded unrestricted keys, can be considered able to verify the entire message's compliance
        with the domain's practices. The established trust is with the signing domain, and can never
        be based upon a dubious identity within the From header field.</t>

      <t>Conceptually, receiving hosts verify a DKIM signature by obtaining the corresponding public
        key. A valid signature confirms the message is attested to by a party in possession of the
        private key, and in control of a portion of the domain publishing the public key. An
        important missing check is needed to repair <xref target="I-D.ietf-dkim-ssp"/>. The check
        should be applied whenever a key restricts the &quot;on-behalf-of&quot; identity for
        remote signing agents. For the domain to control the From header field with remote signing
        agents, a restricted &quot;on-behalf-of&quot; identity must then be required to also
        match against the From header field before considering the signature to be valid. The From
        header field requirement for a restricted &quot;on-behalf-of&quot; identity should
        be consistent at every stage in the process.</t>

      <t>Ideally, <xref target="I-D.ietf-dkim-ssp"/> should only introduce practices that ensure the
        From header field domains are within their signing domain, and ensure the signing domain is
        able to control the From header field for remote signing agents in all cases. Keys that
        restrict the &quot;on-behalf-of&quot; identity being signed are likely to be
        employed by mobile users having limited access to the domain's outbound signing servers.</t>

      <t>When a key restricts identities, the signature is then required to include a matching
        &quot;on-behalf-of&quot; identity. Currently, there is no general requirement that
        the restricted identity also match against the From header field. Since these keys are prone
        to theft and are easily abused, no signature should be considered valid when a restricted
        identity does not match against the From header field.</t>

      <t><xref target="I-D.ietf-dkim-ssp"/> fails to stipulate that signatures using identity
        restricted keys should be considered invalid when the identity does not match against the
        From header field. These signatures are only considered invalid when the domain is able to
        advertise a restrictive practice at the domain or subdomain in question. Ensuring that a
        restricted identity match against the From header field should not depend upon the recipient
        discovering and the domain being able to assert a restrictive advertised practice. Not
        relying upon restrictive advertised practices becomes even more necessary when restrictive
        advertised practices potentially harm the integrity of delivery status. When delivery
        integrity is important, the use of restrictive advertised practices may need to be avoided.</t>

      <t>As providers block SMTP's public port 25 for a growing number of IP addresses, compromised
        systems, often containing account information, are prevalently being used by bad actors to
        gain access to larger domains. Blocking the combined outbound messages from larger domains
        often proves impractical. Ordinarily, larger domains are either unwilling or unable to
        affirm the identity in the From header field and, as a result, end up leaving the
        &quot;on-behalf-of&quot; identity tag and value blank. Leaving the identity tag
        value blank severely limits a recipient's defence from replay abuse, and as such, should be
        considered a bad practice. The &quot;on-behalf-of&quot; identity tag and value
        should always reflect the element that was authenticated, even when this value is opaque and
        dynamic.</t>

      <t>The constraints imposed by <xref target="I-D.ietf-dkim-ssp"/> make it impractical for the
        &quot;on-behalf-of&quot; identity to always indicate what was authenticated, as
        intended in <xref target="RFC4871"/>. Ironically, an ability to always indicate an
        authenticated identity was lost as a result of optimizing a two-stage signature validation
        scheme that considered signatures with a restricted &quot;on-behalf-of&quot;
        identity, that does not match against the From header field, to be initially valid. Schemes
        that consider signatures valid when a restricted &quot;on-behalf-of&quot; identity
        fails to match against the From header field places recipients in significant peril.
        Signature headers, which are seldom visible, contain the &quot;on-behalf-of&quot;
        identity. Any annotation or handling of signatures that also have a restricted
        &quot;on-behalf-of&quot; identity that does not match against the From header field
        as being valid, would leaves the From header field open to exploitation.</t>

      <t>Detecting inappropriate use of an identity restricted key should occur quickly and prior to
        message acceptance. The fix for <xref target="I-D.ietf-dkim-ssp"/> is to preclude signatures
        from being considered valid which might permit an unverifiable use of a domain within the
        From header field by remote signing agents. This check is not prefaced upon discovering
        whether the domain advertises practices. In other words, in addition to restrictions on the
        &quot;on-behalf-of&quot; identity within the signature for remote signing agents,
        for SMTP, the From header field should also match against the key's local-part restrictions
        as well.</t>

      <t>Currently, <xref target="I-D.ietf-dkim-ssp"/> advertised practices may affect messages that
        lack signatures, or where the From header field address is not within the signing domain, or
        where the &quot;on-behalf-of&quot; identity does not match against the From header
        field. The impact of an advertised practice and the resulting
        &quot;on-behalf-of&quot; identity requirement occurs irrespective of the type of
        signing agent and key used. This creates a security vulnerability that may encourage DNS
        attack, and unnecessarily limits the practical utility of the DKIM signature.</t>

      <t>When a restricted identity fails to match against the From header field, and is considered
        to provide a valid signature, <xref target="I-D.ietf-dkim-ssp"/> may subsequently invalidate
        the signature whenever a practice advertisement by the domain is discovered. Unfortunately,
        the two-stage conditional valid signature requirement unnecessarily affects all signing
        agents. Signature validity is dependent upon the success of advertisement discovery, where
        this two-stage process is likely to negatively impact both delivery integrity and security.
        Limitations imposed on the &quot;on-behalf-of&quot; identity within the second stage
        may alter what is considered valid by <xref target="RFC4871"/>. When the signing agent
        employs unrestricted keys, this change is wholly without merit.</t>

      <t>To control remote signing agents, keys may restrict the &quot;on-behalf-of&quot;
        identity being signed. However, <xref target="RFC4871"/> imposes no requirement for
        restricted identity placement within the message. In addition, <xref
          target="I-D.ietf-dkim-ssp"/> incorrectly assumes reliable advertisement discovery, and
        fails to impose restricted identity placement for remote signing agents as well. Although
        remote signing agents may have keys that restrict identity signing, the domain is unable to
        control whether a restricted &quot;on-behalf-of&quot; identity is also assured to
        match with the From header field, except by publishing advertised practices at every
        existing subdomain.</t>

      <t>Per <xref target="RFC4871"/>, the &quot;on-behalf-of&quot; identity is not required
        to be that of a message author, and may even indicate authentication of a system or an
        access account. This distinction is important since predominately compromised systems,
        rather than individuals, are the source of abuse. Unfortunately, <xref
          target="I-D.ietf-dkim-ssp"/> places constraints on what may be placed within the
        &quot;on-behalf-of&quot; identity. It is unrealistic to suggest the impractical use
        of multiple signatures as a solution, since this doubles the overhead related to signatures
        and signature validation. <xref target="RFC4871"/> has already defined an
        &quot;on-behalf-of&quot; identity. There is no reason to reinvent the meaning of the
        &quot;on-behalf-of&quot; identity in support of a flawed, two-stage, conditional,
        valid signature definition.</t>
    </section>

    <section title="Errors and Omissions">
      <section title="Factual Errors">
        <t>Section 3.2 of <xref target="I-D.ietf-dkim-ssp"/> makes a factual error in stating that a
          valid signature by an Author Domain is already known to be compliant with any possible
          ADSP for that domain. Compliance with ADSP currently requires an Author Signature, not
          just a signature by the Author domain.</t>

        <t>The Author Signature requires the &quot;on-behalf-of&quot; identity to match
          against the author's address. A valid signature by the Author Domain per <xref
            target="RFC4871"/> will not impose this limitation, where the <xref
            target="I-D.ietf-dkim-ssp"/> Author Signature requirements limit interchange without
          justification.</t>

        <t>For example, office administrators might submit messages authored by their managers. The
          authenticated DKIM signature &quot;on-behalf-of&quot; identity could be that of
          the office administrator whose email-address was placed within the Sender header field as
          permitted by <xref target="RFC2822"/>. When a signing domain's practice permits office
          administrators to send messages on behalf of managers, a manager's email-address could be
          placed within the From header field to signify the manager's role as author.</t>

        <t>A valid signature, verified with a key that lacks identity restrictions, clearly
          indicates the signature was applied by a trusted signing agent. A trusted signing agent
          can sign on behalf of the entire domain and should ensure message conformance prior to
          signing. A signature by the Author domain, with a key that lacks identity restrictions, is
          sufficient to ensure the domain's ability to fully control the use of the From header
          field, and to assert any sundry list of message conformance requirements.</t>

        <t>A valid signature applied by the Author Domain using a key that lacks identity
          restrictions should be considered compliant with any possible ADSP. However, the current
          Author Signature definition, in conjunction with the discovery of a practice, may cause a
          valid signature to become invalid when assessing ADSP compliance where the
          &quot;on-behalf-of&quot; identity does not match against the author's address.</t>
      </section>

      <section title="Factual Omissions">
        <t><xref target="I-D.ietf-dkim-ssp"/> attempts to define practices used by a domain, but
          then fails to specify which public transport protocol or protocols meet the advertised
          practice. Misapplication of practice compliance assessments could lead to interchange
          problems when only a portion of the possible <xref target="RFC2822"/> related transports
          employ <xref target="RFC4871"/>.</t>

        <t>Omitting public transport specifics might seem reasonable, since there are many possible
          protocol gateways into SMTP provided by various third-parties. However, remaining silent
          on the relevant transport will lead to various ad-hoc methods for dealing with protocol
          gateways. As a result of the omission, <xref target="I-D.ietf-dkim-ssp"/> fails to warn of
          potential problems, such as various NNTP messages being dropped, for example.</t>

        <t>Omitting transport specifics has lead to the general requirement in <xref
            target="I-D.ietf-dkim-ssp"/> Section 4.3 that any ADSP related transport will use DNS at
          the domain of the address. The lack of transport agility results from there not being any
          ADSP parameter that makes a specific public transport assertion to clarify where and what
          resources are available.</t>
      </section>
    </section>

    <section title="DKIM and SMTP's transition to IPv6">
      <t>As IPv4 addresses become less available, a demand is growing for the acceptance of IPv6
        SMTP clients over port 25. IPv6 supports 340,000 decillion (340,000 x 10^33) unique
        addresses that operate over dual-stacks, IPv6/IPv4 gateways, and tunnels. Currently,
        protective services defend MTAs from abusive clients by processing logs that resolve on the
        order of 200 million unique IPv4 addresses every few minutes. These protective services are
        time sensitive while providing a dynamic shield against sporadic, and often high levels of
        abuse, when these sources are aggregated.</t>

      <t>The resources consumed, and cost expended, in providing protective services is not
        insignificant. A desire to use IPv6 addresses with SMTP happens at a time where companies
        are striving to reduce their expenditures. There is some justification in cutting back on
        SMTP specific protections. Surveys indicate email represents a small and falling percentage
        of one's direct exposure to malware. The browser, rather than the MUA, offers a greater
        target of opportunity for bad actors.</t>

      <t>Although DKIM has a potential for replay abuse, combining the signing domain with the
        &quot;on-behalf-of&quot; identity, can better establish a defensible basis for
        acceptance, as opposed to a virtually unlimited IPv6 address space that might also represent
        a mixture of good and bad actors. Using the DKIM domain and &quot;on-behalf-of&quot;
        identity tuple to tracking tens of millions of opaque accounts within hundreds of thousands
        of large domains represents a manageable dataset of about 6 billion.</t>

      <t>This dataset represents an increase of about 30,000 times over the dataset now defending
        IPv4. Even with this sizable increase, DKIM still offers a simpler, more reliable, and much
        smaller dataset than what is likely needed to track a more complex range of IPv6 addresses
        that extend well beyond a human comprehensible scale.</t>

      <t>For DKIM to provide a defensible basis for acceptance, the signing domain needs to offer
        valid &quot;on-behalf-of&quot; identities that track the elements authenticated by
        the signing domain. A domain, that can be trusted to offer opaque identifiers of what they
        authenticate, provides a safe basis for acceptance. These identifiers might represent that
        of an account, an IP address within a network, or a system's certificate, and not that of an
        email-address found within the From header field.</t>

      <t>Most abuse is enabled by compromised accounts or systems that are seldom directly
        associated with a From email-address. Since ADSP is unlikely to alter what a domain
        authenticates, DKIM is can be far more effective against abuse wrought by compromised
        systems by allowing the &quot;on-behalf-of&quot; identity to represent an account or
        system as well. Unfortunately, <xref target="I-D.ietf-dkim-ssp"/> requires a bad practice
        where the &quot;on-behalf-of&quot; must be blank when it does not represent that of
        the From header field. The imposition of a bad practice results from the failure of <xref
          target="I-D.ietf-dkim-ssp"/> to differentiate between remote and trusted signing agents.
          <xref target="I-D.ietf-dkim-ssp"/> prevents the good practice of always indicating the
        element authenticated. <xref target="I-D.ietf-dkim-ssp"/> also fails to satisfy a goal of
        controlling the From header field when remote signing agents are used.</t>
    </section>

    <section title="Recommended Changes">
      <section title="3.2 ADSP Usage">
        <t>CHANGE:</t>
        <t>If a message has a Valid Signature from an Author Domain, ADSP provides no benefit
          relative to that domain since the message is already known to be compliant with any
          possible ADSP for that domain.</t>
        <t>TO:</t>
        <t>If a message has a Valid Signature from an Author Domain, an additional consideration
          must be applied. When a key used to validate the signature imposes a restrictive template
          on the local-part of the &quot;on-behalf-of&quot; identity, this template and the
          signature's domain should also match against an address contained within the From header
          field, or the signature should not be considered valid.</t>
        <t>A match is determined by the construction of a template composed of the key's
          &quot;g=&quot; tag and value, and the domain as denoted in the signature's
          &quot;d=&quot; tag and value in the form:<vspace/>
          <list style="hanging">
            <t>&lt;g value | * &gt;@[*.]&lt;d value&gt;</t>
          </list></t>
        <t>The default for the key's local-part template value, when it is not present, is
          &quot;*&quot;, in which case no From header field comparison will be required.</t>
      </section>

      <section title="2.7.  Author Signature">
        <t>CHANGE:</t>
        <t>An &quot;Author Signature&quot; is any Valid Signature where the identity of the
          user or agent on behalf of which the message is signed (listed in the
          &quot;i=&quot; tag or its default value from the &quot;d=&quot; tag)
          matches an Author Address in the message. When the identity of the user or agent includes
          a Local-part, the identities match if the Local-parts are the same string, and the domains
          are the same string.</t>

        <t>TO:</t>
        <t>An &quot;Author Signature&quot; is any Valid Signature per section 3.2, where an
          Author Address domain is within the signature's &quot;d=&quot; tag and value
          domain.</t>
      </section>

      <section title="Section 4.1.  DNS Representation">
        <t>CHANGE:</t>
        <t>_adsp._domainkey.</t>
        <t>TO:</t>
        <t>_adsp. (preferably adopt a specific resource record instead).<vspace blankLines="1"/>
          <list style="hanging">
            <t>There is no practice that asserts no email is signed, so the presence of the
              &quot;_domainkey.&quot; subdomain at every existing node creates a misleading
              appearance of DKIM support at each node. The absence of the
              &quot;_domainkey.&quot; subdomain clarifies that the domain does not support
              DKIM.</t>
          </list></t>
      </section>

      <section title="3.1.  ADSP Applicability">
        <t>CHANGE:</t>
        <t>ADSP as defined in this document is bound to DNS.</t>
        <t>TO:</t>
        <t>ADSP as defined in this document is bound to DNS and SMTP.<vspace blankLines="1"/></t>
      </section>
      <section title="4.2.1.  Record Syntax">
        <t>CHANGE TERMS:</t>
        <t>Discardable and discard</t>
        <t>TO:</t>
        <t>Dismissable and dismiss<vspace blankLines="0"/>
          <list style="hanging">
            <t>Even for the example cases sighted in the DKIM mailing list, arrangements are being
              made to offer feedback to the sender so they can determine the level of abuse. The
              term discardable is likely to thwart adoption when the integrity of the delivery
              status is also important. If the mechanism proves effective, the level of abuse should
              also dramatically wane.</t>
          </list></t>
      </section>
    </section>

    <section title="IANA Considerations">
      <t>This document requires no IANA consideration.</t>
    </section>

    <section title="Security Considerations">
      <section title="Considerations not managed by draft-ietf-dkim-ssp">
        <t>DKIM keys with a restrictive local-part template in the <spanx style="verb">g=</spanx>
          tag and value are likely to be employed by remote signing agents beyond the direct control
          of the signing domain. As a result, additional consideration is required when a
          restrictive local-part template does not match against the From header field. Signatures
          should not be considered valid whenever a restrictive local-part key <spanx style="verb"
            >g=</spanx> tag and value, and the signature <spanx style="verb">d=</spanx> tag and
          value, do not match against a From header field address.</t>

        <t>Signatures by keys lacking a restrictive local-part template are only safely used when
          the signing agent is able to directly evaluate the signed header fields and content.
          Recognition of signing agents able to apply policy over the entire message improves
          security in several ways:<list style="hanging">
            <t>Discerns potentially deceptive signatures, independent of advertised signing practice
              discovery.</t>
            <t>Permits an accurate indication of on whose behalf the signature was added, even when
              not on behalf of the author's address.</t>
            <t>Permits the &quot;on behalf of&quot; identity to be derived from an account,
              instead of being left blank, when a signing domain is unable or unwilling to affirm
              the identity of the author's address.</t>
            <t>Permits the identity to track either the author or the account used. In response to a
              growing portion of the IP address space being blocked, bot-nets increasingly send
              their mail through a provider's outbound server after obtaining access to valid
              accounts. Being able to track the element granted access by a domain is most useful to
              third-parties wanting to implement a safe basis for refusing problematic accounts.
              Blocking problematic accounts will likely isolate bot-net 0wned systems.</t>
          </list></t>

        <t><xref target="I-D.ietf-dkim-ssp"/> should state that a valid DKIM signature does not
          safely provide an assertion of the author's identity, and that only the domain contained
          within the signature will have been verified by DKIM signature validation. In addition,
          when the &quot;on-behalf-of&quot; identity signing is restricted, and does not
          match against the From header field, the signature should not be considered valid.</t>

        <section title="Lack of transport specificity">
          <t><xref target="I-D.ietf-dkim-ssp"/> fails to signal which transport protocol implements
            an advertised practice. As such, it also fails to indicate which DNS resource, if any,
            supports the transport. Although verifying a domain's existence might query resource
            records specified by <xref target="RFC2821"/>, the associated transport is never
            specified, where only returned query errors are meaningful.</t>

          <t>Since the goal is to control use of a domain in the From header field, a DNS error will
            then likely require a message to be refused, because the proposed methods are unable to
            resolve practices over a domain hierarchy. <xref target="I-D.ietf-dkim-ssp"/> also never
            specifies a transport or related resource records. This means any wildcard resource
            record within the domain will thereby allow domain spoofing. Any domain that uses
            wildcards will permit any synthesized domain appear to lack advertised practice
            assertions.</t>

          <t>Contrary to the MUST NOT use wildcards mandate, a solution for covering the entire
            domain hierarchy or for coping with wildcard resources will likely be wildcard TXT
            resource records containing restrictive practice assertions. The sanctioned alternative
            would be to publish separate resource records at each existing domain node. As if a per
            node alternative was not bad enough, this alternative is made even less attractive by
            requiring more entries and by consuming more resources than otherwise required had a
            specific resource record been defined for ADSP, or had just a single prefix been used.</t>

          <t>The additional DNS overhead occurs with the use of two prefixed subdomain labels
            locating the TXT resource record. Instead of just the 6 byte &quot;_adsp.&quot;,
            the additional &quot;_domainkey.&quot; label introduces an additional 11 bytes
            and subdomain for every DNS node protected. The logic for having any label was to
            accommodate typical web-based commodity provider tools that often do not support new
            resource record types.</t>

          <t>Justification for the second label is likely based upon a false assumption that the
            delegation of the &quot;_domainkey.&quot; subdomain will also facilitate the
            typical needs of third-party providers that advertise practices at only the domain
            supporting the transport.</t>

          <t>There are transport protocols in wide use that employ <xref target="RFC2822"/>
            messages, but that might not utilize DNS. There are also cases where a domain contained
            within a message is intentionally not found in DNS. Such domains may be used to deal
            with a different name space, or to ensure the related email address is not exploited by
            spammers. Without any transport or related resources being defined, <xref
              target="I-D.ietf-dkim-ssp"/> fails offer a practical a means to deal with messages
            that might conflict with its strategy that depends upon the lack of DNS errors as a
            basis for acceptance.</t>
        </section>

        <t><xref target="I-D.ietf-dkim-ssp"/> should recommend that recipients be advised to use
          automated folder placement for trusted signing domains to reduce deceptions that utilize
          domain look-alike and subdomain based tactics.</t>

        <section title="DNS Wildcards and specifying SMTP as the transport">
          <t>With the exception of wildcard MX records, wildcards within a domain that also publish
            ADSP records should not pose a significant problem. Although referencing SMTP related
            records will not provide <spanx style="verb">NXDOMAIN</spanx> results when a domain
            contains a wildcard, SMTP discovery records, such as MX or A records, still offer
            evidence of SMTP support. Whether AAAA records, absent MX or A records, can be
            considered evidence of SMTP support has not withstood the widespread use of AAAA only
            servers.</t>

          <t>For security reasons, SMTP should also adopt an MX resource record mandate for the
            acceptance of public exchanges. This would then mean advertised practice discovery could
            be limited to subdomains containing MX records, and ensure failure of a single
            transaction obtaining an MX record would curtail all other message related transactions.
            An MX resource record mandate would thereby shelter domains not publishing MX records
            from the additional assortment of transactions often associated with any number of
            spoofed email-addresses and DKIM signatures that might be generated per message.</t>
        </section>
      </section>
    </section>
  </middle>
  <back>
    <references title="References - Normative"> &I-D.ietf-dkim-ssp; </references>
    <references title="References - Informative"> &rfc1034; &rfc2119; &rfc2181;
      &rfc2606; &rfc2821; &rfc2822; &rfc4033; &rfc4034; &rfc4686;
      &rfc4871; &rfc5234; &rfc2782; &rfc5016; </references>
  </back>
</rfc>
