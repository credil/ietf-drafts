<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes" ?>
<?rfc compact="yes" ?>
<?rfc sortrefs="no" ?>

<rfc category="info" docName="draft-elwell-sipping-update-pai-02.txt" ipr="full3978" obsoletes="" updates="RFC 3325">
<front>
  <title abbrev="Updates to SIP Asserted Identity">Updates to Asserted Identity in the Session Initiation Protocol (SIP)</title>
  <author fullname="John Elwell" initials="J." surname="Elwell">
    <organization>Siemens Enterprise Communications GmbH & Co KG</organization>
    <address>
      <postal>
        <street>Hofmannstrasse 51</street>
        <city>D-81379 Munich</city>
        <country>Germany</country>
      </postal>
      <phone>+44 115 943 4989</phone>
      <email>john.elwell@siemens.com</email>
    </address>
  </author>
  <date month="November" year="2007"></date>
  <area>RAI</area>
  <workgroup>SIPPING WG</workgroup>
  <keyword>I-D</keyword>
  <keyword>Internet-Draft</keyword>
  <keyword>SIP</keyword>
  <keyword>P-Asserted-Identity</keyword>
  <abstract>
    <t>SIP has a mechanism for conveying the asserted identity of the originator of a request by means of the P-Asserted-Identity header field. This header field is specified for use in requests using a number of SIP methods, in particular the INVITE method. However, RFC 3325 does not specify the insertion of this header field by a trusted UAC, does not specify the use of this header field with the SIP UPDATE, MESSAGE  or PUBLISH methods, and is unclear on the use of this header field in responses. This document extends RFC 3325 to cover these situations. </t>
<t>This work is being discussed on the sipping@ietf.org mailing list.</t>
  </abstract>
</front>
<middle>
  <section title="Terminology" toc="default">
    <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",   "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be   interpreted as described in <xref target="RFC2119" pageno="false" format="default">RFC-2119</xref>.</t>
  </section>
  <section title="Introduction" toc="default">
    <t>SIP (RFC 3261 <xref target="RFC3261" pageno="false" format="default"></xref>) has a mechanism for conveying the asserted identity of the originator of a request by means of the P-Asserted-Identity header field (RFC 3325 <xref target="RFC3325" pageno="false" format="default"></xref>). This header field is specified for use in requests using a number of SIP methods, in particular the INVITE method. However, RFC 3325 does not specify the insertion of this header field by a trusted UAC, does not specify the use of this header field with the SIP UPDATE method (RFC 3311 <xref target="RFC3311" pageno="false" format="default"></xref>), the SIP MESSAGE method (RFC 3428 <xref target="RFC3428" pageno="false" format="default"></xref>) or the SIP PUBLISH method (RFC 3903 <xref target="RFC3903" pageno="false" format="default"></xref>), and is unclear on the use of this header field in responses. This document extends RFC 3325 by allowing inclusion of the P-Asserted-Identity header field by trusted UACs, allowing use of this header field in UPDATE, MESSAGE and PUBLISH requests and, under certain conditions, allowing use of this header field in SIP responses.</t>
  </section>
  <section title="Discussion" toc="default">
    <section title="Inclusion of P-Asserted-Identity by a UAC" toc="default">
    <t>RFC 3325 does not include procedures for a UAC to include the P-Asserted-Identity header field in a request. This can be meaningful if the UAC can be trusted by the first proxy, as is often the case for PSTN gateways, for example. Indeed it is common practice to do so. Normal proxy procedures would ensure that the header field is removed or replaced if the UAC cannot be trusted and the asserted identity cannot be authenticated.</t>
    </section>
    <section title="Inclusion of P-Asserted-Identity in an UPDATE request" toc="default">
      <t>There are several use cases that would benefit from the use of the P-Asserted-Identity header field in an UPDATE request. These use cases apply within a trusted environment where the use of asserted identity is appropriate (see RFC 3325).</t>
      <t>In one example, an established call passes through a gateway to the PSTN. The gateway becomes aware that the remote party in the PSTN has changed, e.g., due to call transfer. By including the P-Asserted-Identity header field in an UPDATE request, the gateway can convey the identity of the new remote party to the peer SIP UA.</t>
      <t><list>
        <t>Note that the (re-)INVITE method could be used in this situation. However, this forces an offer-answer exchange, which typically is not required in this situation. Also it involves 3 messages rather than 2.</t>
      </list></t>
      <t>In another example, a B2BUA that provides third party call control (3PCC) wishes to join two calls together, one of which is still waiting to be answered and potentially is forked to different UAs. At this point in time it is not possible to trigger the normal offer-answer exchange between the two joined parties, because of the mismatch between a single dialog on the one side and potentially multiple early dialogs on the other side, so this action must wait until one of the called UAs answers. However, it would be useful to give an early indication to each user concerned of the identity of the user to which they will become connected when the call is answered. This can be achieved by the B2BUA sending an UPDATE request with a P-Asserted-Identity header field on the dialogs concerned.</t>
    </section>
    <section title="Inclusion of P-Asserted-Identity in a MESSAGE request" toc="default">
      <t>Within a trusted environment, a P-Asserted-Identity header field could advantageously be used in a MESSAGE request to assert the source of a page mode instant message. This would complement its use in an INVITE request to assert the source of an instant message session or any other form of session.</t>
    </section>
    <section title="Inclusion of P-Asserted-Identity in a PUBLISH request" toc="default">
      <t>Within a trusted environment, a P-Asserted-Identity header field could advantageously be used in a PUBLISH request to assert the source of published state information. This would complement its use in SUBSCRIBE and NOTIFY requests.</t>
    </section>
    <section title="Inclusion of P-Asserted-Identity in a response" toc="default">
      <t>There are cases where the inclusion of the P-Asserted-Identity header field in responses would be useful. RFC 3325 is ambiguous on this. For example, section 4 of RFC 3325 talks about inclusion of the header field in messages, as opposed to requests. Moreover section 5 explicitly mentions "message (request or response)". However, there are other places (e.g., sections 6, 7 and 8) that talk only about requests.</t>
      <t>Section 5 of RFC 3325 requires a proxy to authenticate the originator of a message before adding a P-Asserted-Identity header field to the forwarded message. In practice there is no SIP means to authenticate the sender of a SIP response message. However, authentication may be possible by other means. For example, if the proxy has TLS connectivity with the originator of the response and has previously authenticated the connected entity (e.g., using SIP digest authentication at registration time), then the originator of the response can be considered to be authenticated. In such circumstances it is permissible for a proxy to insert a P-Asserted-Identity header field in a SIP response.</t>
    </section>
  </section>
  <section title="Behaviour" toc="default">
    <t>This updates RFC 3325 by allowing a P-Asserted-Identity header field to be included by a trusted UAC, by allowing a P-Asserted-Identity header field to appear in an UPDATE, MESSAGE or PUBLISH request, and by allowing a P-Asserted-Identity header field to appear in a response in certain circumstances.</t>
    <section title="UAC Behaviour" toc="default">
      <section title="Request handling" toc="default">
        <t>A UAC MAY include a P-Asserted-Identity header field in a request to report the identity of the user on behalf of which the UAC is acting and whose identity the UAC is in a position to assert. A UAC SHOULD do so only in cases where it can expect to be trusted by the first proxy. A UAC SHOULD NOT do so in other circumstances and might instead use the P-Preferred-Identity header field.</t>
        <t><list>
          <t>Note that a proxy might trust a UAC such as a known PSTN gateway. The proxy might trust the PSTN gateway to assert an identity received from the PSTN, the proxy itself having no means to authenticate such an identity.</t>
        </list></t>
        <t>A UAC MAY include a P-Asserted-Identity header field in an UPDATE request to report a changed identity mid-dialog. This can be an UPDATE request sent specially for this purpose or an UPDATE request sent for some other purpose.</t>
        <t>A UAC MAY include a P-Asserted-Identity header field in a MESSAGE or PUBLISH request.</t>
      </section>
      <section title="Response handling" toc="default">
        <t>Typically a UA renders the value of a P-Asserted-Identity header field that it receives in a response to its user.  It may consider the identity provided by a Trust Domain to be privileged, or intrinsically more trustworthy than other information in the response. However, any particular behaviour is specific to implementations or services. This document also does not mandate any UA handling for multiple P-Asserted-Identity header field values that happen to appear in a response (such as a SIP URI alongside a tel URL).</t>
        <t>However, if a UAC receives a response from a previous element that it does not trust, it MUST NOT use the P-Asserted-Identity header field in any way.</t>
        <t>If a UA is part of the Trust Domain from which it received a response containing a P-Asserted-Identity header field, then it can use the value freely but it MUST ensure that it does not forward the information to any element that is not part of the Trust Domain if the user has requested that asserted identity information be kept private.</t>
        <t>If a UA is not part of the Trust Domain from which it received a response containing a P-Asserted-Identity header field, then it can assume this information does not need to be kept private.</t>
      </section>
    </section>
    <section title="Proxy Behaviour" toc="default">
      <section title="Request handling" toc="default">
        <t>If a proxy receives an UPDATE, MESSAGE or PUBLISH request containing a P-Asserted-Identity header field, it MUST behave as for any other request in accordance with the rules of RFC 3325 for a proxy.</t>
      </section>
      <section title="Response handling" toc="default">
        <t>The proxy behaviour specified in RFC 3325 is applicable to responses with the following qualification. A proxy that receives a response from a node that it does not trust cannot directly authenticate the UAS by SIP means. Therefore it MUST NOT include a P-Asserted-Identity header field when forwarding the response unless it has authenticated the UAS by other means.</t>
        <t><list>
          <t>One possible circumstance in which a proxy can include a P-Asserted-Identity header field when forwarding a response from a node that it does not trust is when the proxy has direct TLS connectivity with the UAS and has authenticated the UA by some other means (e.g., SIP digest authentication) during that same TLS session.</t>
        </list></t>
      </section>
    </section>
    <section title="UAS Behaviour" toc="default">
      <section title="Request handling" toc="default">
        <t>If a UAS receives an UPDATE, MESSAGE or PUBLISH request containing a P-Asserted-Identity header field, it MUST behave as for any other request in accordance with the rules of RFC 3325 for a UAS.</t>
      </section>
      <section title="Response handling" toc="default">
        <t>A UAS MAY include a P-Asserted-Identity header field in a response to report the identity of the user on behalf of which the UAS is acting and whose identity the UAS is in a position to assert. A UAS SHOULD do so only in cases where it can expect to be trusted by the first proxy that handles the response.</t>
        <t><list>
          <t>Note that a proxy might trust a UAS such as a known PSTN gateway. The proxy might trust the PSTN gateway to assert an identity received from the PSTN, the proxy itself having no means to authenticate such an identity.</t>
        </list></t>
      </section>
    </section>
  </section>
  <section title="IANA considerations" toc="default">
    <t>None</t>.
  </section>
  <section title="Security considerations" toc="default" anchor="section-security">
    <t>The use of asserted identity raises a number of security considerations, which are discussed fully in RFC 3325 <xref target="RFC3325" pageno="false" format="default"></xref>. This document raises the following additional security considerations.</t>
    <t>When receiving a request or response containing a P-Asserted-Identity header field directly from a UA (rather than from another proxy), a proxy may trust the UA in certain circumstances. This might occur if the UA is a known PSTN gateway and the request or response has been secured by TLS. The proxy might trust the PSTN gateway to assert an identity received from the PSTN, the proxy itself having no means to authenticate such an identity. In other circumstances a proxy should not trust an identity asserted by a UA.</t>
    <t>When receiving a response from an untrusted node, a proxy has no direct SIP means to authenticate the node. However, if authentication has taken place by other means (e.g., an earlier use of SIP digest authentication) and the entity sending the response is known to be the same entity (e.g., connected via the same TLS session) this can be sufficient grounds for asserting an identity. In other circumstances a proxy must not assert identity for a responding user.</t>
  </section>

</middle>

<back>
  <references title="Normative References">
    <reference anchor="RFC3261">
      <front>
        <title>SIP: Session Initiation Protocol</title>
        <author initials="J." surname="Rosenberg" fullname="J. Rosenberg">
          <organization></organization>
        </author>
        <author initials="H." surname="Schulzrinne" fullname="H. Schulzrinne">
          <organization></organization>
        </author>
        <author initials="G." surname="Camarillo" fullname="G. Camarillo">
          <organization></organization>
        </author>
        <author initials="A." surname="Johnston" fullname="A. Johnston">
          <organization></organization>
        </author>
        <author initials="J." surname="Peterson" fullname="J. Peterson">
          <organization></organization>
        </author>
        <author initials="R." surname="Sparks" fullname="R. Sparks">
          <organization></organization>
        </author>
        <author initials="M." surname="Handley" fullname="M. Handley">
          <organization></organization>
        </author><author initials="E." surname="Schooler" fullname="E. Schooler">
          <organization></organization>
        </author>
        <date month="June" year="2002"></date>
      </front>
      <seriesInfo name="RFC" value="3261"></seriesInfo>
    </reference>
    <reference anchor="RFC2119">
      <front>
        <title abbrev="RFC Key Words">Key words for use in RFCs to Indicate Requirement Levels</title>
        <author initials="S." surname="Bradner" fullname="Scott Bradner">
          <organization></organization>
        </author>
        <date month="March" year="1997"></date>
      </front>
      <seriesInfo name="BCP" value="14"></seriesInfo>
      <seriesInfo name="RFC" value="2119"></seriesInfo>
      <format type="HTML" octets="14486" target="http://xml.resource.org/public/rfc/html/rfc2119.html"></format>
      <format type="XML" octets="5661" target="http://xml.resource.org/public/rfc/xml/rfc2119.xml"></format>
    </reference>
    <reference anchor="RFC3311">
      <front>
        <title>The Session Initiation Protocol (SIP) UPDATE Method</title>
        <author initials="J." surname="Rosenberg" fullname="Jonathan Rosenberg">
          <organization></organization>
        </author>
        <date month="September" year="2002"></date>
      </front>
      <seriesInfo name="RFC" value="3311"></seriesInfo>
    </reference>
    <reference anchor="RFC3325">
      <front>
        <title>Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks</title>
        <author initials="C." surname="Jennings" fullname="Cullen Jennings">
          <organization>Cisco Systems</organization>
        </author>
        <author initials="J." surname="Peterson" fullname="Jon Peterson">
          <organization>NeuStar, Inc.</organization>
        </author>
        <author initials="M." surname="Watson" fullname="Mark Watson">
          <organization>Nortel Networks</organization>
        </author>
        <date month="November" year="2002"></date>
      </front>
      <seriesInfo name="RFC" value="3325"></seriesInfo>
    </reference>
    <reference anchor="RFC3428">
      <front>
        <title>Session Initiation Protocol (SIP) Extension for Instant Messaging</title>
        <author initials="B." surname="Campbell" fullname="Ben Campbell">
          <organization>Dynamicsoft</organization>
        </author>
        <author initials="J." surname="Rosenberg" fullname="Jonathan Rosenberg">
          <organization>Dynamicsoft</organization>
        </author>
        <author initials="H." surname="Schulzrinne" fullname="Henning Schulzrinne">
          <organization>Columbia University</organization>
        </author>
        <author initials="C." surname="Huitema" fullname="Christian Huitema">
          <organization>Microsoft Corporation</organization>
        </author>
        <date month="November" year="2002"></date>
        <author initials="D." surname="Gurle" fullname="David Gurle">
          <organization>Microsoft Corporation</organization>
        </author>
      </front>
      <seriesInfo name="RFC" value="3428"></seriesInfo>
    </reference>
    <reference anchor="RFC3903">
      <front>
        <title>Session Initiation Protocol (SIP) Extension for Event State Publication</title>
        <author initials="A." surname="Niemi" fullname="Aki Niemi">
          <organization>Nokia</organization>
        </author>
        <date month="November" year="2002"></date>
      </front>
      <seriesInfo name="RFC" value="3903"></seriesInfo>
    </reference>
  </references>
</back>
</rfc>
