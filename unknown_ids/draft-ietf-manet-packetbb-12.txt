


Mobile Ad hoc Networking (MANET)                              T. Clausen
Internet-Draft                          LIX, Ecole Polytechnique, France
Intended status: Standards Track                             C. Dearlove
Expires: September 8, 2008               BAE Systems Advanced Technology
                                                                  Centre
                                                                 J. Dean
                                               Naval Research Laboratory
                                                                C. Adjih
                                                      INRIA Rocquencourt
                                                           March 7, 2008


                Generalized MANET Packet/Message Format
                      draft-ietf-manet-packetbb-12

Status of This Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on September 8, 2008.












Clausen, et al.         Expires September 8, 2008               [Page 1]

Internet-Draft             MANET packet format                March 2008


Abstract

   This document specifies a packet format capable of carrying multiple
   messages that may be used by mobile ad hoc network routing and
   signaling protocols.

Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology and Notation . . . . . . . . . . . . . . . . . . .  5
   3.  Applicability Statement  . . . . . . . . . . . . . . . . . . .  7
   4.  Protocol Overview and Functioning  . . . . . . . . . . . . . .  8
   5.  Syntactical Specification  . . . . . . . . . . . . . . . . . .  9
     5.1.  Packets  . . . . . . . . . . . . . . . . . . . . . . . . .  9
     5.2.  Messages . . . . . . . . . . . . . . . . . . . . . . . . . 11
     5.3.  Address Blocks . . . . . . . . . . . . . . . . . . . . . . 13
     5.4.  TLVs and TLV Blocks  . . . . . . . . . . . . . . . . . . . 16
       5.4.1.  TLVs . . . . . . . . . . . . . . . . . . . . . . . . . 16
       5.4.2.  TLV Inclusion and Constraints  . . . . . . . . . . . . 19
     5.5.  Malformed Elements . . . . . . . . . . . . . . . . . . . . 20
   6.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 21
     6.1.  Message Types  . . . . . . . . . . . . . . . . . . . . . . 21
     6.2.  Packet TLV Types . . . . . . . . . . . . . . . . . . . . . 21
     6.3.  Message TLV Types  . . . . . . . . . . . . . . . . . . . . 22
     6.4.  Address Block TLV Types  . . . . . . . . . . . . . . . . . 22
   7.  Security Considerations  . . . . . . . . . . . . . . . . . . . 24
     7.1.  Authentication Suggestions . . . . . . . . . . . . . . . . 24
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 25
     8.1.  Normative References . . . . . . . . . . . . . . . . . . . 25
     8.2.  Informative References . . . . . . . . . . . . . . . . . . 25
   Appendix A.  Intended Usage  . . . . . . . . . . . . . . . . . . . 26
   Appendix B.  Compatibility Requirements for Future Versions  . . . 27
   Appendix C.  Examples  . . . . . . . . . . . . . . . . . . . . . . 28
     C.1.  Address Block Examples . . . . . . . . . . . . . . . . . . 28
     C.2.  TLV Examples . . . . . . . . . . . . . . . . . . . . . . . 30
   Appendix D.  Illustrations . . . . . . . . . . . . . . . . . . . . 33
     D.1.  Packet . . . . . . . . . . . . . . . . . . . . . . . . . . 33
     D.2.  Message  . . . . . . . . . . . . . . . . . . . . . . . . . 40
     D.3.  Message Body . . . . . . . . . . . . . . . . . . . . . . . 46
     D.4.  Address Block  . . . . . . . . . . . . . . . . . . . . . . 47
     D.5.  TLV Block  . . . . . . . . . . . . . . . . . . . . . . . . 54
     D.6.  TLV  . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
   Appendix E.  Complete Example  . . . . . . . . . . . . . . . . . . 60
   Appendix F.  Contributors  . . . . . . . . . . . . . . . . . . . . 62
   Appendix G.  Acknowledgements  . . . . . . . . . . . . . . . . . . 63






Clausen, et al.         Expires September 8, 2008               [Page 2]

Internet-Draft             MANET packet format                March 2008


1.  Introduction

   This document specifies the syntax of a general purpose packet format
   capable of carrying multiple messages for information exchange
   between MANET (Mobile Ad hoc NETwork) routers.  Messages consist of a
   message header, which is designed for control of message
   dissemination, and a message body, which contains protocol
   information.  Only the syntax of the packet and messages is
   specified.  All syntactical entities, including packets and messages,
   are specified using regular expressions.

   This document specifies:

   o  A packet format, allowing zero or more messages to be contained
      within a single transmission, and optionally including a packet
      header.  A packet with zero messages may be sent in case the only
      information to exchange is contained in the packet header.

   o  A message format, where a message is composed of a message header
      and a message body.

   o  A message header format, which contains information which may be
      sufficient to allow a protocol using this specification to make
      processing and forwarding decisions.

   o  A message body format, containing attributes associated with the
      message or the originator of the message, as well as blocks of
      addresses, or address prefixes, with associated attributes.

   o  An address block format, where an address block represents sets of
      addresses, or address prefixes, in a compact (compressed) form.

   o  A generalized type-length-value (TLV) format representing
      attributes.  Multiple TLVs can be included and each associated
      with a packet, a message, or one or more addresses or address
      prefixes.

   The specification has been explicitly designed with the following
   properties, listed in no particular order, in mind:

   Parsing logic  - the regular expression specification facilitates
      generic, protocol independent, parsing logic.

   Extensibility  - packets and messages defined by a protocol using
      this specification are extensible through defining new message
      types and new TLVs.  Existing protocol specifications using this
      specification will be able to correctly identify and skip such new
      message types and TLVs, while correctly parsing the remainder of



Clausen, et al.         Expires September 8, 2008               [Page 3]

Internet-Draft             MANET packet format                March 2008


      the packet and message.

   Efficiency  - when reported addresses share common bit sequences
      (e.g. address prefixes or IPv6 interface identifiers) the address
      block representation allows for a compact representation.  Compact
      message headers are ensured through permitting inclusion of only
      required message header elements, unless indicated otherwise.  The
      structure of packet and message encoding allows parsing,
      verifying, and identifying individual elements in a single pass.

   Separation of forwarding and processing  - a protocol using this
      specification can be designed such that duplicate detection and
      controlled scope message forwarding decisions can be made using
      information contained in the message header, without processing
      the message body.




































Clausen, et al.         Expires September 8, 2008               [Page 4]

Internet-Draft             MANET packet format                March 2008


2.  Terminology and Notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119.  [RFC2119].

   Additionally, this document uses the following terminology:

   Packet  - The top level entity in this specification.  A packet
      contains zero or more messages, and may contain a packet header.

   Message  - The fundamental entity carrying protocol information, in
      the form of address objects and TLVs.

   Address  - A number of octets of the same length as the source IP
      address in the IP datagram carrying the packet.  The meaning of an
      address is defined by the protocol using this specification.

   Address Prefix  - An address plus a prefix length, with the prefix
      length being a number of address bits measured from the left/most
      significant end of the address.

   Address Object  - Either an address, or an address prefix, as
      specified in an address block in this specification.

   TLV  - A Type-Length-Value structure.  This is a generic way in which
      an attribute can be represented and correctly parsed, without the
      parser having to understand the attribute.

   Element  - A syntactic entity defined in the regular expression
      specification, represented using the notation <foo>.

   <foo>  - If <foo> is an 8 or 16 bit unsigned integer field then <foo>
      is also used to represent the value of that field.

   bar  - A variable, usually obtained through calculations based on the
      value(s) of element(s).  Variables are introduced into the
      specification solely as a means to clarify the description.

   := - Indicates that the element or variable on the left hand side is
      defined as the expression on the right hand side.

   {<element1><element2>}  - Indicates a grouping of the elements
      enclosed by the braces.







Clausen, et al.         Expires September 8, 2008               [Page 5]

Internet-Draft             MANET packet format                March 2008


   ?  - Zero or one occurrences of the preceding element or group.

   *  - Zero or more occurrences of the preceding element or group.

   address-length  - A variable whose value is the length of an address
      in octets, it is 4 if using IPv4, 16 if using IPv6.













































Clausen, et al.         Expires September 8, 2008               [Page 6]

Internet-Draft             MANET packet format                March 2008


3.  Applicability Statement

   This specification describes a generic packet format capable of
   carrying multiple messages, for carrying MANET routing protocol
   signals.  The specification has been inspired by and extended from
   that used by OLSR (The Optimized Link State Routing protocol)
   [RFC3626].

   The specification is designed with IP (IPv4/IPv6) in mind.  All
   addresses within a control message are assumed to be of the same
   size, deduced from IP.  In the case of mixed IPv6 and IPv4 addresses,
   IPv4 addresses can be represented as IPv4-mapped IPv6 addresses as
   specified in [RFC4291].

   The messages defined by this specification are designed to carry
   MANET routing protocol signals between MANET routers.  This
   specification includes elements which can support limited diffusion
   (flooding), as well as being usable for point to point delivery of
   MANET routing protocol signals in a multi-hop network.

   The packets defined by this specification are designed to carry a
   number of MANET routing protocol messages in a single transmission.
   The packets may be unicast or multicast, and may be transmitted as
   appropriate to the MANET routing protocol using this specification.

   This specification is particularly appropriate for extensible MANET
   routing protocols.  It offers external extensibility in the form of
   new message types.  It offers internal extensibility in the form of
   TLVs, which may be added to existing message types.

   A MANET routing protocol using the multi-message packet format
   defined by this specification MAY constrain the syntax (for example
   requiring a specific set of message header fields) that the protocol
   will employ.

















Clausen, et al.         Expires September 8, 2008               [Page 7]

Internet-Draft             MANET packet format                March 2008


4.  Protocol Overview and Functioning

   This specification does not describe a protocol.  It describes a
   packet format, which may be used by any mobile ad hoc network routing
   or other protocol.














































Clausen, et al.         Expires September 8, 2008               [Page 8]

Internet-Draft             MANET packet format                March 2008


5.  Syntactical Specification

   This section provides syntactical specification of a packet,
   represented by the element <packet> and the elements from which it is
   composed.  The specification is given in the form of regular
   expressions.  Illustrations of specified elements are given in
   Appendix D.

   This format uses network byte order (most significant octet first)
   for all fields.

5.1.  Packets

   <packet> is defined by:

       <packet> := <pkt-header>?
                   <message>*

   where <message> is as defined in Section 5.2.  Successful parsing is
   terminated when all octets (defined using the variable pkt-size
   below) are used.  A packet MUST NOT be empty, that is a packet MUST
   contain either a <pkt-header> or at least one <message>.

   <pkt-header> is defined by:

       <pkt-header> := <zero>
                       <pkt-semantics>
                       <pkt-version>?
                       <pkt-size>?
                       <pkt-seq-num>?
                       <tlv-block>?

   where:

   <zero>  is an 8 bit field with all bits cleared ('0').  This field
      serves to identify that the packet starts with a <pkt-header>.

   <pkt-semantics>  is an 8 bit field, specifying the composition of the
      <pkt-header>:

      bit 0 (phasversion):  If cleared ('0'), then <pkt-version> is not
         included in the <pkt-header>.  If set ('1'), then <pkt-version>
         is included in the <pkt-header>.

      bit 1 (phassize):  If cleared ('0'), then <pkt-size> is not
         included in the <pkt-header>.  If set ('1'), then <pkt-size> is
         included in the <pkt-header>.




Clausen, et al.         Expires September 8, 2008               [Page 9]

Internet-Draft             MANET packet format                March 2008


      bit 2 (phasseqnum):  If cleared ('0'), then <pkt-seq-num> is not
         included in the <pkt-header>.  If set ('1'), then <pkt-seq-num>
         is included in the <pkt-header>.

      bit 3 (phastlv):  If cleared ('0'), then <tlv-block> is not
         included in the <pkt-header>.  If set ('1'), then <tlv-block>
         is included in the <pkt-header>.

      bit 4 (pnouniord):  If cleared ('0'), then the packet TLV block
         MUST conform to the constraints in Section 5.4.2.  If set
         ('1'), then the packet TLV block is not subject to the
         constraints in Section 5.4.2.  Additional constraints MAY be
         imposed by a protocol using this specification.

      bits 5-7:  Are RESERVED, and SHOULD each be cleared ('0') on
         transmission, and SHOULD be ignored on reception.

   <pkt-version>  is omitted if the phasversion bit is cleared ('0'),
      otherwise is an 8 bit unsigned integer field, specifying the
      version of this specification.

   <pkt-size>  is omitted if the phassize bit is cleared ('0'),
      otherwise is a 16 bit unsigned integer field, specifying the
      number of octets that make up the <packet>.

   <pkt-seq-num>  is omitted if the phasseqnum bit is cleared ('0'),
      otherwise is a 16 bit unsigned field, specifying a packet sequence
      number.

   <tlv-block>  is omitted if the phastlv bit is cleared ('0'), and is
      otherwise as defined in Section 5.4.

   Note that since message type zero is not used (see Section 6), the
   presence or absence of a packet header can be determined by
   inspecting the first octet of the packet.

   pkt-version  is a variable, defined to equal <pkt-version> if
      present, or zero (0) otherwise. pkt-version MUST be zero to be in
      accordance with this version of this specification.  See
      Appendix B.

   pkt-size  is a variable, defined to equal <pkt-size> if present, or
      the size of the payload of the network or transport protocol
      employed otherwise.  (If not present, and the payload size is
      unknown, then the packet cannot be parsed, and is considered
      malformed.)





Clausen, et al.         Expires September 8, 2008              [Page 10]

Internet-Draft             MANET packet format                March 2008


5.2.  Messages

   Information is carried through messages.  Messages contain:

   o  A message header.

   o  A message TLV block that contains zero or more TLVs, associated
      with the whole message.

   o  Zero or more address blocks, each containing one or more address
      objects.

   o  An address TLV block, containing zero or more TLVs, following each
      address block.

   <message> is defined by:

       <message>    := <msg-header>
                       <tlv-block>
                       {<addr-block><tlv-block>}*

       <msg-header> := <msg-type>
                       <msg-semantics>
                       <msg-version>?
                       <msg-size>
                       <msg-orig-addr>?
                       <msg-hop-limit>?
                       <msg-hop-count>?
                       <msg-seq-num>?

   where:

   <tlv-block>  is as defined in Section 5.4.

   <addr-block>  is as defined in Section 5.3.

   <msg-type>  is an 8 bit unsigned integer field, specifying the type
      of the message.  A type with all bits cleared ('0') MUST NOT be
      used.

   <msg-semantics>  is an 8 bit field, specifying the interpretation of
      the remainder of the message header:

      bit 0 (mhasversion):  If cleared ('0'), then <msg-version> is not
         included in the <msg-header>.  If set ('1'), then <msg-version>
         is included in the <msg-header>.





Clausen, et al.         Expires September 8, 2008              [Page 11]

Internet-Draft             MANET packet format                March 2008


      bit 1 (mhasorig):  If cleared ('0'), then <msg-orig-addr> is not
         included in the <msg-header>.  If set ('1'), then <msg-orig-
         addr> is included in the <msg-header>.

      bit 2 (mhashoplimit):  If cleared ('0'), then <msg-hop-limit> is
         not included in the <msg-header>.  If set ('1'), then <msg-hop-
         limit> is included in the <msg-header>.

      bit 3 (mhashopcount):  If cleared ('0'), then <msg-hop-count> is
         not included in the <msg-header>.  If set ('1'), then <msg-hop-
         count> is included in the <msg-header>

      bit 4 (mhasseqnum):  If cleared ('0'), then <msg-seq-num> is not
         included in the <msg-header>.  If set ('1'), then <msg-seq-num>
         is included in the <msg-header>.

      bit 5 (mistypedep):  If cleared ('0'), then the message sequence
         number in the message is type-independent.  If set ('1'), then
         the message sequence number contained in the message is type
         dependent (the message originator maintains a sequence number
         specific to <msg-type>).  This bit MUST be cleared ('0') if the
         mhasorig bit is cleared ('0').

      bit 6 (mnouniord):  If cleared ('0'), then the message TLV block
         and all address TLV blocks in the message MUST conform to the
         constraints in Section 5.4.2.  If set ('1'), then the message
         TLV block and all address TLV blocks in the message are not
         subject to the constraints in Section 5.4.2.  Additional
         constraints MAY be imposed by a protocol using this
         specification.

      bit 7:  Is RESERVED, and SHOULD be cleared ('0') on transmission,
         and SHOULD be ignored on reception.

   <msg-version>  is omitted if the mhasversion bit is cleared ('0'),
      otherwise is an 8 bit unsigned integer field, specifying the
      version of this specification.

   <msg-size>  is a 16 bit unsigned integer field, specifying the number
      of octets that make up the <message>

   <msg-orig-addr>  is omitted if the mhasorig bit is cleared ('0'),
      otherwise is an identifier with length equal to address-length,
      which can serve to uniquely identify the node that originated the
      message.






Clausen, et al.         Expires September 8, 2008              [Page 12]

Internet-Draft             MANET packet format                March 2008


   <msg-hop-limit>  is omitted if the mhashoplimit bit is cleared ('0'),
      otherwise is an 8 bit unsigned integer field, which can contain
      the maximum number of hops that the message should be further
      transmitted.

   <msg-hop-count>  is omitted if the mhashopcount bit is cleared ('0'),
      otherwise is an 8 bit unsigned integer field, which can contain
      the number of hops that the message has traveled.

   <msg-seq-num>  is omitted if the mhasseqnum bit is cleared ('0'),
      otherwise is a 16 bit unsigned integer field, which can contain a
      sequence number, generated by the message's originator node.

   msg-version  is a variable, defined to equal <msg-version> if
      present, or to pkt-version otherwise. msg-version MUST be 0 (zero)
      to be in accordance with this version of this specification.  See
      Appendix B.

5.3.  Address Blocks

   An address block can specify one or more addresses.  It can also
   specify prefix lengths that can be applied to all addresses in the
   address block.  This allows an address block to specify either
   addresses or address prefixes.  A protocol may specify that an
   address with a maximum prefix length (equal to the address length, in
   bits) is considered to be an address, rather than a address prefix,
   thus allowing an address block to contain a mixture of addresses and
   address prefixes.  The common term "address object" is used in this
   specification to cover both of these; note that an address object in
   an address block always includes the prefix length, if present.

   An address is specified as a sequence of address-length octets of the
   form head:mid:tail.  An address block contains an ordered set of
   addresses sharing the same head and tail, and having individual mids.

   An address block can specify address prefixes:

   o  with a single prefix length for all address prefixes, OR

   o  with a prefix length for each address prefix.

   <address-block> is defined by:

       <address-block> := <num-addr>
                          <addr-semantics>
                          {<head-length><head>?}?
                          {<tail-length><tail>?}?
                          <mid>*



Clausen, et al.         Expires September 8, 2008              [Page 13]

Internet-Draft             MANET packet format                March 2008


                          <prefix-length>*

   where:

   <num-addr>  is an 8 bit unsigned integer field containing the number
      of addresses represented in the address block, which MUST NOT be
      zero.

   <addr-semantics>  is an 8 bit field specifying the interpretation of
      the remainder of the address block:

      bit 0 (ahashead):  If cleared ('0'), then <head-length> and <head>
         are not included in the <address-block>.  If set ('1'), then
         <head-length> is included in the <address-block>, and <head> is
         included in the <address-block> unless <head-length> is zero.

      bit 1 (ahasfulltail) and bit 2 (ahaszerotail):  Are interpreted
         according to Table 1.  A combination not shown in that table
         MUST NOT be used.

      bit 3 (ahassingleprelen) and bit 4 (ahasmultiprelen):  Are
         interpreted according to Table 2.  A combination not shown in
         that table MUST NOT be used.

      bits 5-7:  Are RESERVED, and SHOULD each be cleared ('0') on
         transmission, and SHOULD be ignored on reception.

   +--------------+--------------+---------------+---------------------+
   | ahasfulltail | ahaszerotail | <tail-length> |        <tail>       |
   +--------------+--------------+---------------+---------------------+
   |       0      |       0      |  not included |     not included    |
   |              |              |               |                     |
   |       1      |       0      |    included   |   included unless   |
   |              |              |               |   <tail-length> is  |
   |              |              |               |         zero        |
   |              |              |               |                     |
   |       0      |       1      |    included   |     not included    |
   +--------------+--------------+---------------+---------------------+

     Table 1: Interpretation of the ahasfulltail and ahaszerotail bits











Clausen, et al.         Expires September 8, 2008              [Page 14]

Internet-Draft             MANET packet format                March 2008


   +------------+-----------+------------------+-----------------------+
   | ahassingle | ahasmulti |     number of    |  prefix length of the |
   |   prelen   |   prelen  |  <prefix-length> |  nth address prefix,  |
   |            |           |      fields      |        in bits        |
   +------------+-----------+------------------+-----------------------+
   |      0     |     0     |         0        |   8 * address-length  |
   |            |           |                  |                       |
   |      1     |     0     |         1        |    <prefix-length>    |
   |            |           |                  |                       |
   |      0     |     1     |    <num-addr>    |  nth <prefix-length>  |
   +------------+-----------+------------------+-----------------------+

    Table 2: Interpretation of the ahassingleprelen and ahasmultiprelen
                                   bits

   <head-length>  if present is an 8 bit unsigned integer field, which
      contains the number of octets in the head of all of the addresses.

   head-length  is a variable, defined to equal <head-length> if
      present, or 0 otherwise.

   <head>  is omitted if head-length is equal to 0, otherwise it is a
      field of the head-length leftmost octets of all the addresses.

   <tail-length>  if present is an 8 bit unsigned integer field, which
      contains the number of octets in the tail of all of the addresses.

   tail-length  is a variable, defined to equal <tail-length> if
      present, or 0 otherwise.

   <tail>  is omitted if tail-length is equal to 0 or if the
      ahaszerotail bit is set ('1'), otherwise it is a field of the
      tail-length rightmost octets of all the addresses.  If the
      ahaszerotail bit is set ('1') then the tail-length rightmost
      octets of all the addresses are all 0.

   mid-length  is a variable, which MUST be non-negative, defined by:

      *  mid-length := address-length - head-length - tail-length

   <mid>  is omitted if mid-length is equal to 0, otherwise each <mid>
      is a field of length mid-length octets, representing the mid of
      the corresponding address in the address block.

   <prefix-length>  is an 8 bit unsigned integer field containing the
      length, in bits, of the prefix length of an address prefix.  If
      the ahassingleprelen bit is set ('1') then a single <prefix-
      length> field contains the prefix length of all addresses in the



Clausen, et al.         Expires September 8, 2008              [Page 15]

Internet-Draft             MANET packet format                March 2008


      address block.  If the ahasmultiprelen bit is set ('1') then each
      of the <num-addr> <prefix-length> fields contains the prefix
      length of the corresponding address prefix in the address block
      (in the same order).  Otherwise no <prefix-length> fields are
      present; each address object can be considered to have a prefix
      length equal to 8 * address-length bits.  The address block is
      malformed if any <prefix-length> element has a value greater than
      8 * address-length.

5.4.  TLVs and TLV Blocks

   A TLV block is defined by:

       <tlv-block> := <tlvs-length>
                      <tlv>*

   where:

   <tlvs-length>  is a 16 bit unsigned integer field, which contains the
      total number of octets in all of the immediately following <tlv>
      elements.

   <tlv>  is as defined in Section 5.4.1.

5.4.1.  TLVs

   There are three kinds of TLV, each represented by an element <tlv>:

   o  A packet TLV, included in the packet TLV block in a packet header.

   o  A message TLV, included in the message TLV block in a message,
      before the first address block.

   o  An address block TLV, included in an address TLV block following
      an address block.  An address block TLV applies to:

      *  all address objects in the address block; OR

      *  any continuous sequence of address objects in the address
         block; OR

      *  a single address object in the address block.

   <tlv> is defined by:







Clausen, et al.         Expires September 8, 2008              [Page 16]

Internet-Draft             MANET packet format                March 2008


       <tlv> := <tlv-type>
                <tlv-semantics>
                <tlv-type-ext>?
                {<index-start><index-stop>?}?
                {<length><value>?}?

   where:

   <tlv-type>  is an 8 bit unsigned integer field, specifying the type
      of the TLV, specific to the TLV kind (i.e. packet, message, or
      address block TLV).

   <tlv-semantics>  is an 8 bit field specifying the interpretation of
      the remainder of the TLV:

      bit 0 (thastypeext):  If cleared ('0'), then <tlv-type-ext> is not
         included in the <tlv>.  If set ('1'), then <tlv-type-ext> is
         included in the <tlv>.

      bit 1 (thassingleindex) and bit 2 (thasmultiindex):  Are
         interpreted according to Table 3.  A combination not shown in
         that table MUST NOT be used.  Both bits MUST be cleared ('0')
         in packet and message TLVs.

      bit 3 (thasvalue) and bit 4 (thasextlen):  Are interpreted
         according to Table 4.  A combination not shown in that table
         MUST NOT be used.

      bit 5 (tismultivalue):  This bit serves to specify how the <value>
         field is interpreted, as specified below.  This bit MUST be
         cleared ('0') in packet and message TLVs, if the thasmultiindex
         bit is cleared ('0'), or if the thasvalue bit is cleared ('0').

      bits 6-7:  Are RESERVED, and SHOULD each be cleared ('0') on
         transmission, and SHOULD be ignored on reception.

    +-----------------+----------------+---------------+--------------+
    | thassingleindex | thasmultiindex | <index-start> | <index-stop> |
    +-----------------+----------------+---------------+--------------+
    |        0        |        0       |  not included | not included |
    |                 |                |               |              |
    |        1        |        0       |    included   | not included |
    |                 |                |               |              |
    |        0        |        1       |    included   |   included   |
    +-----------------+----------------+---------------+--------------+

     Table 3: Interpretation of the thassingleindex and thasmultiindex
                                   bits



Clausen, et al.         Expires September 8, 2008              [Page 17]

Internet-Draft             MANET packet format                March 2008


   +-----------+------------+-------------+----------------------------+
   | thasvalue | thasextlen |   <length>  |           <value>          |
   +-----------+------------+-------------+----------------------------+
   |     0     |      0     |     not     |        not included        |
   |           |            |   included  |                            |
   |           |            |             |                            |
   |     1     |      0     |    8 bits   |  included unless <length>  |
   |           |            |             |           is zero          |
   |           |            |             |                            |
   |     1     |      1     |   16 bits   |  included unless <length>  |
   |           |            |             |           is zero          |
   +-----------+------------+-------------+----------------------------+

       Table 4: Interpretation of the thasvalue and thasextlen bits

   <tlv-type-ext>  is an 8 bit unsigned integer field, specifying an
      extension of the TLV type, specific to the TLV type and kind (i.e.
      packet, message, or address block TLV).

   tlv-type-ext  is a variable, defined to equal <tlv-type-ext> if
      present, or 0 otherwise.

   tlv-fulltype  is a variable, defined by:

      *  tlv-fulltype := 256 * <tlv-type> + tlv-type-ext;

   <index-start> and <index-stop>  when present, in an address block TLV
      only, are each an 8 bit unsigned integer field.

   index-start and index-stop  are variables, defined according to
      Table 5.  The variable end-index is defined as follows:

      *  For message and packet TLVs:

         +  end-index := 0

      *  For address block TLVs:

         +  end-index := <num-addr> - 1

      An address block TLV applies to the address objects from position
      index-start to position index-stop (inclusive) in the address
      block, where the first address object has position zero.








Clausen, et al.         Expires September 8, 2008              [Page 18]

Internet-Draft             MANET packet format                March 2008


   +-----------------+----------------+----------------+---------------+
   | thassingleindex | thasmultiindex | index-start := | index-stop := |
   +-----------------+----------------+----------------+---------------+
   |        0        |        0       |        0       |   end-index   |
   |                 |                |                |               |
   |        1        |        0       |  <index-start> | <index-start> |
   |                 |                |                |               |
   |        0        |        1       |  <index-start> |  <index-stop> |
   +-----------------+----------------+----------------+---------------+

     Table 5: Interpretation of the thassingleindex and thasmultiindex
                                   bits

   number-values  is a variable, defined by:

      *  number-values := index-stop - index-start + 1

   <length>  is omitted or is an 8 or 16 bit unsigned integer field
      according to Table 4.  If the tismultivalue bit is set ('1') then
      <length> MUST be an integral multiple of number-values, and the
      variable single-length is defined by:

      *  single-length := <length> / number-values

      If the tismultivalue bit is cleared ('0'), then the variable
      single-length is defined by:

      *  single-length := <length>

   <value>  if present (see Table 4) is a field of length <length>
      octets.  In an address block TLV, <value> is associated with the
      address objects from positions index-start to index-stop,
      inclusive.  If the tismultivalue bit is cleared ('0') then the
      whole of this field is associated with each of the indicated
      address objects.  If the tismultivalue bit is set ('1') then this
      field is divided equally into number-values fields, each of length
      single-length octets and these are associated, in order, with the
      indicated address objects.

5.4.2.  TLV Inclusion and Constraints

   A TLV associates an attribute with a packet, a message or one or more
   consecutive address objects in an address block.  The interpretation
   and processing of this attribute, and the relationship (including
   order of processing) between different attributes associated with the
   same entity MUST be defined by a protocol which uses this
   specification.




Clausen, et al.         Expires September 8, 2008              [Page 19]

Internet-Draft             MANET packet format                March 2008


   If the appropriate semantics bit (pnouniord for a packet TLV block,
   mnouniord for a message TLV block or an address TLV block) is clear
   ('0'), then the following constraints MUST be respected.  These bits
   MUST always be clear ('0') unless a protocol using this specification
   defines otherwise.  Protocols SHOULD only define use of these bits
   when necessary, and then MUST indicate what constraints do apply if
   each of the indicated bits is set ('1'); each of these constraints
   SHOULD be retained unless otherwise necessary.

   o  TLVs in the same TLV block are sorted in non-descending tlv-
      fulltype order.

   o  Two or more address TLVs with the same tlv-fulltype in the same
      message are not associated with the same value of address object.

   o  TLVs with the same tlv-fulltype associated with the same address
      block are sorted in ascending index-start order.

   In addition, packet and message TLVs MUST be defined so as to
   indicate whether two such TLVs with the same tlv-fulltype are, or are
   not, allowed in the same packet or message TLV block, respectively.

   Note that the above constrains only the encoding of TLVs in a TLV
   block for transmission, and do specifically NOT mandate any given
   order of processing or interpretation by a protocol of the TLVs and
   the entities to which these are associated.

   Respecting the constraints above allows parsing and verification of a
   TLV block in a single pass and allows terminating the search for a
   TLV with a specific type without traversing the entire TLV block.

   The constraints on address block TLVs ensure that encoded information
   (entity-attributes) can be unambiguously decoded.

5.5.  Malformed Elements

   An element is malformed if it cannot be parsed according to its
   syntactical specification (including if there are insufficient octets
   available when a length is specified, in particular if there are
   fewer than pkt-size octets overall) or if a constraint (including,
   but not only, those specified in Section 5.4.2) specified as one
   which MUST be satisfied, is not.  A protocol using this specification
   MUST specify the action, or choice of actions, to be taken when a
   packet containing such elements is received.  Typical examples will
   include discarding any affected message(s), or discarding the
   complete packet.





Clausen, et al.         Expires September 8, 2008              [Page 20]

Internet-Draft             MANET packet format                March 2008


6.  IANA Considerations

6.1.  Message Types

   A new registry for message types must be created, with initial
   assignments as specified in Table 6.

               +---------+---------------------------------+
               |   Type  | Description                     |
               +---------+---------------------------------+
               |    0    | MUST NOT be allocated.          |
               |         |                                 |
               | 128-255 | Reserved for private/local use. |
               +---------+---------------------------------+

                          Table 6: Message Types

   Future values in the range 1-127 can be allocated using standards
   action [RFC2434].  Message type 0 MUST NOT be allocated because a
   zero octet signifies a packet header.

6.2.  Packet TLV Types

   A new registry for packet TLV types must be created, with initial
   assignments as specified in Table 7.

               +---------+---------------------------------+
               |   Type  | Description                     |
               +---------+---------------------------------+
               | 128-255 | Reserved for private/local use. |
               +---------+---------------------------------+

                         Table 7: Packet TLV Types

   Future values in the range 0-127 can be allocated using standards
   action [RFC2434], respecting the following guidelines:

   values 0-7  - MUST NOT be assigned except when a documented need
      exists that TLVs of a given type are required to appear before all
      other TLVs in the TLV block as encoded for transmission.  Note
      that the need for a TLV to be processed before other TLVs does not
      however automatically translate into a need for the TLV to appear
      before all other TLVs in the TLV block - the order in which TLVs
      are to be processed MUST be defined, if applicable, in the
      protocols using this specification.






Clausen, et al.         Expires September 8, 2008              [Page 21]

Internet-Draft             MANET packet format                March 2008


   values 8-127  - no constraints.

   If a packet TLV type is allocated then a new registry for type
   extensions of that type must be created.  A document which defines a
   packet TLV type MUST also specify the mechanism by which its type
   extensions are allocated, from among those in [RFC2434].

6.3.  Message TLV Types

   A new registry for message TLV types must be created, with initial
   assignments as specified in Table 8.

               +---------+---------------------------------+
               |   Type  | Description                     |
               +---------+---------------------------------+
               | 128-255 | Reserved for private/local use. |
               +---------+---------------------------------+

                        Table 8: Message TLV Types

   Future values in the range 0-127 can be allocated using standards
   action [RFC2434], respecting the following guidelines:

   values 0-7  - MUST NOT be assigned except when a documented need
      exists that TLVs of a given type are required to appear before all
      other TLVs in the TLV block as encoded for transmission.  Note
      that the need for a TLV to be processed before other TLVs does not
      however automatically translate into a need for the TLV to appear
      before all other TLVs in the TLV block - the order in which TLVs
      are to be processed MUST be defined, if applicable, in the
      protocols using this specification.

   values 8-127  - no constraints.

   If a message TLV type is allocated then a new registry for type
   extensions of that type must be created.  A document which defines a
   message TLV type MUST also specify the mechanism by which its type
   extensions are allocated, from among those in [RFC2434].

6.4.  Address Block TLV Types

   A new registry for address block TLV types must be created, with
   initial assignments as specified in Table 9.








Clausen, et al.         Expires September 8, 2008              [Page 22]

Internet-Draft             MANET packet format                March 2008


               +---------+---------------------------------+
               |   Type  | Description                     |
               +---------+---------------------------------+
               | 128-255 | Reserved for private/local use. |
               +---------+---------------------------------+

                     Table 9: Address Block TLV Types

   Future values in the range 0-127 can be allocated using standards
   action [RFC2434], respecting the following guidelines:

   values 0-7  - MUST NOT be assigned except when a documented need
      exists that TLVs of a given type are required to appear before all
      other TLVs in the TLV block as encoded for transmission.  Note
      that the need for a TLV to be processed before other TLVs does not
      however automatically translate into a need for the TLV appearing
      before all other TLVs in the TLV block - the order in which TLVs
      are to be processed MUST be defined, if applicable, in the
      protocols using this specification.

   values 8-127  - no constraints.

   If an address block TLV type is allocated then a new registry for
   type extensions of that type must be created.  A document which
   defines an address block TLV type MUST also specify the mechanism by
   which its type extensions are allocated, from among those in
   [RFC2434].
























Clausen, et al.         Expires September 8, 2008              [Page 23]

Internet-Draft             MANET packet format                March 2008


7.  Security Considerations

   This specification does not describe a protocol; it describes a
   packet format.  As such it does not specify any security
   considerations, these are matters for a protocol using this
   specification.  However two mechanisms which are enabled by this
   specification, and may form part of a security approach in a protocol
   using this specification, are described in Section 8.1.  There is
   however no requirement that a protocol using this specification
   should use either.

7.1.  Authentication Suggestions

   The authentication suggestions made here, are based on the intended
   usage in Appendix A, specifically that:

   o  Messages are designed to be carriers of protocol information and
      MAY, at each hop, be forwarded and/or processed by the protocol
      using this specification.

   o  Packets are designed to carry a number of messages between
      neighboring nodes in a single transmission and over a single
      logical hop.

   Consequently:

   o  For forwarded messages where the message is unchanged by
      forwarding nodes, then end-to-end security MAY be implemented,
      between nodes with an existing security association, by including
      a suitable message TLV containing a cryptographic signature in the
      message.  Since <hop-count> and <hop-limit> are the only fields
      that should be modified when such a message is forwarded in this
      manner, this signature can be calculated based on the entire
      message, including the message header, with the <hop-count> and
      <hop-limit> fields set to 0 if present.

   o  Hop-by-hop packet level security MAY be implemented, between nodes
      with an existing security association, by including a suitable
      packet TLV containing a cryptographic signature to the packet.
      Since packets are received as transmitted, this signature can be
      calculated based on the entire packet, or on parts thereof as
      appropriate.









Clausen, et al.         Expires September 8, 2008              [Page 24]

Internet-Draft             MANET packet format                March 2008


8.  References

8.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", RFC 2119, BCP 14, March 1997.

   [RFC4291]  Hinden, R. and S. Deering, "IP Version 6 Addressing
              Architecture", RFC 4291, February 2006.

   [RFC2434]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", RFC 2434, BCP 26,
              October 1998.

8.2.  Informative References

   [RFC3626]  Clausen, T. and P. Jacquet, "The Optimized Link State
              Routing Protocol", RFC 3626, October 2003.

































Clausen, et al.         Expires September 8, 2008              [Page 25]

Internet-Draft             MANET packet format                March 2008


Appendix A.  Intended Usage

   The packet and message format specified in this document is designed
   to carry MANET routing protocol messages and signals between MANET
   routers, and to support scope limited diffusion (flooding) as well as
   point-to-point delivery.

   Specifically:

   o  Packets are transmitted over a single logical hop and are not
      forwarded.  Messages are designed to be able to be forwarded over
      one or more logical hops, in a new packet for each logical hop.
      Each logical hop may consist of one or more IP hops.  Packets may
      contain a different combination of messages for each logical hop.
      Packets may be formed from messages from more than one MANET
      routing protocol; the use of a single message type space for all
      such protocols allows these messages to be separated by protocol.

   o  Scope limited flooding is supported for messages thus:

      *  If the mhasorig and mhasseqnum and bits in the <msg-semantics>
         field are both set ('1') then the message header provides for
         duplicate suppression, using the identifier consisting of the
         message's <msg-orig-addr>, <msg-seq-num>, and, if the
         mistypedep bit in the <msg-semantics> field is set ('1), <msg-
         type>.  These serve to uniquely identify the message in the
         network within the time period until <msg-seq-num> is repeated,
         i.e. wraps around to a matching value if used sequentially.

      *  If the mhashoplimit bit in the <msg-semantics> field is set
         ('1'), then the message header provides the information to make
         forwarding decisions for scope limited diffusion (flooding).
         This may be by any appropriate flooding mechanism specified by
         a protocol using this specification.

      *  <msg-hop-limit> SHOULD, if present, be decremented, usually by
         one, if the message is forwarded.

      *  <msg-hop-count> SHOULD, if present, be incremented, usually by
         one, if the message is forwarded.











Clausen, et al.         Expires September 8, 2008              [Page 26]

Internet-Draft             MANET packet format                March 2008


Appendix B.  Compatibility Requirements for Future Versions

   This specification defines packets and messages with version zero
   (0).

   Although this specification does not define packet and message
   versions greater than zero, any future version of this specification
   MUST, for backwards compatibility, satisfy the following:

   o  If the packet version is greater than zero, then a <pkt-header>
      element MUST be included in the packet, which MUST include a <pkt-
      version> element indicating the packet version.

   o  If the message version is greater than zero, then a <msg-version>
      element MUST be included in the <msg-header>, indicating the
      message version.

   o  The initial octets of a <pkt-header>, up to and including <pkt-
      version>, MUST be preserved as in this specification, in order
      that packets of versions greater than zero can be correctly
      recognized (and discarded) by implementations of this version of
      this specification.

   o  The initial octets of a <msg-header>, up until and including <msg-
      length>, MUST be preserved as in this specification, in order that
      messages of versions greater than zero can be correctly recognized
      (and discarded) by implementations of this version of this
      specification.























Clausen, et al.         Expires September 8, 2008              [Page 27]

Internet-Draft             MANET packet format                March 2008


Appendix C.  Examples

   This appendix contains some examples of parts of this specification.

C.1.  Address Block Examples

   The following examples illustrate how some combinations of addresses
   may be efficiently included in address blocks.  These examples are
   for IPv4, with address-length equal to 4. a, b, c etc. represent
   distinct, non-zero, octet values.

   Note that it is permissible to use a less efficient representation,
   in particular one in which the ahashead and ahasfulltail bits of the
   semantics octet are cleared ('0'), and hence head-length = 0, tail-
   length = 0, mid-length = address-length, and (with no address
   prefixes) the address block consists of the number of addresses, the
   semantics octet with value 0, and a list of the uncompressed
   addresses.  This is also the most efficient way to represent a single
   address, and the only way to represent, for example, a.b.c.d and
   e.f.g.h in one address block.

   Examples:

   o  To include a.b.c.d, a.b.e.f and a.b.g.h:

      *  head-length = 2;

      *  tail-length = 0;

      *  mid-length = 2;

      *  <addr-semantics> has ahashead set (value 1);

      *  <tail-length> and <tail> are omitted.

      The address block is then 3 1 2 a b c d e f g h (11 octets).

   o  To include a.b.c.g and d.e.f.g:

      *  head-length = 0;

      *  tail-length = 1;

      *  mid-length = 3;

      *  <addr-semantics> has ahasfulltail set (value 2);





Clausen, et al.         Expires September 8, 2008              [Page 28]

Internet-Draft             MANET packet format                March 2008


      *  <head-length> and <head> are omitted.

      The address block is then 2 2 1 g a b c d e f (10 octets).

   o  To include a.b.d.e and a.c.d.e:

      *  head-length = 1;

      *  tail-length = 2;

      *  mid-length = 1;

      *  <addr-semantics> has ahashead and ahasfulltail set (value 3).

      The address block is then 2 3 1 a 2 d e b c (9 octets).

   o  To include a.b.0.0, a.c.0.0, and a.d.0.0:

      *  head-length = 1;

      *  tail-length = 2;

      *  mid-length = 1;

      *  <addr-semantics> has ahashead and ahaszerotail set (value 5);

      *  <tail> is omitted.

      The address block is then 3 5 1 a 2 b c d (8 octets).

   o  To include a.b.0.0 and c.d.0.0:

      *  head-length = 0;

      *  tail-length = 2;

      *  mid-length = 2;

      *  <addr-semantics> has ahaszerotail set (value 4);

      *  <head> and <tail> are omitted.

      The address block is then 2 4 2 a b c d (7 octets).

   o  To include a.b.0.0/n and c.d.0.0/n:

      *  head-length = 0;




Clausen, et al.         Expires September 8, 2008              [Page 29]

Internet-Draft             MANET packet format                March 2008


      *  tail-length = 2;

      *  mid-length = 2;

      *  <addr-semantics> has ahaszerotail and ahassingleprelen set
         (value 12);

      *  <head> and <tail> are omitted.

      The address block is then 2 12 2 a b c d n (8 octets).

   o  To include a.b.0.0/n and c.d.0.0/m:

      *  head-length = 0;

      *  tail-length = 2;

      *  mid-length = 2;

      *  <addr-semantics> has ahaszerotail and ahasmultiprelen set
         (value 20);

      *  <head> and <tail> are omitted.

      The address block is then 2 20 2 a b c d n m (9 octets).

C.2.  TLV Examples

   Assuming the definition of an address block TLV with type EXAMPLE1
   (and no type extension) which has single octet values per address,
   then if values a, a, b and c are to be associated with the four
   addresses in the preceding address block, where c is a default value
   that can be omitted, then this can be done in a number of ways.

   Examples:

   o  Using one multivalue TLV covering all of the addresses:

      *  <tlv-semantics> has thasvalue and tismultivalue set (value 36);

      *  <index-start> and <index-stop> are omitted;

      *  <length> = 4 (single-length = 1).

      *  The TLV is then EXAMPLE1 36 4 a a b c (7 octets).






Clausen, et al.         Expires September 8, 2008              [Page 30]

Internet-Draft             MANET packet format                March 2008


   o  Using one multivalue TLV omitting the last address:

      *  <tlv-semantics> has thasvalue, thasmultiindex and tismultivalue
         set (value 52);

      *  <index-start> = 0;

      *  <index-stop> = 2

      *  <length> = 3 (single-length = 1).

      *  The TLV is then EXAMPLE1 52 0 2 3 a a b (8 octets).

   o  Using two single value TLVs, omitting the last address.  First:

      *  <tlv-semantics> has thasvalue and thasmultiindex set (value
         20);

      *  <index-start> = 0;

      *  <index-stop> = 1;

      *  <length> = 1;

      *  <value> = a.

      *  The TLV is then EXAMPLE1 20 0 1 1 a (6 octets).

      Second:

      *  <tlv-semantics> has thasvalue and thassingleindex set (value
         12);

      *  <index-start> = 2;

      *  <index-stop> is omitted;

      *  <length> = 1;

      *  <value> = b.

      *  The TLV is then EXAMPLE1 12 2 1 b (5 octets).

      Total length of TLVs is 11 octets.

   In this case the first of these is the most efficient.  In other
   cases patterns such as the others may be preferred.  Regardless of
   efficiency, any of these may be used.



Clausen, et al.         Expires September 8, 2008              [Page 31]

Internet-Draft             MANET packet format                March 2008


   Assuming the definition of an address block TLV with type EXAMPLE2
   (and no type extension) which has no value, which is to be associated
   with the second and third addresses in an address block, then this
   can be indicated with a single TLV:

   o  <tlv-semantics> has thasmultiindex set (value 16);

   o  <index-start> = 1;

   o  <index-stop> = 2;

   o  <length> and <value> are omitted.

   o  The TLV is then EXAMPLE2 16 1 2 (4 octets).

   Assuming the definition of a message TLV with type EXAMPLE3 (and no
   type extension) which can take a value field of any length, for such
   a TLV with 8 octets of data (a to h):

   o  <tlv-semantics> has thasvalue set (value 4);

   o  <index-start> and <index-stop> are omitted;

   o  <length> = 8.

   o  The TLV is then EXAMPLE3 4 8 a b c d e f g h (11 octets).

   If, in this example, the number of data octets were 256 or greater
   then <tlv-semantics> would also have thasextlen set and have value 6.
   The length would require two octets (most significant first).  The
   TLV length would be 4 + N octets, where N is the number of data
   octets (it can be 3 + N octets if N is 255 or less).



















Clausen, et al.         Expires September 8, 2008              [Page 32]

Internet-Draft             MANET packet format                March 2008


Appendix D.  Illustrations

   This informative appendix illustrates the elements, which are
   normatively specified in Section 5 using regular expressions.
   Examples with version fields are omitted, as not needed when using
   this version of this specification (although permitted).

   Bits labeled Rsv or R must be cleared ('0').  Bits labeled C, N, or M
   may be cleared ('0') or set ('1').

D.1.  Packet

   Possible options for the <packet> element.  These are differentiated
   by their second (semantics) octet, except the last, which starts with
   a non-zero octet.  The packet may include any number (zero or more)
   of messages, except in the last case, when there must be one or more
   messages.  The number of messages is determined from the size of the
   packet (either the <pkt-size> field if present, or from the network
   or transport protocol employed).

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Rsv |C|0|0|0|0|                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+










Clausen, et al.         Expires September 8, 2008              [Page 33]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Rsv |C|0|0|1|0|          Packet Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                            Message                            |
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


       0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Rsv |C|0|1|0|0|    Packet Sequence Number     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                            Message                            |
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+





Clausen, et al.         Expires September 8, 2008              [Page 34]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Rsv |C|0|1|1|0|          Packet Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Packet Sequence Number     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




























Clausen, et al.         Expires September 8, 2008              [Page 35]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Rsv |C|1|0|0|0|                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                       Packet TLV Block                        |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                            Message                            |
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
























Clausen, et al.         Expires September 8, 2008              [Page 36]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Rsv |C|1|0|1|0|          Packet Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Packet TLV Block                        |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+























Clausen, et al.         Expires September 8, 2008              [Page 37]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Rsv |C|1|1|0|0|    Packet Sequence Number     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Packet TLV Block                        |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+























Clausen, et al.         Expires September 8, 2008              [Page 38]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0| Rsv |C|1|1|1|0|          Packet Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Packet Sequence Number     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                       Packet TLV Block                        |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                            Message                            |
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+






















Clausen, et al.         Expires September 8, 2008              [Page 39]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                            Message                            |
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                            Message                            |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

D.2.  Message

   Possible options for the <message> element.  These are differentiated
   by their second (semantics) octet.  The length of the message body is
   determined using the <msg-size> field, which includes all the fields
   shown.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|0|0|0|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+












Clausen, et al.         Expires September 8, 2008              [Page 40]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|0|0|0|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|0|0|1|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|0|0|1|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+








Clausen, et al.         Expires September 8, 2008              [Page 41]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|0|1|0|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|0|1|0|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|0|1|1|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+








Clausen, et al.         Expires September 8, 2008              [Page 42]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|0|1|1|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|1|0|0|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Message Sequence Number    |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|1|0|0|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Message Sequence Number    |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Clausen, et al.         Expires September 8, 2008              [Page 43]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|1|0|1|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |    Message Sequence Number    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|1|0|1|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |    Message Sequence Number    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|0|1|1|0|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |    Message Sequence Number    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+






Clausen, et al.         Expires September 8, 2008              [Page 44]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|1|1|0|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |    Message Sequence Number    |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|0|1|1|1|0|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |    Message Sequence Number    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |R|C|N|1|1|1|1|0|         Message Size          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |    Message Sequence Number    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                         Message Body                          |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Clausen, et al.         Expires September 8, 2008              [Page 45]

Internet-Draft             MANET packet format                March 2008


D.3.  Message Body

   Format of a message body (the <message> element excluding its initial
   <msg-header> element).  The message may include any number (zero or
   more) of address block and address TLV block pairs.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       Message TLV Block                       |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Address Block                         |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                       Address TLV Block                       |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                         Address Block                         |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                       Address TLV Block                       |
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+








Clausen, et al.         Expires September 8, 2008              [Page 46]

Internet-Draft             MANET packet format                March 2008


D.4.  Address Block

   Possible options for the <addr-block> element.  These are
   differentiated by their second (semantics) octet.  The number of
   <mid> elements is equal to the number of addresses (except when mid-
   length is zero, when there are no <mid> elements).  Where a variable
   number of <prefix-length> fields is shown, their number is equal to
   the number of addresses.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|0|0|0|0|              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          Mid (cont)           |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          Mid (cont)           |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|0|0|0|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |              Mid              |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+












Clausen, et al.         Expires September 8, 2008              [Page 47]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|0|0|1|0|  Tail Length  |     Tail      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Tail (cont)  |              Mid              |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|0|0|1|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |  Tail Length  |             Tail              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|0|1|0|0|  Tail Length  |      Mid      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Mid (cont)   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+






Clausen, et al.         Expires September 8, 2008              [Page 48]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|0|1|0|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |  Tail Length  |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|1|0|0|0|              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          Mid (cont)           |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          Mid (cont)           | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|1|0|0|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |              Mid              |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+






Clausen, et al.         Expires September 8, 2008              [Page 49]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|1|0|1|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |  Tail Length  |             Tail              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Prefix Length |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|1|0|1|0|  Tail Length  |     Tail      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Tail (cont)  |              Mid              |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|1|1|0|0|  Tail Length  |      Mid      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Mid (cont)   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Clausen, et al.         Expires September 8, 2008              [Page 50]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |0|1|1|0|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |  Tail Length  |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |1|0|0|0|0|              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          Mid (cont)           |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |          Mid (cont)           | Prefix Length |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+















Clausen, et al.         Expires September 8, 2008              [Page 51]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |1|0|0|0|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |              Mid              |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |1|0|0|1|0|  Tail Length  |     Tail      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Tail (cont)  |              Mid              |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+











Clausen, et al.         Expires September 8, 2008              [Page 52]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |1|0|0|1|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |  Tail Length  |             Tail              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Prefix Length |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     :                              ...                              :
     |                                               +-+-+-+-+-+-+-+-+
     |                                               | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |1|0|1|0|0|  Tail Length  |      Mid      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Mid (cont)   |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |              Mid              | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+









Clausen, et al.         Expires September 8, 2008              [Page 53]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Number Addrs  | Rsv |1|0|1|0|1|  Head Length  |     Head      |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Head (cont)  |  Tail Length  |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     :                              ...                              :
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              | Prefix Length |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               | Prefix Length |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

D.5.  TLV Block

   Format if a <tlv-block> element.  There may be any number (zero or
   more) of TLVs, with total length (in octets) equal to the length
   field.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |            Length             |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                              TLV                              |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     :                              ...                              :
     |                                                               |
     |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                               |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                              TLV                              |
     |                                               +-+-+-+-+-+-+-+-+
     |                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+




Clausen, et al.         Expires September 8, 2008              [Page 54]

Internet-Draft             MANET packet format                March 2008


D.6.  TLV

   Possible options for the <tlv> element.  These are differentiated by
   their second (semantics) octet.  If there are no index fields then
   this may be a packet, message or address block TLV, if there is one
   or two index fields then this must be an address block TLV.  The
   length field gives the length of the value field (in octets).

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|0|0|0|0|0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|0|0|0|0|1|   Type Ext    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|0|0|0|1|0|  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|0|0|0|1|1|   Type Ext    |  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|0|0|1|0|0|  Index Start  |  Index Stop   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+










Clausen, et al.         Expires September 8, 2008              [Page 55]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|0|0|1|0|1|   Type Ext    |  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Index Stop   |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|M|0|1|0|0|0|    Length     |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|M|0|1|0|0|1|   Type Ext    |    Length     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|0|1|0|1|0|  Index Start  |    Length     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+





Clausen, et al.         Expires September 8, 2008              [Page 56]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|0|1|0|1|1|   Type Ext    |  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Length     |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|M|0|1|1|0|0|  Index Start  |  Index Stop   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Length     |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|M|0|1|1|0|1|   Type Ext    |  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Index Stop   |    Length     |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+










Clausen, et al.         Expires September 8, 2008              [Page 57]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|M|1|1|0|0|0|            Length             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|M|1|1|0|0|1|   Type Ext    |    Length     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Length (cont) |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|1|1|0|1|0|  Index Start  |    Length     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Length (cont) |                                               |
     +-+-+-+-+-+-+-+-+                                               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+











Clausen, et al.         Expires September 8, 2008              [Page 58]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|0|1|1|0|1|1|   Type Ext    |  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |            Length             |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|M|1|1|1|0|0|  Index Start  |  Index Stop   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |            Length             |                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |Rsv|M|1|1|1|0|1|   Type Ext    |  Index Start  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |  Index Stop   |            Length             |               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
     |                                                               |
     |                             Value                             |
     |                                                               |
     |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |               |
     +-+-+-+-+-+-+-+-+








Clausen, et al.         Expires September 8, 2008              [Page 59]

Internet-Draft             MANET packet format                March 2008


Appendix E.  Complete Example

   An example packet, using IPv4 addresses (length four octets) is
   shown.  This packet has a header, indicated by the initial octet 0.
   The packet header has the phasseqnum bit of its semantics octet 4
   set, and hence has version zero, no packet size (this is taken from
   the network or transport protocol carrying this packet), a packet
   sequence number, and no packet TLV block.

   The packet contains a single message with length 55 octets.  This
   message has the mhasorig, mhashoplimit, mhashopcount and mhasseqnum
   bits of its semantics octet 30 set, and hence has version zero and
   includes an originator address, a hop limit, a hop count and a
   message sequence number (which is type independent).  The message has
   a message TLV block with content length 9 octets, containing a single
   message TLV.  This TLV has the thasvalue bit of its semantics octet 8
   set, and hence contains a value field, with preceding value length 6
   octets.  The message then has two address blocks each with a
   following address TLV block.

   The first address block contains 2 address prefixes.  It has the
   ahaszerotail and ahassingleprelen bits of its semantics octet 12 set,
   and hence has no head (head length is zero octets).  It has tail
   length 2 octets, hence mid length two octets.  The two tail octets of
   each address are not included and have value zero.  The address block
   has a single prefix length.  The following address TLV block is empty
   (content length 0 octets).

   The second address block contains 3 addresses.  It has the ahashead
   bit of its semantics octet 1 set, and has head length 2 octets, no
   tail (tail length is zero octets) and hence mid length two octets.
   It is followed by an address TLV block, with content length 9 octets,
   containing two address block TLVs.  The first of these TLVs has the
   thasvalue bit of its semantics octet 8 set, and has a single value of
   length 2 octets, which applies to all of the addresses in the address
   block.  The second of these TLVs has the thasmultiindex bit of its
   semantics octet 4 set, and hence has no value length or value fields.
   It has two index fields, which indicate those addresses this TLV
   applies to (inclusive range, counting from zero).












Clausen, et al.         Expires September 8, 2008              [Page 60]

Internet-Draft             MANET packet format                March 2008


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0|0 0 0 0 0 1 0 0|    Packet Sequence Number     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Message Type  |0 0 0 1 1 1 1 0|0 0 0 0 0 0 0 0 0 0 1 1 0 1 1 1|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Originator Address                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Limit   |   Hop Count   |    Message Sequence Number    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1|   TLV Type    |0 0 0 0 1 0 0 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 1 1 0|                     Value                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                 Value (cont)                  |0 0 0 0 0 0 1 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 1 1 0 0|0 0 0 0 0 0 1 0|              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              | Prefix Length |0 0 0 0 0 0 0 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0|0 0 0 0 0 0 1 1|0 0 0 0 0 0 0 1|0 0 0 0 0 0 1 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |             Head              |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |              Mid              |              Mid              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1|   TLV Type    |0 0 0 0 1 0 0 0|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 0 1 0|             Value             |   TLV Type    |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |0 0 0 0 0 1 0 0|  Index Start  |  Index Stop   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


















Clausen, et al.         Expires September 8, 2008              [Page 61]

Internet-Draft             MANET packet format                March 2008


Appendix F.  Contributors

   This specification is the result of the joint efforts of the
   following contributors from the OLSRv2 Design Team, listed
   alphabetically:

   o  Cedric Adjih, INRIA, France, <Cedric.Adjih@inria.fr>

   o  Emmanuel Baccelli, INRIA, France, <Emmanuel.Baccelli@inria.fr>

   o  Thomas Heide Clausen, LIX, Ecole Polytechnique, France,
      <T.Clausen@computer.org>

   o  Justin W. Dean, NRL, USA<jdean@itd.nrl.navy.mil>

   o  Christopher Dearlove, BAE Systems, UK,
      <chris.dearlove@baesystems.com>

   o  Satoh Hiroki, Hitachi SDL, Japan, <h-satoh.yj@sdl.hitachi.co.jp>

   o  Philippe Jacquet, INRIA, France, <Philippe.Jacquet@inria.fr>

   o  Monden Kazuya, Hitachi SDL, Japan, <monden.vw@sdl.hitachi.co.jp>




























Clausen, et al.         Expires September 8, 2008              [Page 62]

Internet-Draft             MANET packet format                March 2008


Appendix G.  Acknowledgements

   The authors would like to acknowledge the team behind OLSRv1, as
   specified in RFC 3626, including Anis Laouiti, Pascale Minet, Laurent
   Viennot (all at INRIA, France), and Amir Qayyum (Center for Advanced
   Research in Engineering, Pakistan) for their contributions.

   The authors would like to gratefully acknowledge the following people
   for intense technical discussions, early reviews and comments on the
   specification and its components: Joe Macker (NRL), Alan Cullen (BAE
   Systems), Ian Chakeres (Motorola), Charlie E. Perkins (Nokia),
   Andreas Schjonhaug (LIX), Florent Brunneau (LIX), Yasunori Owada
   (Niigata University), Teco Boot (Infinity Networks) and the entire
   IETF MANET working group.





































Clausen, et al.         Expires September 8, 2008              [Page 63]

Internet-Draft             MANET packet format                March 2008


Authors' Addresses

   Thomas Heide Clausen
   LIX, Ecole Polytechnique, France

   Phone: +33 6 6058 9349
   EMail: T.Clausen@computer.org
   URI:   http://www.thomasclausen.org/


   Christopher M. Dearlove
   BAE Systems Advanced Technology Centre

   Phone: +44 1245 242194
   EMail: chris.dearlove@baesystems.com
   URI:   http://www.baesystems.com/


   Justin W. Dean
   Naval Research Laboratory

   Phone: +1 202 767 3397
   EMail: jdean@itd.nrl.navy.mil
   URI:   http://pf.itd.nrl.navy.mil/


   Cedric Adjih
   INRIA Rocquencourt

   Phone: +33 1 3963 5215
   EMail: Cedric.Adjih@inria.fr
   URI:   http://menetou.inria.fr/~adjih/



















Clausen, et al.         Expires September 8, 2008              [Page 64]

Internet-Draft             MANET packet format                March 2008


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Clausen, et al.         Expires September 8, 2008              [Page 65]

