<?xml version="1.0" encoding="US-ASCII"?>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY rfc2119 PUBLIC "" "bibxml/reference.RFC.2119.xml">
  <!ENTITY rfc2616 PUBLIC "" "bibxml/reference.RFC.2616.xml">
  <!ENTITY rfc2782 PUBLIC "" "bibxml/reference.RFC.2782.xml">
  <!ENTITY rfc2818 PUBLIC "" "bibxml/reference.RFC.2818.xml">
  <!ENTITY rfc3688 PUBLIC "" "bibxml/reference.RFC.3688.xml">
  <!ENTITY rfc3864 PUBLIC "" "bibxml/reference.RFC.3864.xml">
  <!ENTITY rfc3986 PUBLIC "" "bibxml/reference.RFC.3986.xml">
  <!ENTITY rfc4398 PUBLIC "" "bibxml/reference.RFC.4398.xml">
  <!ENTITY rfc5246 PUBLIC "" "bibxml/reference.RFC.5246.xml">
  <!ENTITY rfc4791 PUBLIC "" "bibxml/reference.RFC.4791.xml">
  <!ENTITY rfc5545 PUBLIC "" "bibxml/reference.RFC.5545.xml">
  <!ENTITY I-D.ietf-calsify-2446bis PUBLIC "" "bibxml3/reference.I-D.ietf-calsify-2446bis.xml">
  <!ENTITY I-D.ietf-calsify-rfc2447bis PUBLIC "" "bibxml3/reference.I-D.ietf-calsify-rfc2447bis.xml">
  <!ENTITY I-D.desruisseaux-caldav-sched PUBLIC "" "bibxml3/reference.I-D.desruisseaux-caldav-sched.xml">
  <!ENTITY I-D.nottingham-site-meta PUBLIC "" "bibxml3/reference.I-D.nottingham-site-meta.xml">
  <!ENTITY I-D.faltstrom-uri PUBLIC "" "bibxml3/reference.I-D.faltstrom-uri.xml">
  <!ENTITY W3C.REC-xml-20081126 PUBLIC "" "bibxml4/reference.W3C.REC-xml-20081126.xml">
]>

<?rfc rfcedstyle="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?><!-- default = 3 -->
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc strict="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc category="std" ipr="trust200902" docName="draft-desruisseaux-ischedule-00">
<front>
  <title abbrev="iSchedule">Internet Calendar Scheduling Protocol (iSchedule)</title>
  <author initials="C." surname="Daboo" fullname="Cyrus Daboo">
    <organization abbrev="Apple">Apple Inc.</organization>
    <address>
      <postal>
        <street>1 Infinite Loop</street>
        <city>Cupertino</city>
        <region>CA</region>
        <code>95014</code>
        <country>USA</country>
      </postal>
      <email>cyrus@daboo.name</email>
      <uri>http://www.apple.com/</uri>
    </address>
  </author>
  <author initials="B." surname="Desruisseaux" 
    fullname="Bernard Desruisseaux">
    <organization abbrev="Oracle">Oracle Corporation</organization>
    <address>
      <postal>
        <street>600 Blvd. de Maisonneuve West</street>
        <street>Suite 1900</street>
        <city>Montreal</city>
        <region>QC</region>
        <code>H3A 3J2</code>
        <country>CANADA</country>
      </postal>
      <email>bernard.desruisseaux@oracle.com</email>
      <uri>http://www.oracle.com/</uri>
    </address>
  </author>
  <date day="15" month="November" year="2009"/>
  <area>Applications</area>
  <keyword>calsched</keyword>
  <keyword>calsch</keyword>
  <keyword>caldav</keyword>
  <keyword>calendar</keyword>
  <keyword>calendaring</keyword>
  <keyword>calsify</keyword>
  <keyword>HTTP</keyword>
  <keyword>iCal</keyword>
  <keyword>iCalendar</keyword>
  <keyword>iMIP</keyword>
  <keyword>iTIP</keyword>
  <keyword>iRIP</keyword>
  <keyword>iSchedule</keyword>
  <keyword>scheduling</keyword>
  <keyword>text/calendar</keyword>
  <abstract>
    <t>
      This document defines the Internet Calendar Scheduling
      Protocol (iSchedule), which is a binding from the iCalendar
      Transport-independent Interoperability Protocol (iTIP) to the
      Hypertext Transfer Protocol (HTTP) to enable interoperability
      between calendaring and scheduling systems over the Internet.
    </t>
  </abstract>
</front>
<middle>
<section anchor="intro" title="Introduction">
  <t>
    This binding document provides the transport specific information
    necessary to convey iCalendar Transport-independent Interoperability
    Protocol <xref target="I-D.ietf-calsify-2446bis">(iTIP)</xref>
    messages over the Hypertext Transfer Protocol
    <xref target="RFC2616">(HTTP)</xref>.
  </t>
  <t>
    The Internet Calendar Scheduling Protocol (iSchedule) enables
    interoperability between different calendaring and scheduling
    systems. Calendaring and scheduling systems that provide support for
    iSchedule allows their users to perform scheduling transactions such as
    schedule, reschedule, respond to scheduling request or cancel scheduled
    calendar components, as well as search for busy time information with
    users of other calendaring and scheduling systems on the Internet.
  </t>
  <t>
    Discussion of this Internet-Draft is taking place on the mailing list
    &lt;https://www.ietf.org/mailman/listinfo/ischedule&gt;.
  </t>
  <section title="Motivations">
    <t>
      The iCalendar Message-Based Interoperability Protocol <xref
      target="I-D.ietf-calsify-rfc2447bis">(iMIP)</xref>, has proven
      to be insufficient to allow users to seamlessly perform the
      same scheduling operations with users of other calendaring and
      scheduling systems on the Internet than with users of their own
      system. This section clarifies the motivations for a binding from
      the iCalendar Transport-independent Interoperability Protocol <xref
      target="I-D.ietf-calsify-2446bis">(iTIP)</xref> to a transport that
      allows synchronous end-to-end connectivity.
    </t>
    <t>
      A binding to an email-based transport is clearly inadequate to
      search for busy time information  since users need and expect to
      get an immediate response. As such, some calendaring and scheduling
      systems allow users to publish their free busy information in a
      resource accessible to others on the Internet. In the absence of a
      standardized mechanism to locate the resource that provides the free
      busy information of a user, one thus needs to know the location of
      this resource in addition to the calendar user address of the users
      one wish to schedule with.
    </t>
    <t>
      With an email-based transport, the transparent processing of
      incoming scheduling messages on the server is only possible when
      the calendaring and scheduling system is integrated with the email
      system. Commonly, the processing of incoming scheduling messages
      occurs on the client instead and requires user intervention, which
      yield the following consequences:
      <list style="numbers">
        <t>
          The processing of incoming scheduling messages and the
          corresponding updates to the calendar only occurs when the client
          is active. As such, free busy information may be inaccurate
          (e.g., user still appears busy when the organizer actually
          rescheduled or canceled the meeting).
        </t>
        <t>
          Calendaring and scheduling systems generally restrain the number
          of updates sent to users to reduce the number of messages that
          will clutter their email inbox. As a result, attendees rarely
          obtain up to date participation status of other attendees.
        </t>
        <t>
          The client becomes responsible to verify the authenticity and
          integrity of the scheduling message.
        </t>
      </list>
    </t>
    <!--
      Other motivations:
       * Synchronous delivery status.
       * Synchronous resource booking (first come first server).
    -->
  </section><!-- Motivations -->

  <section title="Related Memos">
    <t>
      Implementers will need to be familiar with other documents that,
      along with this document, form a framework for Internet calendaring
      and scheduling standards.
    </t>
    <t>
      This document specifies a binding from iTIP to HTTP.
    </t>
    <t>
      <list style="symbols">
        <t>
          <xref target="RFC5545">iCalendar</xref>
          specifies a core specification of objects, data types,
          properties and property parameters;
        </t>
        <t>
          <xref target="I-D.ietf-calsify-2446bis">iTIP</xref>
          specifies an interoperability protocol for scheduling
          between different implementations.
        </t>
      </list>
    </t>
    <t>
      This document does not attempt to repeat the specification of
      concepts or definitions from these other documents. Where possible,
      references are made to the document that provides the
      specification of these concepts or definitions.
    </t>
  </section>
  <section title="Notational Conventions">
    <t>
      The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"
      in this document are to be interpreted as described in
      <xref target="RFC2119"/>.
    </t>
    <t>
      The augmented BNF used by this document to describe protocol
      elements is described in Section 2.1 of <xref target="RFC2616"/>.
      Because this augmented BNF uses the basic production rules provided
      in Section 2.2 of <xref target="RFC2616"/>, those rules apply to
      this document as well.
    </t>
    <t>
      Definitions of XML elements in this document use XML element
      type declarations (as found in XML Document Type Declarations),
      described in Section 3.2 of <xref target="W3C.REC-xml-20081126"/>.
    </t>
    <t>
      The namespace "urn:ietf:params:xml:ns:ischedule" is reserved for the
      XML elements defined in this specification, or in other Standards
      Track IETF RFCs written to extend iSchedule. It MUST NOT be used
      for proprietary extensions.
    </t>
    <t>
      Note that the XML declarations used in this document are
      incomplete, in that they do not include namespace information.
      Thus, the reader MUST NOT use these declarations as the only way
      to validate iSchedule XML element types.
    </t>
  </section><!-- Notational Conventions -->
</section><!-- Introduction -->

<section title="iSchedule Model">
  <t>
    The iSchedule design can be pictured as:
    <figure>
      <artwork><![CDATA[
+----------+   +----------+             +----------+   +----------+
| Calendar |   | Calendar |  iSchedule  | Calendar |   | Calendar |  
| User     |-->| Service  |------------>| Service  |-->| Store    |
| Agent    |   |          |             |          |   |          |
+----------+   +----------+             +----------+   +----------+
                iSchedule                iSchedule
                 Sender                   Receiver
      ]]></artwork>
    </figure>
    When an iSchedule Sender has a scheduling message to transmit, it
    determines the iSchedule Receivers to delivers the message to and
    sends the appropriate iSchedule requests.  The responsability of an
    iSchedule Sender is to transfer scheduling messages to one or more
    iSchedule Receivers, or report its failure to do so.
  </t>
  <t>
    The means by which a Calendar User Agent instructs a Calendar Service,
    acting as an iSchedule Sender, to transmit scheduling messages is
    outside the scope of this document. A Calendar Service could provide
    support for a standard calendar access protocol, such as CalDAV
    <xref target="RFC4791"/>,
    <xref target="I-D.desruisseaux-caldav-sched"/>
    or any other protocol, to allow a Calendar User Agent to perform
    scheduling operations with users of other Calendar Services.
  </t>
  <t>
    Likewise, the actual processing of scheduling messages received by a
    Calendar Service, acting as an iSchedule Receiver, is also outside
    the scope of this document. Some Calendar Service implementations
    may decide to process some or all received scheduling messages, while
    other implementations may decide to leave that work to Calendar User
    Agent implementations.
  </t>
</section>

<section title="iSchedule Intermediaries">
  <t>
    From the end-to-end view, an iSchedule request is sent to an
    iSchedule Receiver and a response is returned to the iSchedule
    Sender. In practice, this may not always be the case. An
    iSchedule request may travel through several iSchedule
    intermediaries.
  </t>
  <t>
    iSchedule intermediaries can be used for different purposes, namely:
    <list style="symbols">
      <t>
        Dispatch iSchedule request to the appropriate iSchedule Receivers
        for each specified Recipient; Users of the same domain could
        actually be hosted on different iSchedule Receivers.
      </t>
      <t>
        Dispatch iSchedule request to the appropriate iSchedule Receivers
        according to the calendar component type specified in the
        requests. Different iSchedule Receivers could be responsible of
        handling, VEVENT, VTODO, VJOURNAL and VFREEBUSY requests.
      </t>
      <t>
        Scan iSchedule requests, particularly attachments, for virus.
      </t>
    </list>
  </t>
  <t>
    iSchedule intermediaries are REQUIRED to identify their hostname and
    the version number of the preceding server from which the request or
    response arrived. iSchedule intermediaries append this information
    to the "iSchedule-Via" general header, in sequential order, as the
    request travels between Sender and Receiver.
  </t>
  <t>
    For example, an iSchedule request might be submitted to an iSchedule
    Receiver with the following "iSchedule-Via" header:
    <figure>
      <artwork>
   iSchedule-Via: 1.0 ischedule.example.com:443 (VendorX/2.0),
                  1.0 cal.internal.example.com:80 (VendorZ/4.3)
      </artwork>
    </figure>
  </t>
</section>

<section title="iSchedule Receiver Discovery">
  <t>
    This section describes how an iSchedule Sender can discover
    the host name, the port as well as the Request-URI to use
    to submit a request to an iSchedule Receiver.
  </t>
  <section title='iSchedule SRV Service Types'>
    <t>
      This specification adds two service types for use with SRV records:
    </t>
    <t>
      <list style="hanging">
        <t hangText="ischedule:">
          Identifies an iSchedule Receiver that uses HTTP without
          transport layer security (<xref target="RFC2818"/>).
        </t>
        <t hangText="ischedules:">
          Identifies an iSchedule Receiver that uses HTTP with
          transport layer security (<xref target="RFC2818"/>).
        </t>
      </list>
    </t>
    <t>
      Example: service record for server without transport layer security
      <figure>
        <artwork>
_ischedule._tcp     SRV 0 1 80 ischedule.example.com.
        </artwork>
      </figure>
    </t>
    <t>
      Example: service record for server with transport layer security
      <figure>
        <artwork>
_ischedules._tcp    SRV 0 1 443 ischedule.example.com.
        </artwork>
      </figure>
    </t>
  </section>

  <section title="iSchedule Receiver Request-URI">
    <t>
      This specification registers a well-known URI for the
      iSchedule service, namely, "ischedule"
      (see <xref target="IANA.WELL-KNOWN-URI"/>).
      iSchedule Receivers MUST support requests targeted
      at this well-known URI. iSchedule Sender MUST
      handle HTTP redirects on the well-known URI.
    </t>
  </section>

<!--
  <t>
    In order to make use of SRV records, clients have to do two
    things: map a calendar user address into a DNS identifier that
    can be used in the SRV lookup, and take the result of the SRV
    lookup and map that to a valid iSchedule server.
  </t>
-->

  <section title='Resolving Calendar User Addresses'>
    <t>
      To deliver a scheduling message via the iSchedule protocol,
      an iSchedule Sender needs to determine what iSchedule Receiver
      it needs to deliver a scheduling message to for a particular
      Recipient. Each Recipient's calendar user address is specified
      in the Recipient request header.
    </t>
    <t>
      A calendar user address as defined by iCalendar is simply
      a URI. This is typically a mailto URI, but could potentially
      be any URI type.
    </t>
    <t>
      To map a mailto URI to an SRV record name to query, the
      "domain" portion of the URI is extracted and appended to the
      service identifier "_ischedule._tcp." or "_ischedules._tcp."
      to form the record name.
    </t>
    <t>
      Example: 
      <figure>
        <artwork><![CDATA[
  Calendar User Address:  mailto:cyrus@example.com
  
  Query SRV Record Names: _ischedules._tcp.example.com
                          _ischedule._tcp.example.com
        ]]></artwork>
      </figure>
    </t>
    <t>
      In cases where the "domain" portion of the mailto URI contains
      one or more levels of sub-domain, clients MAY choose to remove
      successive levels of "sub-domain" if queries for that sub-domain
      fail to return any SRV records. For example, a mailto URI with
      the full domain "host.calendar.example.com" would first trigger
      a querying using the domain "host.calendar.example.com", then if
      that failed, the domain "calendar.example.com" would be tried,
      then if that failed the domain "example.com" would be tried.
    </t>
  </section>

  <section title="Using the SRV Record Result">
    <t>
      As defined in <xref target="RFC2782"/> the result of an SRV record
      lookup will be a target host name and a port. An iSchedule Sender
      uses these to contact the iSchedule Receiver.  iSchedule Senders
      MUST honor the full behavior of SRV records as defined by <xref
      target="RFC2782"/>, in particular the TTL, Priority and Weight
      options in the record, as well as handling multiple records
      being returned.
    </t>
    <t>
      Since an iSchedule server is an HTTP server, an iSchedule client
      needs to supply a Request-URI in the HTTP request it makes to the
      server, in addition to the host name and port information. When SRV
      records are being used there is no way to specify the Request-URI
      in the SRV record. As a result clients MUST use "/" as the
      Request-URI for the iSchedule server identified by an SRV record.
    </t>
  </section>
</section>

  <section title="iSchedule Receiver Capabilities"
           anchor="ISCHEDULE_RECEIVER_CAPABILITIES">
    <t>
      iSchedule Receivers supporting the features described in
      this document MUST allow iSchedule Sender to query their
      capabilities by accepting GET requests targeted at the Request-URI
      "/.well-known/ischedule?query=capabilities".
      The response body for a successful
      GET request targeted at this URI MUST be an XML document with
      query-result as its root element.
    </t>


    <section title="Example: Querying iSchedule Receiver Capabilities"
             anchor="ISCHEDULE_RECEIVER_CAPABILITIES_EXAMPLE">
      <figure>
        <preamble>&gt;&gt; Request &lt;&lt;</preamble>
        <artwork><![CDATA[
GET /.well-known/ischedule?query=capabilities HTTP/1.1
Host: cal.example.com
        ]]></artwork>
      </figure>
      <figure>
        <preamble>&gt;&gt; Response &lt;&lt;</preamble>
        <artwork><![CDATA[
HTTP/1.1 200 OK
Date: Mon, 15 Dec 2008 09:32:12 GMT
Content-Type: application/xml; charset=utf-8
Content-Length: xxxx
iSchedule-Version: 1.0
ETag: "afasdf-132afds"

<?xml version="1.0" encoding="utf-8" ?>
<query-result xmlns="urn:ietf:params:xml:ns:ischedule">
  <capability-set>
    <supported-version-set>
      <version>1</version>
    </supported-version-set>
    <supported-scheduling-message-set>
      <comp name="VEVENT">
        <method name="REQUEST"/>
        <method name="ADD"/>
        <method name="REPLY"/>
        <method name="CANCEL"/>
      </comp>
      <comp name="VTODO"/>
      <comp name="VFREEBUSY"/>
    </supported-scheduling-message-set>
    <supported-calendar-data>
      <calendar-data content-type="text/calendar" version="2.0"/>
    </supported-calendar-data>
    <supported-attachment-values>
      <inline-attachment/>
      <external-attachment/>
    </supported-attachment-values>
    <supported-recipient-uri-scheme-set>
      <scheme>mailto</scheme>
    </supported-recipient-uri-scheme-set>
    <max-content-length>102400</max-content-length>
    <min-date-time>19910101T000000Z</min-date-time>
    <max-date-time>20381231T000000Z</max-date-time>
    <max-instances>150</max-instances>
    <max-recipients>250</max-recipients>
    <administrator>mailto:ischedule-admin@example.com</administrator>
  </capability-set>
</query-result>
        ]]></artwork>
      </figure>
    </section>
  </section>

  <section title="Scheduling">
    <t>
      This section defines how an iSchedule Sender can use the
      HTTP POST method to submit a scheduling message to an
      iSchedule Receiver.
    </t>

    <section anchor="schedule" title="POST Method">
      <t>
        The POST method submits a scheduling message to one or more
        recipients by targeting the request at the Request-URI
        of an iSchedule Receiver.  The request body of a POST method
        MUST contain a scheduling message or free-busy message (e.g., an
        iCalendar object that follows the iTIP semantic).
      </t>
      <t>
        A submitted scheduling message will be delivered to the calendar
        user addresses specified in the Recipient request header. A
        submitted free-busy message will be immediately executed and a
        free-busy response returned.
      </t>
      <t>
        Every POST request MUST include the iSchedule-Version request
        header.
      </t>
      <t>
        Every POST request MUST include a single Originator request header
        that specifies the calendar user address of the originator of
        the scheduling message.
      </t>
      <t>
        Every POST request MUST include one or more Recipient
        request headers. The value of this header is a list of one
        or more calendar user addresses and corresponds to the set of
        calendar users who will have the scheduling message delivered
        to them.
      </t>

      <section anchor="schedule-response" title="Schedule Response">
        <t>
          A POST request may deliver a scheduling message to one or
          more calendar users specified in the Recipient request header.
          Since the behavior of each recipient may vary, it is useful
          to get response status information for each recipient in the
          overall POST response. This specification defines a new
          XML response to convey multiple recipient status.  
        </t>
        <t>
          A response to a POST method that indicates status for
          one or more recipients MUST be a schedule-response
          XML element. This MUST contain one or more response
          elements for each recipient, with each of those containing
          elements that indicate which recipient they correspond to,
          the scheduling status of the request for that recipient,
          any error codes and an optional description.
        </t>
        <t>
          In the case of a free-busy request, the response elements
          can also contain calendar-data elements which contain
          free busy information (e.g., an iCalendar VFREEBUSY component)
          indicating the busy state of the corresponding recipient,
          assuming that the free-busy request for that recipient succeeded.
        </t>
        <t>
          TODO: Define the response body for a failed request.
        </t>
        <t>
<?rfc compact="no" ?>
          <list>
            <t>
              (supported-calendar-data): The resource submitted in
              the POST request MUST be a supported media type (i.e.
              text/calendar) for scheduling or free-busy messages;
            </t>
            <t>
              (valid-calendar-data): The resource submitted in the
              POST request MUST be valid data for the media type being
              specified (i.e. valid iCalendar object);
            </t>
            <t>
              (valid-scheduling-message): The resource submitted in
              the POST request MUST obey all restrictions specified for
              the POST request (e.g., the scheduling message follows the
              restrictions of iTIP);
            </t>
            <t>
              (originator-specified): The POST request MUST include a
              valid Originator request header specifying a single
              calendar user address of the currently authenticated user;
            </t>
            <t>
              (recipient-specified): The POST request MUST include
              one or more valid Recipient request headers specifying the
              calendar user address of users to whom the scheduling message
              will be delivered.
            </t>
            <t>
              (originator-reply): The calendar user identified by the
              Originator request header in the POST request MUST have
              previously received the scheduling message that is being
              replied to when the scheduling message is an incoming
              scheduling message;
            </t>
            <t>
              (max-content-length): The request body submitted in the
              POST request MUST have an octet size less than or equal to
              the value of the max-content-length capability of
              the iSchedule Receiver.
            </t>
          </list>
<?rfc compact="yes" ?>
        </t>

      </section>

      <section anchor="schedule-status-codes" title="Status Codes for use with the POST method">
        <t>The following are examples of response codes one would expect to be
           used for this method. Note, however, that unless explicitly
           prohibited any 2/3/4/5xx series response code may be used in a
           response.</t>
           <t>
<?rfc compact="no" ?>
			<list>
				<t>
					200 (OK) - The command succeeded.
				</t>
				<t>
					400 (Bad Request) - The Sender has provided an invalid scheduling message.
				</t>
				<t>
					403 (Forbidden) - The Sender cannot submit a scheduling message to the specified Request-URI.
				</t>
				<t>
					404 (Not Found) - The URL in the Request-URI was not present.
				</t>
				<t>
					507 (Insufficient Storage) - The server did not have sufficient space to record the scheduling message.
				</t>
			</list>
<?rfc compact="yes" ?>
           </t>
      </section><!-- schedule-status-codes -->

      <section anchor="schedule-example" title="Example: Simple meeting invitation">
        <figure>
          <preamble>&gt;&gt; Request &lt;&lt;</preamble>
          <artwork><![CDATA[
POST /.well-known/ischedule HTTP/1.1
Host: cal.example.org
iSchedule-Version: 1.0
Originator: mailto:bernard@example.com
Recipient: mailto:cyrus@example.org
Content-Type: text/calendar
Content-Length: xxxx

BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Example Corp.//EN
METHOD:REQUEST
BEGIN:VEVENT
DTSTAMP:20040901T200200Z
ORGANIZER:mailto:bernard@example.com
DTSTART:20040902T130000Z
DTEND:20040902T140000Z
SUMMARY:Design meeting
UID:34222-232@example.com
ATTENDEE;PARTSTAT=ACCEPTED;ROLE=CHAIR;CUTYPE=IND
 IVIDUAL;CN=Bernard Desruisseaux:mailto:bernard@
 example.com
ATTENDEE;PARTSTAT=NEEDS-ACTION;RSVP=TRUE;ROLE=RE
 Q-PARTICIPANT;CUTYPE=INDIVIDUAL;CN=Cyrus Daboo:
 mailto:cyrus@example.org
END:VEVENT
END:VCALENDAR
]]>
          </artwork>
        </figure>
        <figure>
          <preamble>&gt;&gt; Response &lt;&lt;</preamble>
          <artwork><![CDATA[
HTTP/1.1 200 OK
Date: Thu, 02 Sep 2004 16:53:32 GMT
Content-Type: application/xml; charset=utf-8
Content-Length: xxxx
iSchedule-Version: 1.0

<?xml version="1.0" encoding="utf-8" ?>
<schedule-response xmlns="urn:ietf:params:xml:ns:ischedule">
<response>
  <recipient>mailto:cyrus@example.org</recipient>
  <request-status>2.0;Success</request-status>
  <responsedescription>Delivered to recipient
  scheduling inbox</responsedescription>
</response>
</schedule-response>
]]>
          </artwork>
        </figure>
        <t>
          In this example, the iSchedule Sender requests the iSchedule
          Receiver to deliver a meeting invitation (scheduling REQUEST)
          to the calendar user mailto:cyrus@example.org.
          The response indicates that delivery of the scheduling message
          was successful.
        </t>
      </section>
      <!-- schedule-example -->
      <section anchor="schedule-fb-example" title="Example: Search for Busy Time Information">
        <figure>
          <preamble>&gt;&gt; Request &lt;&lt;</preamble>
          <artwork><![CDATA[
POST /.well-known/ischedule HTTP/1.1
Host: cal.example.org
iSchedule-Version: 1.0
Originator: mailto:bernard@example.com
Recipient: mailto:cyrus@example.org
Content-Type: text/calendar
Content-Length: xxxx

BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Example Corp.//EN
METHOD:REQUEST
BEGIN:VFREEBUSY
DTSTAMP:20040901T200200Z
ORGANIZER:mailto:bernard@example.com
DTSTART:20040902T000000Z
DTEND:20040903T000000Z
UID:34222-232@example.com
ATTENDEE;CN=Cyrus Daboo:mailto:cyrus@example.org
END:VFREEBUSY
END:VCALENDAR
]]>
          </artwork>
        </figure>
        <figure>
          <preamble>&gt;&gt; Response &lt;&lt;</preamble>
          <artwork><![CDATA[
HTTP/1.1 200 OK
Date: Thu, 02 Sep 2004 16:53:32 GMT
Content-Type: application/xml; charset=utf-8
Content-Length: xxxx
iSchedule-Version: 1.0

<?xml version="1.0" encoding="utf-8" ?>
<schedule-response xmlns="urn:ietf:params:xml:ns:ischedule">
<response>
  <recipient>mailto:cyrus@example.org</recipient>
  <request-status>2.0;Success</request-status>
  <calendar-data>BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Example Corp.//EN
METHOD:REPLY
BEGIN:VFREEBUSY
DTSTAMP:20040901T200200Z
ORGANIZER:mailto:bernard@example.com
DTSTART:20040902T000000Z
DTEND:20040903T000000Z
UID:34222-232@example.com
ATTENDEE;CN=Cyrus Daboo:mailto:cyrus@example.org
FREEBUSY;FBTYPE=BUSY-UNAVAILABLE:20040902T000000Z/
 20040902T090000Z,20040902T170000Z/20040903T000000Z
FREEBUSY;FBTYPE=BUSY:20040902T120000Z/20040902T130000Z
END:VFREEBUSY
END:VCALENDAR
</calendar-data>
</response>
</schedule-response>
]]>
          </artwork>
        </figure>
        <t>
          In this example, the iSchedule Sender requests the iSchedule
          Receiver to determine the busy information of the calendar
          user mailto:cyrus@example.org, over the time range specified
          by the scheduling message sent in the request. The response
          includes VFREEBUSY components with the busy time of the
          requested calendar user.
        </t>
      </section>

      <section anchor="schedule-example-task" title="Example: Simple Task Assignment">
        <figure>
          <preamble>&gt;&gt; Request &lt;&lt;</preamble>
          <artwork><![CDATA[
POST /.well-known/ischedule HTTP/1.1
Host: cal.example.org
iSchedule-Version: 1.0
Originator: mailto:bernard@example.com
Recipient: mailto:cyrus@example.org
Content-Type: text/calendar
Content-Length: xxxx

BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Example Corp.//CalDAV Client//EN
METHOD:REQUEST
BEGIN:VTODO
DTSTAMP:20040901T200200Z
ORGANIZER:mailto:bernard@example.com
DUE:20070505
SUMMARY:Review Internet-Draft
UID:34222-456@example.com
ATTENDEE;PARTSTAT=NEEDS-ACTION;RSVP=TRUE;ROLE=RE
 Q-PARTICIPANT;CUTYPE=INDIVIDUAL;CN=Cyrus Daboo:
 mailto:cyrus@example.org
END:VEVENT
END:VCALENDAR
]]>
          </artwork>
        </figure>
        <figure>
          <preamble>&gt;&gt; Response &lt;&lt;</preamble>
          <artwork><![CDATA[
HTTP/1.1 200 OK
Date: Thu, 02 Sep 2004 16:53:32 GMT
Content-Type: application/xml; charset=utf-8
Content-Length: xxxx
iSchedule-Version: 1.0

<?xml version="1.0" encoding="utf-8" ?>
<schedule-response
             xmlns="urn:ietf:params:xml:ns:ischedule">
<response>
  <recipient>mailto:cyrus@example.org</recipient>
  <request-status>2.0;Success</request-status>
  <responsedescription>Delivered to recipient
  scheduling inbox</responsedescription>
</response>
</schedule-response>
]]>
          </artwork>
        </figure>
        <t>
          In this example, the iSchedule Sender requests the iSchedule
          Sender to deliver a task assignment (scheduling REQUEST) to
          the calendar user mailto:cyrus@example.org.
          The response indicates that delivery of the scheduling message
          was successful.
        </t>
      </section>
    </section>
  </section>

  <section title="HTTP Headers" anchor="http.headers">
    <section title="iSchedule-Version General Header" anchor="ischedule-version.header">
      <figure>
        <artwork><![CDATA[
   iSchedule-Version =  "iSchedule-Version" ":" 1*DIGIT "." 1*DIGIT
        ]]></artwork>
      </figure>
      <t>
        The iSchedule-Version general header field MUST be specified by
        the iSchedule Sender on requests, and by the iSchedule Receiver
        on responses.
      </t>
      <t>
        TODO: Consider whether the iSchedule-Version should be returned
        on a per recipient basis in the response body.
      </t>
    </section>

    <section title="iSchedule-Via General Header" anchor="ischedule-via.header">
      <figure>
        <artwork><![CDATA[
   iSchedule-Via =  "iSchedule-Via" ":" 1#( received-protocol
                                            received-by [ comment ] )
   ; received-protocol as defined in [RFC2616]
   ; received-by as defined in [RFC2616]
   ; comment as defined in [RFC2616]

]]>
        </artwork>
      </figure>
      <t>
        The iSchedule-Via general header field MUST be used by iSchedule
        intermediaries to indicate the intermediate protocols and
        recipients between the iSchedule Sender and the iSchedule Receiver
        on requests.
      </t>
      <t>
        TODO: Consider whether the iSchedule-Via should be returned
        on a per recipient basis in the response body.
      </t>
    </section>

    <section title="Originator Request Header" anchor="originator.header">
      <figure>
        <artwork><![CDATA[
   Originator = "Originator" ":" absoluteURI

   ; absoluteURI as defined in [RFC3986]
  ]]>
        </artwork>
      </figure>
      <t>
        The Originator request header value is a URI which specifies the
        calendar user address of the originator of the scheduling message.
        Note that the absoluteURI production is defined in
        <xref target="RFC3986">RFC3986</xref>.
      </t>
    </section>
    <!-- originator.header -->
    <section title="Recipient Request Header" anchor="recipient.header">
      <figure>
        <artwork><![CDATA[
   Recipient = "Recipient" ":" 1#absoluteURI

   ; absoluteURI as defined in [RFC3986]
        ]]></artwork>
      </figure>
      <t>
        The Recipient request header value is a URI which specifies the
        calendar user address of the recipients to which the POST method
        should deliver the submitted scheduling message. Note that the
        absoluteURI production is defined in
        <xref target="RFC3986">RFC3986</xref>
      </t>
    </section><!-- recipient.header -->
  </section><!-- http.headers -->

  <section title="XML Element Definitions">
    <section anchor="schedule_response_element" title="schedule-response XML Element">
      <t>
<?rfc compact="no" ?>
        <list style="hanging">
          <t hangText="Name:">schedule-response</t>
          <t hangText="Namespace:">urn:ietf:params:xml:ns:ischedule</t>
          <t hangText="Purpose:">Contains the set of responses for a POST
                                 method request.</t>
          <t hangText="Description:">
            See <xref target="schedule-response"/>.
          </t>
          <t hangText="Definition:">
            <figure><artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT schedule-response (response*)>
              ]]></artwork>
            </figure>
          </t>
        </list>
<?rfc compact="yes" ?>
      </t>
      <section anchor="response_element" title="response XML Element">
        <t>
<?rfc compact="no" ?>
          <list style="hanging">
            <t hangText="Name:">response</t>
            <t hangText="Namespace:">urn:ietf:params:xml:ns:ischedule</t>
            <t hangText="Purpose:">Contains a single response for a POST
                                   method request.</t>
            <t hangText="Description:">
              See <xref target="schedule-response"/>.
            </t>
            <t hangText="Definition:">
              <figure>
                <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT response (recipient,
                         request-status,
                         calendar-data?,
                         error?,
                         responsedescription?)>
                ]]></artwork>
              </figure>
            </t>
          </list>
<?rfc compact="no" ?>
        </t>
        <section anchor="recipient_element" title="recipient XML Element">
          <t>
<?rfc compact="no" ?>
            <list style="hanging">
              <t hangText="Name:">recipient</t>
              <t hangText="Namespace:">urn:ietf:params:xml:ns:ischedule</t>
              <t hangText="Purpose:">The calendar user address (recipient header
                                     value) that the enclosing response for a
                                     POST method request is for.</t>
              <t hangText="Description:">
                See <xref target="schedule-response"/>.
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT recipient (href)>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc compact="yes" ?>
          </t>
        </section>
        <section anchor="response_status_element" title="request-status XML Element">
          <t>
<?rfc compact="no" ?>
            <list style="hanging">
              <t hangText="Name:">request-status</t>
              <t hangText="Namespace:">urn:ietf:params:xml:ns:ischedule</t>
              <t hangText="Purpose:">The iTIP REQUEST-STATUS property value for
                                     this response.</t>
              <t hangText="Description:">
                See <xref target="schedule-response"/>.
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT request-status (#PCDATA)>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc compact="yes" ?>
          </t>
        </section>

        <section title="calendar-data XML Element">
          <t>
<?rfc compact="no" ?>
            <list style="hanging">
              <t hangText="Name:">calendar-data</t>
              <t hangText="Namespace:">urn:ietf:params:xml:ns:ischedule</t>
              <t hangText="Purpose:">An iCalendar object in a response to a
                                     seach for busy time information.</t>
              <t hangText="Description:">
                See <xref target="schedule-response"/>.
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT calendar-data (#PCDATA)>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc compact="yes" ?>
          </t>
        </section>

        <section title="error XML Element">
          <t>
<?rfc compact="no" ?>
            <list style="hanging">
              <t hangText="Name:">error</t>
              <t hangText="Namespace:">urn:ietf:params:xml:ns:ischedule</t>
              <t hangText="Purpose:">Error responses sometimes need more
                information to indicate what went wrong.</t>
              <t hangText="Description:">
                See <xref target="schedule-response"/>.
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT error ANY>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc compact="yes" ?>
          </t>
        </section>
        <section title="responsedescription XML Element">
          <t>
<?rfc compact="no" ?>
            <list style="hanging">
              <t hangText="Name:">responsedescription</t>
              <t hangText="Namespace:">urn:ietf:params:xml:ns:ischedule</t>
              <t hangText="Purpose:">Contains information about a status
                                    response</t>
              <t hangText="Description:">
                See <xref target="schedule-response"/>.
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT responsedescription (#PCDATA)>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc compact="yes" ?>
          </t>
        </section>
      </section>
    </section>
    <section title="query-result XML Element">
      <t>
<?rfc subcompact="no" ?>
        <list style="hanging">
          <t hangText="Name:">
            query-result
          </t>
          <t hangText="Namespace:">
            urn:ietf:params:xml:ns:ischedule
          </t>
          <t hangText="Purpose:">
            Contains result of a query request.
          </t>
          <t hangText="Description:">
            A generic container for the result of a query request, such as
            a query of the capabilities of an iSchedule Receiver.
          </t>
          <t hangText="Definition:">
            <figure>
              <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT query-result (capability-set)>
              ]]></artwork>
            </figure>
          </t>
        </list>
<?rfc subcompact="yes" ?>
      </t>

      <section title="capability-set XML Element">
        <t>
<?rfc subcompact="no" ?>
          <list style="hanging">
            <t hangText="Name:">
              capability-set
            </t>
            <t hangText="Namespace:">
              urn:ietf:params:xml:ns:ischedule
            </t>
            <t hangText="Purpose:">
              Contains iSchedule Receiver capabilities.
            </t>
            <t hangText="Description:">
              The capability-set element contains capabilities
              of the iSchedule Receiver.
            </t>
            <t hangText="Definition:">
              <figure>
                <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT capability-set (supported-version-set,
                             supported-scheduling-message-set,
                             supported-calendar-data,
                             supported-attachment-values,
                             supported-recipient-uri-scheme-set,
                             max-content-length,
                             min-date-time,
                             max-date-time,
                             max-instances,
                             max-recipients,
                             administrator) >
                ]]></artwork>
              </figure>
            </t>
          </list>
<?rfc subcompact="yes" ?>
        </t>

        <section title="supported-version-set XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                supported-version-set
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Identifies the iSchedule versions supported by the
                iSchedule Receiver.
              </t>
              <t hangText="Description:">
                An iSchedule Receiver MAY advertise support for
                multiple versions of the iSchedule protocol.
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT supported-version-set (version)+>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
          <section title="version XML Element">
            <t>
  <?rfc subcompact="no" ?>
              <list style="hanging">
                <t hangText="Name:">
                  version
                </t>
                <t hangText="Namespace:">
                  urn:ietf:params:xml:ns:ischedule
                </t>
                <t hangText="Purpose:">
                  Specifies an iSchedule version.
                </t>
                <t hangText="Definition:">
                  <figure>
                    <artwork><![CDATA[
     <!ELEMENT version (#PCDATA)>
     <!-- PCDATA value: version number -->
                    ]]></artwork>
                  </figure>
                </t>
              </list>
  <?rfc subcompact="yes" ?>
            </t>
          </section><!-- version -->
        </section><!-- supported-version-set -->

        <section title="supported-scheduling-message-set XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                supported-scheduling-message-set
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Identifies the type of supported scheduling messages.
              </t>
              <t hangText="Description:">
                An iSchedule Receiver could advertise that it only provides
                support for event and free-busy scheduling messages,
                and not for to-do scheduling messages, with this capabilities.
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT supported-scheduling-message-set (comp)+>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
          <section title="comp XML Element">
            <t>
<?rfc subcompact="no" ?>
              <list style="hanging">
                <t hangText="Name:">
                  comp
                </t>
                <t hangText="Namespace:">
                  urn:ietf:params:xml:ns:ischedule
                </t>
                <t hangText="Purpose:">
                  Identifies a calendar component type.
                </t>
                <t hangText="Description:">
                </t>
                <t hangText="Definition:">
                  <figure>
                    <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT comp (method)*>

     <!ATTLIST comp name CDATA #REQUIRED>
     <!-- name value: a calendar component name -->
                    ]]></artwork>
                  </figure>
                </t>
              </list>
<?rfc subcompact="yes" ?>
            </t>
            <section title="method XML Element">
              <t>
<?rfc subcompact="no" ?>
                <list style="hanging">
                  <t hangText="Name:">
                    method
                  </t>
                  <t hangText="Namespace:">
                    urn:ietf:params:xml:ns:ischedule
                  </t>
                  <t hangText="Purpose:">
                    Specifies an iCalendar method type.
                  </t>
                  <t hangText="Description:">
                  </t>
                  <t hangText="Definition:">
                    <figure>
                      <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT method EMPTY>

     <!ATTLIST method name CDATA #REQUIRED>
     <!-- name value: a method type -->
                      ]]></artwork>
                    </figure>
                  </t>
                </list>
<?rfc subcompact="yes" ?>
              </t>
            </section><!-- method -->
          </section><!-- comp -->
        </section><!-- supported-scheduling-message-set -->

        <section title="supported-calendar-data XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                supported-calendar-data
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Contains
              </t>
              <t hangText="Description:">
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT supported-calendar-data (calendar-data)+>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
          <section title="calendar-data XML Element">
            <t>
<?rfc subcompact="no" ?>
              <list style="hanging">
                <t hangText="Name:">
                  calendar-data
                </t>
                <t hangText="Namespace:">
                  urn:ietf:params:xml:ns:ischedule
                </t>
                <t hangText="Purpose:">
                  Specified a supported media type for scheduling messages.
                </t>
                <t hangText="Description:">
                </t>
                <t hangText="Definition:">
                  <figure>
                    <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT calendar-data EMPTY>

     <!ATTLIST calendar-data content-type CDATA "text/calendar"
                             version CDATA "2.0">
     <!-- content-type value: a MIME media type -->
     <!-- version value: a version string -->
                    ]]></artwork>
                  </figure>
                </t>
              </list>
<?rfc subcompact="yes" ?>
            </t>
          </section><!-- calendar-data -->
        </section><!-- supported-calendar-data -->
        <section title="supported-attachment-values XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                supported-attachment-values 
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Identifies the attachment values supported.
              </t>
              <t hangText="Description:">
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT supported-attachment-values (inline-attachment?,
                                            external-attachment?)>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
          <section title="inline-attachment XML Element">
            <t>
<?rfc subcompact="no" ?>
              <list style="hanging">
                <t hangText="Name:">
                  inline-attachment
                </t>
                <t hangText="Namespace:">
                  urn:ietf:params:xml:ns:ischedule
                </t>
                <t hangText="Purpose:">
                  Specifies inline attachment as a supported attachment value.
                </t>
                <t hangText="Description:">
                </t>
                <t hangText="Definition:">
                  <figure>
                    <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT inline-attachment EMPTY>
                    ]]></artwork>
                  </figure>
                </t>
              </list>
<?rfc subcompact="yes" ?>
            </t>
          </section><!-- inline-attachment -->
          <section title="external-attachment XML Element">
            <t>
<?rfc subcompact="no" ?>
              <list style="hanging">
                <t hangText="Name:">
                  external-attachment
                </t>
                <t hangText="Namespace:">
                  urn:ietf:params:xml:ns:ischedule
                </t>
                <t hangText="Purpose:">
                  Specifies external attachment as a supported attachment value.
                </t>
                <t hangText="Description:">
                </t>
                <t hangText="Definition:">
                  <figure>
                    <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT external-attachment EMPTY>
                    ]]></artwork>
                  </figure>
                </t>
              </list>
<?rfc subcompact="yes" ?>
            </t>
          </section><!-- external-attachment -->
        </section><!-- supported-attachment-values -->
        <section title="supported-recipient-uri-scheme-set XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                supported-recipient-uri-scheme-set
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Identifies the supported URI schemes supported in
                the Recipient HTTP request header.
              </t>
              <t hangText="Description:">
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT supported-recipient-uri-scheme-set (scheme+)>
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
          <section title="scheme XML Element">
            <t>
<?rfc subcompact="no" ?>
              <list style="hanging">
                <t hangText="Name:">
                  scheme
                </t>
                <t hangText="Namespace:">
                  urn:ietf:params:xml:ns:ischedule
                </t>
                <t hangText="Purpose:">
                  Specifies a supported URI scheme.
                </t>
                <t hangText="Description:">
                </t>
                <t hangText="Definition:">
                  <figure>
                    <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT scheme (#PCDATA)>
     <!-- PCDATA value: URI scheme (e.g., mailto) -->
                    ]]></artwork>
                  </figure>
                </t>
              </list>
<?rfc subcompact="yes" ?>
            </t>
          </section><!-- scheme -->
        </section><!-- supported-recipient-uri-scheme-set -->
        <section title="max-content-length XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                max-content-length
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Specifies the maximum size allowed for a scheduling
                message in octets.
              </t>
              <t hangText="Description:">
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT max-content-length (#PCDATA)>
     <!-- PCDATA value: a numeric value (positive integer) -->
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
        </section><!-- max-content-length -->
        <section title="min-date-time XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                min-date-time
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Specifies a DATE-TIME value indicating the earliest date and
                time in UTC that the server is willing to accept for any DATE
                or DATE-TIME value in a scheduling message.
              </t>
              <t hangText="Description:">

              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
   <!ELEMENT min-date-time (#PCDATA)>
   <!-- PCDATA value: an iCalendar format DATE-TIME value in UTC -->
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
        </section><!-- min-date-time -->
        <section title="max-date-time XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                max-date-time
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Specifies a DATE-TIME value indicating the latest date and
                time in UTC that the server is willing to accept for any DATE
                or DATE-TIME value in a scheduling message.
              </t>
              <t hangText="Description:">
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
   <!ELEMENT max-date-time (#PCDATA)>
   <!-- PCDATA value: an iCalendar format DATE-TIME value in UTC -->
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
        </section><!-- max-date-time -->
        <section title="max-instances XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                max-instances
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Specifies the maximum number of recurrence instances
                allowed in a scheduling message.
              </t>
              <t hangText="Description:">
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT max-instances (#PCDATA)>
     <!-- PCDATA value: a numeric value (positive integer) -->
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
        </section><!-- max-instances -->
        <section title="max-recipients XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                max-recipients
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Specifies the maximum number of recipients allowed
                for a scheduling message.
              </t>
              <t hangText="Description:">
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT max-recipients (#PCDATA)>
     <!-- PCDATA value: a numeric value (positive integer) -->
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
        </section><!-- max-recipients -->
        <section title="administrator XML Element">
          <t>
<?rfc subcompact="no" ?>
            <list style="hanging">
              <t hangText="Name:">
                administrator
              </t>
              <t hangText="Namespace:">
                urn:ietf:params:xml:ns:ischedule
              </t>
              <t hangText="Purpose:">
                Provides contact information for the administrator
                of the iSchedule Receiver.
              </t>
              <t hangText="Description:">
              </t>
              <t hangText="Definition:">
                <figure>
                  <artwork type="application/xml-dtd"><![CDATA[
     <!ELEMENT administrator (#PCDATA)>
     <!-- PCDATA value: URI to contact administrator -->
                  ]]></artwork>
                </figure>
              </t>
            </list>
<?rfc subcompact="yes" ?>
          </t>
        </section><!-- administrator -->
      </section><!-- capabilities-set -->
    </section><!-- query-result -->
  </section>

  <section title="Security Considerations">
    <t>
      The process of scheduling involves the sending and receiving of
      scheduling messages. As a result, the security problems related
      to messaging in general are relevant here. In particular the
      authenticity of the scheduling messages needs to be verified.
    </t>
    <section title="Privacy">
      <t>
        iSchedule Senders and iSchedule Receivers MUST use an
        HTTP connection protected with TLS as defined in
        <xref target="RFC2818"/> for all scheduling transactions.
      </t>
    </section>
    <section title="Authentication">
      <t>
        Mutual authentication is done with TLS <xref target="RFC5246"/>
        using certificates exchanged between both the iSchedule Sender
        and the iSchedule Receiver.
      </t>
    </section>
    <section title="Authorization">
      <t>
        Once an iSchedule Sender has been successfully authenticated,
        the iSchedule Receiver MUST verify that the iSchedule Sender
        has the authority to send a scheduling message on behalf of
        the Originator.
      </t>
      <t>
        TODO: Clarify how verification must be done.
        Should trusted iSchedule Sender be identified as such in DNS
        (e.g., by storing their certificate in the DNS (see <xref
        target="RFC4398"/>))
        Should the iSchedule Receiver contact the iSchedule
        Receiver of the domain of the iSchedule Sender to find
        out whether it should be trusted or not?
      </t>
    </section>
  </section>

  <section title="IANA Considerations" anchor="IANA">
    <section title="Namespace Registration" anchor="IANA_NS">
      <t>
        This specification registers a new URN to identify a new
        XML namespace as per <xref target="RFC3688"/>.
      </t>
      <section title="iSchedule Namespace Registration"
        anchor="IANA_NS_ISCHEDULE">  
        <t>
          Registration request for the iSchedule namespace:
        </t>  
        <t>
          URI: urn:ietf:params:xml:ns:ischedule
        </t>  
        <t>
          Registrant Contact: See the "Authors' Addresses" section of   
          this document.
        </t>  
        <t>
          XML: None. Namespace URIs do not represent an XML   
          specification.
        </t>  
      </section>
    </section>
    <section title="HTTP Headers Registration" anchor="IANA_HTTP">
      <t>
        This specification registers three new headers for use with
        HTTP as per <xref target="RFC3864"/>.
      </t>
      <section title="iSchedule-Version General Header Registration"
        anchor="IANA_HTTP_ISCHEDULE_VERSION">
        <t>
          Header field name: iSchedule-Version
        </t>
        <t>
          Applicable protocol: http
        </t>
        <t>
          Status: standard
        </t>
        <t>
          Author/Change controller: IETF
        </t>
        <t>
          Specification document(s): this specification
        </t>
        <t>
          Related information: none
        </t>
      </section>
      <section title="iSchedule-Via General Header Registration"
        anchor="IANA_HTTP_ISCHEDULE_VIA">
        <t>
          Header field name: iSchedule-Via
        </t>
        <t>
          Applicable protocol: http
        </t>
        <t>
          Status: standard
        </t>
        <t>
          Author/Change controller: IETF
        </t>
        <t>
          Specification document(s): this specification
        </t>
        <t>
          Related information: none
        </t>
      </section>
      <section title="Originator Request Header Registration"
        anchor="IANA_HTTP_ORIGINATOR">
        <t>
          Header field name: Originator
        </t>
        <t>
          Applicable protocol: http
        </t>
        <t>
          Status: standard
        </t>
        <t>
          Author/Change controller: IETF
        </t>
        <t>
          Specification document(s): this specification
        </t>
        <t>
          Related information: none
        </t>
      </section>
      <section title="Recipient Request Header Registration"
        anchor="IANA_HTTP_RECIPIENT">
        <t>
          Header field name: Recipient
        </t>
        <t>
          Applicable protocol: http
        </t>
        <t>
          Status: standard
        </t>
        <t>
          Author/Change controller: IETF
        </t>
        <t>
          Specification document(s): this specification
        </t>
        <t>
          Related information: none
        </t>
      </section>
    </section>

    <section title="Well-Known URI Registration">
      <t>
        This specification registers a new well-known URI
        as per <xref target="I-D.nottingham-site-meta"/>.
      </t>
      <section title="iSchedule Well-Known URI Registration" anchor="IANA.WELL-KNOWN-URI">
        <t>
          URI suffix: ischedule
        </t>
        <t>
          Change controller:  IETF.
        </t>
        <t>
          Specification document(s): this specification
        </t>
        <t>
          Related information: none
        </t>
      </section>
    </section>
  </section><!-- IANA -->

  <section title="Acknowledgments">
    <t>
      The authors would like to thank the following individuals for
      contributing their ideas and support for writing this specification:
      Mattias Amnefelt,
      Mike Douglass,
      Tomas Hnetila,
      Ciny Joy,
      Arnaud Quillaud,
      Simon Vaillancourt, and
      Wilfredo Sanchez Vega.
    </t>
    <t>
      The authors would also like to thank the Calendaring and
      Scheduling Consortium for advice with this specification,
      and for organizing interoperability testing events to help
      refine it.
    </t>
  </section>
</middle>
<back>

  <references title="Normative References">
    &rfc2119;
    &rfc2616;
    &rfc2782;
    &rfc2818;
    &rfc3688;
    &rfc3986;
    &rfc5246;
    &rfc5545;
    &I-D.ietf-calsify-2446bis;
    &I-D.desruisseaux-caldav-sched;
    &I-D.nottingham-site-meta;
    &W3C.REC-xml-20081126;
  </references>

  <references title="Informative References">
    &I-D.ietf-calsify-rfc2447bis;
    &I-D.faltstrom-uri;
    &rfc3864;
    &rfc4398;
    &rfc4791;
  </references>

  <section title="Open Issues">
    <t>
      <list style="numbers">
        <t>
          Should we consider <xref target="I-D.faltstrom-uri"/>
          as another approach to discover iSchedule Receiver?
        </t>
      </list>
    </t>
  </section>

<!--
  <section title="Change Log (to be removed by RFC Editor prior to publication)">
    <section title="Changes in -01">
      <t>
        <list style="letters">
          <t>
          </t>
        </list>
      </t>
    </section>
  </section>
-->
</back>
</rfc>
