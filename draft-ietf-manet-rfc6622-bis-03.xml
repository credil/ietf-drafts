<?xml version="1.0" ?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc rfcedstyle="yes"?>
<?rfc symrefs="yes"?>
<?rfc compact="yes"?>

<rfc ipr="trust200902" category="std" docName="draft-ietf-manet-rfc6622-bis-03" obsoletes="6622">

  <front>

    <title abbrev="ICV and Timestamp TLVs for MANETs">Integrity Check Value and Timestamp TLV Definitions for&nbsp;Mobile&nbsp;Ad&nbsp;Hoc&nbsp;Networks&nbsp;(MANETs)</title>

    <author fullname="Ulrich Herberg" initials="U" surname="Herberg">
      <organization>Fujitsu Laboratories of America</organization>
      <address>
        <postal>
          <street>1240 E. Arques Ave.</street>
          <city>Sunnyvale</city>
          <region>CA</region>
          <code>94085</code>
          <country>USA</country>
        </postal>
        <email>ulrich@herberg.name</email>
        <uri>http://www.herberg.name/</uri>
      </address>
    </author>

    <author fullname="Thomas Heide Clausen" initials="T" surname="Clausen">
      <organization>LIX, Ecole Polytechnique</organization>
      <address>
         <postal>
          <street></street>
          <city>91128 Palaiseau Cedex</city>
          <country>France</country>
        </postal>
        <phone>+33 6 6058 9349</phone>
        <email>T.Clausen@computer.org</email>
        <uri>http://www.thomasclausen.org/</uri>
      </address>
    </author>

    <author initials="C.M." surname="Dearlove" fullname="Christopher Dearlove">
      <organization abbrev="BAE Systems ATC">BAE Systems Advanced Technology Centre</organization>
      <address>
        <postal>
          <street>
            West Hanningfield Road
          </street>
          <city>
            Great Baddow, Chelmsford
          </city>
          <country>
            United Kingdom
          </country>
        </postal>
        <phone>+44 1245 242194</phone>
        <email>chris.dearlove@baesystems.com</email>
        <uri>http://www.baesystems.com/</uri>
      </address>
    </author>
   
    <date/>

    <workgroup>Mobile Ad hoc Networking (MANET)</workgroup>
    <keyword>MANET</keyword>

    <abstract>
      <t>
        This document revises, extends and replaces RFC 6622. It describes general and flexible TLVs for representing cryptographic Integrity Check Values (ICVs) and timestamps, using the generalized Mobile Ad Hoc Network (MANET) packet/message format defined in RFC 5444. It defines two Packet TLVs, two Message TLVs, and two Address Block TLVs for affixing ICVs and timestamps to a packet, a message, and one or more addresses, respectively.
      </t>
    </abstract>

  </front>

  <middle>

    <section title="Introduction">
    	<t>[RFC Editor note: Please replace "xxxx" throughout this document with the RFC number assigned to this document, and remove this note.]</t>
    
    	<t>This document specifies a syntactical representation of security-
   related information for use with <xref target="RFC5444"/> addresses, messages, and packets, and also reports and updates IANA registrations (from
   <xref target="RFC6622"/>) of TLV types and type extension registries for these TLV types. This specification does not represent a stand-alone protocol, but is intended for use by MANET routing protocols, or security extensions thereof.
   		</t>

      <t>
        Specifically, this document, which revises, extends, and replaces <xref target="RFC6622"/>, specifies:
        
        <list style="symbols">
          <t>
            Two kinds of TLV: one for carrying Integrity Check Values (ICVs) and one for timestamps in packets, messages, and address blocks as defined by <xref target="RFC5444"/>.
          </t>

          <t>
            A generic framework for use of these TLVs, accounting for specific features of Packet, Message and Address Block TLVs.
          </t>
        </list>
      </t>

      <t>
        This document retains the IANA registries, defined in <xref target="RFC6622"/>, for recording code points for ICV calculations, and requests an additional allocation from each these registries. This document retains the IANA registries, defined in <xref target="RFC6622"/>, for recording code points for timestamps, hash-functions, and cryptographic functions, but does not request any additional allocations from these registries. This document replaces <xref target="RFC6622"/> as the reference for these registries.
      </t>

      <t>
        Moreover, in <xref target="decomposition"/>, this document defines the following:
        <list style="symbols">
          <t>
            A method for generating ICVs using a combination of a cryptographic function and a hash function, and for including such ICVs in the value field of a TLV.
          </t>
        </list>
      </t>

      <section title="Differences from RFC6622" anchor="6622diffs">

    	  <t>
          This document obsoletes <xref target="RFC6622"/>, replacing that document as the specification of two TLV types, TIMESTAMP and ICV, for packets, messages and address blocks. For the ICV TLV as well as repeating the specification of two type extensions, 0 and 1, it also specifies a new type extension, 2, in <xref target="decomposition"/> of this document.
        </t>

        <t>
          The TLV value of an ICV TLV with type extension 2 has the same internal structure as an ICV TLV with type extension 1, but is calculated also over the source address of the IP datagram carrying the packet, message, or Address Block. The rationale for adding this type extension is that some MANET protocols, such as <xref target="RFC6130"/>, use the IP source address of the IP datagram carrying the packet, message or Address Block, e.g., to identify links with neighbor routers. If this address is not otherwise contained in the packet, message, or Address Block payload (which is permitted, e.g., in <xref target="RFC6130"/>), then the address is not protected against tampering.
        </t>

        <t>
          This document also incorporates a number of editorial improvements over <xref target="RFC6622"/>. In particular, it makes it clear that an ICV TLV may be used to carry a truncated ICV, and that a single- or multi-value TIMESTAMP or ICV Address Block TLV may cover more than one address.
        </t>

      </section>
    
    </section>

    <section title="Terminology" anchor="terminology">

      <t>
        The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <xref target="RFC2119"/>.
      </t>

      <t>
        This document uses the terminology and notation defined in <xref target="RFC5444"/>. In particular, the following TLV fields and notation from <xref target="RFC5444"/> are used in this specification:
        <list style="hanging">
          <t hangText="&lt;msg-hop-limit&gt;"> is the hop limit of a message, as specified in Section&nbsp;5.2 of <xref target="RFC5444"/>.</t>
          <t hangText="&lt;msg-hop-count&gt;"> is the hop count of a message, as specified in Section&nbsp;5.2 of <xref target="RFC5444"/>.</t>
          <t hangText="&lt;length&gt;"> is the length of the value field in a TLV in octets, as specified in Section 5.4.1 of <xref target="RFC5444"/>.</t>
          <t hangText="single-length"> is the length of a single value in the value field in a TLV in octets, as specified in Section 5.4.1 of <xref target="RFC5444"/>. (It is equal to &lt;length&gt; except in a multivalue Address Block TLV.)</t>
        </list>
      </t>        

	<t>
        In addition to the regular expressions defined in Section 2.1.1 of <xref target="RFC5444"/> this document defines:
      </t>
	<t>
        + -  One or more occurrences of the preceding element or group.
      </t>
	   
    </section>

    <section title="Applicability Statement" anchor="applStatement">

      <t>
        MANET routing protocols using the format defined in <xref target="RFC5444"/> are accorded the ability to carry additional information in control messages and packets, through the inclusion of TLVs. Information so included MAY be used by a MANET routing protocol, or by an extension of a MANET routing protocol, according to its specification.
      </t>

      <t>
        This document specifies how to include an ICV for a packet, a message, and addresses in Address Blocks within a message, using such TLVs.  This document also specifies how to treat an empty Packet TLV Block, and "mutable" fields, specifically the &lt;msg-hop-count&gt; and &lt;msg-hop-limit&gt; fields, if present in the Message Header when calculating ICVs, such that the resulting ICV can be correctly verified by any recipient.
      </t>
      <t>
       This document describes a generic framework for creating ICVs, and how to include these ICVs in TLVs. In <xref target="decomposition"/>, an example method for calculating such ICVs is given, using a cryptographic function and a hash function, for which two TLV type extensions are allocated.
      </t>

    </section>
        
    <section title="Security Architecture">

      <t>
        MANET routing protocol specifications may have a clause allowing a control message to be rejected as "badly formed" or "insecure" prior to the message being processed or forwarded. In particular, MANET routing protocols such as the Neighborhood Discovery Protocol (NHDP) <xref target="RFC6130"/> and the Optimized Link State Routing Protocol version 2 <xref target="OLSRv2"/> recognize external reasons (such as failure to verify an ICV) for rejecting a message that would be considered "invalid for processing".
      </t>

      <t>
        This architecture is a result of the observation that with respect to security in MANETs, "one size rarely fits all" and that MANET routing protocol deployment domains have varying security requirements ranging from "unbreakable" to "virtually none". The virtue of this approach is that MANET routing protocol specifications (and implementations) can remain "generic", with extensions providing proper security mechanisms specific to a deployment domain.
      </t>

      <t>
        The MANET routing protocol "security architecture", in which this specification situates itself, can therefore be summarized as follows:
        <list style="symbols">
          <t> 
            MANET routing protocol specifications, each with a clause allowing an extension to reject a message (prior to processing/forwarding) as "badly formed" or "insecure".
         </t>
         <t>
           MANET routing protocol security extensions, each rejecting messages as "badly formed" or "insecure", as appropriate for a given security requirement specific to a deployment domain.
         </t>
         <t>
           Code points and an exchange format for information, necessary for specification of such MANET routing protocol security extensions.
         </t>
       </list>
     </t>

     <t>
       This document addresses the last of the points above, by specifying a common exchange format for cryptographic ICVs and timestamps, making reservations from within the Packet TLV, Message TLV, and Address Block TLV registries of <xref target="RFC5444"/>, to be used by (and shared among) MANET routing protocol security extensions.
     </t>

     <t>
       For the specific decomposition of an ICV using a cryptographic function and a hash function (specified in <xref target="decomposition"/>), this document reports the two IANA registries from <xref target="RFC6622"/> for code points for hash functions and cryptographic functions.
     </t>

     <t>
       With respect to <xref target="RFC5444"/>, this document is:
       <list style="symbols">
         <t>
           Intended to be used in the non-normative, but intended, mode of use described in Appendix B of <xref target="RFC5444"/>.
         </t>
         <t>
           A specific example of the Security Considerations section of <xref target="RFC5444"/> (the authentication part).
         </t>
       </list>
     </t>

    </section>

    <section title="Overview and Functioning" anchor="overview">

      <t>              
        This document specifies a syntactical representation of security-related information for use with <xref target="RFC5444"/> addresses,
messages, and packets, and also reports and updates IANA registrations (from <xref target="RFC6622"/>) of TLV types and type extension registries for these TLV types.
      </t>

      <t>              
        Moreover, this document provides guidelines for how MANET routing protocols, and MANET routing protocol extensions using this specification, should treat ICV and Timestamp TLVs, and mutable fields in messages. This specification does not represent a stand-alone protocol. MANET routing protocols, and MANET routing protocol extensions using this specification, MUST provide instructions as to how to handle packets, messages, and addresses with security information, associated as specified in this document.
      </t>

      <t>
       This document reports previously assigned TLV types (from <xref target="RFC6622"/>) from the registries defined for Packet, Message, and Address Block TLVs in <xref target="RFC5444"/>. When a TLV type is assigned from one of these registries, a registry for type extensions for that TLV type is created by IANA. This document reports and updates these type extension registries, in order to specify internal structure (and accompanying processing) of the &lt;value&gt; field of a TLV.
      </t>

      <t>
        For example, and as reported in this document, an ICV TLV with type extension = 0 specifies that the &lt;value&gt; field has no pre-defined internal structure, but is simply a sequence of octets. An ICV TLV with type extension = 1 specifies that the &lt;value&gt; field has a pre-defined internal structure and defines its interpretation. An ICV TLV with type extension = 2 (added in this document) is the same as an ICV TLV with type extension = 1, except that the integrity protection also covers the source address of the IP datagram carrying the packet, message, or Address Block.
      </t>

      <t>
        Specifically, with type extension = 1 or type extension = 2, the &lt;value&gt; field contains the result of combining a cryptographic function and a hash function, calculated over the contents of the packet, message, or Address Block. The &lt;value&gt; field contains sub-fields indicating which hash function and cryptographic function have been used, as specified in <xref target="decomposition"/>.
      </t>

      <t>
       Other documents can request assignments for other type extensions; if they do so, they MUST specify their internal structure (if any) and interpretation.
      </t>

    </section>

    <section title="General ICV TLV Structure" anchor="ICVTLVformat">

      <t>
        The value of the ICV TLV is:
      </t>

      <figure>
        <artwork>
   &lt;value&gt; := &lt;ICV-value&gt;+
        </artwork>
      </figure>
                
      <t>
        where:
        <list style="hanging">
          <t hangText="&lt;ICV-value&gt;"> 
            is a field, of length &lt;length&gt; octets (except in a multivalue Address Block TLV, where each &lt;ICV-value&gt; is of length single-length octets) that contains the information to be interpreted by the ICV verification process, as specified by the type extension. 
          </t>
        </list>
      </t>
                
      <t>
        Note that this does not specify how to calculate the &lt;ICV-value&gt; nor the internal structure thereof, if any; such information
MUST be specified by the type extension for the ICV TLV type; see <xref target="IANA"/>. This document specifies three such type extensions -- one for ICVs without pre-defined structures, and two for ICVs constructed combining a cryptographic function and a hash function.
      </t>

    </section>
                
    <section title="General Timestamp TLV Structure" anchor="timestampTLVformat">

      <t>
        The value of the Timestamp TLV is:
      </t>

      <figure>
        <artwork>
   &lt;value&gt; := &lt;time-value&gt;+
        </artwork>
      </figure>

      <t>
        where:
        <list style="hanging">
          <t hangText="&lt;time-value&gt;"> 
            is a field, of length &lt;length&gt; octets (except in a multivalue Address Block TLV, where each &lt;time-value&gt; is of length single-length octets) that contains the timestamp.
          </t>
        </list>
                
        Note that this does not specify how to calculate the &lt;time&nbhy;value&gt; nor the internal structure thereof, if any; such information
MUST be specified by the type extension for the TIMESTAMP TLV type; see <xref target="IANA"/>.

      </t>

      <t>
        A timestamp is essentially "freshness information".  As such, its setting and interpretation are to be determined by the MANET routing protocol,
or MANET routing protocol extension, that uses the timestamp and can, for example, correspond to a POSIX timestamp, GPS timestamp, or a simple sequence number. Note that ensuring time synchronization in a MANET may be difficult because of the decentralized architecture as well as highly dynamic topology due to mobility or other factors. It is out of scope for this document to specify a time synchronization mechanism. 
      </t>

    </section>

    <section title="Packet TLVs" anchor="packetICVs">

      <t>
        Two Packet TLVs are defined: one for including the cryptographic ICV of a packet and one for including the timestamp indicating the time at which the cryptographic ICV was calculated.
      </t>

      <section title="ICV Packet TLV" anchor="packetICVTLV">

        <t>
          An ICV Packet TLV is an example of an ICV TLV as described in <xref target="ICVTLVformat"/>. When determining the &lt;ICV-value&gt; for a packet, and adding an ICV Packet TLV to a packet, the following considerations MUST be applied:
          <list style="symbols">
            <t>
              Because packets as defined in <xref target="RFC5444"/> are never forwarded by routers, no special considerations are required regarding mutable fields (i.e., &lt;msg-hop-count&gt; and &lt;msg-hop-limit&gt;), if present within any messages in the packet, when calculating the ICV.
            </t>
            <t>
              Any Packet ICV TLVs already present in the Packet TLV Block MUST be removed before calculating the ICV, and the Packet TLV Block size MUST be recalculated accordingly.
            </t>
            <t>
              If the Packet TLV Block now contains no Packet TLVs, the Packet TLV Block MUST be removed, and the phastlv bit in the &lt;pkt&nbhy;flags&gt; field in the Packet Header MUST be cleared ('0').
            </t>
            <t>
              Any removed ICV Packet TLVs MUST be restored after having calculated the ICV, and the Packet TLV Block size MUST be recalculated accordingly.
            </t>
            <t>
              When any removed ICV Packet TLVs, and the newly calculated ICV Packet TLV, are added to the packet, if there is no Packet TLV Block then one MUST be added, including setting ('1') the phastlv bit in the &lt;pkt-flags&gt; field in the Packet Header.
            </t>
          </list>
        </t>

        <t>
           The rationale for removing any Packet ICV TLVs already present prior to calculating the ICV is that several ICV TLVs may be added to the same packet, e.g., using different ICV cryptographic and/or hash functions. The rationale for removing an empty Packet TLV Block is because the receiver of the packet cannot tell the difference between what was an absent Packet TLV Block, and what was an empty Packet TLV Block when removing and verifying the ICV Packet TLV if no other Packet TLVs are present.
        </t>
                          
      </section>

      <section title="TIMESTAMP Packet TLV" anchor="packettimestampTLV">

         <t>
           A TIMESTAMP Packet TLV is an example of a Timestamp TLV as described in <xref target="timestampTLVformat"/>. If a packet contains one or more TIMESTAMP TLVs and one or more ICV TLVs, then the TIMESTAMP TLVs (as well as any other Packet TLVs) MUST be added to the packet before the ICV TLVs, in order to include the timestamps and other TLVs in the calculation of the ICVs.
         </t>

      </section>

    </section>  

    <section title="Message TLVs" anchor="messageICVs">

      <t>
        Two Message TLVs are defined: one for including the cryptographic ICV of a message and one for including the timestamp indicating the time at which the cryptographic ICV was calculated.
      </t>

      <section title="ICV Message TLV" anchor="ICVTLV">

        <t>
          An ICV Message TLV is an example of an ICV TLV as described in <xref target="ICVTLVformat"/>. When determining the &lt;ICV-value&gt; for a message, the following considerations MUST be applied:
          <list style="symbols">
            <t>
              The fields &lt;msg-hop-limit&gt; and &lt;msg-hop-count&gt;, if present in the Message Header, MUST both be assumed to have the value 0
(zero) when calculating the ICV.
            </t>
            <t>
              Any Message ICV TLVs already present in the Message TLV Block MUST be removed before calculating the ICV, and the message size as well as the Message TLV Block size MUST be recalculated accordingly. Also, all relevant 
TLVs other than ICV TLVs MUST be added prior to TCV value calculation.
            </t>
            <t>
              Any removed ICV Message TLVs MUST be restored after having calculated the ICV, and the message size as well as the Message TLV Block size MUST be recalculated accordingly.
            </t>
          </list>
        </t>
                
        <t>
          The rationale for removing any ICV Message TLVs already present prior to calculating the ICV is that several ICV TLVs may be added to the
same message, e.g., using different ICV cryptographic and/or hash functions.
        </t>

      </section>

      <section title="TIMESTAMP Message TLV" anchor="timestampTLV">

        <t>
          A TIMESTAMP Message TLV is an example of a Timestamp TLV as described in <xref target="timestampTLVformat"/>. If a message contains one or more TIMESTAMP TLVs and one or more ICV TLVs, then the TIMESTAMP TLVs (as well as any other Message TLVs) MUST be added to the message before the ICV TLVs, in order to include the timestamps and other Message TLVs in the calculation of the ICV.
        </t>

      </section>
          
    </section>

    <section title="Address Block TLVs" anchor="addressblockICVs">

      <t>
        Two Address Block TLVs are defined: one for associating a cryptographic ICV to one or more addresses and their associated information, and one for including the timestamp indicating the time at which the cryptographic ICV was calculated.
      </t>

      <section title="ICV Address Block TLV" anchor="addressblockICVTLV">

        <t>
          An ICV Address Block TLV is an example of an ICV TLV as described in <xref target="ICVTLVformat"/>. The ICV is calculated over one or more addresses, concatenated with any other values -- for example, other Address Block TLV &lt;value&gt; fields -- associated with those addresses. A MANET routing protocol, or MANET routing protocol extension, using Address Block ICV TLVs MUST specify how to include any such concatenated attributes of the addresses in the calculation and verification processes for the ICV. When determining an &lt;ICV&nbhy;value&gt; for one or more addresses, the following consideration MUST be applied:

          <list style="symbols">
            <t>
              If other TLV values are concatenated with the addresses for calculating the ICV, the corresponding TLVs MUST NOT be ICV Address Block TLVs already associated with any of the addresses.
            </t>
          </list>

          The rationale for not concatenating the addresses with any ICV TLV values already associated with the addresses when calculating the ICV
is that several ICVs may be added to the same address or addresses, e.g., using different ICV cryptographic and/or hash functions, and the order of addition is not known to the recipient.
        </t>

      </section>

      <section title="TIMESTAMP Address Block TLV" anchor="addressblocktimestampTLV">

        <t>
          A TIMESTAMP Address Block TLV is an example of a Timestamp TLV as described in <xref target="timestampTLVformat"/>. If one or more TIMESTAMP TLVs and one or more ICV TLVs are associated with an address, the relevant TIMESTAMP TLV &lt;time-value&gt;(s) MUST be included before calculating the value of the ICV to be contained in the ICV TLV value (i.e., concatenated with the associated addresses and any other values as described in <xref target="addressblockICVTLV"/>).
        </t>
      </section>

    </section>
   
    <section title="ICV: Basic" anchor="simple">

      <t>
        The basic ICV, represented by way of an ICV TLV with type extension = 0, is a simple bit-field containing the cryptographic ICV. This
assumes that the mechanism stipulating how ICVs are calculated and verified is established outside of this specification, e.g., by administrative
configuration or external out-of-band signaling. Thus, the &lt;ICV-value&gt;, when using type extension = 0, is:
      </t>
      <figure>
        <artwork>
   &lt;ICV-value&gt; := &lt;ICV-data&gt;
        </artwork>
      </figure>

      <t>
        where:
        <list style="hanging">
          <t hangText="&lt;ICV-data&gt;"> 
            is a field, of length &lt;length&gt; octets (or single-length octets in a multivalue Address Block TLV) that contains the cryptographic ICV.
          </t>
        </list>
      </t>

    </section>

    <section title="ICV: Hash Function and Cryptographic Function" anchor="decomposition">

      <t>
        One common way of calculating an ICV is combining a cryptographic function and a hash function applied to the content. This decomposition is
specified in this section, using either type extension = 1 or type extension = 2, in the ICV TLVs.
      </t>

      <section title="General ICV TLV Structure">

        <t>
          The following data structure allows representation of a cryptographic ICV, including specification of the appropriate hash function and
cryptographic function used for calculating the ICV:
        </t>

        <figure>
          <artwork>
   &lt;ICV-value&gt; := &lt;hash-function&gt;
                  &lt;cryptographic-function&gt;
                  &lt;key-id-length&gt;
                  &lt;key-id&gt;?
                  &lt;ICV-data&gt;
           </artwork>
        </figure>

        <t>
          where:
          <list style="hanging">
            <t hangText="&lt;hash-function&gt;">
              is a one octet unsigned integer field specifying the hash function. 
            </t>
            <t hangText="&lt;cryptographic-function&gt;">
              is a one octet unsigned integer field specifying the cryptographic function.
            </t>
            <t hangText="&lt;key-id-length&gt;">
              is a one octet unsigned integer field specifying the length of the &lt;key-id&gt; field as a number of octets. The value zero (0x00) is reserved for using a single pre-installed, shared key.
            </t>
            <t hangText="&lt;key-id&gt;">
              is a field specifying the key identifier of the key that was used to calculate the ICV of the message, which allows unique identification of different keys with the same originator.  It is the responsibility of each key originator to make sure that actively used keys that it issues have distinct key identifiers. If &lt;key-id-length&gt; equals zero (0x00), the &lt;key-id&gt; field is not contained in the TLV, and a single pre-installed, shared key is used.
            </t>
            <t hangText="&lt;ICV-data&gt;">
              is a field with length &lt;length&gt;&nbsp;&nbhy;&nbsp;3&nbsp;&nbhy;&nbsp;&lt;key&nbhy;id&nbhy;length&gt; octets (except in a multivalue Address Block TLV, in which it is single&nbhy;length&nbsp;&nbhy;&nbsp;3&nbsp;&nbhy;&nbsp;&lt;key&nbhy;id&nbhy;length&gt; octets) and which contains the cryptographic ICV.
            </t>                
          </list>

          The version of this TLV, specified in this section, assumes that, unless otherwise specified, calculating the ICV can be decomposed into:
          <list style="hanging">
            <t>
              ICV-value = cryptographic-function(hash-function(content))
            </t>
          </list>
          In some cases a different combination of cryptographic function and hash function may be specified. This is the case for the HMAC function, which is specified as defined in <xref target="crypto-funcs"/>, using the hash function twice.
        </t>

        <t>
          The difference between the two type extensions is that in addition to the information covered by the ICV using type extension 1 (which is detailed in the following sections), the ICV using type extension 2 also MUST cover the source address of the IP datagram carrying the corresponding packet, message, or Address Block.
        </t>

        <t>
          The &lt;ICV-data&gt; field MAY be truncated after being calculated, this is indicated by its length, calculated as described above. The truncation SHOULD be as specified for the relevant cryptographic function (and, if appropriate, hash function). <!--Further guidelines about truncated ICVs are provided in Section 5 of <xref target="RFC2104"/>. -->
        </t>

        <t>
          The hash function and the cryptographic function correspond to the entries in two IANA registries, which are reported by this specification
and are described in <xref target="IANA"/>.
        </t>

        <section title="Rationale" anchor="rationale">
                
          <t>
            The rationale for separating the hash function and the cryptographic function into two octets instead of having all combinations in a single octet -- possibly as a TLV type extension -- is that adding further hash functions or cryptographic functions in the future may lead to a non-contiguous
number space, as well as providing a smaller overall space.
          </t>
                        
          <t>
            The rationale for not including a field that lists parameters of the cryptographic ICV in the TLV is that, before being able to validate a cryptographic ICV, routers have to exchange or acquire keys. Any additional parameters can be provided together with the keys in that bootstrap process. It is therefore not necessary, and would even entail an extra overhead, to transmit the parameters within every message.
          </t>

          <t>
            The rationale for the addition of type extension 2 is that the source code address is used in some cases, such as when processing HELLO messages in <xref target="RFC6130"/>. This is applicable only to packets (which only ever travel one hop) and messages (and their Address Blocks) that only travel one hop. It is not applicable to messages that may be forwarded more than one hop, such as TC messages in <xref target="OLSRv2"/>.
          </t>

        </section>

      </section>  

      <section title="Considerations for Calculating the ICV">

        <t>
          The considerations listed in the following subsections MUST be applied when calculating the ICV for Packet, Message, and Address Block TLVs,
respectively.
        </t>
         
        <section title="Packet ICV TLV">

          <t>
            When determining the &lt;ICV&nbhy;data&gt; for a packet, with type extension = 1:
            <list style="symbols">
              <t>
                The ICV is calculated over the fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;, &lt;key&nbhy;id&nbhy;length&gt;, and -- if present -- &lt;key&nbhy;id&gt; (in that order), followed by the entire packet, including the Packet Header, including all Packet TLVs (other than ICV Packet TLVs), and all included messages. The considerations of <xref target="packetICVTLV"/> MUST be applied. 
		  </t>
		</list>

		When determining the &lt;ICV&nbhy;data&gt; for a packet, with type extension = 2:
		<list style="symbols">
              <t>
		    The same procedure as for type extension = 1 is used, except that the data used consists of a representation of the source address of the IP datagram carrying the packet, followed by the remaining data (as for type extension = 1). The representation of the source address consists of a single octet containing the address length, in octets, followed by that many octets containing the address in network byte order.
		  </t>
		</list>
          </t>
     
        </section>
                 
        <section title="Message ICV TLV">

          <t>
            When determining the &lt;ICV&nbhy;data&gt; for a message, with type extension = 1:
            <list style="symbols">
              <t>
                The ICV is calculated over the fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;, &lt;key&nbhy;id&nbhy;length&gt;, and -- if present -- &lt;key-id&gt; (in that order), followed by the entire message. The considerations in <xref target="ICVTLV"/> MUST be applied.
		  </t>
		</list>
			
		When determining the &lt;ICV&nbhy;data&gt; for a message, with type extension = 2:
		<list style="symbols">
              <t>
		    The same procedure as for type extension = 1 is used, except that the data used consists of a representation of the source address of the IP datagram carrying the message, followed by the remaining data (as for type extension = 1). The representation of the source address consists of a single octet containing the address length, in octets, followed by that many octets containing the address in network byte order.
		  </t>
            </list>
          </t>

        </section>

        <section title="Address Block ICV TLV">

          <t>
            When determining the &lt;ICV&nbhy;data&gt; for one or more addresses, with type extension = 1:
            <list style="symbols">
              <t>
                The ICV is calculated over the fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;, &lt;key-id-length&gt;, and -- if present -- &lt;key-id&gt; (in that order), followed by the addresses, and followed by any other values -- for example, other address block TLV &lt;value&gt;s that are associated with those addresses. A MANET routing protocol, or MANET routing protocol extension, using ICV Address Block TLVs MUST specify how to include any such concatenated attribute of the addresses in the verification process of the ICV. The considerations in <xref target="addressblockICVTLV"/> MUST be applied.
              </t>
            </list>
            When determining the &lt;ICV&nbhy;data&gt; for one or more addresses, with type extension = 2:
            <list style="symbols">
              <t>
		    The same procedure as for type extension = 1 is used, except that the data used consists of a representation of the source address of the IP datagram carrying the Address Block, followed by the remaining data (as for type extension = 1). The representation of the source address consists of a single octet containing the address length, in octets, followed by that many octets containing the address in network byte order.
		  </t>
            </list>
        </t>

        </section>

      </section>
 
      <section title="Example of a Message Including an ICV">

        <t>
          The sample message depicted in <xref target="exampleMessage"/> is derived from Appendix D of <xref target="RFC5444"/>. The message contains
an ICV Message TLV, with the value representing an ICV that is 16 octets long of the whole message, and a key identifier that is 4 octets long. The type extension of the Message TLV is 1, for the specific decomposition of an ICV using a cryptographic function and a hash function, as specified in <xref target="decomposition"/>.
        </t>
        
        <figure anchor="exampleMessage" title="Example Message with ICV">
          <artwork>
   0                   1                   2                   3  
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | PV=0 |  PF=8  |    Packet Sequence Number     | Message Type  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | MF=15 | MAL=3 |      Message Length = 44      | Msg Orig Addr |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |       Message Originator Address (cont)       |   Hop Limit   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   Hop Count   |    Message Sequence Number    | Msg TLV Block |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Length = 27   |     ICV       |  MTLVF = 144  |  MTLVExt = 1  |  
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |Value Len = 23 |   Hash Func   |  Crypto Func  |Key ID length=4|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                          Key Identifier                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                          ICV Value                            |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                          ICV Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                          ICV Value (cont)                     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                          ICV Value (cont)                     |        
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
          </artwork>
        </figure>

      </section>

    </section>
    
    <section anchor="IANA" title="IANA Considerations">
    
      <t>
        This specification reports the following, originally specified in <xref target="RFC6622"/>:
        <list style="symbols">
          <t>
            Two Packet TLV Types, which have been allocated from the 0-223 range of the "Packet TLV Types" repository of <xref target="RFC5444"/>, as specified in <xref target="table_IANA_packet_TLV_types"/>.
          </t>
          <t>
            Two Message TLV Types, which have been allocated from the 0-127 range of the "Message TLV Types" repository of <xref
target="RFC5444"/>, as specified in <xref target="table_IANA_message_TLV_types"/>.
          </t>
          <t>
            Two Address Block TLV Types, which have been allocated from the 0-127 range of the "Address Block TLV Types" repository of <xref target="RFC5444"/>, as specified in <xref target="table_IANA_addressblock_TLV_types"/>.
          </t>
        </list>
                
        This specification updates the following, created in <xref target="RFC6622"/>:
        <list style="symbols">
          <t>
            A type extension registry for each of these TLV types with values as listed in Tables <xref target="table_IANA_packet_TLV_types" format="counter"/>, <xref target="table_IANA_message_TLV_types" format="counter"/>, and  <xref target="table_IANA_addressblock_TLV_types" format="counter"/>.
          </t>
        </list>    
      </t>

      <t>
        The following terms are used as defined in <xref target="BCP26"/>: "Namespace", "Registration", and "Designated Expert".
      </t>

      <t>
        The following policy is used as defined in <xref target="BCP26"/>: "Expert Review".
      </t>        
                
      <section title="Expert Review: Evaluation Guidelines">

        <t>
          For TLV type extensions registries where an Expert Review is required, the Designated Expert SHOULD take the same general recommendations into consideration as those specified by <xref target="RFC5444"/>.
       </t>
           
        <t>
          For both TIMESTAMP and ICV TLVs, functionally similar extensions for Packet, Message, and Address Block TLVs SHOULD be numbered identically.
        </t>

      </section>



      <section title="Packet TLV Types">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "Packet TLV Types" namespace of <xref target="RFC5444"/> for the Packet TLVs specified in <xref target="table_IANA_packet_TLV_types"/>. IANA is requested to modify this allocation as indicated.
        </t>


        <texttable anchor="table_IANA_packet_TLV_types" title="Packet TLV Types">
          <ttcol align='center'>Type</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          <c>5</c>
          <c>ICV</c>
          <c>RFC xxxx</c>
        
          <c>6</c>
          <c>TIMESTAMP</c>
          <c>RFC xxxx</c>
          
        </texttable>
      </section>
      
      
      <section title="Message TLV Types">
        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "Message TLV Types" namespace of <xref target="RFC5444"/> for the Message TLVs specified in <xref target="table_IANA_message_TLV_types"/>. IANA is requested to modify this allocation as indicated.
        </t>
                
        <texttable anchor="table_IANA_message_TLV_types" title="Message TLV Types">
          <ttcol align='center'>Type</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>

          <c>5</c>
          <c>ICV</c>
          <c>RFC xxxx</c>

          <c>6</c>        
          <c>TIMESTAMP</c>
          <c>RFC xxxx</c>
        </texttable>

      </section>
      
      <section title="Address Block TLV Types">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "Address Block TLV Types" namespace of <xref target="RFC5444"/> for the Packet TLVs specified in <xref target="table_IANA_addressblock_TLV_types"/>. IANA is requested to modify this allocation as indicated.
        </t>
                
        <texttable anchor="table_IANA_addressblock_TLV_types" title="Address Block TLV Types">
          <ttcol align='center'>Type</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
         
          <c>5</c>
          <c>ICV</c>
          <c>RFC xxxx</c>
        
          <c>6</c>
          <c>TIMESTAMP</c>
          <c>RFC xxxx</c>
        </texttable>
      </section>

	<section title="ICV Packet TLV Type Extensions">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "ICV Packet TLV Type Extensions" namespace of <xref target="RFC6622"/> for the Packet TLVs specified in <xref target="table_IANA_ICV_packet_TLV_type_extensions"/>. IANA is requested to modify this allocation (including defining type extension = 2) as indicated.
        </t>

        <texttable anchor="table_IANA_ICV_packet_TLV_type_extensions" title="ICV Packet TLV Type Extensions">
          <ttcol align='center'>Type Extension</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          <c>0</c>
          <c>ICV of a packet</c>
          <c>RFC xxxx</c>
         
          <c>1</c>
          <c>ICV, using a cryptographic function and a hash function, as specified in <xref target="decomposition"/> of this document</c>
          <c>RFC xxxx</c>

          <c>2</c>
          <c>ICV, using a cryptographic function and a hash function, and including the IP datagram source address, as specified in <xref target="decomposition"/> of this document</c>
          <c>RFC xxxx</c>

          <c>3-251</c>
          <c>Unassigned; Expert Review</c>
          <c></c>
          
          <c>252-255</c>
          <c>Experimental Use</c>
          <c>RFC xxxx</c>
          
    	  </texttable>
    	
    	  <t>
          More than one ICV Packet TLV with the same type extension MAY be included in a packet if these represent different ICV calculations (e.g., with type extension 1 or 2 and different cryptographic function and/or hash function, or with a different key identifier). ICV Packet TLVs that carry what is declared to be the same information MUST NOT be included in the same packet.
        </t>
        
	</section>

    <section title="TIMESTAMP Packet TLV Type Extensions">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "TIMESTAMP Packet TLV Type Extensions" namespace of <xref target="RFC6622"/> for the Packet TLVs specified in <xref target="table_IANA_TIMESTAMP_packet_TLV_type_extensions"/>. IANA is requested to modify this allocation as indicated.
        </t>

        <t>
          <vspace blankLines="999"/>
        </t>

        <texttable anchor="table_IANA_TIMESTAMP_packet_TLV_type_extensions" title="TIMESTAMP Packet TLV Type Extensions">
          <ttcol align='center'>Type Extension</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          <c>0</c>
          <c>Unsigned timestamp of arbitrary length, given by the TLV Length field.&nbsp; The MANET routing protocol has to define how to interpret this timestamp</c>
          <c>RFC xxxx</c>
          
          <c>1</c>
          <c>Unsigned 32-bit timestamp, as specified in <xref target="IEEE 1003.1-2008 (POSIX)"/></c>
          <c>RFC xxxx</c>
          
          <c>2</c>
          <c>NTP timestamp format, as specified in <xref target="RFC5905"/></c>
          <c>RFC xxxx</c>
          
          <c>3</c>
          <c>Signed timestamp of arbitrary length with no constraints such as monotonicity.&nbsp; In particular, it may represent any random value</c>
		  <c>RFC xxxx</c>
		  
          <c>4-251</c>
          <c>Unassigned; Expert Review</c>
          <c></c>
          
          <c>252-255</c>
          <c>Experimental Use</c>
          <c>RFC xxxx</c>
          
    	  </texttable>
    	
    	  <t>
          More than one TIMESTAMP Packet TLV with the same type extension MUST NOT be included in a packet.
        </t>

	</section>
          
	<section title="ICV Message TLV Type Extensions">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "ICV Message TLV Type Extensions" namespace of <xref target="RFC6622"/> for the Message TLVs specified in <xref target="table_IANA_ICV_message_TLV_type_extensions"/>. IANA is requested to modify this allocation (including defining type extension = 2) as indicated.
        </t>

        <texttable anchor="table_IANA_ICV_message_TLV_type_extensions" title="ICV Message TLV Type Extensions">
          <ttcol align='center'>Type Extension</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          <c>0</c>
          <c>ICV of a message</c>
          <c>RFC xxxx</c>
         
          <c>1</c>
          <c>ICV, using a cryptographic function and a hash function, as specified in <xref target="decomposition"/> of this document</c>
          <c>RFC xxxx</c>

          <c>2</c>
          <c>ICV, using a cryptographic function and a hash function, and including the IP datagram source address, as specified in <xref target="decomposition"/> of this document</c>
          <c>RFC xxxx</c>

          <c>3-251</c>
          <c>Unassigned; Expert Review</c>
          <c></c>
          
          <c>252-255</c>
          <c>Experimental Use</c>
          <c>RFC xxxx</c>
          
    	  </texttable>
    	
    	  <t>
          More than one ICV Message TLV with the same type extension MAY be included in a message if these represent different ICV calculations (e.g., with type extension 1 or 2 and different cryptographic function and/or hash function, or with a different key identifier). ICV Message TLVs that carry what is declared to be the same information MUST NOT be included in the same message.
        </t>
        
	</section>

    <section title="TIMESTAMP Message TLV Type Extensions">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "TIMESTAMP Message TLV Type Extensions" namespace of <xref target="RFC6622"/> for the Message TLVs specified in <xref target="table_IANA_TIMESTAMP_message_TLV_type_extensions"/>. IANA is requested to modify this allocation as indicated.
        </t>
        
        <texttable anchor="table_IANA_TIMESTAMP_message_TLV_type_extensions" title="TIMESTAMP Message TLV Type Extensions">
          <ttcol align='center'>Type Extension</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          <c>0</c>
          <c>Unsigned timestamp of arbitrary length, given by the TLV Length field.&nbsp; The MANET routing protocol has to define how to interpret this timestamp</c>
          <c>RFC xxxx</c>
          
          <c>1</c>
          <c>Unsigned 32-bit timestamp, as specified in <xref target="IEEE 1003.1-2008 (POSIX)"/></c>
          <c>RFC xxxx</c>
          
          <c>2</c>
          <c>NTP timestamp format, as specified in <xref target="RFC5905"/></c>
          <c>RFC xxxx</c>
          
          <c>3</c>
          <c>Signed timestamp of arbitrary length with no constraints such as monotonicity.&nbsp; In particular, it may represent any random value</c>
		  <c>RFC xxxx</c>
		  
          <c>4-251</c>
          <c>Unassigned; Expert Review</c>
          <c></c>
          
          <c>252-255</c>
          <c>Experimental Use</c>
          <c>RFC xxxx</c>
          
    	  </texttable>
    	
    	  <t>
          More than one TIMESTAMP Message TLV with the same type extension MUST NOT be included in a message.
        </t>

	</section>     

	<section title="ICV Address Block TLV Type Extensions">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "ICV Address Block TLV Type Extensions" namespace of <xref target="RFC6622"/> for the Address Block TLVs specified in <xref target="table_IANA_ICV_address_block_TLV_type_extensions"/>. IANA is requested to modify this allocation (including defining type extension = 2) as indicated.
        </t>

        <texttable anchor="table_IANA_ICV_address_block_TLV_type_extensions" title="ICV Address Block TLV Type Extensions">
          <ttcol align='center'>Type Extension</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          <c>0</c>
          <c>ICV of an object (e.g., an address)</c>
          <c>RFC xxxx</c>
         
          <c>1</c>
          <c>ICV, using a cryptographic function and a hash function, as specified in <xref target="decomposition"/> of this document</c>
          <c>RFC xxxx</c>

          <c>2</c>
          <c>ICV, using a cryptographic function and a hash function, and including the IP datagram source address, as specified in <xref target="decomposition"/> of this document</c>
          <c>RFC xxxx</c>

          <c>3-251</c>
          <c>Unassigned; Expert Review</c>
          <c></c>
          
          <c>252-255</c>
          <c>Experimental Use</c>
          <c>RFC xxxx</c>
          
    	  </texttable>
    	
    	  <t>
          More than one ICV Address Block TLV with the same type extension MAY be associate with an address if these represent different ICV calculations (e.g., with type extension 1 or 2 and different cryptographic function and/or hash function, or with a different key identifier). ICV Address Block TLVs that carry what is declared to be the same information MUST NOT be associated with the same address.
        </t>
        
	</section>

    <section title="TIMESTAMP Address Block TLV Type Extensions">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, made allocations from the "TIMESTAMP Address Block TLV Type Extensions" namespace of <xref target="RFC6622"/> for the Address Block TLVs specified in <xref target="table_IANA_TIMESTAMP_address_block_TLV_type_extensions"/>. IANA is requested to modify this allocation as indicated.
        </t>

        <t>
          <vspace blankLines="999"/>
        </t>

        <texttable anchor="table_IANA_TIMESTAMP_address_block_TLV_type_extensions" title="TIMESTAMP Address Block TLV Type Extensions">
          <ttcol align='center'>Type Extension</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          <c>0</c>
          <c>Unsigned timestamp of arbitrary length, given by the TLV Length field.&nbsp; The MANET routing protocol has to define how to interpret this timestamp</c>
          <c>RFC xxxx</c>
          
          <c>1</c>
          <c>Unsigned 32-bit timestamp, as specified in <xref target="IEEE 1003.1-2008 (POSIX)"/></c>
          <c>RFC xxxx</c>
          
          <c>2</c>
          <c>NTP timestamp format, as specified in <xref target="RFC5905"/></c>
          <c>RFC xxxx</c>
          
          <c>3</c>
          <c>Signed timestamp of arbitrary length with no constraints such as monotonicity.&nbsp; In particular, it may represent any random value</c>
		  <c>RFC xxxx</c>
		  
          <c>4-251</c>
          <c>Unassigned; Expert Review</c>
          <c></c>
          
          <c>252-255</c>
          <c>Experimental Use</c>
          <c>RFC xxxx</c>
          
    	  </texttable>
    	
    	  <t>
           More than one TIMESTAMP Address Block TLV with the same type extension MUST NOT be associated with any address.
        </t>

	</section>   

      <section title="Hash Functions">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, created a registry for hash functions that can be used when creating an ICV, as specified in <xref target="decomposition"/> of this document. The initial assignments and allocation policies are specified in <xref target="table_hash_registry"/>. IANA is requested to modify this allocation as indicated.
        </t>

        <t>
          <vspace blankLines="999"/>
        </t>

        <texttable anchor="table_hash_registry" title="Hash Function Registry">
          <ttcol align='center'>Value</ttcol>
          <ttcol align='center'>Algorithm</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          <c>0</c>
          <c>none</c>
          <c>The "identity function": The hash value of an object is the object itself</c>
          <c>RFC xxxx</c>
          
          <c>1</c>
          <c>SHA-1</c>
          <c><xref target="NIST-FIPS-180-4"/></c>
          <c>RFC xxxx</c>
       
          <c>2</c>
          <c>SHA-224</c>
          <c><xref target="NIST-FIPS-180-4"/></c>
          <c>RFC xxxx</c>
       
          <c>3</c>
          <c>SHA-256</c>
          <c><xref target="NIST-FIPS-180-4"/></c>
          <c>RFC xxxx</c>
       
          <c>4</c>
          <c>SHA-384</c>
          <c><xref target="NIST-FIPS-180-4"/></c>
          <c>RFC xxxx</c>
       
          <c>5</c>
          <c>SHA-512</c>
          <c><xref target="NIST-FIPS-180-4"/></c>
          <c>RFC xxxx</c>
       
          <c>6-251</c>
          <c></c>
          <c>Unassigned; Expert Review</c>
          <c></c>
          
          <c>252-255</c>
          <c></c>
          <c>Experimental Use</c>
          <c>RFC xxxx</c>
        </texttable>

      </section>

      <section title="Cryptographic Functions" anchor="crypto-funcs">

        <t>
          IANA has, in accordance with <xref target="RFC6622"/>, created a registry for the cryptographic functions, as specified in <xref target="decomposition"/> of this document. Initial assignments and allocation policies are specified in <xref target="table_cryptographic_registry"/>. IANA is requested to modify this allocation as indicated.
        </t>

        <texttable anchor="table_cryptographic_registry" title="Cryptographic Function Registry">
          <ttcol align='center'>Value</ttcol>
          <ttcol align='center'>Algorithm</ttcol>
          <ttcol align='center'>Description</ttcol>
          <ttcol align='center'>Reference</ttcol>
          
          <c>0</c>
          <c>none</c>
          <c>The "identity function": The value of an encrypted hash is the hash itself</c>
          <c>RFC xxxx</c>
          
          <c>1</c>
          <c>RSA</c>
          <c><xref target="RFC3447"/></c>
          <c>RFC xxxx</c>
          
          <c>2</c>
          <c>DSA</c>
          <c><xref target="NIST-FIPS-186-3"/></c>
          <c>RFC xxxx</c>
       
          <c>3</c>
          <c>HMAC</c>
          <c><xref target="RFC2104"/></c>
          <c>RFC xxxx</c>
        
          <c>4</c>
          <c>3DES</c>
          <c><xref target="NIST-SP-800-67"/></c>
          <c>RFC xxxx</c>
        
          <c>5</c>
          <c>AES-128</c>
          <c><xref target="NIST-FIPS-197"/></c>
          <c>RFC xxxx</c>

          <c>6</c>
          <c>ECDSA</c>
          <c><xref target="ANSI-X9-62-2005"/></c>
          <c>RFC xxxx</c>
        
          <c>7-251</c>
          <c></c>
          <c>Unassigned; Expert Review</c>
          <c></c>
          
          <c>252-255</c>
          <c></c>
          <c>Experimental Use</c>
          <c>RFC xxxx</c>
        </texttable>

      </section>

    </section>

    <section anchor="Security" title="Security Considerations">

      <t>
        This document does not specify a protocol. It provides a syntactical component for cryptographic ICVs of messages and packets, as defined in <xref target="RFC5444"/>. It can be used to address security issues of a MANET routing protocol or MANET routing protocol extension. As such, it has the same security considerations as <xref target="RFC5444"/>.
      </t>
              
      <t>
       In addition, a MANET routing protocol or MANET routing protocol extension that uses this specification MUST specify how to use the framework, and the TLVs presented in this document.  In addition, the protection that the MANET routing protocol or MANET routing protocol extensions attain by using this framework MUST be described.
      </t>

      <t>
       As an example, a MANET routing protocol that uses this component to reject "badly formed" or "insecure" messages if a control message does not contain a valid ICV SHOULD indicate the security assumption that if the ICV is valid, the message is considered valid. It also SHOULD indicate the security issues that are counteracted by this measure (e.g., link or identity spoofing) as well as the issues that are not counteracted (e.g., compromised keys). 
      </t>

    </section>

    <section anchor="Acknowledgements" title="Acknowledgements">

      <t>
        The authors would like to thank Bo Berry (Cisco), Alan Cullen (BAE Systems), Justin Dean (NRL), Paul Lambert (Marvell), Jerome Milan (Ecole Polytechnique), and Henning Rogge (FGAN) for their constructive comments on <xref target="RFC6622"/>.
      </t>

      <t>
        The authors also appreciate the detailed reviews of <xref target="RFC6622"/> from the Area Directors, in particular Stewart Bryant (Cisco), Stephen Farrell (Trinity College Dublin), and Robert Sparks (Tekelec), as well as Donald Eastlake (Huawei) from the Security Directorate.
      </t>

      <t>
        The authors would like to thank Justin Dean (NRL) and Henning Rogge (FGAN) for their constructive comments on this specification.
      </t>

    </section>

  </middle>

  <back>

    <references title="Normative References">

      <reference anchor="BCP26">
        <front>
          <title abbrev="foo">Guidelines for Writing an IANA Considerations Section in RFCs</title>
          <author initials="T." surname="Narten" fullname="Thomas Narten">
          </author>
          <author initials="H." surname="Alvestrand" fullname="H Alvestrand">
          </author>
          <date month="May" year="2008" />
        </front>
        <seriesInfo name="BCP" value="26" />
        <seriesInfo name="RFC" value="5226" />
      </reference>

      <reference anchor="RFC2119">
        <front>
          <title abbrev="foo">Key words for use in RFCs to Indicate Requirement Levels</title>
          <author initials="S." surname="Bradner" fullname="Scott Bradner">
          </author>
          <date month="March" year="1997" />
        </front>
        <seriesInfo name="BCP" value="14" />
        <seriesInfo name="RFC" value="2119" />
      </reference>
  
      <reference anchor="RFC5444">
        <front>
          <title abbrev="RFC5444">Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format</title>
            <author initials="T.H." surname="Clausen" fullname="Thomas Heide Clausen">
            </author>
            <author initials="C.M." surname="Dearlove" fullname="Christopher Dearlove">
            </author>
            <author initials="J.W." surname="Dean" fullname="Justin W. Dean">
            </author>
            <author initials="C." surname="Adjih" fullname="Cedric Adjih">
            </author>
            <date month="February" year="2009" />
          </front>
          <seriesInfo name="RFC" value="5444"/>
        </reference>

        <reference anchor='RFC5905'>
          <front>
            <title>Network Time Protocol Version 4: Protocol and Algorithms Specification</title>
            <author initials='D.' surname='Mills' fullname='D. Mills'>
              <organization />
            </author>
            <author initials='J.' surname='Martin' fullname='J. Martin' role="editor">
              <organization />
            </author>
            <author initials='J.' surname='Burbank' fullname='J. Burbank'>
              <organization />
            </author>
            <author initials='W.' surname='Kasch' fullname='W. Kasch'>
              <organization />
            </author>
            <date year='2010' month='June' />
          </front>
        <seriesInfo name='RFC' value='5905' />
      </reference>

      <reference anchor='RFC3447'>
        <front>
          <title abbrev='PKCS #1'>Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</title>
          <author initials='J.' surname='Jonsson' fullname='Jakob Jonsson'>
          </author>
          <author initials='B.' surname='Kaliski' fullname='Burt Kaliski'>
          </author>
          <date year='2003' month='February' />
        </front>
        <seriesInfo name='RFC' value='3447' />
      </reference>

      <reference anchor='RFC2104'>
        <front>
          <title abbrev='HMAC'>HMAC: Keyed-Hashing for Message Authentication</title>
          <author initials='H.' surname='Krawczyk' fullname='Hugo Krawczyk'>
          </author>
          <author initials='M.' surname='Bellare' fullname='Mihir Bellare'>
          </author>
          <author initials='R.' surname='Canetti' fullname='Ran Canetti'>
          </author>
          <date year='1997' month='February' />
        </front>        
        <seriesInfo name='RFC' value='2104' />
       </reference>

      <reference anchor="NIST-FIPS-197">
        <front>
          <title>Specification for the Advanced Encryption Standard (AES)</title>
          <author initials="" surname="National Institute of Standards and Technology" fullname="">
          </author>
          <date month="November" year="2001"/>
        </front>
        <seriesInfo name="FIPS" value="197" />
      </reference>

      <reference anchor="NIST-FIPS-186-3">
        <front>
          <title>Digital Signature Standard (DSS)</title>
          <author initials="" surname="National Institute of Standards and Technology" fullname="">
          </author>
          <date month="June" year="2009"/>
        </front>
        <seriesInfo name="FIPS" value="186-3" />
      </reference>
  
      <reference anchor="ANSI-X9-62-2005">
        <front>
          <title>Public Key Cryptography for the Financial Services Industry: The Elliptic Curve Digital Signature Algorithm (ECDSA)</title>
          <author initials="" surname="American National Standards Institute" fullname="">
          </author>
          <date month="November" year="2005"/>
        </front>
        <seriesInfo name="ANSI" value="X9.62-2005" />
      </reference>

      <reference anchor="NIST-SP-800-67">
        <front>
          <title>Recommendation for the Triple Data Encryption Algorithm (TDEA) Block Cipher</title>
          <author initials="" surname="National Institute of Standards and Technology" fullname="">
          </author>
          <date month="January" year="2012"/>
        </front>
        <seriesInfo name="Special Publication" value="800-67, Revision 1" />
      </reference>

      <reference anchor="NIST-FIPS-180-4">
        <front>
          <title>Secure Hash Standard (SHS)</title>
          <author initials="" surname="National Institute of Standards and Technology" fullname="">
          </author>
          <date month="March" year="2012"/>
        </front>
         <seriesInfo name="FIPS" value="180-4" />
      </reference>
  
      <reference anchor="IEEE 1003.1-2008 (POSIX)">
        <front>
          <title>1003.1-2008 Standard for Information Technology - Portable Operating System Interface (POSIX) Base Specifications, Issue 7</title>
          <author initials="" surname="IEEE Computer Society" fullname="">
          </author>
          <date month="December" year="2008"/>
        </front>
      </reference>
    
    </references>

    <references title="Informative References">

      <reference anchor='RFC6130'>
        <front>
          <title>Mobile Ad Hoc Network (MANET) Neighborhood Discovery Protocol (NHDP)</title>
          <author initials='T.' surname='Clausen' fullname='T. Clausen'>
            <organization />
          </author>
          <author initials='C.' surname='Dearlove' fullname='C. Dearlove'>
            <organization />
          </author>
          <author initials='J.' surname='Dean' fullname='J. Dean'>
            <organization />
          </author>
          <date year='2011' month='April'/>
        </front>
        <seriesInfo name='RFC' value='6130' />
      </reference>

	<reference anchor="RFC6622">
	  <front>
	    <title>Integrity Check Value and Timestamp TLV Definitions for Mobile Ad Hoc Networks (MANETs)</title>
	    <author fullname="Ulrich Herberg" initials="U" surname="Herberg">
	      <organization>Fujitsu Laboratories of America</organization>
	    </author>
          <author fullname="Thomas Heide Clausen" initials="T" surname="Clausen">
		<organization>LIX, Ecole Polytechnique</organization>
	    </author>
          <date year="2012" month="May"/>
        </front>
        <seriesInfo name="RFC" value="6622"/>
      </reference>
			
      <reference anchor="OLSRv2">
        <front>
          <title>The Optimized Link State Routing Protocol version 2</title>
          <author initials="T.H." surname="Clausen" fullname="Thomas Heide Clausen">
          </author>
          <author initials="C.M." surname="Dearlove" fullname="Christopher Dearlove">
          </author>
          <author initials="P." surname="Jacquet" fullname="Philippe Jacquet">
          </author>
          <author initials="U." surname="Herberg" fullname="Ulrich Herberg">
          </author>
          <date month="March" year="2013"/>
        </front>
        <seriesInfo name="work in progress" value="draft-ietf-manet-olsrv2-19" />
      </reference>

    </references>

  </back>

</rfc>
