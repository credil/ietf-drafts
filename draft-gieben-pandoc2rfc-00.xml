<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY pandocAbstract PUBLIC "" "abstract.xml">
<!ENTITY pandocMiddle PUBLIC "" "middle.xml">
<!ENTITY pandocBack PUBLIC "" "back.xml">
<!ENTITY ref.Markdown PUBLIC "" "bib/reference.Markdown.xml">
<!ENTITY ref.Pandoc PUBLIC "" "bib/reference.Pandoc.xml">
<!ENTITY ref.xslt PUBLIC "" "bib/reference.XSLT.xml">
<!ENTITY ref.Pandoc2rfc PUBLIC "" "bib/reference.Pandoc2rfc.xml">
<!ENTITY rfc.2629 PUBLIC "" "bib/reference.RFC.2629.xml">
<!ENTITY w3c.xslt PUBLIC "" "bib/reference.W3C.REC-xslt-19991116.xml">
]>
<rfc ipr="trust200902" category="info" docName="draft-gieben-pandoc2rfc-00" obsoletes="" updates="" submissionType="IETF" xml:lang="en">
  <?rfc toc="yes"?>
  <!--generate a table of contents -->
  <?rfc symrefs="yes"?>
  <!--use anchors instead of numbers for references -->
  <?rfc sortrefs="yes" ?>
  <!--alphabetize the references -->
  <?rfc compact="yes" ?>
  <!--conserve vertical whitespace -->
  <?rfc subcompact="no" ?>
  <!--but keep a blank line between list items -->
  <front>
    <title abbrev="Pandoc2rfc">Writing I-Ds and RFCs using Pandoc</title>
    <author initials="R." surname="Gieben" fullname="R. (Miek) Gieben">
      <organization>SIDN Labs</organization>
      <address>
        <!--<postal> <street>123 Buckingham Palace Road</street> <street></street> <city>London</city> <region></region> <code>SW1W 9SH</code> <country>UK</country> </postal> -->
        <phone/>
        <email>miek@miek.nl</email>
        <uri>http://miek.nl/</uri>
      </address>
    </author>
    <date month="January" year="2013"/>
    <area>General</area>
    <workgroup>RFC Beautification Working Group</workgroup>
    <keyword>RFC</keyword>
    <keyword>Request for Comments</keyword>
    <keyword>I-D</keyword>
    <keyword>Internet-Draft</keyword>
    <keyword>XML</keyword>
    <keyword>Pandoc</keyword>
    <keyword>Extensible Markup Language</keyword>
    <abstract><!--This document was prepared using Pandoc2rfc --><!--https://github.com/miekg/pandoc2rfc --><t>This document presents a technique for using Pandoc syntax as a source format for documents in the Internet-Drafts (I-Ds) and Request for Comments (RFC) series.  </t> </abstract>
  </front>
  <middle><!--This document was prepared using Pandoc2rfc --><!--https://github.com/miekg/pandoc2rfc --><section title="Introduction" anchor="introduction" toc="default"><t>This document presents a technique for using Pandoc syntax as a source format for documents in the Internet-Drafts (I-Ds) and Request for Comments (RFC) series.  </t><t>Pandoc <xref target="Pandoc" pageno="false" format="default"/> is an "almost plain text" format and therefor particularly well suited for editing RFC-like documents. The syntax itself is a superset of the syntax championed by Markdown <xref target="Markdown" pageno="false" format="default"/>.  </t><t>Pandoc2rfc generates XML compatible with <xref target="RFC2629" pageno="false" format="default"/>.  </t></section><section title="Pandoc to RFC" anchor="pandoc-to-rfc" toc="default"><t>During the last few years people have been developing markup languages that are very easy to remember and type. These languages have become known as <spanx style="verb" xml:space="preserve">almost plain text</spanx>-markup languages. One of the first was the Markdown (<xref target="Markdown" pageno="false" format="default"/>) syntax. One that was developed later and incorporates Markdown syntax and a number of extensions is Pandoc (<xref target="Pandoc" pageno="false" format="default"/>). The power of Pandoc comes from the fact that it can be translated to numerous output formats, including, but not limited to: HTML, (plain) Markdown and <spanx style="verb" xml:space="preserve">docbook</spanx> XML.  </t><t>Pandoc2rfc allows authors to write in (the simple) Pandoc syntax which is then transformed to XML and given to xml2rfc. The conversions are, in some way amusing, as we start off with (almost) plain text, use elaborate XML and end up with plain text again.  </t><figure anchor="fig:attempt-to" align="center" title="" suppress-title="false" alt="" width="" height=""><artwork xml:space="preserve" name="" type="" align="left" alt="" width="" height="">
+-------------------+   pandoc   +---------+  
| ALMOST PLAIN TEXT |   ------&gt;  | DOCBOOK |  
+-------------------+            +---------+  
              |                       |
non-existent  |                       | xsltproc
  faster way  |                       |
              v                       v
      +------------+    xml2rfc  +---------+ 
      | PLAIN TEXT |  &lt;--------  |   XML   | 
      +------------+             +---------+ 
</artwork><postamble>Attempt to justify Pandoc2rfc.  </postamble></figure><t>The XML generated (the output after the <spanx style="verb" xml:space="preserve">xsltproc</spanx> step in <xref target="fig:attempt-to" pageno="false" format="default"/>) is suitable for inclusion in either the <spanx style="verb" xml:space="preserve">middle</spanx> or <spanx style="verb" xml:space="preserve">back</spanx> section of an RFC.  </t><t>Even though Pandoc2rfc abstracts away a lot of XML details, there are still a few places left where some XML needs to be edited. Most notably in the <spanx style="verb" xml:space="preserve">front</spanx> section of an RFC.  </t><t>The simplest way to start is to create a template XML file and include the appropriate XML for this <spanx style="verb" xml:space="preserve">front</spanx> section: </t><figure anchor="fig:a-very-min" align="center" title="" suppress-title="false" alt="" width="" height=""><artwork xml:space="preserve" name="" type="" align="left" alt="" width="" height="">
&lt;?xml version='1.0' ?&gt;
&lt;!DOCTYPE rfc SYSTEM 'rfc2629.dtd' [
&lt;!ENTITY pandocMiddle PUBLIC '' 'middle.xml'&gt;
&lt;!ENTITY pandocBack   PUBLIC '' 'back.xml'&gt;
&lt;!ENTITY rfc.2629     PUBLIC '' 'reference.RFC.2629.xml'&gt;
]&gt;

&lt;rfc ipr='trust200902' docName='draft-gieben-pandoc2rfc-00'&gt;
 &lt;front&gt;
    &lt;title&gt;Writing I-Ds and RFCs using Pandoc&lt;/title&gt;
&lt;/front&gt;
&lt;middle&gt;
    &amp;pandocMiddle;
&lt;/middle&gt;
&lt;back&gt;
    &lt;references title="Normative References"&gt;
            &amp;rfc.2629;
    &lt;/references&gt;
    &amp;pandocBack;
&lt;/back&gt;

&lt;/rfc&gt;
</artwork><postamble>A very minimal template.xml.  </postamble></figure><t>In this case you need to edit three documents: </t><t><list style="numbers"><t>middle.txt - contains the main body of text; </t><t>back.txt - holds appendices; </t><t>this template.xml - probably a fairly static file, but it also holds the references.  </t></list></t><t>The up to date source code for Pandoc2rfc can be found at <xref target="Pandoc2rfc" pageno="false" format="default"/>, this includes the stylesheet <spanx style="verb" xml:space="preserve">transform.xsl</spanx> used for the transformation.  </t><section title="Dependencies" anchor="dependencies" toc="default"><t>Pandoc2rfc needs <spanx style="verb" xml:space="preserve">xsltproc</spanx> <xref target="XSLT" pageno="false" format="default"/> and <spanx style="verb" xml:space="preserve">pandoc</spanx> <xref target="Pandoc" pageno="false" format="default"/> to be installed. When using the template from <xref target="fig:a-very-min" pageno="false" format="default"/> xml2rfc version 2 needs to be used.  </t><t>The conversion is done with a stylesheet based on XSLT version 1.0 <xref target="W3C.REC-xslt-19991116" pageno="false" format="default"/>.  </t></section></section><section title="Building an Internet-Draft" anchor="building-an-internet-draft" toc="default"><t>Assuming the setup from <xref target="pandoc-to-rfc" pageno="false" format="default"/>, we can build an I-D as follows (in a Unix-like environment): </t><figure anchor="fig:building-a" align="center" title="" suppress-title="false" alt="" width="" height=""><artwork xml:space="preserve" name="" type="" align="left" alt="" width="" height="">
pandoc -t docbook -s middle.txt | xsltproc \
    --nonet transform.xsl - &gt; middle.xml
pandoc -t docbook -s back.txt | xsltproc \
    --nonet transform.xsl - &gt; back.xml

# Create text output
xml2rfc template.xml -f draft.txt --text    

# ... or create HTML output
xml2rfc template.xml -f draft.html --html    

# ... or create (self-contained) XML output
xml2rfc template.xml -f draft.xml --exp
</artwork><postamble>Building an I-D with Pandoc2rfc.  </postamble></figure><t>The <spanx style="verb" xml:space="preserve">draft.txt</spanx> and <spanx style="verb" xml:space="preserve">draft.xml</spanx> are then ready to be uploaded to the I-D tracker.  </t></section><section title="Supported Features" anchor="supported-features" toc="default"><t>Almost everything xml2rfc can do is supported, see <xref target="tab:the-most-i" pageno="false" format="default"/> in <xref target="cheat-sheet" pageno="false" format="default"/> for a "cheat sheet".  </t><t><list style="symbols"><t>Sections with an anchor and title attributes </t><t>Lists <list style="symbols"><t>style=symbols, use "* " for each item; </t><t>style=numbers, use a digit "1. " for each item; </t><t>style=empty, use "#. " for each item; </t><t>style=format %i, use roman lowercase numerals: "ii. "; </t><t>style=format (%d), use roman uppercase numerals "II. "; </t><t>style=letters, use lower- or uppercase letters: "a.  " and "A.  " (note: two spaces); </t><t>style=hanging, use the Pandoc definition list syntax; </t></list> </t><t>Spanx style=verb, style=emph and style=strong, respectively use: <spanx style="verb" xml:space="preserve">`text`</spanx>, <spanx style="verb" xml:space="preserve">_text_</spanx> or <spanx style="verb" xml:space="preserve">**text**</spanx>; </t><t>Block quote - not supported by xml2rfc, so this is converted to <spanx style="verb" xml:space="preserve">&lt;list style="hanging"&gt;</spanx> paragraph; </t><t>Figure/artwork with an anchor and postamble (<xref target="figureartwork" pageno="false" format="default"/>); </t><t>Tables with an anchor and postamble (<xref target="tables" pageno="false" format="default"/>); </t><t>References (<xref target="references" pageno="false" format="default"/>) <list style="symbols"><t>external (eref); </t><t>internal (xref): <list style="symbols"><t>section (handled by Pandoc); </t><t>figures (handled by XSLT); </t><t>tables (handled by XSLT).  </t></list> </t></list> </t><t>Citations, by using internal references; </t><t>Indexes, by (ab)using footnotes (<xref target="indexes" pageno="false" format="default"/>).  </t></list></t></section><section title="Unsupported Features" anchor="unsupported-features" toc="default"><t><list style="symbols"><t>Pandoc markup in the caption for figures/artwork. Pandoc markup for table captions <spanx style="emph" xml:space="preserve">is</spanx> supported; </t><t>crefs: for comments, but you can use HTML comments: <spanx style="verb" xml:space="preserve">&lt;!-- ... --&gt;</spanx>; </t><t>preamble in figures and tables.  </t></list></t></section><section title="Acknowledgements" anchor="acknowledgements" toc="default"><t>The following people have helped shape Pandoc2rfc: Benno Overeinder, Erlend Hamnaberg, Matthijs Mekking and Trygve Laugstøl.  </t><t>This document was prepared using Pandoc2rfc.  </t></section><section title="Pandoc Style" anchor="pandoc-style" toc="default"><t>In some cases the Pandoc syntax is slightly misused to get the desired output, in the following paragraphs we will detail these.  Also the meta data features of Pandoc are not used in Pandoc2rfc.  </t><section title="Figure/Artwork" anchor="figureartwork" toc="default"><t>Indent the paragraph with 4 spaces as mandated by Pandoc. Note that xml2rfc supports a caption with <spanx style="verb" xml:space="preserve">&lt;artwork&gt;</spanx>. If you add a <spanx style="verb" xml:space="preserve">Figure: some text</spanx> as the last line, the artwork gets a <spanx style="verb" xml:space="preserve">&lt;postamble&gt;</spanx> with the text after "Figure: ". It will also be possible to reference the artwork. If a caption is supplied the artwork will be centered on the page.  </t></section><section title="Tables" anchor="tables" toc="default"><t>A table can be entered by using Pandoc's table syntax. All tables are translated to a <spanx style="verb" xml:space="preserve">&lt;texttable&gt;</spanx> element in xml2rfc. You can choose multiple styles as input, but they all are converted to the same style (plain <spanx style="verb" xml:space="preserve">&lt;texttable&gt;</spanx>) table in xml2rfc.  </t><t>The table caption is <spanx style="emph" xml:space="preserve">always</spanx> translated to a <spanx style="verb" xml:space="preserve">&lt;postamble&gt;</spanx>. The <spanx style="verb" xml:space="preserve">&lt;preamble&gt;</spanx> tag isn't supported. If a table has a caption, it will also be possible to reference the table.  </t></section><section title="References" anchor="references" toc="default"><t>Any reference like: <spanx style="verb" xml:space="preserve">[Click here](URI)</spanx>, is an external reference and it converted to an <spanx style="verb" xml:space="preserve">&lt;ulink&gt;</spanx>. An internal (i.e. see Section X) reference is typeset with: <spanx style="verb" xml:space="preserve">[Click here](#localid)</spanx> or <spanx style="verb" xml:space="preserve">[](#localid)</spanx>. This converts to a <spanx style="verb" xml:space="preserve">&lt;link&gt;</spanx>.  </t><t>For referencing RFCs, you will need add the reference source in the template, as an external XML entity. After that you can use: <spanx style="verb" xml:space="preserve">[](#RFC2119)</spanx> </t><t>Note that referencing figures/artworks and tables is done slightly different. The reason for this is that Pandoc does not have native support/syntax for this. We work around it, by "faking" the reference in the xslt. Thus for referencing figures/artworks and tables, you need: </t><t><list style="symbols"><t>To take the first 10 characters of the caption (i.e. this is the text <spanx style="emph" xml:space="preserve">after</spanx> the string "Table: " or "Figure: "); </t><t>Translate spaces and single quotes ' to a minus <spanx style="verb" xml:space="preserve">-</spanx>; </t><t>Translate uppercase letters to lowercase; </t><t>For tables prefix the anchor with <spanx style="verb" xml:space="preserve">tab:</spanx> and for figures use <spanx style="verb" xml:space="preserve">fig:</spanx>.  </t></list></t><t>The figure from <xref target="pandoc-to-rfc" pageno="false" format="default"/> will get <spanx style="verb" xml:space="preserve">fig:a-very-min</spanx> as an anchor.  </t><t>Note that duplicate anchors are an XML validation error which will make xml2rfc fail. These are not detected during the XSL transformation.  </t></section><section title="Indexes" anchor="indexes" toc="default"><t>The footnote syntax of Pandoc is slightly abused to support an index. Sub items are also supported. Use an exclamation mark (<spanx style="verb" xml:space="preserve">!</spanx>) to separate them: </t><figure title="" suppress-title="false" align="left" alt="" width="" height=""><artwork xml:space="preserve" name="" type="" align="left" alt="" width="" height="">
[^1]: item!sub item
</artwork></figure></section></section><section title="Security Considerations" anchor="security-considerations" toc="default"><t>This document raises no security issues.  </t></section><section title="IANA Considerations" anchor="iana-considerations" toc="default"><t>This document has no actions for IANA.  </t></section> </middle>
  <back><references title="Normative References"><reference anchor="Markdown" target="http://daringfireball.net/projects/markdown/"><front><title>Markdown</title><author initials="J." surname="Gruber" fullname="John Gruber"><organization>The Daring Fireball Company LLC.</organization><address><email>comments@daringfireball.net</email><uri>http://daringfireball.net/</uri></address></author><date year="2004"/></front></reference> <reference anchor="XSLT" target="http://xmlsoft.org/XSLT/xsltproc2.html"><front><title>The XSLT C library for GNOME</title><author initials="D." surname="Veillard" fullname="Daniel Veillard"><organization>XML Soft</organization><address><email/><uri>http://xmlsoft.org/</uri></address></author><date year="2006"/></front></reference> <reference anchor="Pandoc" target="http://johnmacfarlane.net/pandoc/"><front><title>Pandoc, a universal document converter</title><author initials="J." surname="MacFarlane" fullname="John MacFarlane"><organization>University of California, Berkeley</organization><address><email>jgm@berkeley.edu</email><uri>http://johnmacfarlane.net/</uri></address></author><date year="2006"/></front></reference> <reference anchor="Pandoc2rfc" target="http://github.com/miekg/pandoc2rfc"><front><title abbrev="Pandoc2rfc">Pandoc2rfc git repository</title><author initials="R." surname="Gieben" fullname="R. (Miek) Gieben"><address><email>miek@miek.nl</email></address></author><date year="2012" month="October"/></front></reference> <reference anchor="RFC2629"><front><title>Writing I-Ds and RFCs using XML</title><author initials="M.T." surname="Rose" fullname="Marshall T. Rose"><organization>Invisible Worlds, Inc.</organization><address><postal><street>660 York Street</street><city>San Francisco</city><region>CA</region><code>94110</code><country>US</country></postal><phone>+1 415 695 3975</phone><email>mrose@not.invisible.net</email><uri>http://invisible.net/</uri></address></author><date year="1999" month="June"/><area>General</area><keyword>RFC</keyword><keyword>Request for Comments</keyword><keyword>I-D</keyword><keyword>Internet-Draft</keyword><keyword>XML</keyword><keyword>Extensible Markup Language</keyword><abstract><t>This memo presents a technique for using XML (Extensible Markup Language) as a source format for documents in the Internet-Drafts (I-Ds) and Request for Comments (RFC) series.</t></abstract></front><seriesInfo name="RFC" value="2629"/><format type="TXT" octets="48677" target="http://www.rfc-editor.org/rfc/rfc2629.txt"/><format type="HTML" octets="72426" target="http://xml.resource.org/public/rfc/html/rfc2629.html"/><format type="XML" octets="53481" target="http://xml.resource.org/public/rfc/xml/rfc2629.xml"/></reference> <reference anchor="W3C.REC-xslt-19991116" target="http://www.w3.org/TR/1999/REC-xslt-19991116"><front><title>XSL Transformations (XSLT) Version 1.0</title><author initials="J." surname="Clark" fullname="James Clark"><organization/></author><date month="November" day="16" year="1999"/></front><seriesInfo name="World Wide Web Consortium Recommendation" value="REC-xslt-19991116"/><format type="HTML" target="http://www.w3.org/TR/1999/REC-xslt-19991116"/></reference> </references><!--This document was prepared using Pandoc2rfc --><!--https://github.com/miekg/pandoc2rfc --><section title="Cheat Sheet" anchor="cheat-sheet" toc="default"><texttable anchor="tab:the-most-i" title="" suppress-title="false" align="center" style="full"><ttcol align="left">Textual Construct </ttcol><ttcol align="left">Pandoc Syntax </ttcol><ttcol align="left">Xml2rfc Syntax </ttcol><c>Section Header </c><c><spanx style="verb" xml:space="preserve"># Section</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;section title= ...&gt;</spanx> </c><c>Unordered List </c><c><spanx style="verb" xml:space="preserve">* item</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;list style="symbols"&gt;</spanx> </c><c>Unordered List </c><c><spanx style="verb" xml:space="preserve">#. item</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;list style="empty"&gt;</spanx> </c><c>Ordered List </c><c><spanx style="verb" xml:space="preserve">1. item</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;list style="numbers"&gt;</spanx> </c><c>Ordered List </c><c><spanx style="verb" xml:space="preserve">a.  item</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;list style="letters"&gt;</spanx> </c><c>Ordered List </c><c><spanx style="verb" xml:space="preserve">ii. item</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;list style="format %i"&gt;</spanx> </c><c>Ordered List </c><c><spanx style="verb" xml:space="preserve">II. item</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;list style="format (%d)"&gt;</spanx> </c><c>Ordered List </c><c><spanx style="verb" xml:space="preserve">A.  item</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;list style="format (%C)"&gt;</spanx> </c><c>Definition List </c><c>Definition </c><c><spanx style="verb" xml:space="preserve">&lt;list style="hanging"&gt;</spanx> </c><c>Emphasis </c><c><spanx style="verb" xml:space="preserve">_text_</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;spanx style="emph"&gt;</spanx> </c><c>Strong Emphasis </c><c><spanx style="verb" xml:space="preserve">**text**</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;spanx style="strong"&gt;</spanx> </c><c>Verbatim </c><c><spanx style="verb" xml:space="preserve">`text`</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;spanx style="verb"&gt;</spanx> </c><c>Block Quote </c><c><spanx style="verb" xml:space="preserve">&gt; quote</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;list style="hanging"&gt;</spanx> </c><c>Index </c><c>Footnotes </c><c><spanx style="verb" xml:space="preserve">&lt;iref item="index"/&gt;</spanx> </c><c>Table </c><c>Tables </c><c><spanx style="verb" xml:space="preserve">&lt;texttable&gt;</spanx> </c><c>Figure/Artwork </c><c>Code Blocks </c><c><spanx style="verb" xml:space="preserve">&lt;figure&gt;&lt;artwork&gt;</spanx> </c><c>External Reference </c><c><spanx style="verb" xml:space="preserve">[Click](URI)</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;eref target="..."/&gt;</spanx> </c><c>Internal Reference </c><c><spanx style="verb" xml:space="preserve">[](#id)</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;xref target="id"&gt;</spanx> </c><c>Figure Reference </c><c><spanx style="verb" xml:space="preserve">[](#fig:...)</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;xref target="..."/&gt;</spanx> </c><c>Table Reference </c><c><spanx style="verb" xml:space="preserve">[](#tab:...)</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;xref target="..."/&gt;</spanx> </c><c>Citations </c><c><spanx style="verb" xml:space="preserve">[](#RFC2119)</spanx> </c><c><spanx style="verb" xml:space="preserve">&lt;xref target="RFC2119"&gt;</spanx> </c><postamble>The most important textual constructs that can be used in Pandoc2rfc.  </postamble></texttable></section> </back>
</rfc>
